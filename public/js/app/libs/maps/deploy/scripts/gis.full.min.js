/*! TacticMapClient - v0.9.5 - 2015-01-16
 * Copyright (c) STC 2015 
 includes leaflet */
var buildDate = "2015-01-16 19:21";
var buildVersion = "0.9.5";
function BitSet(a, b) {
    void 0 === a ? a = 31 : "string" == typeof a && (a = a.length), b = 1 !== b ? 0 : 2147483647;
    for (var c = 31, d = Math.ceil(a / c), e = d; e--;)this[e] = b;
    if ("string" == typeof a)for (e = a.length; e--;)this.set(e, a.charAt(e));
    var f = function (a, b, e, f) {
        if (void 0 === e && (void 0 === b ? (b = 0, e = d * c - 1) : e = b), 0 > b || b > e || e >= c * d)return null;
        for (var g = d; g--;) {
            var h = Math.max(b, g * c), i = Math.min(e, c - 1 + c * g);
            if (i >= h) {
                var j = ~(1 << 1 + i % c) + (1 << h % c);
                0 === f ? a[g] &= j : a[g] ^= ~j
            }
        }
        return a
    };
    this.size = c * d, this.length = d, this.and = function (a) {
        if (a instanceof BitSet)for (var b = d; b--;)this[b] &= a[b] || 0;
        return this
    }, this.or = function (a) {
        if (a instanceof BitSet)for (var b = d; b--;)this[b] |= a[b] || 0;
        return this
    }, this.nand = function (a) {
        if (a instanceof BitSet)for (var b = d; b--;)this[b] = ~(this[b] & (a[b] || 0));
        return this
    }, this.nor = function (a) {
        if (a instanceof BitSet)for (var b = d; b--;)this[b] = ~(this[b] | (a[b] || 0));
        return this
    }, this.not = function () {
        for (var a = d; a--;)this[a] = ~this[a];
        return this
    }, this.xor = function (a) {
        if (a instanceof BitSet)for (var b = d; b--;)this[b] = this[b] ^ (a[b] || 0);
        return this
    }, this.equals = function (a) {
        if (!(a instanceof BitSet))return!1;
        if (a.length !== d)return!1;
        for (var b = d; b--;)if (a[b] !== this[b])return!1;
        return!0
    }, this.subsetOf = function (a) {
        if (!(a instanceof BitSet))return!1;
        if (a.length !== d)return!1;
        for (var b = d; b--;)if ((a[b] & this[b]) !== this[b])return!1;
        return!0
    }, this.clone = function () {
        for (var a = new BitSet(this.size), b = d; b--;)a[b] = this[b];
        return a
    }, this.isEmpty = function () {
        for (var a = d; a--;)if (0 !== this[a])return!1;
        return!0
    }, this.toString = function (a) {
        for (var b = "", e = d; e--;) {
            d > e + 1 && void 0 !== a && (b += String(a));
            var f = this[e].toString(2);
            b += new Array(1 + c - f.length).join("0"), b += f
        }
        return b
    }, this.cardinality = function () {
        for (var a, b = 0, c = d; c--;)for (a = this[c]; a; a &= a - 1, b++);
        return b
    }, this.msb = function () {
        for (var a = d; a--;) {
            var b = this[a], e = 0;
            if (b) {
                for (; b >>= 1; e++);
                return c * a + e
            }
        }
        return 0
    }, this.set = function (a, b) {
        if (void 0 === b && (b = 1), a >= 0 && c * d > a) {
            var e = a / c | 0;
            return this[e] ^= 1 << a % c & (-(1 & b) ^ this[e]), this
        }
        return null
    }, this.setRange = function (a, b, e) {
        if (b >= a && a >= 0 && c * d > b) {
            if ("string" == typeof e) {
                if (b - a !== e.length)return null;
                for (var f = 0; f < e.length; f++)this.set(f + a, e.charAt(e.length - f - 1))
            } else {
                void 0 === e && (e = 1);
                for (var f = a; b >= f; f++)this.set(f, e)
            }
            return this
        }
        return null
    }, this.get = function (a) {
        return a >= 0 && c * d > a ? this[a / c | 0] >> a % c & 1 : null
    }, this.getRange = function (a, b) {
        if (b >= a && a >= 0 && c * d > b) {
            for (var e = new BitSet(b - a + 1), f = a; b >= f; f++)e.set(f - a, this.get(f));
            return e
        }
        return null
    }, this.clear = function (a, b) {
        return f(this, a, b, 0)
    }, this.flip = function (a, b) {
        return f(this, a, b, 1)
    }
}
function HashArray(a) {
    "use strict";
    var b = {}, c = 5;
    c = a || c, this.add = function (a, d) {
        b[a] || (b[a] = []);
        var e = b[a].length;
        e >= c && (b[a] = b[a].slice(e - c + 1)), b[a].push(d)
    }, this.clear = function (a) {
        Gis.Util.isDefine(a) ? delete b[a] : b = {}
    }, this.getList = function (a) {
        return b[a] && b[a].slice()
    }, this.hasElements = function () {
        return Object.keys(b).length
    }
}
function HashList() {
    "use strict";
    function a(a, b) {
        return e[a] ? e[a][b] || void 0 : void 0
    }

    function b(a) {
        var b, c = [];
        for (b in e)e.hasOwnProperty(b) && e[b][a] && c.push(e[b][a]);
        return c.length && (c.length > 1 ? c : c[0]) || void 0
    }

    function c(a, b) {
        return e[a] && e[a][b] ? delete e[a][b] : !1
    }

    function d(a) {
        var b;
        for (b in e)if (e.hasOwnProperty(b) && e[b][a])return delete e[b][a];
        return!1
    }

    var e = {};
    this.add = function (a, b, c) {
        e[a] || (e[a] = {}), e[a][b] = c
    }, this.clear = function (a) {
        Gis.Util.isDefine(a) ? delete e[a] : e = {}
    }, this.getList = function (a) {
        return e[a]
    }, this.hasElements = function () {
        return Object.keys(e).length
    }, this.getObject = function (c, d) {
        return d ? a(c, d) : b(c)
    }, this.remove = function (a, b) {
        return b ? c(a, b) : d(a)
    }, this.each = function (a, b) {
        var c, d, f, g;
        for (c in e)if (e.hasOwnProperty(c)) {
            f = e[c];
            for (d in f)f.hasOwnProperty(d) && (g = f[d], b ? a.call(b, g) : a.call(g, g))
        }
    }
}
function RGBColor(a) {
    this.parseColor(a)
}
var buildDate = "2015-01-16 19:21", buildVersion = "0.9.5";
!function () {
    "use strict";
    var a = navigator.userAgent.match(/AppleWebKit\/(\d+\.\d+)/);
    a && "535.22" === a[1] && (window.L_DISABLE_3D = !0)
}(), function (a, b, c) {
    var d = a.L, e = {};
    e.version = "0.7.2", "object" == typeof module && "object" == typeof module.exports ? module.exports = e : "function" == typeof define && define.amd && define(e), e.noConflict = function () {
        return a.L = d, this
    }, a.L = e, e.Util = {extend: function (a) {
        var b, c, d, e, f = Array.prototype.slice.call(arguments, 1);
        for (c = 0, d = f.length; d > c; c++) {
            e = f[c] || {};
            for (b in e)e.hasOwnProperty(b) && (a[b] = e[b])
        }
        return a
    }, bind: function (a, b) {
        var c = arguments.length > 2 ? Array.prototype.slice.call(arguments, 2) : null;
        return function () {
            return a.apply(b, c || arguments)
        }
    }, stamp: function () {
        var a = 0, b = "_leaflet_id";
        return function (c) {
            return c[b] = c[b] || ++a, c[b]
        }
    }(), invokeEach: function (a, b, c) {
        var d, e;
        if ("object" == typeof a) {
            e = Array.prototype.slice.call(arguments, 3);
            for (d in a)b.apply(c, [d, a[d]].concat(e));
            return!0
        }
        return!1
    }, limitExecByInterval: function (a, b, c) {
        var d, e;
        return function f() {
            var g = arguments;
            return d ? void(e = !0) : (d = !0, setTimeout(function () {
                d = !1, e && (f.apply(c, g), e = !1)
            }, b), void a.apply(c, g))
        }
    }, falseFn: function () {
        return!1
    }, formatNum: function (a, b) {
        var c = Math.pow(10, b || 5);
        return Math.round(a * c) / c
    }, trim: function (a) {
        return a.trim ? a.trim() : a.replace(/^\s+|\s+$/g, "")
    }, splitWords: function (a) {
        return e.Util.trim(a).split(/\s+/)
    }, setOptions: function (a, b) {
        return a.options = e.extend({}, a.options, b), a.options
    }, getParamString: function (a, b, c) {
        var d = [];
        for (var e in a)d.push(encodeURIComponent(c ? e.toUpperCase() : e) + "=" + encodeURIComponent(a[e]));
        return(b && -1 !== b.indexOf("?") ? "&" : "?") + d.join("&")
    }, template: function (a, b) {
        return a.replace(/\{ *([\w_]+) *\}/g, function (a, d) {
            var e = b[d];
            if (e === c)throw new Error("No value provided for variable " + a);
            return"function" == typeof e && (e = e(b)), e
        })
    }, isArray: Array.isArray || function (a) {
        return"[object Array]" === Object.prototype.toString.call(a)
    }, emptyImageUrl: "data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="}, function () {
        function b(b) {
            var c, d, e = ["webkit", "moz", "o", "ms"];
            for (c = 0; c < e.length && !d; c++)d = a[e[c] + b];
            return d
        }

        function c(b) {
            var c = +new Date, e = Math.max(0, 16 - (c - d));
            return d = c + e, a.setTimeout(b, e)
        }

        var d = 0, f = a.requestAnimationFrame || b("RequestAnimationFrame") || c, g = a.cancelAnimationFrame || b("CancelAnimationFrame") || b("CancelRequestAnimationFrame") || function (b) {
            a.clearTimeout(b)
        };
        e.Util.requestAnimFrame = function (b, d, g, h) {
            return b = e.bind(b, d), g && f === c ? void b() : f.call(a, b, h)
        }, e.Util.cancelAnimFrame = function (b) {
            b && g.call(a, b)
        }
    }(), e.extend = e.Util.extend, e.bind = e.Util.bind, e.stamp = e.Util.stamp, e.setOptions = e.Util.setOptions, e.Class = function () {
    }, e.Class.extend = function (a) {
        var b = function () {
            this.initialize && this.initialize.apply(this, arguments), this._initHooks && this.callInitHooks()
        }, c = function () {
        };
        c.prototype = this.prototype;
        var d = new c;
        d.constructor = b, b.prototype = d;
        for (var f in this)this.hasOwnProperty(f) && "prototype" !== f && (b[f] = this[f]);
        a.statics && (e.extend(b, a.statics), delete a.statics), a.includes && (e.Util.extend.apply(null, [d].concat(a.includes)), delete a.includes), a.options && d.options && (a.options = e.extend({}, d.options, a.options)), e.extend(d, a), d._initHooks = [];
        var g = this;
        return b.__super__ = g.prototype, d.callInitHooks = function () {
            if (!this._initHooksCalled) {
                g.prototype.callInitHooks && g.prototype.callInitHooks.call(this), this._initHooksCalled = !0;
                for (var a = 0, b = d._initHooks.length; b > a; a++)d._initHooks[a].call(this)
            }
        }, b
    }, e.Class.include = function (a) {
        e.extend(this.prototype, a)
    }, e.Class.mergeOptions = function (a) {
        e.extend(this.prototype.options, a)
    }, e.Class.addInitHook = function (a) {
        var b = Array.prototype.slice.call(arguments, 1), c = "function" == typeof a ? a : function () {
            this[a].apply(this, b)
        };
        this.prototype._initHooks = this.prototype._initHooks || [], this.prototype._initHooks.push(c)
    };
    var f = "_leaflet_events";
    e.Mixin = {}, e.Mixin.Events = {addEventListener: function (a, b, c) {
        if (e.Util.invokeEach(a, this.addEventListener, this, b, c))return this;
        var d, g, h, i, j, k, l, m = this[f] = this[f] || {}, n = c && c !== this && e.stamp(c);
        for (a = e.Util.splitWords(a), d = 0, g = a.length; g > d; d++)h = {action: b, context: c || this}, i = a[d], n ? (j = i + "_idx", k = j + "_len", l = m[j] = m[j] || {}, l[n] || (l[n] = [], m[k] = (m[k] || 0) + 1), l[n].push(h)) : (m[i] = m[i] || [], m[i].push(h));
        return this
    }, hasEventListeners: function (a) {
        var b = this[f];
        return!!b && (a in b && b[a].length > 0 || a + "_idx"in b && b[a + "_idx_len"] > 0)
    }, removeEventListener: function (a, b, c) {
        if (!this[f])return this;
        if (!a)return this.clearAllEventListeners();
        if (e.Util.invokeEach(a, this.removeEventListener, this, b, c))return this;
        var d, g, h, i, j, k, l, m, n, o = this[f], p = c && c !== this && e.stamp(c);
        for (a = e.Util.splitWords(a), d = 0, g = a.length; g > d; d++)if (h = a[d], k = h + "_idx", l = k + "_len", m = o[k], b) {
            if (i = p && m ? m[p] : o[h]) {
                for (j = i.length - 1; j >= 0; j--)i[j].action !== b || c && i[j].context !== c || (n = i.splice(j, 1), n[0].action = e.Util.falseFn);
                c && m && 0 === i.length && (delete m[p], o[l]--)
            }
        } else delete o[h], delete o[k], delete o[l];
        return this
    }, clearAllEventListeners: function () {
        return delete this[f], this
    }, fireEvent: function (a, b) {
        if (!this.hasEventListeners(a))return this;
        var c, d, g, h, i, j = e.Util.extend({}, b, {type: a, target: this}), k = this[f];
        if (k[a])for (c = k[a].slice(), d = 0, g = c.length; g > d; d++)c[d].action.call(c[d].context, j);
        h = k[a + "_idx"];
        for (i in h)if (c = h[i].slice())for (d = 0, g = c.length; g > d; d++)c[d].action.call(c[d].context, j);
        return this
    }, addOneTimeEventListener: function (a, b, c) {
        if (e.Util.invokeEach(a, this.addOneTimeEventListener, this, b, c))return this;
        var d = e.bind(function () {
            this.removeEventListener(a, b, c).removeEventListener(a, d, c)
        }, this);
        return this.addEventListener(a, b, c).addEventListener(a, d, c)
    }}, e.Mixin.Events.on = e.Mixin.Events.addEventListener, e.Mixin.Events.off = e.Mixin.Events.removeEventListener, e.Mixin.Events.once = e.Mixin.Events.addOneTimeEventListener, e.Mixin.Events.fire = e.Mixin.Events.fireEvent, function () {
        var d = "ActiveXObject"in a, f = d && !b.addEventListener, g = navigator.userAgent.toLowerCase(), h = -1 !== g.indexOf("webkit"), i = -1 !== g.indexOf("chrome"), j = -1 !== g.indexOf("phantom"), k = -1 !== g.indexOf("android"), l = -1 !== g.search("android [23]"), m = -1 !== g.indexOf("gecko"), n = typeof orientation != c + "", o = a.navigator && a.navigator.msPointerEnabled && a.navigator.msMaxTouchPoints && !a.PointerEvent, p = a.PointerEvent && a.navigator.pointerEnabled && a.navigator.maxTouchPoints || o, q = "devicePixelRatio"in a && a.devicePixelRatio > 1 || "matchMedia"in a && a.matchMedia("(min-resolution:144dpi)") && a.matchMedia("(min-resolution:144dpi)").matches, r = b.documentElement, s = d && "transition"in r.style, t = "WebKitCSSMatrix"in a && "m11"in new a.WebKitCSSMatrix && !l, u = "MozPerspective"in r.style, v = "OTransition"in r.style, w = !a.L_DISABLE_3D && (s || t || u || v) && !j, x = !a.L_NO_TOUCH && !j && function () {
            var a = "ontouchstart";
            if (p || a in r)return!0;
            var c = b.createElement("div"), d = !1;
            return c.setAttribute ? (c.setAttribute(a, "return;"), "function" == typeof c[a] && (d = !0), c.removeAttribute(a), c = null, d) : !1
        }();
        e.Browser = {ie: d, ielt9: f, webkit: h, gecko: m && !h && !a.opera && !d, android: k, android23: l, chrome: i, ie3d: s, webkit3d: t, gecko3d: u, opera3d: v, any3d: w, mobile: n, mobileWebkit: n && h, mobileWebkit3d: n && t, mobileOpera: n && a.opera, touch: x, msPointer: o, pointer: p, retina: q}
    }(), e.Point = function (a, b, c) {
        this.x = c ? Math.round(a) : a, this.y = c ? Math.round(b) : b
    }, e.Point.prototype = {clone: function () {
        return new e.Point(this.x, this.y)
    }, add: function (a) {
        return this.clone()._add(e.point(a))
    }, _add: function (a) {
        return this.x += a.x, this.y += a.y, this
    }, subtract: function (a) {
        return this.clone()._subtract(e.point(a))
    }, _subtract: function (a) {
        return this.x -= a.x, this.y -= a.y, this
    }, divideBy: function (a) {
        return this.clone()._divideBy(a)
    }, _divideBy: function (a) {
        return this.x /= a, this.y /= a, this
    }, multiplyBy: function (a) {
        return this.clone()._multiplyBy(a)
    }, _multiplyBy: function (a) {
        return this.x *= a, this.y *= a, this
    }, round: function () {
        return this.clone()._round()
    }, _round: function () {
        return this.x = Math.round(this.x), this.y = Math.round(this.y), this
    }, floor: function () {
        return this.clone()._floor()
    }, _floor: function () {
        return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this
    }, distanceTo: function (a) {
        a = e.point(a);
        var b = a.x - this.x, c = a.y - this.y;
        return Math.sqrt(b * b + c * c)
    }, equals: function (a) {
        return a = e.point(a), a.x === this.x && a.y === this.y
    }, contains: function (a) {
        return a = e.point(a), Math.abs(a.x) <= Math.abs(this.x) && Math.abs(a.y) <= Math.abs(this.y)
    }, toString: function () {
        return"Point(" + e.Util.formatNum(this.x) + ", " + e.Util.formatNum(this.y) + ")"
    }}, e.point = function (a, b, d) {
        return a instanceof e.Point ? a : e.Util.isArray(a) ? new e.Point(a[0], a[1]) : a === c || null === a ? a : new e.Point(a, b, d)
    }, e.Bounds = function (a, b) {
        if (a)for (var c = b ? [a, b] : a, d = 0, e = c.length; e > d; d++)this.extend(c[d])
    }, e.Bounds.prototype = {extend: function (a) {
        return a = e.point(a), this.min || this.max ? (this.min.x = Math.min(a.x, this.min.x), this.max.x = Math.max(a.x, this.max.x), this.min.y = Math.min(a.y, this.min.y), this.max.y = Math.max(a.y, this.max.y)) : (this.min = a.clone(), this.max = a.clone()), this
    }, getCenter: function (a) {
        return new e.Point((this.min.x + this.max.x) / 2, (this.min.y + this.max.y) / 2, a)
    }, getBottomLeft: function () {
        return new e.Point(this.min.x, this.max.y)
    }, getTopRight: function () {
        return new e.Point(this.max.x, this.min.y)
    }, getSize: function () {
        return this.max.subtract(this.min)
    }, contains: function (a) {
        var b, c;
        return a = "number" == typeof a[0] || a instanceof e.Point ? e.point(a) : e.bounds(a), a instanceof e.Bounds ? (b = a.min, c = a.max) : b = c = a, b.x >= this.min.x && c.x <= this.max.x && b.y >= this.min.y && c.y <= this.max.y
    }, intersects: function (a) {
        a = e.bounds(a);
        var b = this.min, c = this.max, d = a.min, f = a.max, g = f.x >= b.x && d.x <= c.x, h = f.y >= b.y && d.y <= c.y;
        return g && h
    }, isValid: function () {
        return!(!this.min || !this.max)
    }}, e.bounds = function (a, b) {
        return!a || a instanceof e.Bounds ? a : new e.Bounds(a, b)
    }, e.Transformation = function (a, b, c, d) {
        this._a = a, this._b = b, this._c = c, this._d = d
    }, e.Transformation.prototype = {transform: function (a, b) {
        return this._transform(a.clone(), b)
    }, _transform: function (a, b) {
        return b = b || 1, a.x = b * (this._a * a.x + this._b), a.y = b * (this._c * a.y + this._d), a
    }, untransform: function (a, b) {
        return b = b || 1, new e.Point((a.x / b - this._b) / this._a, (a.y / b - this._d) / this._c)
    }}, e.DomUtil = {get: function (a) {
        return"string" == typeof a ? b.getElementById(a) : a
    }, getStyle: function (a, c) {
        var d = a.style[c];
        if (!d && a.currentStyle && (d = a.currentStyle[c]), (!d || "auto" === d) && b.defaultView) {
            var e = b.defaultView.getComputedStyle(a, null);
            d = e ? e[c] : null
        }
        return"auto" === d ? null : d
    }, getViewportOffset: function (a) {
        var c, d = 0, f = 0, g = a, h = b.body, i = b.documentElement;
        do {
            if (d += g.offsetTop || 0, f += g.offsetLeft || 0, d += parseInt(e.DomUtil.getStyle(g, "borderTopWidth"), 10) || 0, f += parseInt(e.DomUtil.getStyle(g, "borderLeftWidth"), 10) || 0, c = e.DomUtil.getStyle(g, "position"), g.offsetParent === h && "absolute" === c)break;
            if ("fixed" === c) {
                d += h.scrollTop || i.scrollTop || 0, f += h.scrollLeft || i.scrollLeft || 0;
                break
            }
            if ("relative" === c && !g.offsetLeft) {
                var j = e.DomUtil.getStyle(g, "width"), k = e.DomUtil.getStyle(g, "max-width"), l = g.getBoundingClientRect();
                ("none" !== j || "none" !== k) && (f += l.left + g.clientLeft), d += l.top + (h.scrollTop || i.scrollTop || 0);
                break
            }
            g = g.offsetParent
        } while (g);
        g = a;
        do {
            if (g === h)break;
            d -= g.scrollTop || 0, f -= g.scrollLeft || 0, g = g.parentNode
        } while (g);
        return new e.Point(f, d)
    }, documentIsLtr: function () {
        return e.DomUtil._docIsLtrCached || (e.DomUtil._docIsLtrCached = !0, e.DomUtil._docIsLtr = "ltr" === e.DomUtil.getStyle(b.body, "direction")), e.DomUtil._docIsLtr
    }, create: function (a, c, d) {
        var e = b.createElement(a);
        return e.className = c, d && d.appendChild(e), e
    }, hasClass: function (a, b) {
        if (a.classList !== c)return a.classList.contains(b);
        var d = e.DomUtil._getClass(a);
        return d.length > 0 && new RegExp("(^|\\s)" + b + "(\\s|$)").test(d)
    }, addClass: function (a, b) {
        if (a.classList !== c)for (var d = e.Util.splitWords(b), f = 0, g = d.length; g > f; f++)a.classList.add(d[f]); else if (!e.DomUtil.hasClass(a, b)) {
            var h = e.DomUtil._getClass(a);
            e.DomUtil._setClass(a, (h ? h + " " : "") + b)
        }
    }, removeClass: function (a, b) {
        a.classList !== c ? a.classList.remove(b) : e.DomUtil._setClass(a, e.Util.trim((" " + e.DomUtil._getClass(a) + " ").replace(" " + b + " ", " ")))
    }, _setClass: function (a, b) {
        a.className.baseVal === c ? a.className = b : a.className.baseVal = b
    }, _getClass: function (a) {
        return a.className.baseVal === c ? a.className : a.className.baseVal
    }, setOpacity: function (a, b) {
        if ("opacity"in a.style)a.style.opacity = b; else if ("filter"in a.style) {
            var c = !1, d = "DXImageTransform.Microsoft.Alpha";
            try {
                c = a.filters.item(d)
            } catch (e) {
                if (1 === b)return
            }
            b = Math.round(100 * b), c ? (c.Enabled = 100 !== b, c.Opacity = b) : a.style.filter += " progid:" + d + "(opacity=" + b + ")"
        }
    }, testProp: function (a) {
        for (var c = b.documentElement.style, d = 0; d < a.length; d++)if (a[d]in c)return a[d];
        return!1
    }, getTranslateString: function (a) {
        var b = e.Browser.webkit3d, c = "translate" + (b ? "3d" : "") + "(", d = (b ? ",0" : "") + ")";
        return c + a.x + "px," + a.y + "px" + d
    }, getScaleString: function (a, b) {
        var c = e.DomUtil.getTranslateString(b.add(b.multiplyBy(-1 * a))), d = " scale(" + a + ") ";
        return c + d
    }, setPosition: function (a, b, c) {
        a._leaflet_pos = b, !c && e.Browser.any3d ? a.style[e.DomUtil.TRANSFORM] = e.DomUtil.getTranslateString(b) : (a.style.left = b.x + "px", a.style.top = b.y + "px")
    }, getPosition: function (a) {
        return a._leaflet_pos
    }}, e.DomUtil.TRANSFORM = e.DomUtil.testProp(["transform", "WebkitTransform", "OTransform", "MozTransform", "msTransform"]), e.DomUtil.TRANSITION = e.DomUtil.testProp(["webkitTransition", "transition", "OTransition", "MozTransition", "msTransition"]), e.DomUtil.TRANSITION_END = "webkitTransition" === e.DomUtil.TRANSITION || "OTransition" === e.DomUtil.TRANSITION ? e.DomUtil.TRANSITION + "End" : "transitionend", function () {
        if ("onselectstart"in b)e.extend(e.DomUtil, {disableTextSelection: function () {
            e.DomEvent.on(a, "selectstart", e.DomEvent.preventDefault)
        }, enableTextSelection: function () {
            e.DomEvent.off(a, "selectstart", e.DomEvent.preventDefault)
        }}); else {
            var c = e.DomUtil.testProp(["userSelect", "WebkitUserSelect", "OUserSelect", "MozUserSelect", "msUserSelect"]);
            e.extend(e.DomUtil, {disableTextSelection: function () {
                if (c) {
                    var a = b.documentElement.style;
                    this._userSelect = a[c], a[c] = "none"
                }
            }, enableTextSelection: function () {
                c && (b.documentElement.style[c] = this._userSelect, delete this._userSelect)
            }})
        }
        e.extend(e.DomUtil, {disableImageDrag: function () {
            e.DomEvent.on(a, "dragstart", e.DomEvent.preventDefault)
        }, enableImageDrag: function () {
            e.DomEvent.off(a, "dragstart", e.DomEvent.preventDefault)
        }})
    }(), e.LatLng = function (a, b, d) {
        if (a = parseFloat(a), b = parseFloat(b), isNaN(a) || isNaN(b))throw new Error("Invalid LatLng object: (" + a + ", " + b + ")");
        this.lat = a, this.lng = b, d !== c && (this.alt = parseFloat(d))
    }, e.extend(e.LatLng, {DEG_TO_RAD: Math.PI / 180, RAD_TO_DEG: 180 / Math.PI, MAX_MARGIN: 1e-9}), e.LatLng.prototype = {equals: function (a) {
        if (!a)return!1;
        a = e.latLng(a);
        var b = Math.max(Math.abs(this.lat - a.lat), Math.abs(this.lng - a.lng));
        return b <= e.LatLng.MAX_MARGIN
    }, toString: function (a) {
        return"LatLng(" + e.Util.formatNum(this.lat, a) + ", " + e.Util.formatNum(this.lng, a) + ")"
    }, distanceTo: function (a) {
        a = e.latLng(a);
        var b = 6378137, c = e.LatLng.DEG_TO_RAD, d = (a.lat - this.lat) * c, f = (a.lng - this.lng) * c, g = this.lat * c, h = a.lat * c, i = Math.sin(d / 2), j = Math.sin(f / 2), k = i * i + j * j * Math.cos(g) * Math.cos(h);
        return 2 * b * Math.atan2(Math.sqrt(k), Math.sqrt(1 - k))
    }, wrap: function (a, b) {
        var c = this.lng;
        return a = a || -180, b = b || 180, c = (c + b) % (b - a) + (a > c || c === b ? b : a), new e.LatLng(this.lat, c)
    }}, e.latLng = function (a, b) {
        return a instanceof e.LatLng ? a : e.Util.isArray(a) ? "number" == typeof a[0] || "string" == typeof a[0] ? new e.LatLng(a[0], a[1], a[2]) : null : a === c || null === a ? a : "object" == typeof a && "lat"in a ? new e.LatLng(a.lat, "lng"in a ? a.lng : a.lon) : b === c ? null : new e.LatLng(a, b)
    }, e.LatLngBounds = function (a, b) {
        if (a)for (var c = b ? [a, b] : a, d = 0, e = c.length; e > d; d++)this.extend(c[d])
    }, e.LatLngBounds.prototype = {extend: function (a) {
        if (!a)return this;
        var b = e.latLng(a);
        return a = null !== b ? b : e.latLngBounds(a), a instanceof e.LatLng ? this._southWest || this._northEast ? (this._southWest.lat = Math.min(a.lat, this._southWest.lat), this._southWest.lng = Math.min(a.lng, this._southWest.lng), this._northEast.lat = Math.max(a.lat, this._northEast.lat), this._northEast.lng = Math.max(a.lng, this._northEast.lng)) : (this._southWest = new e.LatLng(a.lat, a.lng), this._northEast = new e.LatLng(a.lat, a.lng)) : a instanceof e.LatLngBounds && (this.extend(a._southWest), this.extend(a._northEast)), this
    }, pad: function (a) {
        var b = this._southWest, c = this._northEast, d = Math.abs(b.lat - c.lat) * a, f = Math.abs(b.lng - c.lng) * a;
        return new e.LatLngBounds(new e.LatLng(b.lat - d, b.lng - f), new e.LatLng(c.lat + d, c.lng + f))
    }, getCenter: function () {
        return new e.LatLng((this._southWest.lat + this._northEast.lat) / 2, (this._southWest.lng + this._northEast.lng) / 2)
    }, getSouthWest: function () {
        return this._southWest
    }, getNorthEast: function () {
        return this._northEast
    }, getNorthWest: function () {
        return new e.LatLng(this.getNorth(), this.getWest())
    }, getSouthEast: function () {
        return new e.LatLng(this.getSouth(), this.getEast())
    }, getWest: function () {
        return this._southWest.lng
    }, getSouth: function () {
        return this._southWest.lat
    }, getEast: function () {
        return this._northEast.lng
    }, getNorth: function () {
        return this._northEast.lat
    }, contains: function (a) {
        a = "number" == typeof a[0] || a instanceof e.LatLng ? e.latLng(a) : e.latLngBounds(a);
        var b, c, d = this._southWest, f = this._northEast;
        return a instanceof e.LatLngBounds ? (b = a.getSouthWest(), c = a.getNorthEast()) : b = c = a, b.lat >= d.lat && c.lat <= f.lat && b.lng >= d.lng && c.lng <= f.lng
    }, intersects: function (a) {
        a = e.latLngBounds(a);
        var b = this._southWest, c = this._northEast, d = a.getSouthWest(), f = a.getNorthEast(), g = f.lat >= b.lat && d.lat <= c.lat, h = f.lng >= b.lng && d.lng <= c.lng;
        return g && h
    }, toBBoxString: function () {
        return[this.getWest(), this.getSouth(), this.getEast(), this.getNorth()].join(",")
    }, equals: function (a) {
        return a ? (a = e.latLngBounds(a), this._southWest.equals(a.getSouthWest()) && this._northEast.equals(a.getNorthEast())) : !1
    }, isValid: function () {
        return!(!this._southWest || !this._northEast)
    }}, e.latLngBounds = function (a, b) {
        return!a || a instanceof e.LatLngBounds ? a : new e.LatLngBounds(a, b)
    }, e.Projection = {}, e.Projection.SphericalMercator = {MAX_LATITUDE: 85.0511287798, project: function (a) {
        var b = e.LatLng.DEG_TO_RAD, c = this.MAX_LATITUDE, d = Math.max(Math.min(c, a.lat), -c), f = a.lng * b, g = d * b;
        return g = Math.log(Math.tan(Math.PI / 4 + g / 2)), new e.Point(f, g)
    }, unproject: function (a) {
        var b = e.LatLng.RAD_TO_DEG, c = a.x * b, d = (2 * Math.atan(Math.exp(a.y)) - Math.PI / 2) * b;
        return new e.LatLng(d, c)
    }}, e.Projection.LonLat = {project: function (a) {
        return new e.Point(a.lng, a.lat)
    }, unproject: function (a) {
        return new e.LatLng(a.y, a.x)
    }}, e.CRS = {latLngToPoint: function (a, b) {
        var c = this.projection.project(a), d = this.scale(b);
        return this.transformation._transform(c, d)
    }, pointToLatLng: function (a, b) {
        var c = this.scale(b), d = this.transformation.untransform(a, c);
        return this.projection.unproject(d)
    }, project: function (a) {
        return this.projection.project(a)
    }, scale: function (a) {
        return 256 * Math.pow(2, a)
    }, getSize: function (a) {
        var b = this.scale(a);
        return e.point(b, b)
    }}, e.CRS.Simple = e.extend({}, e.CRS, {projection: e.Projection.LonLat, transformation: new e.Transformation(1, 0, -1, 0), scale: function (a) {
        return Math.pow(2, a)
    }}), e.CRS.EPSG3857 = e.extend({}, e.CRS, {code: "EPSG:3857", projection: e.Projection.SphericalMercator, transformation: new e.Transformation(.5 / Math.PI, .5, -.5 / Math.PI, .5), project: function (a) {
        var b = this.projection.project(a), c = 6378137;
        return b.multiplyBy(c)
    }}), e.CRS.EPSG900913 = e.extend({}, e.CRS.EPSG3857, {code: "EPSG:900913"}), e.CRS.EPSG4326 = e.extend({}, e.CRS, {code: "EPSG:4326", projection: e.Projection.LonLat, transformation: new e.Transformation(1 / 360, .5, -1 / 360, .5)}), e.Map = e.Class.extend({includes: e.Mixin.Events, options: {crs: e.CRS.EPSG3857, fadeAnimation: e.DomUtil.TRANSITION && !e.Browser.android23, trackResize: !0, markerZoomAnimation: e.DomUtil.TRANSITION && e.Browser.any3d}, initialize: function (a, b) {
        b = e.setOptions(this, b), this._initContainer(a), this._initLayout(), this._onResize = e.bind(this._onResize, this), this._initEvents(), b.maxBounds && this.setMaxBounds(b.maxBounds), b.center && b.zoom !== c && this.setView(e.latLng(b.center), b.zoom, {reset: !0}), this._handlers = [], this._customLayers = {}, this._zoomBoundLayers = {}, this._tileLayersNum = 0, this.callInitHooks(), this._addLayers(b.layers)
    }, setView: function (a, b) {
        return b = b === c ? this.getZoom() : b, this._resetView(e.latLng(a), this._limitZoom(b)), this
    }, setZoom: function (a, b) {
        return this._loaded ? this.setView(this.getCenter(), a, {zoom: b}) : (this._zoom = this._limitZoom(a), this)
    }, zoomIn: function (a, b) {
        return this.setZoom(this._zoom + (a || 1), b)
    }, zoomOut: function (a, b) {
        return this.setZoom(this._zoom - (a || 1), b)
    }, setZoomAround: function (a, b, c) {
        var d = this.getZoomScale(b), f = this.getSize().divideBy(2), g = a instanceof e.Point ? a : this.latLngToContainerPoint(a), h = g.subtract(f).multiplyBy(1 - 1 / d), i = this.containerPointToLatLng(f.add(h));
        return this.setView(i, b, {zoom: c})
    }, fitBounds: function (a, b) {
        b = b || {}, a = a.getBounds ? a.getBounds() : e.latLngBounds(a);
        var c = e.point(b.paddingTopLeft || b.padding || [0, 0]), d = e.point(b.paddingBottomRight || b.padding || [0, 0]), f = this.getBoundsZoom(a, !1, c.add(d)), g = d.subtract(c).divideBy(2), h = this.project(a.getSouthWest(), f), i = this.project(a.getNorthEast(), f), j = this.unproject(h.add(i).divideBy(2).add(g), f);
        return f = b && b.maxZoom ? Math.min(b.maxZoom, f) : f, this.setView(j, f, b)
    }, fitWorld: function (a) {
        return this.fitBounds([
            [-90, -180],
            [90, 180]
        ], a)
    }, panTo: function (a, b) {
        return this.setView(a, this._zoom, {pan: b})
    }, panBy: function (a) {
        return this.fire("movestart"), this._rawPanBy(e.point(a)), this.fire("move"), this.fire("moveend")
    }, setMaxBounds: function (a) {
        return a = e.latLngBounds(a), this.options.maxBounds = a, a ? (this._loaded && this._panInsideMaxBounds(), this.on("moveend", this._panInsideMaxBounds, this)) : this.off("moveend", this._panInsideMaxBounds, this)
    }, panInsideBounds: function (a, b) {
        var c = this.getCenter(), d = this._limitCenter(c, this._zoom, a);
        return c.equals(d) ? this : this.panTo(d, b)
    }, addLayer: function (a) {
        var b = e.stamp(a);
        return this._customLayers[b] ? this : (this._customLayers[b] = a, !a.options || isNaN(a.options.maxZoom) && isNaN(a.options.minZoom) || (this._zoomBoundLayers[b] = a, this._updateZoomLevels()), this.options.zoomAnimation && e.TileLayer && a instanceof e.TileLayer && (this._tileLayersNum++, this._tileLayersToLoad++, a.on("load", this._onTileLayerLoad, this)), this._loaded && this._layerAdd(a), this)
    }, removeLayer: function (a) {
        var b = e.stamp(a);
        return this._customLayers[b] ? (this._loaded && a.onRemove(this), delete this._customLayers[b], this._loaded && this.fire("layerremove", {layer: a}), this._zoomBoundLayers[b] && (delete this._zoomBoundLayers[b], this._updateZoomLevels()), this.options.zoomAnimation && e.TileLayer && a instanceof e.TileLayer && (this._tileLayersNum--, this._tileLayersToLoad--, a.off("load", this._onTileLayerLoad, this)), this) : this
    }, hasLayer: function (a) {
        return a ? e.stamp(a)in this._customLayers : !1
    }, eachLayer: function (a, b) {
        for (var c in this._customLayers)a.call(b, this._customLayers[c]);
        return this
    }, invalidateSize: function (a) {
        if (!this._loaded)return this;
        a = e.extend({animate: !1, pan: !0}, a === !0 ? {animate: !0} : a);
        var b = this.getSize();
        this._sizeChanged = !0, this._initialCenter = null;
        var c = this.getSize(), d = b.divideBy(2).round(), f = c.divideBy(2).round(), g = d.subtract(f);
        return g.x || g.y ? (a.animate && a.pan ? this.panBy(g) : (a.pan && this._rawPanBy(g), this.fire("move"), a.debounceMoveend ? (clearTimeout(this._sizeTimer), this._sizeTimer = setTimeout(e.bind(this.fire, this, "moveend"), 200)) : this.fire("moveend")), this.fire("resize", {oldSize: b, newSize: c})) : this
    }, addHandler: function (a, b) {
        if (!b)return this;
        var c = this[a] = new b(this);
        return this._handlers.push(c), this.options[a] && c.enable(), this
    }, remove: function () {
        this._loaded && this.fire("unload"), this._initEvents("off");
        try {
            delete this._container._leaflet
        } catch (a) {
            this._container._leaflet = c
        }
        return this._clearPanes(), this._clearControlPos && this._clearControlPos(), this._clearHandlers(), this
    }, getCenter: function () {
        return this._checkIfLoaded(), this._initialCenter && !this._moved() ? this._initialCenter : this.layerPointToLatLng(this._getCenterLayerPoint())
    }, getZoom: function () {
        return this._zoom
    }, getBounds: function () {
        var a = this.getPixelBounds(), b = this.unproject(a.getBottomLeft()), c = this.unproject(a.getTopRight());
        return new e.LatLngBounds(b, c)
    }, getMinZoom: function () {
        return this.options.minZoom === c ? this._layersMinZoom === c ? 0 : this._layersMinZoom : this.options.minZoom
    }, getMaxZoom: function () {
        return this.options.maxZoom === c ? this._layersMaxZoom === c ? 1 / 0 : this._layersMaxZoom : this.options.maxZoom
    }, getBoundsZoom: function (a, b, c) {
        a = e.latLngBounds(a);
        var d, f = this.getMinZoom() - (b ? 1 : 0), g = this.getMaxZoom(), h = this.getSize(), i = a.getNorthWest(), j = a.getSouthEast(), k = !0;
        c = e.point(c || [0, 0]);
        do f++, d = this.project(j, f).subtract(this.project(i, f)).add(c), k = b ? d.x < h.x || d.y < h.y : h.contains(d); while (k && g >= f);
        return k && b ? null : b ? f : f - 1
    }, getSize: function () {
        return(!this._size || this._sizeChanged) && (this._size = new e.Point(this._container.clientWidth, this._container.clientHeight), this._sizeChanged = !1), this._size.clone()
    }, getPixelBounds: function () {
        var a = this._getTopLeftPoint();
        return new e.Bounds(a, a.add(this.getSize()))
    }, getPixelOrigin: function () {
        return this._checkIfLoaded(), this._initialTopLeftPoint
    }, getPanes: function () {
        return this._panes
    }, getContainer: function () {
        return this._container
    }, getZoomScale: function (a) {
        var b = this.options.crs;
        return b.scale(a) / b.scale(this._zoom)
    }, getScaleZoom: function (a) {
        return this._zoom + Math.log(a) / Math.LN2
    }, project: function (a, b) {
        return b = b === c ? this._zoom : b, this.options.crs.latLngToPoint(e.latLng(a), b)
    }, unproject: function (a, b) {
        return b = b === c ? this._zoom : b, this.options.crs.pointToLatLng(e.point(a), b)
    }, layerPointToLatLng: function (a) {
        var b = e.point(a).add(this.getPixelOrigin());
        return this.unproject(b)
    }, latLngToLayerPoint: function (a) {
        var b = this.project(e.latLng(a))._round();
        return b._subtract(this.getPixelOrigin())
    }, containerPointToLayerPoint: function (a) {
        return e.point(a).subtract(this._getMapPanePos())
    }, layerPointToContainerPoint: function (a) {
        return e.point(a).add(this._getMapPanePos())
    }, containerPointToLatLng: function (a) {
        var b = this.containerPointToLayerPoint(e.point(a));
        return this.layerPointToLatLng(b)
    }, latLngToContainerPoint: function (a) {
        return this.layerPointToContainerPoint(this.latLngToLayerPoint(e.latLng(a)))
    }, mouseEventToContainerPoint: function (a) {
        return e.DomEvent.getMousePosition(a, this._container)
    }, mouseEventToLayerPoint: function (a) {
        return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))
    }, mouseEventToLatLng: function (a) {
        return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))
    }, _initContainer: function (a) {
        var b = this._container = e.DomUtil.get(a);
        if (!b)throw new Error("Map container not found.");
        if (b._leaflet)throw new Error("Map container is already initialized.");
        b._leaflet = !0
    }, _initLayout: function () {
        var a = this._container;
        e.DomUtil.addClass(a, "leaflet-container" + (e.Browser.touch ? " leaflet-touch" : "") + (e.Browser.retina ? " leaflet-retina" : "") + (e.Browser.ielt9 ? " leaflet-oldie" : "") + (this.options.fadeAnimation ? " leaflet-fade-anim" : ""));
        var b = e.DomUtil.getStyle(a, "position");
        "absolute" !== b && "relative" !== b && "fixed" !== b && (a.style.position = "relative"), this._initPanes(), this._initControlPos && this._initControlPos()
    }, _initPanes: function () {
        var a = this._panes = {};
        this._mapPane = a.mapPane = this._createPane("leaflet-map-pane", this._container), this._tilePane = a.tilePane = this._createPane("leaflet-tile-pane", this._mapPane), a.objectsPane = this._createPane("leaflet-objects-pane", this._mapPane), a.shadowPane = this._createPane("leaflet-shadow-pane"), a.overlayPane = this._createPane("leaflet-overlay-pane"), a.markerPane = this._createPane("leaflet-marker-pane"), a.popupPane = this._createPane("leaflet-popup-pane");
        var b = " leaflet-zoom-hide";
        this.options.markerZoomAnimation || (e.DomUtil.addClass(a.markerPane, b), e.DomUtil.addClass(a.shadowPane, b), e.DomUtil.addClass(a.popupPane, b))
    }, _createPane: function (a, b) {
        return e.DomUtil.create("div", a, b || this._panes.objectsPane)
    }, _clearPanes: function () {
        this._container.removeChild(this._mapPane)
    }, _addLayers: function (a) {
        a = a ? e.Util.isArray(a) ? a : [a] : [];
        for (var b = 0, c = a.length; c > b; b++)this.addLayer(a[b])
    }, _resetView: function (a, b, c, d) {
        var f = this._zoom !== b;
        d || (this.fire("movestart"), f && this.fire("zoomstart")), this._zoom = b, this._initialCenter = a, this._initialTopLeftPoint = this._getNewTopLeftPoint(a), c ? this._initialTopLeftPoint._add(this._getMapPanePos()) : e.DomUtil.setPosition(this._mapPane, new e.Point(0, 0)), this._tileLayersToLoad = this._tileLayersNum;
        var g = !this._loaded;
        this._loaded = !0, g && (this.fire("load"), this.eachLayer(this._layerAdd, this)), this.fire("viewreset", {hard: !c}), this.fire("move"), (f || d) && this.fire("zoomend"), this.fire("moveend", {hard: !c})
    }, _rawPanBy: function (a) {
        e.DomUtil.setPosition(this._mapPane, this._getMapPanePos().subtract(a))
    }, _getZoomSpan: function () {
        return this.getMaxZoom() - this.getMinZoom()
    }, _updateZoomLevels: function () {
        var a, b = 1 / 0, d = -1 / 0, e = this._getZoomSpan();
        for (a in this._zoomBoundLayers) {
            var f = this._zoomBoundLayers[a];
            isNaN(f.options.minZoom) || (b = Math.min(b, f.options.minZoom)), isNaN(f.options.maxZoom) || (d = Math.max(d, f.options.maxZoom))
        }
        a === c ? this._layersMaxZoom = this._layersMinZoom = c : (this._layersMaxZoom = d, this._layersMinZoom = b), e !== this._getZoomSpan() && this.fire("zoomlevelschange")
    }, _panInsideMaxBounds: function () {
        this.panInsideBounds(this.options.maxBounds)
    }, _checkIfLoaded: function () {
        if (!this._loaded)throw new Error("Set map center and zoom first.")
    }, _initEvents: function (b) {
        if (e.DomEvent) {
            b = b || "on", e.DomEvent[b](this._container, "click", this._onMouseClick, this);
            var c, d, f = ["dblclick", "mousedown", "mouseup", "mouseenter", "mouseleave", "mousemove", "contextmenu"];
            for (c = 0, d = f.length; d > c; c++)e.DomEvent[b](this._container, f[c], this._fireMouseEvent, this);
            this.options.trackResize && e.DomEvent[b](a, "resize", this._onResize, this)
        }
    }, _onResize: function () {
        e.Util.cancelAnimFrame(this._resizeRequest), this._resizeRequest = e.Util.requestAnimFrame(function () {
            this.invalidateSize({debounceMoveend: !0})
        }, this, !1, this._container)
    }, _onMouseClick: function (a) {
        !this._loaded || !a._simulated && (this.dragging && this.dragging.moved() || this.boxZoom && this.boxZoom.moved()) || e.DomEvent._skipped(a) || (this.fire("preclick"), this._fireMouseEvent(a))
    }, _fireMouseEvent: function (a) {
        if (this._loaded && !e.DomEvent._skipped(a)) {
            var b = a.type;
            if (b = "mouseenter" === b ? "mouseover" : "mouseleave" === b ? "mouseout" : b, this.hasEventListeners(b)) {
                "contextmenu" === b && e.DomEvent.preventDefault(a);
                var c = this.mouseEventToContainerPoint(a), d = this.containerPointToLayerPoint(c), f = this.layerPointToLatLng(d);
                this.fire(b, {latlng: f, layerPoint: d, containerPoint: c, originalEvent: a})
            }
        }
    }, _onTileLayerLoad: function () {
        this._tileLayersToLoad--, this._tileLayersNum && !this._tileLayersToLoad && this.fire("tilelayersload")
    }, _clearHandlers: function () {
        for (var a = 0, b = this._handlers.length; b > a; a++)this._handlers[a].disable()
    }, whenReady: function (a, b) {
        return this._loaded ? a.call(b || this, this) : this.on("load", a, b), this
    }, _layerAdd: function (a) {
        a.onAdd(this), this.fire("layeradd", {layer: a})
    }, _getMapPanePos: function () {
        return e.DomUtil.getPosition(this._mapPane)
    }, _moved: function () {
        var a = this._getMapPanePos();
        return a && !a.equals([0, 0])
    }, _getTopLeftPoint: function () {
        return this.getPixelOrigin().subtract(this._getMapPanePos())
    }, _getNewTopLeftPoint: function (a, b) {
        var c = this.getSize()._divideBy(2);
        return this.project(a, b)._subtract(c)._round()
    }, _latLngToNewLayerPoint: function (a, b, c) {
        var d = this._getNewTopLeftPoint(c, b).add(this._getMapPanePos());
        return this.project(a, b)._subtract(d)
    }, _getCenterLayerPoint: function () {
        return this.containerPointToLayerPoint(this.getSize()._divideBy(2))
    }, _getCenterOffset: function (a) {
        return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())
    }, _limitCenter: function (a, b, c) {
        if (!c)return a;
        var d = this.project(a, b), f = this.getSize().divideBy(2), g = new e.Bounds(d.subtract(f), d.add(f)), h = this._getBoundsOffset(g, c, b);
        return this.unproject(d.add(h), b)
    }, _limitOffset: function (a, b) {
        if (!b)return a;
        var c = this.getPixelBounds(), d = new e.Bounds(c.min.add(a), c.max.add(a));
        return a.add(this._getBoundsOffset(d, b))
    }, _getBoundsOffset: function (a, b, c) {
        var d = this.project(b.getNorthWest(), c).subtract(a.min), f = this.project(b.getSouthEast(), c).subtract(a.max), g = this._rebound(d.x, -f.x), h = this._rebound(d.y, -f.y);
        return new e.Point(g, h)
    }, _rebound: function (a, b) {
        return a + b > 0 ? Math.round(a - b) / 2 : Math.max(0, Math.ceil(a)) - Math.max(0, Math.floor(b))
    }, _limitZoom: function (a) {
        var b = this.getMinZoom(), c = this.getMaxZoom();
        return Math.max(b, Math.min(c, a))
    }}), e.map = function (a, b) {
        return new e.Map(a, b)
    }, e.Projection.Mercator = {MAX_LATITUDE: 85.0840591556, R_MINOR: 6356752.314245179, R_MAJOR: 6378137, project: function (a) {
        var b = e.LatLng.DEG_TO_RAD, c = this.MAX_LATITUDE, d = Math.max(Math.min(c, a.lat), -c), f = this.R_MAJOR, g = this.R_MINOR, h = a.lng * b * f, i = d * b, j = g / f, k = Math.sqrt(1 - j * j), l = k * Math.sin(i);
        l = Math.pow((1 - l) / (1 + l), .5 * k);
        var m = Math.tan(.5 * (.5 * Math.PI - i)) / l;
        return i = -f * Math.log(m), new e.Point(h, i)
    }, unproject: function (a) {
        for (var b, c = e.LatLng.RAD_TO_DEG, d = this.R_MAJOR, f = this.R_MINOR, g = a.x * c / d, h = f / d, i = Math.sqrt(1 - h * h), j = Math.exp(-a.y / d), k = Math.PI / 2 - 2 * Math.atan(j), l = 15, m = 1e-7, n = l, o = .1; Math.abs(o) > m && --n > 0;)b = i * Math.sin(k), o = Math.PI / 2 - 2 * Math.atan(j * Math.pow((1 - b) / (1 + b), .5 * i)) - k, k += o;
        return new e.LatLng(k * c, g)
    }}, e.CRS.EPSG3395 = e.extend({}, e.CRS, {code: "EPSG:3395", projection: e.Projection.Mercator, transformation: function () {
        var a = e.Projection.Mercator, b = a.R_MAJOR, c = .5 / (Math.PI * b);
        return new e.Transformation(c, .5, -c, .5)
    }()}), e.TileLayer = e.Class.extend({includes: e.Mixin.Events, options: {minZoom: 0, maxZoom: 18, tileSize: 256, subdomains: "abc", errorTileUrl: "", attribution: "", zoomOffset: 0, opacity: 1, unloadInvisibleTiles: e.Browser.mobile, updateWhenIdle: e.Browser.mobile}, initialize: function (a, b) {
        b = e.setOptions(this, b), b.detectRetina && e.Browser.retina && b.maxZoom > 0 && (b.tileSize = Math.floor(b.tileSize / 2), b.zoomOffset++, b.minZoom > 0 && b.minZoom--, this.options.maxZoom--), b.bounds && (b.bounds = e.latLngBounds(b.bounds)), this._url = a;
        var c = this.options.subdomains;
        "string" == typeof c && (this.options.subdomains = c.split(""))
    }, onAdd: function (a) {
        this._map = a, this._animated = a._zoomAnimated, this._initContainer(), a.on({viewreset: this._reset, moveend: this._update}, this), this._animated && a.on({zoomanim: this._animateZoom, zoomend: this._endZoomAnim}, this), this.options.updateWhenIdle || (this._limitedUpdate = e.Util.limitExecByInterval(this._update, 150, this), a.on("move", this._limitedUpdate, this)), this._reset(), this._update()
    }, addTo: function (a) {
        return a.addLayer(this), this
    }, onRemove: function (a) {
        this._container.parentNode.removeChild(this._container), a.off({viewreset: this._reset, moveend: this._update}, this), this._animated && a.off({zoomanim: this._animateZoom, zoomend: this._endZoomAnim}, this), this.options.updateWhenIdle || a.off("move", this._limitedUpdate, this), this._container = null, this._map = null
    }, bringToFront: function () {
        var a = this._map._panes.tilePane;
        return this._container && (a.appendChild(this._container), this._setAutoZIndex(a, Math.max)), this
    }, bringToBack: function () {
        var a = this._map._panes.tilePane;
        return this._container && (a.insertBefore(this._container, a.firstChild), this._setAutoZIndex(a, Math.min)), this
    }, getAttribution: function () {
        return this.options.attribution
    }, getContainer: function () {
        return this._container
    }, setOpacity: function (a) {
        return this.options.opacity = a, this._map && this._updateOpacity(), this
    }, setZIndex: function (a) {
        return this.options.zIndex = a, this._updateZIndex(), this
    }, setUrl: function (a, b) {
        return this._url = a, b || this.redraw(), this
    }, redraw: function () {
        return this._map && (this._reset({hard: !0}), this._update()), this
    }, _updateZIndex: function () {
        this._container && this.options.zIndex !== c && (this._container.style.zIndex = this.options.zIndex)
    }, _setAutoZIndex: function (a, b) {
        var c, d, e, f = a.children, g = -b(1 / 0, -1 / 0);
        for (d = 0, e = f.length; e > d; d++)f[d] !== this._container && (c = parseInt(f[d].style.zIndex, 10), isNaN(c) || (g = b(g, c)));
        this.options.zIndex = this._container.style.zIndex = (isFinite(g) ? g : 0) + b(1, -1)
    }, _updateOpacity: function () {
        var a, b = this._tiles;
        if (e.Browser.ielt9)for (a in b)e.DomUtil.setOpacity(b[a], this.options.opacity); else e.DomUtil.setOpacity(this._container, this.options.opacity)
    }, _initContainer: function () {
        var a = this._map._panes.tilePane;
        if (!this._container) {
            if (this._container = e.DomUtil.create("div", "leaflet-layer"), this._updateZIndex(), this._animated) {
                var b = "leaflet-tile-container";
                this._bgBuffer = e.DomUtil.create("div", b, this._container), this._tileContainer = e.DomUtil.create("div", b, this._container)
            } else this._tileContainer = this._container;
            a.appendChild(this._container), this.options.opacity < 1 && this._updateOpacity()
        }
    }, _reset: function (a) {
        for (var b in this._tiles)this.fire("tileunload", {tile: this._tiles[b]});
        this._tiles = {}, this._tilesToLoad = 0, this.options.reuseTiles && (this._unusedTiles = []), this._tileContainer.innerHTML = "", this._animated && a && a.hard && this._clearBgBuffer(), this._initContainer()
    }, _getTileSize: function () {
        var a = this._map, b = a.getZoom() + this.options.zoomOffset, c = this.options.maxNativeZoom, d = this.options.tileSize;
        return c && b > c && (d = Math.round(a.getZoomScale(b) / a.getZoomScale(c) * d)), d
    }, _update: function () {
        if (this._map) {
            var a = this._map, b = a.getPixelBounds(), c = a.getZoom(), d = this._getTileSize();
            if (!(c > this.options.maxZoom || c < this.options.minZoom)) {
                var f = e.bounds(b.min.divideBy(d)._floor(), b.max.divideBy(d)._floor());
                this._addTilesFromCenterOut(f), (this.options.unloadInvisibleTiles || this.options.reuseTiles) && this._removeOtherTiles(f)
            }
        }
    }, _addTilesFromCenterOut: function (a) {
        var c, d, f, g = [], h = a.getCenter();
        for (c = a.min.y; c <= a.max.y; c++)for (d = a.min.x; d <= a.max.x; d++)f = new e.Point(d, c), this._tileShouldBeLoaded(f) && g.push(f);
        var i = g.length;
        if (0 !== i) {
            g.sort(function (a, b) {
                return a.distanceTo(h) - b.distanceTo(h)
            });
            var j = b.createDocumentFragment();
            for (this._tilesToLoad || this.fire("loading"), this._tilesToLoad += i, d = 0; i > d; d++)this._addTile(g[d], j);
            this._tileContainer.appendChild(j)
        }
    }, _tileShouldBeLoaded: function (a) {
        if (a.x + ":" + a.y in this._tiles)return!1;
        var b = this.options;
        if (!b.continuousWorld) {
            var c = this._getWrapTileNum();
            if (b.noWrap && (a.x < 0 || a.x >= c.x) || a.y < 0 || a.y >= c.y)return!1
        }
        if (b.bounds) {
            var d = b.tileSize, e = a.multiplyBy(d), f = e.add([d, d]), g = this._map.unproject(e), h = this._map.unproject(f);
            if (b.continuousWorld || b.noWrap || (g = g.wrap(), h = h.wrap()), !b.bounds.intersects([g, h]))return!1
        }
        return!0
    }, _removeOtherTiles: function (a) {
        var b, c, d, e;
        for (e in this._tiles)b = e.split(":"), c = parseInt(b[0], 10), d = parseInt(b[1], 10), (c < a.min.x || c > a.max.x || d < a.min.y || d > a.max.y) && this._removeTile(e)
    }, _removeTile: function (a) {
        var b = this._tiles[a];
        this.fire("tileunload", {tile: b, url: b.src}), this.options.reuseTiles ? (e.DomUtil.removeClass(b, "leaflet-tile-loaded"), this._unusedTiles.push(b)) : b.parentNode === this._tileContainer && this._tileContainer.removeChild(b), e.Browser.android || (b.onload = null, b.src = e.Util.emptyImageUrl), delete this._tiles[a]
    }, _addTile: function (a, b) {
        var c = this._getTilePos(a), d = this._getTile();
        e.DomUtil.setPosition(d, c, e.Browser.chrome), this._tiles[a.x + ":" + a.y] = d, this._loadTile(d, a), d.parentNode !== this._tileContainer && b.appendChild(d)
    }, _getZoomForUrl: function () {
        var a = this.options, b = this._map.getZoom();
        return a.zoomReverse && (b = a.maxZoom - b), b += a.zoomOffset, a.maxNativeZoom ? Math.min(b, a.maxNativeZoom) : b
    }, _getTilePos: function (a) {
        var b = this._map.getPixelOrigin(), c = this._getTileSize();
        return a.multiplyBy(c).subtract(b)
    }, getTileUrl: function (a) {
        return e.Util.template(this._url, e.extend({s: this._getSubdomain(a), z: a.z, x: a.x, y: a.y}, this.options))
    }, _getWrapTileNum: function () {
        var a = this._map.options.crs, b = a.getSize(this._map.getZoom());
        return b.divideBy(this._getTileSize())._floor()
    }, _adjustTilePoint: function (a) {
        var b = this._getWrapTileNum();
        this.options.continuousWorld || this.options.noWrap || (a.x = (a.x % b.x + b.x) % b.x), this.options.tms && (a.y = b.y - a.y - 1), a.z = this._getZoomForUrl()
    }, _getSubdomain: function (a) {
        var b = Math.abs(a.x + a.y) % this.options.subdomains.length;
        return this.options.subdomains[b]
    }, _getTile: function () {
        if (this.options.reuseTiles && this._unusedTiles.length > 0) {
            var a = this._unusedTiles.pop();
            return this._resetTile(a), a
        }
        return this._createTile()
    }, _resetTile: function () {
    }, _createTile: function () {
        var a = e.DomUtil.create("img", "leaflet-tile");
        return a.style.width = a.style.height = this._getTileSize() + "px", a.galleryimg = "no", a.onselectstart = a.onmousemove = e.Util.falseFn, e.Browser.ielt9 && this.options.opacity !== c && e.DomUtil.setOpacity(a, this.options.opacity), e.Browser.mobileWebkit3d && (a.style.WebkitBackfaceVisibility = "hidden"), a
    }, _loadTile: function (a, b) {
        a._layer = this, a.onload = this._tileOnLoad, a.onerror = this._tileOnError, this._adjustTilePoint(b), a.src = this.getTileUrl(b), this.fire("tileloadstart", {tile: a, url: a.src})
    }, _tileLoaded: function () {
        this._tilesToLoad--, this._animated && e.DomUtil.addClass(this._tileContainer, "leaflet-zoom-animated"), this._tilesToLoad || (this.fire("load"), this._animated && (clearTimeout(this._clearBgBufferTimer), this._clearBgBufferTimer = setTimeout(e.bind(this._clearBgBuffer, this), 500)))
    }, _tileOnLoad: function () {
        var a = this._layer;
        this.src !== e.Util.emptyImageUrl && (e.DomUtil.addClass(this, "leaflet-tile-loaded"), a.fire("tileload", {tile: this, url: this.src})), a._tileLoaded()
    }, _tileOnError: function () {
        var a = this._layer;
        a.fire("tileerror", {tile: this, url: this.src});
        var b = a.options.errorTileUrl;
        b && (this.src = b), a._tileLoaded()
    }}), e.tileLayer = function (a, b) {
        return new e.TileLayer(a, b)
    }, e.TileLayer.WMS = e.TileLayer.extend({defaultWmsParams: {service: "WMS", request: "GetMap", version: "1.1.1", layers: "", styles: "", format: "image/jpeg", transparent: !1}, initialize: function (a, b) {
        this._url = a;
        var c = e.extend({}, this.defaultWmsParams), d = b.tileSize || this.options.tileSize;
        c.width = c.height = b.detectRetina && e.Browser.retina ? 2 * d : d;
        for (var f in b)this.options.hasOwnProperty(f) || "crs" === f || (c[f] = b[f]);
        this.wmsParams = c, e.setOptions(this, b)
    }, onAdd: function (a) {
        this._crs = this.options.crs || a.options.crs, this._wmsVersion = parseFloat(this.wmsParams.version);
        var b = this._wmsVersion >= 1.3 ? "crs" : "srs";
        this.wmsParams[b] = this._crs.code, e.TileLayer.prototype.onAdd.call(this, a)
    }, getTileUrl: function (a) {
        var b = this._map, c = this.options.tileSize, d = a.multiplyBy(c), f = d.add([c, c]), g = this._crs.project(b.unproject(d, a.z)), h = this._crs.project(b.unproject(f, a.z)), i = this._wmsVersion >= 1.3 && this._crs === e.CRS.EPSG4326 ? [h.y, g.x, g.y, h.x].join(",") : [g.x, h.y, h.x, g.y].join(","), j = e.Util.template(this._url, {s: this._getSubdomain(a)});
        return j + e.Util.getParamString(this.wmsParams, j, !0) + "&BBOX=" + i
    }, setParams: function (a, b) {
        return e.extend(this.wmsParams, a), b || this.redraw(), this
    }}), e.tileLayer.wms = function (a, b) {
        return new e.TileLayer.WMS(a, b)
    }, e.TileLayer.Canvas = e.TileLayer.extend({options: {async: !1}, initialize: function (a) {
        e.setOptions(this, a)
    }, redraw: function () {
        this._map && (this._reset({hard: !0}), this._update());
        for (var a in this._tiles)this._redrawTile(this._tiles[a]);
        return this
    }, _redrawTile: function (a) {
        this.drawTile(a, a._tilePoint, this._map._zoom)
    }, _createTile: function () {
        var a = e.DomUtil.create("canvas", "leaflet-tile");
        return a.width = a.height = this.options.tileSize, a.onselectstart = a.onmousemove = e.Util.falseFn, a
    }, _loadTile: function (a, b) {
        a._layer = this, a._tilePoint = b, this._redrawTile(a), this.options.async || this.tileDrawn(a)
    }, drawTile: function () {
    }, tileDrawn: function (a) {
        this._tileOnLoad.call(a)
    }}), e.tileLayer.canvas = function (a) {
        return new e.TileLayer.Canvas(a)
    }, e.ImageOverlay = e.Class.extend({includes: e.Mixin.Events, options: {opacity: 1}, initialize: function (a, b, c) {
        this._url = a, this._bounds = e.latLngBounds(b), e.setOptions(this, c)
    }, onAdd: function (a) {
        this._map = a, this._image || this._initImage(), a._panes.overlayPane.appendChild(this._image), a.on("viewreset", this._reset, this), a.options.zoomAnimation && e.Browser.any3d && a.on("zoomanim", this._animateZoom, this), this._reset()
    }, onRemove: function (a) {
        a.getPanes().overlayPane.removeChild(this._image), a.off("viewreset", this._reset, this), a.options.zoomAnimation && a.off("zoomanim", this._animateZoom, this)
    }, addTo: function (a) {
        return a.addLayer(this), this
    }, setOpacity: function (a) {
        return this.options.opacity = a, this._updateOpacity(), this
    }, bringToFront: function () {
        return this._image && this._map._panes.overlayPane.appendChild(this._image), this
    }, bringToBack: function () {
        var a = this._map._panes.overlayPane;
        return this._image && a.insertBefore(this._image, a.firstChild), this
    }, setUrl: function (a) {
        this._url = a, this._image.src = this._url
    }, getAttribution: function () {
        return this.options.attribution
    }, _initImage: function () {
        this._image = e.DomUtil.create("img", "leaflet-image-layer"), this._map.options.zoomAnimation && e.Browser.any3d ? e.DomUtil.addClass(this._image, "leaflet-zoom-animated") : e.DomUtil.addClass(this._image, "leaflet-zoom-hide"), this._updateOpacity(), e.extend(this._image, {galleryimg: "no", onselectstart: e.Util.falseFn, onmousemove: e.Util.falseFn, onload: e.bind(this._onImageLoad, this), src: this._url})
    }, _animateZoom: function (a) {
        var b = this._map, c = this._image, d = b.getZoomScale(a.zoom), f = this._bounds.getNorthWest(), g = this._bounds.getSouthEast(), h = b._latLngToNewLayerPoint(f, a.zoom, a.center), i = b._latLngToNewLayerPoint(g, a.zoom, a.center)._subtract(h), j = h._add(i._multiplyBy(.5 * (1 - 1 / d)));
        c.style[e.DomUtil.TRANSFORM] = e.DomUtil.getTranslateString(j) + " scale(" + d + ") "
    }, _reset: function () {
        var a = this._image, b = this._map.latLngToLayerPoint(this._bounds.getNorthWest()), c = this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(b);
        e.DomUtil.setPosition(a, b), a.style.width = c.x + "px", a.style.height = c.y + "px"
    }, _onImageLoad: function () {
        this.fire("load")
    }, _updateOpacity: function () {
        e.DomUtil.setOpacity(this._image, this.options.opacity)
    }}), e.imageOverlay = function (a, b, c) {
        return new e.ImageOverlay(a, b, c)
    }, e.Icon = e.Class.extend({options: {className: ""}, initialize: function (a) {
        e.setOptions(this, a)
    }, createIcon: function (a) {
        return this._createIcon("icon", a)
    }, createShadow: function (a) {
        return this._createIcon("shadow", a)
    }, _createIcon: function (a, b) {
        var c = this._getIconUrl(a);
        if (!c) {
            if ("icon" === a)throw new Error("iconUrl not set in Icon options (see the docs).");
            return null
        }
        var d;
        return d = b && "IMG" === b.tagName ? this._createImg(c, b) : this._createImg(c), this._setIconStyles(d, a), d
    }, _setIconStyles: function (a, b) {
        var c, d = this.options, f = e.point(d[b + "Size"]);
        c = e.point("shadow" === b ? d.shadowAnchor || d.iconAnchor : d.iconAnchor), !c && f && (c = f.divideBy(2, !0)), a.className = "leaflet-marker-" + b + " " + d.className, c && (a.style.marginLeft = -c.x + "px", a.style.marginTop = -c.y + "px"), f && (a.style.width = f.x + "px", a.style.height = f.y + "px")
    }, _createImg: function (a, c) {
        return c = c || b.createElement("img"), c.src = a, c
    }, _getIconUrl: function (a) {
        return e.Browser.retina && this.options[a + "RetinaUrl"] ? this.options[a + "RetinaUrl"] : this.options[a + "Url"]
    }}), e.icon = function (a) {
        return new e.Icon(a)
    }, e.Icon.Default = e.Icon.extend({options: {iconSize: [25, 41], iconAnchor: [12, 41], popupAnchor: [1, -34], shadowSize: [41, 41]}, _getIconUrl: function (a) {
        var b = a + "Url";
        if (this.options[b])return this.options[b];
        e.Browser.retina && "icon" === a && (a += "-2x");
        var c = e.Icon.Default.imagePath;
        if (!c)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");
        return c + "/marker-" + a + ".png"
    }}), e.Icon.Default.imagePath = function () {
        var a, c, d, e, f, g = b.getElementsByTagName("script"), h = /[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;
        for (a = 0, c = g.length; c > a; a++)if (d = g[a].src, e = d.match(h))return f = d.split(h)[0], (f ? f + "/" : "") + "images"
    }(), e.Marker = e.Class.extend({includes: e.Mixin.Events, options: {icon: new e.Icon.Default, title: "", alt: "", clickable: !0, draggable: !1, keyboard: !0, zIndexOffset: 0, opacity: 1, riseOnHover: !1, riseOffset: 250}, initialize: function (a, b) {
        e.setOptions(this, b), this._latlng = e.latLng(a)
    }, onAdd: function (a) {
        this._map = a, a.on("viewreset", this.update, this), this._initIcon(), this.update(), this.fire("add"), a.options.zoomAnimation && a.options.markerZoomAnimation && a.on("zoomanim", this._animateZoom, this)
    }, addTo: function (a) {
        return a.addLayer(this), this
    }, onRemove: function (a) {
        this.dragging && this.dragging.disable(), this._removeIcon(), this._removeShadow(), this.fire("remove"), a.off({viewreset: this.update, zoomanim: this._animateZoom}, this), this._map = null
    }, getLatLng: function () {
        return this._latlng
    }, setLatLng: function (a) {
        return this._latlng = e.latLng(a), this.update(), this.fire("move", {latlng: this._latlng})
    }, setZIndexOffset: function (a) {
        return this.options.zIndexOffset = a, this.update(), this
    }, setIcon: function (a) {
        return this.options.icon = a, this._map && (this._initIcon(), this.update()), this._popup && this.bindPopup(this._popup), this
    }, update: function () {
        if (this._icon) {
            var a = this._map.latLngToLayerPoint(this._latlng).round();
            this._setPos(a)
        }
        return this
    }, _initIcon: function () {
        var a = this.options, b = this._map, c = b.options.zoomAnimation && b.options.markerZoomAnimation, d = c ? "leaflet-zoom-animated" : "leaflet-zoom-hide", f = a.icon.createIcon(this._icon), g = !1;
        f !== this._icon && (this._icon && this._removeIcon(), g = !0, a.title && (f.title = a.title), a.alt && (f.alt = a.alt)), e.DomUtil.addClass(f, d), a.keyboard && (f.tabIndex = "0"), this._icon = f, this._initInteraction(), a.riseOnHover && e.DomEvent.on(f, "mouseover", this._bringToFront, this).on(f, "mouseout", this._resetZIndex, this);
        var h = a.icon.createShadow(this._shadow), i = !1;
        h !== this._shadow && (this._removeShadow(), i = !0), h && e.DomUtil.addClass(h, d), this._shadow = h, a.opacity < 1 && this._updateOpacity();
        var j = this._map._panes;
        g && j.markerPane.appendChild(this._icon), h && i && j.shadowPane.appendChild(this._shadow)
    }, _removeIcon: function () {
        this.options.riseOnHover && e.DomEvent.off(this._icon, "mouseover", this._bringToFront).off(this._icon, "mouseout", this._resetZIndex), this._map._panes.markerPane.removeChild(this._icon), this._icon = null
    }, _removeShadow: function () {
        this._shadow && this._map._panes.shadowPane.removeChild(this._shadow), this._shadow = null
    }, _setPos: function (a) {
        e.DomUtil.setPosition(this._icon, a), this._shadow && e.DomUtil.setPosition(this._shadow, a), this._zIndex = a.y + this.options.zIndexOffset, this._resetZIndex()
    }, _updateZIndex: function (a) {
        this._icon.style.zIndex = this._zIndex + a
    }, _animateZoom: function (a) {
        var b = this._map._latLngToNewLayerPoint(this._latlng, a.zoom, a.center).round();
        this._setPos(b)
    }, _initInteraction: function () {
        if (this.options.clickable) {
            var a = this._icon, b = ["dblclick", "mousedown", "mouseover", "mouseout", "contextmenu"];
            e.DomUtil.addClass(a, "leaflet-clickable"), e.DomEvent.on(a, "click", this._onMouseClick, this), e.DomEvent.on(a, "keypress", this._onKeyPress, this);
            for (var c = 0; c < b.length; c++)e.DomEvent.on(a, b[c], this._fireMouseEvent, this);
            e.Handler.MarkerDrag && (this.dragging = new e.Handler.MarkerDrag(this), this.options.draggable && this.dragging.enable())
        }
    }, _onMouseClick: function (a) {
        var b = this.dragging && this.dragging.moved();
        (this.hasEventListeners(a.type) || b) && e.DomEvent.stopPropagation(a), b || (this.dragging && this.dragging._enabled || !this._map.dragging || !this._map.dragging.moved()) && this.fire(a.type, {originalEvent: a, latlng: this._latlng})
    }, _onKeyPress: function (a) {
        13 === a.keyCode && this.fire("click", {originalEvent: a, latlng: this._latlng})
    }, _fireMouseEvent: function (a) {
        this.fire(a.type, {originalEvent: a, latlng: this._latlng}), "contextmenu" === a.type && this.hasEventListeners(a.type) && e.DomEvent.preventDefault(a), "mousedown" !== a.type ? e.DomEvent.stopPropagation(a) : e.DomEvent.preventDefault(a)
    }, setOpacity: function (a) {
        return this.options.opacity = a, this._map && this._updateOpacity(), this
    }, _updateOpacity: function () {
        e.DomUtil.setOpacity(this._icon, this.options.opacity), this._shadow && e.DomUtil.setOpacity(this._shadow, this.options.opacity)
    }, _bringToFront: function () {
        this._updateZIndex(this.options.riseOffset)
    }, _resetZIndex: function () {
        this._updateZIndex(0)
    }}), e.marker = function (a, b) {
        return new e.Marker(a, b)
    }, e.DivIcon = e.Icon.extend({options: {iconSize: [12, 12], className: "leaflet-div-icon", html: !1}, createIcon: function (a) {
        var c = a && "DIV" === a.tagName ? a : b.createElement("div"), d = this.options;
        return c.innerHTML = d.html !== !1 ? d.html : "", d.bgPos && (c.style.backgroundPosition = -d.bgPos.x + "px " + -d.bgPos.y + "px"), this._setIconStyles(c, "icon"), c
    }, createShadow: function () {
        return null
    }}), e.divIcon = function (a) {
        return new e.DivIcon(a)
    }, e.Map.mergeOptions({closePopupOnClick: !0}), e.Popup = e.Class.extend({includes: e.Mixin.Events, options: {minWidth: 50, maxWidth: 300, autoPan: !0, closeButton: !0, offset: [0, 7], autoPanPadding: [5, 5], keepInView: !1, className: "", zoomAnimation: !0}, initialize: function (a, b) {
        e.setOptions(this, a), this._source = b, this._animated = e.Browser.any3d && this.options.zoomAnimation, this._isOpen = !1
    }, onAdd: function (a) {
        this._map = a, this._container || this._initLayout();
        var b = a.options.fadeAnimation;
        b && e.DomUtil.setOpacity(this._container, 0), a._panes.popupPane.appendChild(this._container), a.on(this._getEvents(), this), this.update(), b && e.DomUtil.setOpacity(this._container, 1), this.fire("open"), a.fire("popupopen", {popup: this}), this._source && this._source.fire("popupopen", {popup: this})
    }, addTo: function (a) {
        return a.addLayer(this), this
    }, openOn: function (a) {
        return a.openPopup(this), this
    }, onRemove: function (a) {
        a._panes.popupPane.removeChild(this._container), e.Util.falseFn(this._container.offsetWidth), a.off(this._getEvents(), this), a.options.fadeAnimation && e.DomUtil.setOpacity(this._container, 0), this._map = null, this.fire("close"), a.fire("popupclose", {popup: this}), this._source && this._source.fire("popupclose", {popup: this})
    }, getLatLng: function () {
        return this._latlng
    }, setLatLng: function (a) {
        return this._latlng = e.latLng(a), this._map && (this._updatePosition(), this._adjustPan()), this
    }, getContent: function () {
        return this._content
    }, setContent: function (a) {
        return this._content = a, this.update(), this
    }, update: function () {
        this._map && (this._container.style.visibility = "hidden", this._updateContent(), this._updateLayout(), this._updatePosition(), this._container.style.visibility = "", this._adjustPan())
    }, _getEvents: function () {
        var a = {viewreset: this._updatePosition};
        return this._animated && (a.zoomanim = this._zoomAnimation), ("closeOnClick"in this.options ? this.options.closeOnClick : this._map.options.closePopupOnClick) && (a.preclick = this._close), this.options.keepInView && (a.moveend = this._adjustPan), a
    }, _close: function () {
        this._map && this._map.closePopup(this)
    }, _initLayout: function () {
        var a, b = "leaflet-popup", c = b + " " + this.options.className + " leaflet-zoom-" + (this._animated ? "animated" : "hide"), d = this._container = e.DomUtil.create("div", c);
        this.options.closeButton && (a = this._closeButton = e.DomUtil.create("a", b + "-close-button", d), a.href = "#close", a.innerHTML = "&#215;", e.DomEvent.disableClickPropagation(a), e.DomEvent.on(a, "click", this._onCloseButtonClick, this));
        var f = this._wrapper = e.DomUtil.create("div", b + "-content-wrapper", d);
        e.DomEvent.disableClickPropagation(f), this._contentNode = e.DomUtil.create("div", b + "-content", f), e.DomEvent.disableScrollPropagation(this._contentNode), e.DomEvent.on(f, "contextmenu", e.DomEvent.stopPropagation), this._tipContainer = e.DomUtil.create("div", b + "-tip-container", d), this._tip = e.DomUtil.create("div", b + "-tip", this._tipContainer)
    }, _updateContent: function () {
        if (this._content) {
            if ("string" == typeof this._content)this._contentNode.innerHTML = this._content; else {
                for (; this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);
                this._contentNode.appendChild(this._content)
            }
            this.fire("contentupdate")
        }
    }, _updateLayout: function () {
        var a = this._contentNode, b = a.style;
        b.width = "", b.whiteSpace = "nowrap";
        var c = a.offsetWidth;
        c = Math.min(c, this.options.maxWidth), c = Math.max(c, this.options.minWidth), b.width = c + 1 + "px", b.whiteSpace = "", b.height = "";
        var d = a.offsetHeight, f = this.options.maxHeight, g = "leaflet-popup-scrolled";
        f && d > f ? (b.height = f + "px", e.DomUtil.addClass(a, g)) : e.DomUtil.removeClass(a, g), this._containerWidth = this._container.offsetWidth
    }, _updatePosition: function () {
        if (this._map) {
            var a = this._map.latLngToLayerPoint(this._latlng), b = this._animated, c = e.point(this.options.offset);
            b && e.DomUtil.setPosition(this._container, a), this._containerBottom = -c.y - (b ? 0 : a.y), this._containerLeft = -Math.round(this._containerWidth / 2) + c.x + (b ? 0 : a.x), this._container.style.bottom = this._containerBottom + "px", this._container.style.left = this._containerLeft + "px"
        }
    }, _zoomAnimation: function (a) {
        var b = this._map._latLngToNewLayerPoint(this._latlng, a.zoom, a.center);
        e.DomUtil.setPosition(this._container, b)
    }, _adjustPan: function () {
        if (this.options.autoPan) {
            var a = this._map, b = this._container.offsetHeight, c = this._containerWidth, d = new e.Point(this._containerLeft, -b - this._containerBottom);
            this._animated && d._add(e.DomUtil.getPosition(this._container));
            var f = a.layerPointToContainerPoint(d), g = e.point(this.options.autoPanPadding), h = e.point(this.options.autoPanPaddingTopLeft || g), i = e.point(this.options.autoPanPaddingBottomRight || g), j = a.getSize(), k = 0, l = 0;
            f.x + c + i.x > j.x && (k = f.x + c - j.x + i.x), f.x - k - h.x < 0 && (k = f.x - h.x), f.y + b + i.y > j.y && (l = f.y + b - j.y + i.y), f.y - l - h.y < 0 && (l = f.y - h.y), (k || l) && a.fire("autopanstart").panBy([k, l])
        }
    }, _onCloseButtonClick: function (a) {
        this._close(), e.DomEvent.stop(a)
    }}), e.popup = function (a, b) {
        return new e.Popup(a, b)
    }, e.Map.include({openPopup: function (a, b, c) {
        if (this.closePopup(), !(a instanceof e.Popup)) {
            var d = a;
            a = new e.Popup(c).setLatLng(b).setContent(d)
        }
        return a._isOpen = !0, this._popup = a, this.addLayer(a)
    }, closePopup: function (a) {
        return a && a !== this._popup || (a = this._popup, this._popup = null), a && (this.removeLayer(a), a._isOpen = !1), this
    }}), e.Marker.include({openPopup: function () {
        return this._popup && this._map && !this._map.hasLayer(this._popup) && (this._popup.setLatLng(this._latlng), this._map.openPopup(this._popup)), this
    }, closePopup: function () {
        return this._popup && this._popup._close(), this
    }, togglePopup: function () {
        return this._popup && (this._popup._isOpen ? this.closePopup() : this.openPopup()), this
    }, bindPopup: function (a, b) {
        var c = e.point(this.options.icon.options.popupAnchor || [0, 0]);
        return c = c.add(e.Popup.prototype.options.offset), b && b.offset && (c = c.add(b.offset)), b = e.extend({offset: c}, b), this._popupHandlersAdded || (this.on("click", this.togglePopup, this).on("remove", this.closePopup, this).on("move", this._movePopup, this), this._popupHandlersAdded = !0), a instanceof e.Popup ? (e.setOptions(a, b), this._popup = a) : this._popup = new e.Popup(b, this).setContent(a), this
    }, setPopupContent: function (a) {
        return this._popup && this._popup.setContent(a), this
    }, unbindPopup: function () {
        return this._popup && (this._popup = null, this.off("click", this.togglePopup, this).off("remove", this.closePopup, this).off("move", this._movePopup, this), this._popupHandlersAdded = !1), this
    }, getPopup: function () {
        return this._popup
    }, _movePopup: function (a) {
        this._popup.setLatLng(a.latlng)
    }}), e.LayerGroup = e.Class.extend({initialize: function (a) {
        this._customLayers = {};
        var b, c;
        if (a)for (b = 0, c = a.length; c > b; b++)this.addLayer(a[b])
    }, addLayer: function (a) {
        var b = this.getLayerId(a);
        return this._customLayers[b] = a, this._map && this._map.addLayer(a), this
    }, removeLayer: function (a) {
        var b = a in this._customLayers ? a : this.getLayerId(a);
        return this._map && this._customLayers[b] && this._map.removeLayer(this._customLayers[b]), delete this._customLayers[b], this
    }, hasLayer: function (a) {
        return a ? a in this._customLayers || this.getLayerId(a)in this._customLayers : !1
    }, clearLayers: function () {
        return this.eachLayer(this.removeLayer, this), this
    }, invoke: function (a) {
        var b, c, d = Array.prototype.slice.call(arguments, 1);
        for (b in this._customLayers)c = this._customLayers[b], c[a] && c[a].apply(c, d);
        return this
    }, onAdd: function (a) {
        this._map = a, this.eachLayer(a.addLayer, a)
    }, onRemove: function (a) {
        this.eachLayer(a.removeLayer, a), this._map = null
    }, addTo: function (a) {
        return a.addLayer(this), this
    }, eachLayer: function (a, b) {
        for (var c in this._customLayers)a.call(b, this._customLayers[c]);
        return this
    }, getLayer: function (a) {
        return this._customLayers[a]
    }, getLayers: function () {
        var a = [];
        for (var b in this._customLayers)a.push(this._customLayers[b]);
        return a
    }, setZIndex: function (a) {
        return this.invoke("setZIndex", a)
    }, getLayerId: function (a) {
        return e.stamp(a)
    }}), e.layerGroup = function (a) {
        return new e.LayerGroup(a)
    }, e.FeatureGroup = e.LayerGroup.extend({includes: e.Mixin.Events, statics: {EVENTS: "click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"}, addLayer: function (a) {
        return this.hasLayer(a) ? this : ("on"in a && a.on(e.FeatureGroup.EVENTS, this._propagateEvent, this), e.LayerGroup.prototype.addLayer.call(this, a), this._popupContent && a.bindPopup && a.bindPopup(this._popupContent, this._popupOptions), this.fire("layeradd", {layer: a}))
    }, removeLayer: function (a) {
        return this.hasLayer(a) ? (a in this._customLayers && (a = this._customLayers[a]), a.off(e.FeatureGroup.EVENTS, this._propagateEvent, this), e.LayerGroup.prototype.removeLayer.call(this, a), this._popupContent && this.invoke("unbindPopup"), this.fire("layerremove", {layer: a})) : this
    }, bindPopup: function (a, b) {
        return this._popupContent = a, this._popupOptions = b, this.invoke("bindPopup", a, b)
    }, openPopup: function (a) {
        for (var b in this._customLayers) {
            this._customLayers[b].openPopup(a);
            break
        }
        return this
    }, setStyle: function (a) {
        return this.invoke("setStyle", a)
    }, bringToFront: function () {
        return this.invoke("bringToFront")
    }, bringToBack: function () {
        return this.invoke("bringToBack")
    }, getBounds: function () {
        var a = new e.LatLngBounds;
        return this.eachLayer(function (b) {
            a.extend(b instanceof e.Marker ? b.getLatLng() : b.getBounds())
        }), a
    }, _propagateEvent: function (a) {
        a = e.extend({layer: a.target, target: this}, a), this.fire(a.type, a)
    }}), e.featureGroup = function (a) {
        return new e.FeatureGroup(a)
    }, e.Path = e.Class.extend({includes: [e.Mixin.Events], statics: {CLIP_PADDING: function () {
        var b = e.Browser.mobile ? 1280 : 2e3, c = (b / Math.max(a.outerWidth, a.outerHeight) - 1) / 2;
        return Math.max(0, Math.min(.5, c))
    }()}, options: {stroke: !0, color: "#0033ff", dashArray: null, lineCap: null, lineJoin: null, weight: 5, opacity: .5, fill: !1, fillColor: null, fillOpacity: .2, clickable: !0}, initialize: function (a) {
        e.setOptions(this, a)
    }, onAdd: function (a) {
        this._map = a, this._container || (this._initElements(), this._initEvents()), this.projectLatlngs(), this._updatePath(), this._container && this._map._pathRoot.appendChild(this._container), this.fire("add"), a.on({viewreset: this.projectLatlngs, moveend: this._updatePath}, this)
    }, addTo: function (a) {
        return a.addLayer(this), this
    }, onRemove: function (a) {
        a._pathRoot.removeChild(this._container), this.fire("remove"), this._map = null, e.Browser.vml && (this._container = null, this._stroke = null, this._fill = null), a.off({viewreset: this.projectLatlngs, moveend: this._updatePath}, this)
    }, projectLatlngs: function () {
    }, setStyle: function (a) {
        return e.setOptions(this, a), this._container && this._updateStyle(), this
    }, redraw: function () {
        return this._map && (this.projectLatlngs(), this._updatePath()), this
    }}), e.Map.include({_updatePathViewport: function () {
        var a = e.Path.CLIP_PADDING, b = this.getSize(), c = e.DomUtil.getPosition(this._mapPane), d = c.multiplyBy(-1)._subtract(b.multiplyBy(a)._round()), f = d.add(b.multiplyBy(1 + 2 * a)._round());
        this._pathViewport = new e.Bounds(d, f)
    }}), e.Path.SVG_NS = "http://www.w3.org/2000/svg", e.Browser.svg = !(!b.createElementNS || !b.createElementNS(e.Path.SVG_NS, "svg").createSVGRect), e.Path = e.Path.extend({statics: {SVG: e.Browser.svg}, bringToFront: function () {
        var a = this._map._pathRoot, b = this._container;
        return b && a.lastChild !== b && a.appendChild(b), this
    }, bringToBack: function () {
        var a = this._map._pathRoot, b = this._container, c = a.firstChild;
        return b && c !== b && a.insertBefore(b, c), this
    }, getPathString: function () {
    }, _createElement: function (a) {
        return b.createElementNS(e.Path.SVG_NS, a)
    }, _initElements: function () {
        this._map._initPathRoot(), this._initPath(), this._initStyle()
    }, _initPath: function () {
        this._container = this._createElement("g"), this._path = this._createElement("path"), this.options.className && e.DomUtil.addClass(this._path, this.options.className), this._container.appendChild(this._path)
    }, _initStyle: function () {
        this.options.stroke && (this._path.setAttribute("stroke-linejoin", "round"), this._path.setAttribute("stroke-linecap", "round")), this.options.fill && this._path.setAttribute("fill-rule", "evenodd"), this.options.pointerEvents && this._path.setAttribute("pointer-events", this.options.pointerEvents), this.options.clickable || this.options.pointerEvents || this._path.setAttribute("pointer-events", "none"), this._updateStyle()
    }, _updateStyle: function () {
        this.options.stroke ? (this._path.setAttribute("stroke", this.options.color), this._path.setAttribute("stroke-opacity", this.options.opacity), this._path.setAttribute("stroke-width", this.options.weight), this.options.dashArray ? this._path.setAttribute("stroke-dasharray", this.options.dashArray) : this._path.removeAttribute("stroke-dasharray"), this.options.lineCap && this._path.setAttribute("stroke-linecap", this.options.lineCap), this.options.lineJoin && this._path.setAttribute("stroke-linejoin", this.options.lineJoin)) : this._path.setAttribute("stroke", "none"), this.options.fill ? (this._path.setAttribute("fill", this.options.fillColor || this.options.color), this._path.setAttribute("fill-opacity", this.options.fillOpacity)) : this._path.setAttribute("fill", "none")
    }, _updatePath: function () {
        var a = this.getPathString();
        a || (a = "M0 0"), this._path.setAttribute("d", a)
    }, _initEvents: function () {
        if (this.options.clickable) {
            (e.Browser.svg || !e.Browser.vml) && e.DomUtil.addClass(this._path, "leaflet-clickable"), e.DomEvent.on(this._container, "click", this._onMouseClick, this);
            for (var a = ["dblclick", "mousedown", "mouseover", "mouseout", "mousemove", "contextmenu"], b = 0; b < a.length; b++)e.DomEvent.on(this._container, a[b], this._fireMouseEvent, this)
        }
    }, _onMouseClick: function (a) {
        this._map.dragging && this._map.dragging.moved() || this._fireMouseEvent(a)
    }, _fireMouseEvent: function (a) {
        if (this.hasEventListeners(a.type)) {
            var b = this._map, c = b.mouseEventToContainerPoint(a), d = b.containerPointToLayerPoint(c), f = b.layerPointToLatLng(d);
            this.fire(a.type, {latlng: f, layerPoint: d, containerPoint: c, originalEvent: a}), "contextmenu" === a.type && e.DomEvent.preventDefault(a), "mousemove" !== a.type && e.DomEvent.stopPropagation(a)
        }
    }}), e.Map.include({_initPathRoot: function () {
        this._pathRoot || (this._pathRoot = e.Path.prototype._createElement("svg"), this._panes.overlayPane.appendChild(this._pathRoot), this.options.zoomAnimation && e.Browser.any3d ? (e.DomUtil.addClass(this._pathRoot, "leaflet-zoom-animated"), this.on({zoomanim: this._animatePathZoom, zoomend: this._endPathZoom})) : e.DomUtil.addClass(this._pathRoot, "leaflet-zoom-hide"), this.on("moveend", this._updateSvgViewport), this._updateSvgViewport())
    }, _animatePathZoom: function (a) {
        var b = this.getZoomScale(a.zoom), c = this._getCenterOffset(a.center)._multiplyBy(-b)._add(this._pathViewport.min);
        this._pathRoot.style[e.DomUtil.TRANSFORM] = e.DomUtil.getTranslateString(c) + " scale(" + b + ") ", this._pathZooming = !0
    }, _endPathZoom: function () {
        this._pathZooming = !1
    }, _updateSvgViewport: function () {
        if (!this._pathZooming) {
            this._updatePathViewport();
            var a = this._pathViewport, b = a.min, c = a.max, d = c.x - b.x, f = c.y - b.y, g = this._pathRoot, h = this._panes.overlayPane;
            e.Browser.mobileWebkit && h.removeChild(g), e.DomUtil.setPosition(g, b), g.setAttribute("width", d), g.setAttribute("height", f), g.setAttribute("viewBox", [b.x, b.y, d, f].join(" ")), e.Browser.mobileWebkit && h.appendChild(g)
        }
    }}), e.Path.include({bindPopup: function (a, b) {
        return a instanceof e.Popup ? this._popup = a : ((!this._popup || b) && (this._popup = new e.Popup(b, this)), this._popup.setContent(a)), this._popupHandlersAdded || (this.on("click", this._openPopup, this).on("remove", this.closePopup, this), this._popupHandlersAdded = !0), this
    }, unbindPopup: function () {
        return this._popup && (this._popup = null, this.off("click", this._openPopup).off("remove", this.closePopup), this._popupHandlersAdded = !1), this
    }, openPopup: function (a) {
        return this._popup && (a = a || this._latlng || this._latlngs[Math.floor(this._latlngs.length / 2)], this._openPopup({latlng: a})), this
    }, closePopup: function () {
        return this._popup && this._popup._close(), this
    }, _openPopup: function (a) {
        this._popup.setLatLng(a.latlng), this._map.openPopup(this._popup)
    }}), e.Browser.vml = !e.Browser.svg && function () {
        try {
            var a = b.createElement("div");
            a.innerHTML = '<v:shape adj="1"/>';
            var c = a.firstChild;
            return c.style.behavior = "url(#default#VML)", c && "object" == typeof c.adj
        } catch (d) {
            return!1
        }
    }(), e.Path = e.Browser.svg || !e.Browser.vml ? e.Path : e.Path.extend({statics: {VML: !0, CLIP_PADDING: .02}, _createElement: function () {
        try {
            return b.namespaces.add("lvml", "urn:schemas-microsoft-com:vml"), function (a) {
                return b.createElement("<lvml:" + a + ' class="lvml">')
            }
        } catch (a) {
            return function (a) {
                return b.createElement("<" + a + ' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')
            }
        }
    }(), _initPath: function () {
        var a = this._container = this._createElement("shape");
        e.DomUtil.addClass(a, "leaflet-vml-shape" + (this.options.className ? " " + this.options.className : "")), this.options.clickable && e.DomUtil.addClass(a, "leaflet-clickable"), a.coordsize = "1 1", this._path = this._createElement("path"), a.appendChild(this._path), this._map._pathRoot.appendChild(a)
    }, _initStyle: function () {
        this._updateStyle()
    }, _updateStyle: function () {
        var a = this._stroke, b = this._fill, c = this.options, d = this._container;
        d.stroked = c.stroke, d.filled = c.fill, c.stroke ? (a || (a = this._stroke = this._createElement("stroke"), a.endcap = "round", d.appendChild(a)), a.weight = c.weight + "px", a.color = c.color, a.opacity = c.opacity, a.dashStyle = c.dashArray ? e.Util.isArray(c.dashArray) ? c.dashArray.join(" ") : c.dashArray.replace(/( *, *)/g, " ") : "", c.lineCap && (a.endcap = c.lineCap.replace("butt", "flat")), c.lineJoin && (a.joinstyle = c.lineJoin)) : a && (d.removeChild(a), this._stroke = null), c.fill ? (b || (b = this._fill = this._createElement("fill"), d.appendChild(b)), b.color = c.fillColor || c.color, b.opacity = c.fillOpacity) : b && (d.removeChild(b), this._fill = null)
    }, _updatePath: function () {
        var a = this._container.style;
        a.display = "none", this._path.v = this.getPathString() + " ", a.display = ""
    }}), e.Map.include(e.Browser.svg || !e.Browser.vml ? {} : {_initPathRoot: function () {
        if (!this._pathRoot) {
            var a = this._pathRoot = b.createElement("div");
            a.className = "leaflet-vml-container", this._panes.overlayPane.appendChild(a), this.on("moveend", this._updatePathViewport), this._updatePathViewport()
        }
    }}), e.Browser.canvas = function () {
        return!!b.createElement("canvas").getContext
    }(), e.Path = e.Path.SVG && !a.L_PREFER_CANVAS || !e.Browser.canvas ? e.Path : e.Path.extend({statics: {CANVAS: !0, SVG: !1}, redraw: function () {
        return this._map && (this.projectLatlngs(), this._requestUpdate()), this
    }, setStyle: function (a) {
        return e.setOptions(this, a), this._map && (this._updateStyle(), this._requestUpdate()), this
    }, onRemove: function (a) {
        a.off("viewreset", this.projectLatlngs, this).off("moveend", this._updatePath, this), this.options.clickable && (this._map.off("click", this._onClick, this), this._map.off("mousemove", this._onMouseMove, this)), this._requestUpdate(), this._map = null
    }, _requestUpdate: function () {
        this._map && !e.Path._updateRequest && (e.Path._updateRequest = e.Util.requestAnimFrame(this._fireMapMoveEnd, this._map))
    }, _fireMapMoveEnd: function () {
        e.Path._updateRequest = null, this.fire("moveend")
    }, _initElements: function () {
        this._map._initPathRoot(), this._ctx = this._map._canvasCtx
    }, _updateStyle: function () {
        var a = this.options;
        a.stroke && (this._ctx.lineWidth = a.weight, this._ctx.strokeStyle = a.color), a.fill && (this._ctx.fillStyle = a.fillColor || a.color)
    }, _drawPath: function () {
        var a, b, c, d, f, g;
        for (this._ctx.beginPath(), a = 0, c = this._parts.length; c > a; a++) {
            for (b = 0, d = this._parts[a].length; d > b; b++)f = this._parts[a][b], g = (0 === b ? "move" : "line") + "To", this._ctx[g](f.x, f.y);
            this instanceof e.Polygon && this._ctx.closePath()
        }
    }, _checkIfEmpty: function () {
        return!this._parts.length
    }, _updatePath: function () {
        if (!this._checkIfEmpty()) {
            var a = this._ctx, b = this.options;
            this._drawPath(), a.save(), this._updateStyle(), b.fill && (a.globalAlpha = b.fillOpacity, a.fill()), b.stroke && (a.globalAlpha = b.opacity, a.stroke()), a.restore()
        }
    }, _initEvents: function () {
        this.options.clickable && (this._map.on("mousemove", this._onMouseMove, this), this._map.on("click", this._onClick, this))
    }, _onClick: function (a) {
        this._containsPoint(a.layerPoint) && this.fire("click", a)
    }, _onMouseMove: function (a) {
        this._map && !this._map._animatingZoom && (this._containsPoint(a.layerPoint) ? (this._ctx.canvas.style.cursor = "pointer", this._mouseInside = !0, this.fire("mouseover", a)) : this._mouseInside && (this._ctx.canvas.style.cursor = "", this._mouseInside = !1, this.fire("mouseout", a)))
    }}), e.Map.include(e.Path.SVG && !a.L_PREFER_CANVAS || !e.Browser.canvas ? {} : {_initPathRoot: function () {
        var a, c = this._pathRoot;
        c || (c = this._pathRoot = b.createElement("canvas"), c.style.position = "absolute", a = this._canvasCtx = c.getContext("2d"), a.lineCap = "round", a.lineJoin = "round", this._panes.overlayPane.appendChild(c), this.options.zoomAnimation && (this._pathRoot.className = "leaflet-zoom-animated", this.on("zoomanim", this._animatePathZoom), this.on("zoomend", this._endPathZoom)), this.on("moveend", this._updateCanvasViewport), this._updateCanvasViewport())
    }, _updateCanvasViewport: function () {
        if (!this._pathZooming) {
            this._updatePathViewport();
            var a = this._pathViewport, b = a.min, c = a.max.subtract(b), d = this._pathRoot;
            e.DomUtil.setPosition(d, b), d.width = c.x, d.height = c.y, d.getContext("2d").translate(-b.x, -b.y)
        }
    }}), e.LineUtil = {simplify: function (a, b) {
        if (!b || !a.length)return a.slice();
        var c = b * b;
        return a = this._reducePoints(a, c), a = this._simplifyDP(a, c)
    }, pointToSegmentDistance: function (a, b, c) {
        return Math.sqrt(this._sqClosestPointOnSegment(a, b, c, !0))
    }, closestPointOnSegment: function (a, b, c) {
        return this._sqClosestPointOnSegment(a, b, c)
    }, _simplifyDP: function (a, b) {
        var d = a.length, e = typeof Uint8Array != c + "" ? Uint8Array : Array, f = new e(d);
        f[0] = f[d - 1] = 1, this._simplifyDPStep(a, f, b, 0, d - 1);
        var g, h = [];
        for (g = 0; d > g; g++)f[g] && h.push(a[g]);
        return h
    }, _simplifyDPStep: function (a, b, c, d, e) {
        var f, g, h, i = 0;
        for (g = d + 1; e - 1 >= g; g++)h = this._sqClosestPointOnSegment(a[g], a[d], a[e], !0), h > i && (f = g, i = h);
        i > c && (b[f] = 1, this._simplifyDPStep(a, b, c, d, f), this._simplifyDPStep(a, b, c, f, e))
    }, _reducePoints: function (a, b) {
        for (var c = [a[0]], d = 1, e = 0, f = a.length; f > d; d++)this._sqDist(a[d], a[e]) > b && (c.push(a[d]), e = d);
        return f - 1 > e && c.push(a[f - 1]), c
    }, clipSegment: function (a, b, c, d) {
        var e, f, g, h = d ? this._lastCode : this._getBitCode(a, c), i = this._getBitCode(b, c);
        for (this._lastCode = i; ;) {
            if (!(h | i))return[a, b];
            if (h & i)return!1;
            e = h || i, f = this._getEdgeIntersection(a, b, e, c), g = this._getBitCode(f, c), e === h ? (a = f, h = g) : (b = f, i = g)
        }
    }, _getEdgeIntersection: function (a, b, c, d) {
        var f = b.x - a.x, g = b.y - a.y, h = d.min, i = d.max;
        return 8 & c ? new e.Point(a.x + f * (i.y - a.y) / g, i.y) : 4 & c ? new e.Point(a.x + f * (h.y - a.y) / g, h.y) : 2 & c ? new e.Point(i.x, a.y + g * (i.x - a.x) / f) : 1 & c ? new e.Point(h.x, a.y + g * (h.x - a.x) / f) : void 0
    }, _getBitCode: function (a, b) {
        var c = 0;
        return a.x < b.min.x ? c |= 1 : a.x > b.max.x && (c |= 2), a.y < b.min.y ? c |= 4 : a.y > b.max.y && (c |= 8), c
    }, _sqDist: function (a, b) {
        var c = b.x - a.x, d = b.y - a.y;
        return c * c + d * d
    }, _sqClosestPointOnSegment: function (a, b, c, d) {
        var f, g = b.x, h = b.y, i = c.x - g, j = c.y - h, k = i * i + j * j;
        return k > 0 && (f = ((a.x - g) * i + (a.y - h) * j) / k, f > 1 ? (g = c.x, h = c.y) : f > 0 && (g += i * f, h += j * f)), i = a.x - g, j = a.y - h, d ? i * i + j * j : new e.Point(g, h)
    }}, e.Polyline = e.Path.extend({initialize: function (a, b) {
        e.Path.prototype.initialize.call(this, b), this._latlngs = this._convertLatLngs(a)
    }, options: {smoothFactor: 1, noClip: !1}, projectLatlngs: function () {
        this._originalPoints = [];
        for (var a = 0, b = this._latlngs.length; b > a; a++)this._originalPoints[a] = this._map.latLngToLayerPoint(this._latlngs[a])
    }, getPathString: function () {
        for (var a = 0, b = this._parts.length, c = ""; b > a; a++)c += this._getPathPartStr(this._parts[a]);
        return c
    }, getLatLngs: function () {
        return this._latlngs
    }, setLatLngs: function (a) {
        return this._latlngs = this._convertLatLngs(a), this.redraw()
    }, addLatLng: function (a) {
        return this._latlngs.push(e.latLng(a)), this.redraw()
    }, spliceLatLngs: function () {
        var a = [].splice.apply(this._latlngs, arguments);
        return this._convertLatLngs(this._latlngs, !0), this.redraw(), a
    }, closestLayerPoint: function (a) {
        for (var b, c, d = 1 / 0, f = this._parts, g = null, h = 0, i = f.length; i > h; h++)for (var j = f[h], k = 1, l = j.length; l > k; k++) {
            b = j[k - 1], c = j[k];
            var m = e.LineUtil._sqClosestPointOnSegment(a, b, c, !0);
            d > m && (d = m, g = e.LineUtil._sqClosestPointOnSegment(a, b, c))
        }
        return g && (g.distance = Math.sqrt(d)), g
    }, getBounds: function () {
        return new e.LatLngBounds(this.getLatLngs())
    }, _convertLatLngs: function (a, b) {
        var c, d, f = b ? a : [];
        for (c = 0, d = a.length; d > c; c++) {
            if (e.Util.isArray(a[c]) && "number" != typeof a[c][0])return;
            f[c] = e.latLng(a[c])
        }
        return f
    }, _initEvents: function () {
        e.Path.prototype._initEvents.call(this)
    }, _getPathPartStr: function (a) {
        for (var b, c = e.Path.VML, d = 0, f = a.length, g = ""; f > d; d++)b = a[d], c && b._round(), g += (d ? "L" : "M") + b.x + " " + b.y;
        return g
    }, _clipPoints: function () {
        var a, b, c, d = this._originalPoints, f = d.length;
        if (this.options.noClip)return void(this._parts = [d]);
        this._parts = [];
        var g = this._parts, h = this._map._pathViewport, i = e.LineUtil;
        for (a = 0, b = 0; f - 1 > a; a++)c = i.clipSegment(d[a], d[a + 1], h, a), c && (g[b] = g[b] || [], g[b].push(c[0]), (c[1] !== d[a + 1] || a === f - 2) && (g[b].push(c[1]), b++))
    }, _simplifyPoints: function () {
        for (var a = this._parts, b = e.LineUtil, c = 0, d = a.length; d > c; c++)a[c] = b.simplify(a[c], this.options.smoothFactor)
    }, _updatePath: function () {
        this._map && (this._clipPoints(), this._simplifyPoints(), e.Path.prototype._updatePath.call(this))
    }}), e.polyline = function (a, b) {
        return new e.Polyline(a, b)
    }, e.PolyUtil = {}, e.PolyUtil.clipPolygon = function (a, b) {
        var c, d, f, g, h, i, j, k, l, m = [1, 4, 2, 8], n = e.LineUtil;
        for (d = 0, j = a.length; j > d; d++)a[d]._code = n._getBitCode(a[d], b);
        for (g = 0; 4 > g; g++) {
            for (k = m[g], c = [], d = 0, j = a.length, f = j - 1; j > d; f = d++)h = a[d], i = a[f], h._code & k ? i._code & k || (l = n._getEdgeIntersection(i, h, k, b), l._code = n._getBitCode(l, b), c.push(l)) : (i._code & k && (l = n._getEdgeIntersection(i, h, k, b), l._code = n._getBitCode(l, b), c.push(l)), c.push(h));
            a = c
        }
        return a
    }, e.Polygon = e.Polyline.extend({options: {fill: !0}, initialize: function (a, b) {
        e.Polyline.prototype.initialize.call(this, a, b), this._initWithHoles(a)
    }, _initWithHoles: function (a) {
        var b, c, d;
        if (a && e.Util.isArray(a[0]) && "number" != typeof a[0][0])for (this._latlngs = this._convertLatLngs(a[0]), this._holes = a.slice(1), b = 0, c = this._holes.length; c > b; b++)d = this._holes[b] = this._convertLatLngs(this._holes[b]), d[0].equals(d[d.length - 1]) && d.pop();
        a = this._latlngs, a.length >= 2 && a[0].equals(a[a.length - 1]) && a.pop()
    }, projectLatlngs: function () {
        if (e.Polyline.prototype.projectLatlngs.call(this), this._holePoints = [], this._holes) {
            var a, b, c, d;
            for (a = 0, c = this._holes.length; c > a; a++)for (this._holePoints[a] = [], b = 0, d = this._holes[a].length; d > b; b++)this._holePoints[a][b] = this._map.latLngToLayerPoint(this._holes[a][b])
        }
    }, setLatLngs: function (a) {
        return a && e.Util.isArray(a[0]) && "number" != typeof a[0][0] ? (this._initWithHoles(a), this.redraw()) : e.Polyline.prototype.setLatLngs.call(this, a)
    }, _clipPoints: function () {
        var a = this._originalPoints, b = [];
        if (this._parts = [a].concat(this._holePoints), !this.options.noClip) {
            for (var c = 0, d = this._parts.length; d > c; c++) {
                var f = e.PolyUtil.clipPolygon(this._parts[c], this._map._pathViewport);
                f.length && b.push(f)
            }
            this._parts = b
        }
    }, _getPathPartStr: function (a) {
        var b = e.Polyline.prototype._getPathPartStr.call(this, a);
        return b + (e.Browser.svg ? "z" : "x")
    }}), e.polygon = function (a, b) {
        return new e.Polygon(a, b)
    }, function () {
        function a(a) {
            return e.FeatureGroup.extend({initialize: function (a, b) {
                this._customLayers = {}, this._options = b, this.setLatLngs(a)
            }, setLatLngs: function (b) {
                var c = 0, d = b.length;
                for (this.eachLayer(function (a) {
                    d > c ? a.setLatLngs(b[c++]) : this.removeLayer(a)
                }, this); d > c;)this.addLayer(new a(b[c++], this._options));
                return this
            }, getLatLngs: function () {
                var a = [];
                return this.eachLayer(function (b) {
                    a.push(b.getLatLngs())
                }), a
            }})
        }

        e.MultiPolyline = a(e.Polyline), e.MultiPolygon = a(e.Polygon), e.multiPolyline = function (a, b) {
            return new e.MultiPolyline(a, b)
        }, e.multiPolygon = function (a, b) {
            return new e.MultiPolygon(a, b)
        }
    }(), e.Rectangle = e.Polygon.extend({initialize: function (a, b) {
        e.Polygon.prototype.initialize.call(this, this._boundsToLatLngs(a), b)
    }, setBounds: function (a) {
        this.setLatLngs(this._boundsToLatLngs(a))
    }, _boundsToLatLngs: function (a) {
        return a = e.latLngBounds(a), [a.getSouthWest(), a.getNorthWest(), a.getNorthEast(), a.getSouthEast()]
    }}), e.rectangle = function (a, b) {
        return new e.Rectangle(a, b)
    }, e.Circle = e.Path.extend({initialize: function (a, b, c) {
        e.Path.prototype.initialize.call(this, c), this._latlng = e.latLng(a), this._mRadius = b
    }, options: {fill: !0}, setLatLng: function (a) {
        return this._latlng = e.latLng(a), this.redraw()
    }, setRadius: function (a) {
        return this._mRadius = a, this.redraw()
    }, projectLatlngs: function () {
        var a = this._getLngRadius(), b = this._latlng, c = this._map.latLngToLayerPoint([b.lat, b.lng - a]);
        this._point = this._map.latLngToLayerPoint(b), this._radius = Math.max(this._point.x - c.x, 1)
    }, getBounds: function () {
        var a = this._getLngRadius(), b = this._mRadius / 40075017 * 360, c = this._latlng;
        return new e.LatLngBounds([c.lat - b, c.lng - a], [c.lat + b, c.lng + a])
    }, getLatLng: function () {
        return this._latlng
    }, getPathString: function () {
        var a = this._point, b = this._radius;
        return this._checkIfEmpty() ? "" : e.Browser.svg ? "M" + a.x + "," + (a.y - b) + "A" + b + "," + b + ",0,1,1," + (a.x - .1) + "," + (a.y - b) + " z" : (a._round(), b = Math.round(b), "AL " + a.x + "," + a.y + " " + b + "," + b + " 0,23592600")
    }, getRadius: function () {
        return this._mRadius
    }, _getLatRadius: function () {
        return this._mRadius / 40075017 * 360
    }, _getLngRadius: function () {
        return this._getLatRadius() / Math.cos(e.LatLng.DEG_TO_RAD * this._latlng.lat)
    }, _checkIfEmpty: function () {
        if (!this._map)return!1;
        var a = this._map._pathViewport, b = this._radius, c = this._point;
        return c.x - b > a.max.x || c.y - b > a.max.y || c.x + b < a.min.x || c.y + b < a.min.y
    }}), e.circle = function (a, b, c) {
        return new e.Circle(a, b, c)
    }, e.CircleMarker = e.Circle.extend({options: {radius: 10, weight: 2}, initialize: function (a, b) {
        e.Circle.prototype.initialize.call(this, a, null, b), this._radius = this.options.radius
    }, projectLatlngs: function () {
        this._point = this._map.latLngToLayerPoint(this._latlng)
    }, _updateStyle: function () {
        e.Circle.prototype._updateStyle.call(this), this.setRadius(this.options.radius)
    }, setLatLng: function (a) {
        return e.Circle.prototype.setLatLng.call(this, a), this._popup && this._popup._isOpen && this._popup.setLatLng(a), this
    }, setRadius: function (a) {
        return this.options.radius = this._radius = a, this.redraw()
    }, getRadius: function () {
        return this._radius
    }}), e.circleMarker = function (a, b) {
        return new e.CircleMarker(a, b)
    }, e.Polyline.include(e.Path.CANVAS ? {_containsPoint: function (a, b) {
        var c, d, f, g, h, i, j, k = this.options.weight / 2;
        for (e.Browser.touch && (k += 10), c = 0, g = this._parts.length; g > c; c++)for (j = this._parts[c], d = 0, h = j.length, f = h - 1; h > d; f = d++)if ((b || 0 !== d) && (i = e.LineUtil.pointToSegmentDistance(a, j[f], j[d]), k >= i))return!0;
        return!1
    }} : {}), e.Polygon.include(e.Path.CANVAS ? {_containsPoint: function (a) {
        var b, c, d, f, g, h, i, j, k = !1;
        if (e.Polyline.prototype._containsPoint.call(this, a, !0))return!0;
        for (f = 0, i = this._parts.length; i > f; f++)for (b = this._parts[f], g = 0, j = b.length, h = j - 1; j > g; h = g++)c = b[g], d = b[h], c.y > a.y != d.y > a.y && a.x < (d.x - c.x) * (a.y - c.y) / (d.y - c.y) + c.x && (k = !k);
        return k
    }} : {}), e.Circle.include(e.Path.CANVAS ? {_drawPath: function () {
        var a = this._point;
        this._ctx.beginPath(), this._ctx.arc(a.x, a.y, this._radius, 0, 2 * Math.PI, !1)
    }, _containsPoint: function (a) {
        var b = this._point, c = this.options.stroke ? this.options.weight / 2 : 0;
        return a.distanceTo(b) <= this._radius + c
    }} : {}), e.CircleMarker.include(e.Path.CANVAS ? {_updateStyle: function () {
        e.Path.prototype._updateStyle.call(this)
    }} : {}), e.GeoJSON = e.FeatureGroup.extend({initialize: function (a, b) {
        e.setOptions(this, b), this._customLayers = {}, a && this.addData(a)
    }, addData: function (a) {
        var b, c, d, f = e.Util.isArray(a) ? a : a.features;
        if (f) {
            for (b = 0, c = f.length; c > b; b++)d = f[b], (d.geometries || d.geometry || d.features || d.coordinates) && this.addData(f[b]);
            return this
        }
        var g = this.options;
        if (!g.filter || g.filter(a)) {
            var h = e.GeoJSON.geometryToLayer(a, g.pointToLayer, g.coordsToLatLng, g);
            return h.feature = e.GeoJSON.asFeature(a), h.defaultOptions = h.options, this.resetStyle(h), g.onEachFeature && g.onEachFeature(a, h), this.addLayer(h)
        }
    }, resetStyle: function (a) {
        var b = this.options.style;
        b && (e.Util.extend(a.options, a.defaultOptions), this._setLayerStyle(a, b))
    }, setStyle: function (a) {
        this.eachLayer(function (b) {
            this._setLayerStyle(b, a)
        }, this)
    }, _setLayerStyle: function (a, b) {
        "function" == typeof b && (b = b(a.feature)), a.setStyle && a.setStyle(b)
    }}), e.extend(e.GeoJSON, {geometryToLayer: function (a, b, c, d) {
        var f, g, h, i, j = "Feature" === a.type ? a.geometry : a, k = j.coordinates, l = [];
        switch (c = c || this.coordsToLatLng, j.type) {
            case"Point":
                return f = c(k), b ? b(a, f) : new e.Marker(f);
            case"MultiPoint":
                for (h = 0, i = k.length; i > h; h++)f = c(k[h]), l.push(b ? b(a, f) : new e.Marker(f));
                return new e.FeatureGroup(l);
            case"LineString":
                return g = this.coordsToLatLngs(k, 0, c), new e.Polyline(g, d);
            case"Polygon":
                if (2 === k.length && !k[1].length)throw new Error("Invalid GeoJSON object.");
                return g = this.coordsToLatLngs(k, 1, c), new e.Polygon(g, d);
            case"MultiLineString":
                return g = this.coordsToLatLngs(k, 1, c), new e.MultiPolyline(g, d);
            case"MultiPolygon":
                return g = this.coordsToLatLngs(k, 2, c), new e.MultiPolygon(g, d);
            case"GeometryCollection":
                for (h = 0, i = j.geometries.length; i > h; h++)l.push(this.geometryToLayer({geometry: j.geometries[h], type: "Feature", properties: a.properties}, b, c, d));
                return new e.FeatureGroup(l);
            default:
                throw new Error("Invalid GeoJSON object.")
        }
    }, coordsToLatLng: function (a) {
        return new e.LatLng(a[1], a[0], a[2])
    }, coordsToLatLngs: function (a, b, c) {
        var d, e, f, g = [];
        for (e = 0, f = a.length; f > e; e++)d = b ? this.coordsToLatLngs(a[e], b - 1, c) : (c || this.coordsToLatLng)(a[e]), g.push(d);
        return g
    }, latLngToCoords: function (a) {
        var b = [a.lng, a.lat];
        return a.alt !== c && b.push(a.alt), b
    }, latLngsToCoords: function (a) {
        for (var b = [], c = 0, d = a.length; d > c; c++)b.push(e.GeoJSON.latLngToCoords(a[c]));
        return b
    }, getFeature: function (a, b) {
        return a.feature ? e.extend({}, a.feature, {geometry: b}) : e.GeoJSON.asFeature(b)
    }, asFeature: function (a) {
        return"Feature" === a.type ? a : {type: "Feature", properties: {}, geometry: a}
    }});
    var g = {toGeoJSON: function () {
        return e.GeoJSON.getFeature(this, {type: "Point", coordinates: e.GeoJSON.latLngToCoords(this.getLatLng())})
    }};
    e.Marker.include(g), e.Circle.include(g), e.CircleMarker.include(g), e.Polyline.include({toGeoJSON: function () {
        return e.GeoJSON.getFeature(this, {type: "LineString", coordinates: e.GeoJSON.latLngsToCoords(this.getLatLngs())})
    }}), e.Polygon.include({toGeoJSON: function () {
        var a, b, c, d = [e.GeoJSON.latLngsToCoords(this.getLatLngs())];
        if (d[0].push(d[0][0]), this._holes)for (a = 0, b = this._holes.length; b > a; a++)c = e.GeoJSON.latLngsToCoords(this._holes[a]), c.push(c[0]), d.push(c);
        return e.GeoJSON.getFeature(this, {type: "Polygon", coordinates: d})
    }}), function () {
        function a(a) {
            return function () {
                var b = [];
                return this.eachLayer(function (a) {
                    b.push(a.toGeoJSON().geometry.coordinates)
                }), e.GeoJSON.getFeature(this, {type: a, coordinates: b})
            }
        }

        e.MultiPolyline.include({toGeoJSON: a("MultiLineString")}), e.MultiPolygon.include({toGeoJSON: a("MultiPolygon")}), e.LayerGroup.include({toGeoJSON: function () {
            var b, c = this.feature && this.feature.geometry, d = [];
            if (c && "MultiPoint" === c.type)return a("MultiPoint").call(this);
            var f = c && "GeometryCollection" === c.type;
            return this.eachLayer(function (a) {
                a.toGeoJSON && (b = a.toGeoJSON(), d.push(f ? b.geometry : e.GeoJSON.asFeature(b)))
            }), f ? e.GeoJSON.getFeature(this, {geometries: d, type: "GeometryCollection"}) : {type: "FeatureCollection", features: d}
        }})
    }(), e.geoJson = function (a, b) {
        return new e.GeoJSON(a, b)
    }, e.DomEvent = {addListener: function (a, b, c, d) {
        var f, g, h, i = e.stamp(c), j = "_leaflet_" + b + i;
        return a[j] ? this : (f = function (b) {
            return c.call(d || a, b || e.DomEvent._getEvent())
        }, e.Browser.pointer && 0 === b.indexOf("touch") ? this.addPointerListener(a, b, f, i) : (e.Browser.touch && "dblclick" === b && this.addDoubleTapListener && this.addDoubleTapListener(a, f, i), "addEventListener"in a ? "mousewheel" === b ? (a.addEventListener("DOMMouseScroll", f, !1), a.addEventListener(b, f, !1)) : "mouseenter" === b || "mouseleave" === b ? (g = f, h = "mouseenter" === b ? "mouseover" : "mouseout", f = function (b) {
            return e.DomEvent._checkMouse(a, b) ? g(b) : void 0
        }, a.addEventListener(h, f, !1)) : "click" === b && e.Browser.android ? (g = f, f = function (a) {
            return e.DomEvent._filterClick(a, g)
        }, a.addEventListener(b, f, !1)) : a.addEventListener(b, f, !1) : "attachEvent"in a && a.attachEvent("on" + b, f), a[j] = f, this))
    }, removeListener: function (a, b, c) {
        var d = e.stamp(c), f = "_leaflet_" + b + d, g = a[f];
        return g ? (e.Browser.pointer && 0 === b.indexOf("touch") ? this.removePointerListener(a, b, d) : e.Browser.touch && "dblclick" === b && this.removeDoubleTapListener ? this.removeDoubleTapListener(a, d) : "removeEventListener"in a ? "mousewheel" === b ? (a.removeEventListener("DOMMouseScroll", g, !1), a.removeEventListener(b, g, !1)) : "mouseenter" === b || "mouseleave" === b ? a.removeEventListener("mouseenter" === b ? "mouseover" : "mouseout", g, !1) : a.removeEventListener(b, g, !1) : "detachEvent"in a && a.detachEvent("on" + b, g), a[f] = null, this) : this
    }, stopPropagation: function (a) {
        return a.stopPropagation ? a.stopPropagation() : a.cancelBubble = !0, e.DomEvent._skipped(a), this
    }, disableScrollPropagation: function (a) {
        var b = e.DomEvent.stopPropagation;
        return e.DomEvent.on(a, "mousewheel", b).on(a, "MozMousePixelScroll", b)
    }, disableClickPropagation: function (a) {
        for (var b = e.DomEvent.stopPropagation, c = e.Draggable.START.length - 1; c >= 0; c--)e.DomEvent.on(a, e.Draggable.START[c], b);
        return e.DomEvent.on(a, "click", e.DomEvent._fakeStop).on(a, "dblclick", b)
    }, preventDefault: function (a) {
        return a.preventDefault ? a.preventDefault() : a.returnValue = !1, this
    }, stop: function (a) {
        return e.DomEvent.preventDefault(a).stopPropagation(a)
    }, getMousePosition: function (a, b) {
        if (!b)return new e.Point(a.clientX, a.clientY);
        var c = b.getBoundingClientRect();
        return new e.Point(a.clientX - c.left - b.clientLeft, a.clientY - c.top - b.clientTop)
    }, getWheelDelta: function (a) {
        var b = 0;
        return a.wheelDelta && (b = a.wheelDelta / 120), a.detail && (b = -a.detail / 3), b
    }, _skipEvents: {}, _fakeStop: function (a) {
        e.DomEvent._skipEvents[a.type] = !0
    }, _skipped: function (a) {
        var b = this._skipEvents[a.type];
        return this._skipEvents[a.type] = !1, b
    }, _checkMouse: function (a, b) {
        var c = b.relatedTarget;
        if (!c)return!0;
        try {
            for (; c && c !== a;)c = c.parentNode
        } catch (d) {
            return!1
        }
        return c !== a
    }, _getEvent: function () {
        var b = a.event;
        if (!b)for (var c = arguments.callee.caller; c && (b = c.arguments[0], !b || a.Event !== b.constructor);)c = c.caller;
        return b
    }, _filterClick: function (a, b) {
        var c = a.timeStamp || a.originalEvent.timeStamp, d = e.DomEvent._lastClick && c - e.DomEvent._lastClick;
        return d && d > 100 && 1e3 > d || a.target._simulatedClick && !a._simulated ? void e.DomEvent.stop(a) : (e.DomEvent._lastClick = c, b(a))
    }}, e.DomEvent.on = e.DomEvent.addListener, e.DomEvent.off = e.DomEvent.removeListener, e.Draggable = e.Class.extend({includes: e.Mixin.Events, statics: {START: e.Browser.touch ? ["touchstart", "mousedown"] : ["mousedown"], END: {mousedown: "mouseup", touchstart: "touchend", pointerdown: "touchend", MSPointerDown: "touchend"}, MOVE: {mousedown: "mousemove", touchstart: "touchmove", pointerdown: "touchmove", MSPointerDown: "touchmove"}}, initialize: function (a, b) {
        this._element = a, this._dragStartTarget = b || a
    }, enable: function () {
        if (!this._enabled) {
            for (var a = e.Draggable.START.length - 1; a >= 0; a--)e.DomEvent.on(this._dragStartTarget, e.Draggable.START[a], this._onDown, this);
            this._enabled = !0
        }
    }, disable: function () {
        if (this._enabled) {
            for (var a = e.Draggable.START.length - 1; a >= 0; a--)e.DomEvent.off(this._dragStartTarget, e.Draggable.START[a], this._onDown, this);
            this._enabled = !1, this._moved = !1
        }
    }, _onDown: function (a) {
        if (this._moved = !1, !(a.shiftKey || 1 !== a.which && 1 !== a.button && !a.touches || (e.DomEvent.stopPropagation(a), e.Draggable._disabled || (e.DomUtil.disableImageDrag(), e.DomUtil.disableTextSelection(), this._moving)))) {
            var c = a.touches ? a.touches[0] : a;
            this._startPoint = new e.Point(c.clientX, c.clientY), this._startPos = this._newPos = e.DomUtil.getPosition(this._element), e.DomEvent.on(b, e.Draggable.MOVE[a.type], this._onMove, this).on(b, e.Draggable.END[a.type], this._onUp, this)
        }
    }, _onMove: function (a) {
        if (a.touches && a.touches.length > 1)return void(this._moved = !0);
        var c = a.touches && 1 === a.touches.length ? a.touches[0] : a, d = new e.Point(c.clientX, c.clientY), f = d.subtract(this._startPoint);
        (f.x || f.y) && (e.DomEvent.preventDefault(a), this._moved || (this.fire("dragstart"), this._moved = !0, this._startPos = e.DomUtil.getPosition(this._element).subtract(f), e.DomUtil.addClass(b.body, "leaflet-dragging"), e.DomUtil.addClass(a.target || a.srcElement, "leaflet-drag-target")), this._newPos = this._startPos.add(f), this._moving = !0, e.Util.cancelAnimFrame(this._animRequest), this._animRequest = e.Util.requestAnimFrame(this._updatePosition, this, !0, this._dragStartTarget))
    }, _updatePosition: function () {
        this.fire("predrag"), e.DomUtil.setPosition(this._element, this._newPos), this.fire("drag")
    }, _onUp: function (a) {
        e.DomUtil.removeClass(b.body, "leaflet-dragging"), e.DomUtil.removeClass(a.target || a.srcElement, "leaflet-drag-target");
        for (var c in e.Draggable.MOVE)e.DomEvent.off(b, e.Draggable.MOVE[c], this._onMove).off(b, e.Draggable.END[c], this._onUp);
        e.DomUtil.enableImageDrag(), e.DomUtil.enableTextSelection(), this._moved && this._moving && (e.Util.cancelAnimFrame(this._animRequest), this.fire("dragend", {distance: this._newPos.distanceTo(this._startPos)})), this._moving = !1
    }}), e.Handler = e.Class.extend({initialize: function (a) {
        this._map = a
    }, enable: function () {
        this._enabled || (this._enabled = !0, this.addHooks())
    }, disable: function () {
        this._enabled && (this._enabled = !1, this.removeHooks())
    }, enabled: function () {
        return!!this._enabled
    }}), e.Map.mergeOptions({dragging: !0, inertia: !e.Browser.android23, inertiaDeceleration: 3400, inertiaMaxSpeed: 1 / 0, inertiaThreshold: e.Browser.touch ? 32 : 18, easeLinearity: .25, worldCopyJump: !1}), e.Map.Drag = e.Handler.extend({addHooks: function () {
        if (!this._draggable) {
            var a = this._map;
            this._draggable = new e.Draggable(a._mapPane, a._container), this._draggable.on({dragstart: this._onDragStart, drag: this._onDrag, dragend: this._onDragEnd}, this), a.options.worldCopyJump && (this._draggable.on("predrag", this._onPreDrag, this), a.on("viewreset", this._onViewReset, this), a.whenReady(this._onViewReset, this))
        }
        this._draggable.enable()
    }, removeHooks: function () {
        this._draggable.disable()
    }, moved: function () {
        return this._draggable && this._draggable._moved
    }, _onDragStart: function () {
        var a = this._map;
        a._panAnim && a._panAnim.stop(), a.fire("movestart").fire("dragstart"), a.options.inertia && (this._positions = [], this._times = [])
    }, _onDrag: function () {
        if (this._map.options.inertia) {
            var a = this._lastTime = +new Date, b = this._lastPos = this._draggable._newPos;
            this._positions.push(b), this._times.push(a), a - this._times[0] > 200 && (this._positions.shift(), this._times.shift())
        }
        this._map.fire("move").fire("drag")
    }, _onViewReset: function () {
        var a = this._map.getSize()._divideBy(2), b = this._map.latLngToLayerPoint([0, 0]);
        this._initialWorldOffset = b.subtract(a).x, this._worldWidth = this._map.project([0, 180]).x
    }, _onPreDrag: function () {
        var a = this._worldWidth, b = Math.round(a / 2), c = this._initialWorldOffset, d = this._draggable._newPos.x, e = (d - b + c) % a + b - c, f = (d + b + c) % a - b - c, g = Math.abs(e + c) < Math.abs(f + c) ? e : f;
        this._draggable._newPos.x = g
    }, _onDragEnd: function (a) {
        var b = this._map, c = b.options, d = +new Date - this._lastTime, f = !c.inertia || d > c.inertiaThreshold || !this._positions[0];
        if (b.fire("dragend", a), f)b.fire("moveend"); else {
            var g = this._lastPos.subtract(this._positions[0]), h = (this._lastTime + d - this._times[0]) / 1e3, i = c.easeLinearity, j = g.multiplyBy(i / h), k = j.distanceTo([0, 0]), l = Math.min(c.inertiaMaxSpeed, k), m = j.multiplyBy(l / k), n = l / (c.inertiaDeceleration * i), o = m.multiplyBy(-n / 2).round();
            o.x && o.y ? (o = b._limitOffset(o, b.options.maxBounds), e.Util.requestAnimFrame(function () {
                b.panBy(o, {duration: n, easeLinearity: i, noMoveStart: !0})
            })) : b.fire("moveend")
        }
    }}), e.Map.addInitHook("addHandler", "dragging", e.Map.Drag), e.Map.mergeOptions({doubleClickZoom: !0}), e.Map.DoubleClickZoom = e.Handler.extend({addHooks: function () {
        this._map.on("dblclick", this._onDoubleClick, this)
    }, removeHooks: function () {
        this._map.off("dblclick", this._onDoubleClick, this)
    }, _onDoubleClick: function (a) {
        var b = this._map, c = b.getZoom() + (a.originalEvent.shiftKey ? -1 : 1);
        "center" === b.options.doubleClickZoom ? b.setZoom(c) : b.setZoomAround(a.containerPoint, c)
    }}), e.Map.addInitHook("addHandler", "doubleClickZoom", e.Map.DoubleClickZoom), e.Map.mergeOptions({scrollWheelZoom: !0}), e.Map.ScrollWheelZoom = e.Handler.extend({addHooks: function () {
        e.DomEvent.on(this._map._container, "mousewheel", this._onWheelScroll, this), e.DomEvent.on(this._map._container, "MozMousePixelScroll", e.DomEvent.preventDefault), this._delta = 0
    }, removeHooks: function () {
        e.DomEvent.off(this._map._container, "mousewheel", this._onWheelScroll), e.DomEvent.off(this._map._container, "MozMousePixelScroll", e.DomEvent.preventDefault)
    }, _onWheelScroll: function (a) {
        var b = e.DomEvent.getWheelDelta(a);
        this._delta += b, this._lastMousePos = this._map.mouseEventToContainerPoint(a), this._startTime || (this._startTime = +new Date);
        var c = Math.max(40 - (+new Date - this._startTime), 0);
        clearTimeout(this._timer), this._timer = setTimeout(e.bind(this._performZoom, this), c), e.DomEvent.preventDefault(a), e.DomEvent.stopPropagation(a)
    }, _performZoom: function () {
        var a = this._map, b = this._delta, c = a.getZoom();
        b = b > 0 ? Math.ceil(b) : Math.floor(b), b = Math.max(Math.min(b, 4), -4), b = a._limitZoom(c + b) - c, this._delta = 0, this._startTime = null, b && ("center" === a.options.scrollWheelZoom ? a.setZoom(c + b) : a.setZoomAround(this._lastMousePos, c + b))
    }}), e.Map.addInitHook("addHandler", "scrollWheelZoom", e.Map.ScrollWheelZoom), e.extend(e.DomEvent, {_touchstart: e.Browser.msPointer ? "MSPointerDown" : e.Browser.pointer ? "pointerdown" : "touchstart", _touchend: e.Browser.msPointer ? "MSPointerUp" : e.Browser.pointer ? "pointerup" : "touchend", addDoubleTapListener: function (a, c, d) {
        function f(a) {
            var b;
            if (e.Browser.pointer ? (o.push(a.pointerId), b = o.length) : b = a.touches.length, !(b > 1)) {
                var c = Date.now(), d = c - (h || c);
                i = a.touches ? a.touches[0] : a, j = d > 0 && k >= d, h = c
            }
        }

        function g(a) {
            if (e.Browser.pointer) {
                var b = o.indexOf(a.pointerId);
                if (-1 === b)return;
                o.splice(b, 1)
            }
            if (j) {
                if (e.Browser.pointer) {
                    var d, f = {};
                    for (var g in i)d = i[g], f[g] = "function" == typeof d ? d.bind(i) : d;
                    i = f
                }
                i.type = "dblclick", c(i), h = null
            }
        }

        var h, i, j = !1, k = 250, l = "_leaflet_", m = this._touchstart, n = this._touchend, o = [];
        a[l + m + d] = f, a[l + n + d] = g;
        var p = e.Browser.pointer ? b.documentElement : a;
        return a.addEventListener(m, f, !1), p.addEventListener(n, g, !1), e.Browser.pointer && p.addEventListener(e.DomEvent.POINTER_CANCEL, g, !1), this
    }, removeDoubleTapListener: function (a, c) {
        var d = "_leaflet_";
        return a.removeEventListener(this._touchstart, a[d + this._touchstart + c], !1), (e.Browser.pointer ? b.documentElement : a).removeEventListener(this._touchend, a[d + this._touchend + c], !1), e.Browser.pointer && b.documentElement.removeEventListener(e.DomEvent.POINTER_CANCEL, a[d + this._touchend + c], !1), this
    }}), e.extend(e.DomEvent, {POINTER_DOWN: e.Browser.msPointer ? "MSPointerDown" : "pointerdown", POINTER_MOVE: e.Browser.msPointer ? "MSPointerMove" : "pointermove", POINTER_UP: e.Browser.msPointer ? "MSPointerUp" : "pointerup", POINTER_CANCEL: e.Browser.msPointer ? "MSPointerCancel" : "pointercancel", _pointers: [], _pointerDocumentListener: !1, addPointerListener: function (a, b, c, d) {
        switch (b) {
            case"touchstart":
                return this.addPointerListenerStart(a, b, c, d);
            case"touchend":
                return this.addPointerListenerEnd(a, b, c, d);
            case"touchmove":
                return this.addPointerListenerMove(a, b, c, d);
            default:
                throw"Unknown touch event type"
        }
    }, addPointerListenerStart: function (a, c, d, f) {
        var g = "_leaflet_", h = this._pointers, i = function (a) {
            e.DomEvent.preventDefault(a);
            for (var b = !1, c = 0; c < h.length; c++)if (h[c].pointerId === a.pointerId) {
                b = !0;
                break
            }
            b || h.push(a), a.touches = h.slice(), a.changedTouches = [a], d(a)
        };
        if (a[g + "touchstart" + f] = i, a.addEventListener(this.POINTER_DOWN, i, !1), !this._pointerDocumentListener) {
            var j = function (a) {
                for (var b = 0; b < h.length; b++)if (h[b].pointerId === a.pointerId) {
                    h.splice(b, 1);
                    break
                }
            };
            b.documentElement.addEventListener(this.POINTER_UP, j, !1), b.documentElement.addEventListener(this.POINTER_CANCEL, j, !1), this._pointerDocumentListener = !0
        }
        return this
    }, addPointerListenerMove: function (a, b, c, d) {
        function e(a) {
            if (a.pointerType !== a.MSPOINTER_TYPE_MOUSE && "mouse" !== a.pointerType || 0 !== a.buttons) {
                for (var b = 0; b < g.length; b++)if (g[b].pointerId === a.pointerId) {
                    g[b] = a;
                    break
                }
                a.touches = g.slice(), a.changedTouches = [a], c(a)
            }
        }

        var f = "_leaflet_", g = this._pointers;
        return a[f + "touchmove" + d] = e, a.addEventListener(this.POINTER_MOVE, e, !1), this
    }, addPointerListenerEnd: function (a, b, c, d) {
        var e = "_leaflet_", f = this._pointers, g = function (a) {
            for (var b = 0; b < f.length; b++)if (f[b].pointerId === a.pointerId) {
                f.splice(b, 1);
                break
            }
            a.touches = f.slice(), a.changedTouches = [a], c(a)
        };
        return a[e + "touchend" + d] = g, a.addEventListener(this.POINTER_UP, g, !1), a.addEventListener(this.POINTER_CANCEL, g, !1), this
    }, removePointerListener: function (a, b, c) {
        var d = "_leaflet_", e = a[d + b + c];
        switch (b) {
            case"touchstart":
                a.removeEventListener(this.POINTER_DOWN, e, !1);
                break;
            case"touchmove":
                a.removeEventListener(this.POINTER_MOVE, e, !1);
                break;
            case"touchend":
                a.removeEventListener(this.POINTER_UP, e, !1), a.removeEventListener(this.POINTER_CANCEL, e, !1)
        }
        return this
    }}), e.Map.mergeOptions({touchZoom: e.Browser.touch && !e.Browser.android23, bounceAtZoomLimits: !0}), e.Map.TouchZoom = e.Handler.extend({addHooks: function () {
        e.DomEvent.on(this._map._container, "touchstart", this._onTouchStart, this)
    }, removeHooks: function () {
        e.DomEvent.off(this._map._container, "touchstart", this._onTouchStart, this)
    }, _onTouchStart: function (a) {
        var c = this._map;
        if (a.touches && 2 === a.touches.length && !c._animatingZoom && !this._zooming) {
            var d = c.mouseEventToLayerPoint(a.touches[0]), f = c.mouseEventToLayerPoint(a.touches[1]), g = c._getCenterLayerPoint();
            this._startCenter = d.add(f)._divideBy(2), this._startDist = d.distanceTo(f), this._moved = !1, this._zooming = !0, this._centerOffset = g.subtract(this._startCenter), c._panAnim && c._panAnim.stop(), e.DomEvent.on(b, "touchmove", this._onTouchMove, this).on(b, "touchend", this._onTouchEnd, this), e.DomEvent.preventDefault(a)
        }
    }, _onTouchMove: function (a) {
        var b = this._map;
        if (a.touches && 2 === a.touches.length && this._zooming) {
            var c = b.mouseEventToLayerPoint(a.touches[0]), d = b.mouseEventToLayerPoint(a.touches[1]);
            this._scale = c.distanceTo(d) / this._startDist, this._delta = c._add(d)._divideBy(2)._subtract(this._startCenter), 1 !== this._scale && (b.options.bounceAtZoomLimits || !(b.getZoom() === b.getMinZoom() && this._scale < 1 || b.getZoom() === b.getMaxZoom() && this._scale > 1)) && (this._moved || (e.DomUtil.addClass(b._mapPane, "leaflet-touching"), b.fire("movestart").fire("zoomstart"), this._moved = !0), e.Util.cancelAnimFrame(this._animRequest), this._animRequest = e.Util.requestAnimFrame(this._updateOnMove, this, !0, this._map._container), e.DomEvent.preventDefault(a))
        }
    }, _updateOnMove: function () {
        var a = this._map, b = this._getScaleOrigin(), c = a.layerPointToLatLng(b), d = a.getScaleZoom(this._scale);
        a._animateZoom(c, d, this._startCenter, this._scale, this._delta)
    }, _onTouchEnd: function () {
        if (!this._moved || !this._zooming)return void(this._zooming = !1);
        var a = this._map;
        this._zooming = !1, e.DomUtil.removeClass(a._mapPane, "leaflet-touching"), e.Util.cancelAnimFrame(this._animRequest), e.DomEvent.off(b, "touchmove", this._onTouchMove).off(b, "touchend", this._onTouchEnd);
        var c = this._getScaleOrigin(), d = a.layerPointToLatLng(c), f = a.getZoom(), g = a.getScaleZoom(this._scale) - f, h = g > 0 ? Math.ceil(g) : Math.floor(g), i = a._limitZoom(f + h), j = a.getZoomScale(i) / this._scale;
        a._animateZoom(d, i, c, j)
    }, _getScaleOrigin: function () {
        var a = this._centerOffset.subtract(this._delta).divideBy(this._scale);
        return this._startCenter.add(a)
    }}), e.Map.addInitHook("addHandler", "touchZoom", e.Map.TouchZoom), e.Map.mergeOptions({tap: !0, tapTolerance: 15}), e.Map.Tap = e.Handler.extend({addHooks: function () {
        e.DomEvent.on(this._map._container, "touchstart", this._onDown, this)
    }, removeHooks: function () {
        e.DomEvent.off(this._map._container, "touchstart", this._onDown, this)
    }, _onDown: function (a) {
        if (a.touches) {
            if (e.DomEvent.preventDefault(a), this._fireClick = !0, a.touches.length > 1)return this._fireClick = !1, void clearTimeout(this._holdTimeout);
            var c = a.touches[0], d = c.target;
            this._startPos = this._newPos = new e.Point(c.clientX, c.clientY), d.tagName && "a" === d.tagName.toLowerCase() && e.DomUtil.addClass(d, "leaflet-active"), this._holdTimeout = setTimeout(e.bind(function () {
                this._isTapValid() && (this._fireClick = !1, this._onUp(), this._simulateEvent("contextmenu", c))
            }, this), 1e3), e.DomEvent.on(b, "touchmove", this._onMove, this).on(b, "touchend", this._onUp, this)
        }
    }, _onUp: function (a) {
        if (clearTimeout(this._holdTimeout), e.DomEvent.off(b, "touchmove", this._onMove, this).off(b, "touchend", this._onUp, this), this._fireClick && a && a.changedTouches) {
            var c = a.changedTouches[0], d = c.target;
            d && d.tagName && "a" === d.tagName.toLowerCase() && e.DomUtil.removeClass(d, "leaflet-active"), this._isTapValid() && this._simulateEvent("click", c)
        }
    }, _isTapValid: function () {
        return this._newPos.distanceTo(this._startPos) <= this._map.options.tapTolerance
    }, _onMove: function (a) {
        var b = a.touches[0];
        this._newPos = new e.Point(b.clientX, b.clientY)
    }, _simulateEvent: function (c, d) {
        var e = b.createEvent("MouseEvents");
        e._simulated = !0, d.target._simulatedClick = !0, e.initMouseEvent(c, !0, !0, a, 1, d.screenX, d.screenY, d.clientX, d.clientY, !1, !1, !1, !1, 0, null), d.target.dispatchEvent(e)
    }}), e.Browser.touch && !e.Browser.pointer && e.Map.addInitHook("addHandler", "tap", e.Map.Tap), e.Map.mergeOptions({boxZoom: !0}), e.Map.BoxZoom = e.Handler.extend({initialize: function (a) {
        this._map = a, this._container = a._container, this._pane = a._panes.overlayPane, this._moved = !1
    }, addHooks: function () {
        e.DomEvent.on(this._container, "mousedown", this._onMouseDown, this)
    }, removeHooks: function () {
        e.DomEvent.off(this._container, "mousedown", this._onMouseDown), this._moved = !1
    }, moved: function () {
        return this._moved
    }, _onMouseDown: function (a) {
        return this._moved = !1, !a.shiftKey || 1 !== a.which && 1 !== a.button ? !1 : (e.DomUtil.disableTextSelection(), e.DomUtil.disableImageDrag(), this._startLayerPoint = this._map.mouseEventToLayerPoint(a), void e.DomEvent.on(b, "mousemove", this._onMouseMove, this).on(b, "mouseup", this._onMouseUp, this).on(b, "keydown", this._onKeyDown, this))
    }, _onMouseMove: function (a) {
        this._moved || (this._box = e.DomUtil.create("div", "leaflet-zoom-box", this._pane), e.DomUtil.setPosition(this._box, this._startLayerPoint), this._container.style.cursor = "crosshair", this._map.fire("boxzoomstart"));
        var b = this._startLayerPoint, c = this._box, d = this._map.mouseEventToLayerPoint(a), f = d.subtract(b), g = new e.Point(Math.min(d.x, b.x), Math.min(d.y, b.y));
        e.DomUtil.setPosition(c, g), this._moved = !0, c.style.width = Math.max(0, Math.abs(f.x) - 4) + "px", c.style.height = Math.max(0, Math.abs(f.y) - 4) + "px"
    }, _finish: function () {
        this._moved && (this._pane.removeChild(this._box), this._container.style.cursor = ""), e.DomUtil.enableTextSelection(), e.DomUtil.enableImageDrag(), e.DomEvent.off(b, "mousemove", this._onMouseMove).off(b, "mouseup", this._onMouseUp).off(b, "keydown", this._onKeyDown)
    }, _onMouseUp: function (a) {
        this._finish();
        var b = this._map, c = b.mouseEventToLayerPoint(a);
        if (!this._startLayerPoint.equals(c)) {
            var d = new e.LatLngBounds(b.layerPointToLatLng(this._startLayerPoint), b.layerPointToLatLng(c));
            b.fitBounds(d), b.fire("boxzoomend", {boxZoomBounds: d})
        }
    }, _onKeyDown: function (a) {
        27 === a.keyCode && this._finish()
    }}), e.Map.addInitHook("addHandler", "boxZoom", e.Map.BoxZoom), e.Map.mergeOptions({keyboard: !0, keyboardPanOffset: 80, keyboardZoomOffset: 1}), e.Map.Keyboard = e.Handler.extend({keyCodes: {left: [37], right: [39], down: [40], up: [38], zoomIn: [187, 107, 61, 171], zoomOut: [189, 109, 173]}, initialize: function (a) {
        this._map = a, this._setPanOffset(a.options.keyboardPanOffset), this._setZoomOffset(a.options.keyboardZoomOffset)
    }, addHooks: function () {
        var a = this._map._container;
        -1 === a.tabIndex && (a.tabIndex = "0"), e.DomEvent.on(a, "focus", this._onFocus, this).on(a, "blur", this._onBlur, this).on(a, "mousedown", this._onMouseDown, this), this._map.on("focus", this._addHooks, this).on("blur", this._removeHooks, this)
    }, removeHooks: function () {
        this._removeHooks();
        var a = this._map._container;
        e.DomEvent.off(a, "focus", this._onFocus, this).off(a, "blur", this._onBlur, this).off(a, "mousedown", this._onMouseDown, this), this._map.off("focus", this._addHooks, this).off("blur", this._removeHooks, this)
    }, _onMouseDown: function () {
        if (!this._focused) {
            var c = b.body, d = b.documentElement, e = c.scrollTop || d.scrollTop, f = c.scrollLeft || d.scrollLeft;
            this._map._container.focus(), a.scrollTo(f, e)
        }
    }, _onFocus: function () {
        this._focused = !0, this._map.fire("focus")
    }, _onBlur: function () {
        this._focused = !1, this._map.fire("blur")
    }, _setPanOffset: function (a) {
        var b, c, d = this._panKeys = {}, e = this.keyCodes;
        for (b = 0, c = e.left.length; c > b; b++)d[e.left[b]] = [-1 * a, 0];
        for (b = 0, c = e.right.length; c > b; b++)d[e.right[b]] = [a, 0];
        for (b = 0, c = e.down.length; c > b; b++)d[e.down[b]] = [0, a];
        for (b = 0, c = e.up.length; c > b; b++)d[e.up[b]] = [0, -1 * a]
    }, _setZoomOffset: function (a) {
        var b, c, d = this._zoomKeys = {}, e = this.keyCodes;
        for (b = 0, c = e.zoomIn.length; c > b; b++)d[e.zoomIn[b]] = a;
        for (b = 0, c = e.zoomOut.length; c > b; b++)d[e.zoomOut[b]] = -a
    }, _addHooks: function () {
        e.DomEvent.on(b, "keydown", this._onKeyDown, this)
    }, _removeHooks: function () {
        e.DomEvent.off(b, "keydown", this._onKeyDown, this)
    }, _onKeyDown: function (a) {
        var b = a.keyCode, c = this._map;
        if (b in this._panKeys) {
            if (c._panAnim && c._panAnim._inProgress)return;
            c.panBy(this._panKeys[b]), c.options.maxBounds && c.panInsideBounds(c.options.maxBounds)
        } else {
            if (!(b in this._zoomKeys))return;
            c.setZoom(c.getZoom() + this._zoomKeys[b])
        }
        e.DomEvent.stop(a)
    }}), e.Map.addInitHook("addHandler", "keyboard", e.Map.Keyboard), e.Handler.MarkerDrag = e.Handler.extend({initialize: function (a) {
        this._marker = a
    }, addHooks: function () {
        var a = this._marker._icon;
        this._draggable || (this._draggable = new e.Draggable(a, a)), this._draggable.on("dragstart", this._onDragStart, this).on("drag", this._onDrag, this).on("dragend", this._onDragEnd, this), this._draggable.enable(), e.DomUtil.addClass(this._marker._icon, "leaflet-marker-draggable")
    }, removeHooks: function () {
        this._draggable.off("dragstart", this._onDragStart, this).off("drag", this._onDrag, this).off("dragend", this._onDragEnd, this), this._draggable.disable(), e.DomUtil.removeClass(this._marker._icon, "leaflet-marker-draggable")
    }, moved: function () {
        return this._draggable && this._draggable._moved
    }, _onDragStart: function () {
        this._marker.closePopup().fire("movestart").fire("dragstart")
    }, _onDrag: function () {
        var a = this._marker, b = a._shadow, c = e.DomUtil.getPosition(a._icon), d = a._map.layerPointToLatLng(c);
        b && e.DomUtil.setPosition(b, c), a._latlng = d, a.fire("move", {latlng: d}).fire("drag")
    }, _onDragEnd: function (a) {
        this._marker.fire("moveend").fire("dragend", a)
    }}), e.Control = e.Class.extend({options: {position: "topright"}, initialize: function (a) {
        e.setOptions(this, a)
    }, getPosition: function () {
        return this.options.position
    }, setPosition: function (a) {
        var b = this._map;
        return b && b.removeControl(this), this.options.position = a, b && b.addControl(this), this
    }, getContainer: function () {
        return this._container
    }, addTo: function (a) {
        this._map = a;
        var b = this._container = this.onAdd(a), c = this.getPosition(), d = a._controlCorners[c];
        return e.DomUtil.addClass(b, "leaflet-control"), -1 !== c.indexOf("bottom") ? d.insertBefore(b, d.firstChild) : d.appendChild(b), this
    }, removeFrom: function (a) {
        var b = this.getPosition(), c = a._controlCorners[b];
        return c.removeChild(this._container), this._map = null, this.onRemove && this.onRemove(a), this
    }, _refocusOnMap: function () {
        this._map && this._map.getContainer().focus()
    }}), e.control = function (a) {
        return new e.Control(a)
    }, e.Map.include({addControl: function (a) {
        return a.addTo(this), this
    }, removeControl: function (a) {
        return a.removeFrom(this), this
    }, _initControlPos: function () {
        function a(a, f) {
            var g = c + a + " " + c + f;
            b[a + f] = e.DomUtil.create("div", g, d)
        }

        var b = this._controlCorners = {}, c = "leaflet-", d = this._controlContainer = e.DomUtil.create("div", c + "control-container", this._container);
        a("top", "left"), a("top", "right"), a("bottom", "left"), a("bottom", "right")
    }, _clearControlPos: function () {
        this._container.removeChild(this._controlContainer)
    }}), e.Control.Zoom = e.Control.extend({options: {position: "topleft", zoomInText: "+", zoomInTitle: "Zoom in", zoomOutText: "-", zoomOutTitle: "Zoom out"}, onAdd: function (a) {
        var b = "leaflet-control-zoom", c = e.DomUtil.create("div", b + " leaflet-bar");
        return this._map = a, this._zoomInButton = this._createButton(this.options.zoomInText, this.options.zoomInTitle, b + "-in", c, this._zoomIn, this), this._zoomOutButton = this._createButton(this.options.zoomOutText, this.options.zoomOutTitle, b + "-out", c, this._zoomOut, this), this._updateDisabled(), a.on("zoomend zoomlevelschange", this._updateDisabled, this), c
    }, onRemove: function (a) {
        a.off("zoomend zoomlevelschange", this._updateDisabled, this)
    }, _zoomIn: function (a) {
        this._map.zoomIn(a.shiftKey ? 3 : 1)
    }, _zoomOut: function (a) {
        this._map.zoomOut(a.shiftKey ? 3 : 1)
    }, _createButton: function (a, b, c, d, f, g) {
        var h = e.DomUtil.create("a", c, d);
        h.innerHTML = a, h.href = "#", h.title = b;
        var i = e.DomEvent.stopPropagation;
        return e.DomEvent.on(h, "click", i).on(h, "mousedown", i).on(h, "dblclick", i).on(h, "click", e.DomEvent.preventDefault).on(h, "click", f, g).on(h, "click", this._refocusOnMap, g), h
    }, _updateDisabled: function () {
        var a = this._map, b = "leaflet-disabled";
        e.DomUtil.removeClass(this._zoomInButton, b), e.DomUtil.removeClass(this._zoomOutButton, b), a._zoom === a.getMinZoom() && e.DomUtil.addClass(this._zoomOutButton, b), a._zoom === a.getMaxZoom() && e.DomUtil.addClass(this._zoomInButton, b)
    }}), e.Map.mergeOptions({zoomControl: !0}), e.Map.addInitHook(function () {
        this.options.zoomControl && (this.zoomControl = new e.Control.Zoom, this.addControl(this.zoomControl))
    }), e.control.zoom = function (a) {
        return new e.Control.Zoom(a)
    }, e.Control.Attribution = e.Control.extend({options: {position: "bottomright", prefix: '<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'}, initialize: function (a) {
        e.setOptions(this, a), this._attributions = {}
    }, onAdd: function (a) {
        this._container = e.DomUtil.create("div", "leaflet-control-attribution"), e.DomEvent.disableClickPropagation(this._container);
        for (var b in a._customLayers)a._customLayers[b].getAttribution && this.addAttribution(a._customLayers[b].getAttribution());
        return a.on("layeradd", this._onLayerAdd, this).on("layerremove", this._onLayerRemove, this), this._update(), this._container
    }, onRemove: function (a) {
        a.off("layeradd", this._onLayerAdd).off("layerremove", this._onLayerRemove)
    }, setPrefix: function (a) {
        return this.options.prefix = a, this._update(), this
    }, addAttribution: function (a) {
        return a ? (this._attributions[a] || (this._attributions[a] = 0), this._attributions[a]++, this._update(), this) : void 0
    }, removeAttribution: function (a) {
        return a ? (this._attributions[a] && (this._attributions[a]--, this._update()), this) : void 0
    }, _update: function () {
        if (this._map) {
            var a = [];
            for (var b in this._attributions)this._attributions[b] && a.push(b);
            var c = [];
            this.options.prefix && c.push(this.options.prefix), a.length && c.push(a.join(", ")), this._container.innerHTML = c.join(" | ")
        }
    }, _onLayerAdd: function (a) {
        a.layer.getAttribution && this.addAttribution(a.layer.getAttribution())
    }, _onLayerRemove: function (a) {
        a.layer.getAttribution && this.removeAttribution(a.layer.getAttribution())
    }}), e.Map.mergeOptions({attributionControl: !0}), e.Map.addInitHook(function () {
        this.options.attributionControl && (this.attributionControl = (new e.Control.Attribution).addTo(this))
    }), e.control.attribution = function (a) {
        return new e.Control.Attribution(a)
    }, e.Control.Scale = e.Control.extend({options: {position: "bottomleft", maxWidth: 100, metric: !0, imperial: !0, updateWhenIdle: !1}, onAdd: function (a) {
        this._map = a;
        var b = "leaflet-control-scale", c = e.DomUtil.create("div", b), d = this.options;
        return this._addScales(d, b, c), a.on(d.updateWhenIdle ? "moveend" : "move", this._update, this), a.whenReady(this._update, this), c
    }, onRemove: function (a) {
        a.off(this.options.updateWhenIdle ? "moveend" : "move", this._update, this)
    }, _addScales: function (a, b, c) {
        a.metric && (this._mScale = e.DomUtil.create("div", b + "-line", c)), a.imperial && (this._iScale = e.DomUtil.create("div", b + "-line", c))
    }, _update: function () {
        var a = this._map.getBounds(), b = a.getCenter().lat, c = 6378137 * Math.PI * Math.cos(b * Math.PI / 180), d = c * (a.getNorthEast().lng - a.getSouthWest().lng) / 180, e = this._map.getSize(), f = this.options, g = 0;
        e.x > 0 && (g = d * (f.maxWidth / e.x)), this._updateScales(f, g)
    }, _updateScales: function (a, b) {
        a.metric && b && this._updateMetric(b), a.imperial && b && this._updateImperial(b)
    }, _updateMetric: function (a) {
        var b = this._getRoundNum(a);
        this._mScale.style.width = this._getScaleWidth(b / a) + "px", this._mScale.innerHTML = 1e3 > b ? b + " m" : b / 1e3 + " km"
    }, _updateImperial: function (a) {
        var b, c, d, e = 3.2808399 * a, f = this._iScale;
        e > 5280 ? (b = e / 5280, c = this._getRoundNum(b), f.style.width = this._getScaleWidth(c / b) + "px", f.innerHTML = c + " mi") : (d = this._getRoundNum(e), f.style.width = this._getScaleWidth(d / e) + "px", f.innerHTML = d + " ft")
    }, _getScaleWidth: function (a) {
        return Math.round(this.options.maxWidth * a) - 10
    }, _getRoundNum: function (a) {
        var b = Math.pow(10, (Math.floor(a) + "").length - 1), c = a / b;
        return c = c >= 10 ? 10 : c >= 5 ? 5 : c >= 3 ? 3 : c >= 2 ? 2 : 1, b * c
    }}), e.control.scale = function (a) {
        return new e.Control.Scale(a)
    }, e.Control.Layers = e.Control.extend({options: {collapsed: !0, position: "topright", autoZIndex: !0}, initialize: function (a, b, c) {
        e.setOptions(this, c), this._customLayers = {}, this._lastZIndex = 0, this._handlingClick = !1;
        for (var d in a)this._addLayer(a[d], d);
        for (d in b)this._addLayer(b[d], d, !0)
    }, onAdd: function (a) {
        return this._initLayout(), this._update(), a.on("layeradd", this._onLayerChange, this).on("layerremove", this._onLayerChange, this), this._container
    }, onRemove: function (a) {
        a.off("layeradd", this._onLayerChange).off("layerremove", this._onLayerChange)
    }, addBaseLayer: function (a, b) {
        return this._addLayer(a, b), this._update(), this
    }, addOverlay: function (a, b) {
        return this._addLayer(a, b, !0), this._update(), this
    }, removeLayer: function (a) {
        var b = e.stamp(a);
        return delete this._customLayers[b], this._update(), this
    }, _initLayout: function () {
        var a = "leaflet-control-layers", b = this._container = e.DomUtil.create("div", a);
        b.setAttribute("aria-haspopup", !0), e.Browser.touch ? e.DomEvent.on(b, "click", e.DomEvent.stopPropagation) : e.DomEvent.disableClickPropagation(b).disableScrollPropagation(b);
        var c = this._form = e.DomUtil.create("form", a + "-list");
        if (this.options.collapsed) {
            e.Browser.android || e.DomEvent.on(b, "mouseover", this._expand, this).on(b, "mouseout", this._collapse, this);
            var d = this._layersLink = e.DomUtil.create("a", a + "-toggle", b);
            d.href = "#", d.title = "Layers", e.Browser.touch ? e.DomEvent.on(d, "click", e.DomEvent.stop).on(d, "click", this._expand, this) : e.DomEvent.on(d, "focus", this._expand, this), e.DomEvent.on(c, "click", function () {
                setTimeout(e.bind(this._onInputClick, this), 0)
            }, this), this._map.on("click", this._collapse, this)
        } else this._expand();
        this._baseLayersList = e.DomUtil.create("div", a + "-base", c), this._separator = e.DomUtil.create("div", a + "-separator", c), this._overlaysList = e.DomUtil.create("div", a + "-overlays", c), b.appendChild(c)
    }, _addLayer: function (a, b, c) {
        var d = e.stamp(a);
        this._customLayers[d] = {layer: a, name: b, overlay: c}, this.options.autoZIndex && a.setZIndex && (this._lastZIndex++, a.setZIndex(this._lastZIndex))
    }, _update: function () {
        if (this._container) {
            this._baseLayersList.innerHTML = "", this._overlaysList.innerHTML = "";
            var a, b, c = !1, d = !1;
            for (a in this._customLayers)b = this._customLayers[a], this._addItem(b), d = d || b.overlay, c = c || !b.overlay;
            this._separator.style.display = d && c ? "" : "none"
        }
    }, _onLayerChange: function (a) {
        var b = this._customLayers[e.stamp(a.layer)];
        if (b) {
            this._handlingClick || this._update();
            var c = b.overlay ? "layeradd" === a.type ? "overlayadd" : "overlayremove" : "layeradd" === a.type ? "baselayerchange" : null;
            c && this._map.fire(c, b)
        }
    }, _createRadioElement: function (a, c) {
        var d = '<input type="radio" class="leaflet-control-layers-selector" name="' + a + '"';
        c && (d += ' checked="checked"'), d += "/>";
        var e = b.createElement("div");
        return e.innerHTML = d, e.firstChild
    }, _addItem: function (a) {
        var c, d = b.createElement("label"), f = this._map.hasLayer(a.layer);
        a.overlay ? (c = b.createElement("input"), c.type = "checkbox", c.className = "leaflet-control-layers-selector", c.defaultChecked = f) : c = this._createRadioElement("leaflet-base-layers", f), c.layerId = e.stamp(a.layer), e.DomEvent.on(c, "click", this._onInputClick, this);
        var g = b.createElement("span");
        g.innerHTML = " " + a.name, d.appendChild(c), d.appendChild(g);
        var h = a.overlay ? this._overlaysList : this._baseLayersList;
        return h.appendChild(d), d
    }, _onInputClick: function () {
        var a, b, c, d = this._form.getElementsByTagName("input"), e = d.length;
        for (this._handlingClick = !0, a = 0; e > a; a++)b = d[a], c = this._customLayers[b.layerId], b.checked && !this._map.hasLayer(c.layer) ? this._map.addLayer(c.layer) : !b.checked && this._map.hasLayer(c.layer) && this._map.removeLayer(c.layer);
        this._handlingClick = !1, this._refocusOnMap()
    }, _expand: function () {
        e.DomUtil.addClass(this._container, "leaflet-control-layers-expanded")
    }, _collapse: function () {
        this._container.className = this._container.className.replace(" leaflet-control-layers-expanded", "")
    }}), e.control.layers = function (a, b, c) {
        return new e.Control.Layers(a, b, c)
    }, e.PosAnimation = e.Class.extend({includes: e.Mixin.Events, run: function (a, b, c, d) {
        this.stop(), this._el = a, this._inProgress = !0, this._newPos = b, this.fire("start"), a.style[e.DomUtil.TRANSITION] = "all " + (c || .25) + "s cubic-bezier(0,0," + (d || .5) + ",1)", e.DomEvent.on(a, e.DomUtil.TRANSITION_END, this._onTransitionEnd, this), e.DomUtil.setPosition(a, b), e.Util.falseFn(a.offsetWidth), this._stepTimer = setInterval(e.bind(this._onStep, this), 50)
    }, stop: function () {
        this._inProgress && (e.DomUtil.setPosition(this._el, this._getPos()), this._onTransitionEnd(), e.Util.falseFn(this._el.offsetWidth))
    }, _onStep: function () {
        var a = this._getPos();
        return a ? (this._el._leaflet_pos = a, void this.fire("step")) : void this._onTransitionEnd()
    }, _transformRe: /([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/, _getPos: function () {
        var b, c, d, f = this._el, g = a.getComputedStyle(f);
        if (e.Browser.any3d) {
            if (d = g[e.DomUtil.TRANSFORM].match(this._transformRe), !d)return;
            b = parseFloat(d[1]), c = parseFloat(d[2])
        } else b = parseFloat(g.left), c = parseFloat(g.top);
        return new e.Point(b, c, !0)
    }, _onTransitionEnd: function () {
        e.DomEvent.off(this._el, e.DomUtil.TRANSITION_END, this._onTransitionEnd, this), this._inProgress && (this._inProgress = !1, this._el.style[e.DomUtil.TRANSITION] = "", this._el._leaflet_pos = this._newPos, clearInterval(this._stepTimer), this.fire("step").fire("end"))
    }}), e.Map.include({setView: function (a, b, d) {
        if (b = b === c ? this._zoom : this._limitZoom(b), a = this._limitCenter(e.latLng(a), b, this.options.maxBounds), d = d || {}, this._panAnim && this._panAnim.stop(), this._loaded && !d.reset && d !== !0) {
            d.animate !== c && (d.zoom = e.extend({animate: d.animate}, d.zoom), d.pan = e.extend({animate: d.animate}, d.pan));
            var f = this._zoom !== b ? this._tryAnimatedZoom && this._tryAnimatedZoom(a, b, d.zoom) : this._tryAnimatedPan(a, d.pan);
            if (f)return clearTimeout(this._sizeTimer), this
        }
        return this._resetView(a, b), this
    }, panBy: function (a, b) {
        if (a = e.point(a).round(), b = b || {}, !a.x && !a.y)return this;
        if (this._panAnim || (this._panAnim = new e.PosAnimation, this._panAnim.on({step: this._onPanTransitionStep, end: this._onPanTransitionEnd}, this)), b.noMoveStart || this.fire("movestart"), b.animate !== !1) {
            e.DomUtil.addClass(this._mapPane, "leaflet-pan-anim");
            var c = this._getMapPanePos().subtract(a);
            this._panAnim.run(this._mapPane, c, b.duration || .25, b.easeLinearity)
        } else this._rawPanBy(a), this.fire("move").fire("moveend");
        return this
    }, _onPanTransitionStep: function () {
        this.fire("move")
    }, _onPanTransitionEnd: function () {
        e.DomUtil.removeClass(this._mapPane, "leaflet-pan-anim"), this.fire("moveend")
    }, _tryAnimatedPan: function (a, b) {
        var c = this._getCenterOffset(a)._floor();
        return(b && b.animate) === !0 || this.getSize().contains(c) ? (this.panBy(c, b), !0) : !1
    }}), e.PosAnimation = e.DomUtil.TRANSITION ? e.PosAnimation : e.PosAnimation.extend({run: function (a, b, c, d) {
        this.stop(), this._el = a, this._inProgress = !0, this._duration = c || .25, this._easeOutPower = 1 / Math.max(d || .5, .2), this._startPos = e.DomUtil.getPosition(a), this._offset = b.subtract(this._startPos), this._startTime = +new Date, this.fire("start"), this._animate()
    }, stop: function () {
        this._inProgress && (this._step(), this._complete())
    }, _animate: function () {
        this._animId = e.Util.requestAnimFrame(this._animate, this), this._step()
    }, _step: function () {
        var a = +new Date - this._startTime, b = 1e3 * this._duration;
        b > a ? this._runFrame(this._easeOut(a / b)) : (this._runFrame(1), this._complete())
    }, _runFrame: function (a) {
        var b = this._startPos.add(this._offset.multiplyBy(a));
        e.DomUtil.setPosition(this._el, b), this.fire("step")
    }, _complete: function () {
        e.Util.cancelAnimFrame(this._animId), this._inProgress = !1, this.fire("end")
    }, _easeOut: function (a) {
        return 1 - Math.pow(1 - a, this._easeOutPower)
    }}), e.Map.mergeOptions({zoomAnimation: !0, zoomAnimationThreshold: 4}), e.DomUtil.TRANSITION && e.Map.addInitHook(function () {
        this._zoomAnimated = this.options.zoomAnimation && e.DomUtil.TRANSITION && e.Browser.any3d && !e.Browser.android23 && !e.Browser.mobileOpera, this._zoomAnimated && e.DomEvent.on(this._mapPane, e.DomUtil.TRANSITION_END, this._catchTransitionEnd, this)
    }), e.Map.include(e.DomUtil.TRANSITION ? {_catchTransitionEnd: function (a) {
        this._animatingZoom && a.propertyName.indexOf("transform") >= 0 && this._onZoomTransitionEnd()
    }, _nothingToAnimate: function () {
        return!this._container.getElementsByClassName("leaflet-zoom-animated").length
    }, _tryAnimatedZoom: function (a, b, c) {
        if (this._animatingZoom)return!0;
        if (c = c || {}, !this._zoomAnimated || c.animate === !1 || this._nothingToAnimate() || Math.abs(b - this._zoom) > this.options.zoomAnimationThreshold)return!1;
        var d = this.getZoomScale(b), e = this._getCenterOffset(a)._divideBy(1 - 1 / d), f = this._getCenterLayerPoint()._add(e);
        return c.animate === !0 || this.getSize().contains(e) ? (this.fire("movestart").fire("zoomstart"), this._animateZoom(a, b, f, d, null, !0), !0) : !1
    }, _animateZoom: function (a, b, c, d, f, g) {
        this._animatingZoom = !0, e.DomUtil.addClass(this._mapPane, "leaflet-zoom-anim"), this._animateToCenter = a, this._animateToZoom = b, e.Draggable && (e.Draggable._disabled = !0), this.fire("zoomanim", {center: a, zoom: b, origin: c, scale: d, delta: f, backwards: g})
    }, _onZoomTransitionEnd: function () {
        this._animatingZoom = !1, e.DomUtil.removeClass(this._mapPane, "leaflet-zoom-anim"), this._resetView(this._animateToCenter, this._animateToZoom, !0, !0), e.Draggable && (e.Draggable._disabled = !1)
    }} : {}), e.TileLayer.include({_animateZoom: function (a) {
        this._animating || (this._animating = !0, this._prepareBgBuffer());
        var b = this._bgBuffer, c = e.DomUtil.TRANSFORM, d = a.delta ? e.DomUtil.getTranslateString(a.delta) : b.style[c], f = e.DomUtil.getScaleString(a.scale, a.origin);
        b.style[c] = a.backwards ? f + " " + d : d + " " + f
    }, _endZoomAnim: function () {
        var a = this._tileContainer, b = this._bgBuffer;
        a.style.visibility = "", a.parentNode.appendChild(a), e.Util.falseFn(b.offsetWidth), this._animating = !1
    }, _clearBgBuffer: function () {
        var a = this._map;
        !a || a._animatingZoom || a.touchZoom._zooming || (this._bgBuffer.innerHTML = "", this._bgBuffer.style[e.DomUtil.TRANSFORM] = "")
    }, _prepareBgBuffer: function () {
        var a = this._tileContainer, b = this._bgBuffer, c = this._getLoadedTilesPercentage(b), d = this._getLoadedTilesPercentage(a);
        return b && c > .5 && .5 > d ? (a.style.visibility = "hidden", void this._stopLoadingImages(a)) : (b.style.visibility = "hidden", b.style[e.DomUtil.TRANSFORM] = "", this._tileContainer = b, b = this._bgBuffer = a, this._stopLoadingImages(b), void clearTimeout(this._clearBgBufferTimer))
    }, _getLoadedTilesPercentage: function (a) {
        var b, c, d = a.getElementsByTagName("img"), e = 0;
        for (b = 0, c = d.length; c > b; b++)d[b].complete && e++;
        return e / c
    }, _stopLoadingImages: function (a) {
        var b, c, d, f = Array.prototype.slice.call(a.getElementsByTagName("img"));
        for (b = 0, c = f.length; c > b; b++)d = f[b], d.complete || (d.onload = e.Util.falseFn, d.onerror = e.Util.falseFn, d.src = e.Util.emptyImageUrl, d.parentNode.removeChild(d))
    }}), e.Map.include({_defaultLocateOptions: {watch: !1, setView: !1, maxZoom: 1 / 0, timeout: 1e4, maximumAge: 0, enableHighAccuracy: !1}, locate: function (a) {
        if (a = this._locateOptions = e.extend(this._defaultLocateOptions, a), !navigator.geolocation)return this._handleGeolocationError({code: 0, message: "Geolocation not supported."}), this;
        var b = e.bind(this._handleGeolocationResponse, this), c = e.bind(this._handleGeolocationError, this);
        return a.watch ? this._locationWatchId = navigator.geolocation.watchPosition(b, c, a) : navigator.geolocation.getCurrentPosition(b, c, a), this
    }, stopLocate: function () {
        return navigator.geolocation && navigator.geolocation.clearWatch(this._locationWatchId), this._locateOptions && (this._locateOptions.setView = !1), this
    }, _handleGeolocationError: function (a) {
        var b = a.code, c = a.message || (1 === b ? "permission denied" : 2 === b ? "position unavailable" : "timeout");
        this._locateOptions.setView && !this._loaded && this.fitWorld(), this.fire("locationerror", {code: b, message: "Geolocation error: " + c + "."})
    }, _handleGeolocationResponse: function (a) {
        var b = a.coords.latitude, c = a.coords.longitude, d = new e.LatLng(b, c), f = 180 * a.coords.accuracy / 40075017, g = f / Math.cos(e.LatLng.DEG_TO_RAD * b), h = e.latLngBounds([b - f, c - g], [b + f, c + g]), i = this._locateOptions;
        if (i.setView) {
            var j = Math.min(this.getBoundsZoom(h), i.maxZoom);
            this.setView(d, j)
        }
        var k = {latlng: d, bounds: h, timestamp: a.timestamp};
        for (var l in a.coords)"number" == typeof a.coords[l] && (k[l] = a.coords[l]);
        this.fire("locationfound", k)
    }})
}(window, document), function (a) {
    "use strict";
    var b = a.TileLayer.prototype.initialize, c = a.TileLayer.prototype.onAdd, d = a.TileLayer.prototype._reset, e = a.TileLayer.prototype.onRemove, f = a.TileLayer.prototype._animateZoom, g = a.TileLayer.prototype._getTilePos, h = a.TileLayer.prototype._endZoomAnim, i = 1e-5;
    a.TileLayer.mergeOptions({autoRefresh: void 0, errorTileUrl: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAP8AAAD/CAYAAAA+CADKAAAOLElEQVR4nO3dLZeryhKA4fvzR2JxaBQWicPFoXCoGCS2rtiHWUUB3Q0hyST1PmvFnDObIRlePhoC/xMALv3v3TMA4D2IH3CK+AGniB9wivgBp4gfcIr4AaeIH3CK+AGniB9wivgBp4gfcIr4AaeIH3CK+AGniB9wivgBp4gfcIr4AaeIH3CK+AGniB9wivgBp4gfcIr4AaeIH3CK+AGniB9wivgBp4gfcIr4AaeIH3CK+AGniB9wivgBp4gfcIr4AaeIH3CK+AGniB9wivgBp4gfcIr4AaeIH3CK+AGniB9wivgBp4gfcIr4AaeIH3CK+AGniB9wivgBp4gfcIr4AaeIH3CK+AGniB9wivgBp4gfcIr4AaeIH3CK+AGniB9wivgBp4gfcIr4Aac+Iv5hGOTn5+f3dUZZlr//vm3bi+cQ+DzEDzhF/IBTxA84RfyAU8QPOEX8gFPEv2GaJrndblKWpWRZ9vvv8jyXuq5lGIbNf6fn8cirLMtT70lEpG3bw79vb/5n4zhK27ar9z/Pa9M0Mo7j7r/Xf6+U9xaatyunZf//WXu/43a7Lf5f3/fB6dR1/fuzRVHINE2n5+kM4jf6vl8t8FuvqqpWf6xviL9pmuTpdF23OQ2v8Yssl7Msy3aD7vt+MZ37/X56fs4ifqXrukMR2bX1p8evt0SPTMtz/NM0LTYeVVWt/v04joufud1up+flER8Z/6Ovrfjt78jzXLquW+ze3u/31ZaxaZpD8341HX/IkWDnhdb+3P1+l7Ztowu35/hF1lt1G7feED2y4n8U8f9H/0Hqug7Oz/1+XwSQevz7jPj1yigktsBWVRUMWrN7SJb3+EWWf5csy36XEb2yDh0WvALxy7+Y9RY/5Q+i/4ihrf+z49crrZAjUYRWZls/bxH/v93/oigW826XhdjA67N9ZPxnhI759ShtbDd+No7j778piuKp8x4yv6/QPIikLbBHEH/8s9QbFftKXc6eifjl2Aj33uuZ8x4yH37Ewngk/nEcZRgGud1uUtf1YosWC/bo65nTsp/D3ms+nZlySjf2WdrTfykr6lchfvP/Pin+aZqStySpC6w+x5/n+duDfUf8dkUQOqWbsiK1K8vY+f9XIX753Pj1qPLeOfdZygJ7dg/om+P/+VlvqY/EbweHt6b3LsQvy/PbV1/6+8z4dayxQbrYArt3jj/PcynLUqqqkrZtpe/7xXhHLNhPO+afpkmGYVh9Hvp03ZH47Vb/WcvZGcQvy5H72Gmuo54Z/7xbnud59GdDC6wdmKrrOnrF2bfGr+kVgP7dqfHrlXNRFKvjf0b7Ezw7frvwp1xqqc91v2O0X083ZeQ4tNDplV/sGgeR9UUs3xr/3u9OCVj/2yzLfpcpvRymnlZ+FuL/jx7cin3Jwh7HhS7PfFb8+qKco+flH4l/GIbVMey3xq+33Efit5f46uUj5fLfVyH+/9itWZZl0rbtYi9gHgm33/QLrSieEb+eZsqWWiS8wNor9uxu/zRN0vf97rjAN8U/juPmez1yzB+7fNcua7HB2mchfuXoaLfenXvmvO9N69HXvODardHRlz119Snxp75CX+Cyv0Mf14cu39V7bvry31cifqPruqQQ8jxPGhv4hPhFtk9J7a3w2rZdLLx2zOGb4t86BAx9hqGVomZXuO84/Uf8G/Zu5pFlmVRVdWg37VPin9/3fIGPXdHN73sOQR8q2LMNnx6/fr+pv8Ney58yCGv/nq8+/fcR8eMfvbCcPU2kB/fefaoJ70X8H4T4cSXi/yDEjysR/wchflyJ+D8I8eNKxA84RfyAU8QPOEX8gFPEDzhF/IBTxA84RfyAU8QPOEX8gFPEDzhF/HBlvs3W3u3O5xty/IX76j8b8cMV/cCRuq5/7503TdOhh6B8A+KHO/ZuxfblYasvQvxwahgGqapqdQ/9v/IQzVcgfsAp4gecIn7lzK2xQ8eHV91Se6ZvKZ46rSs+k7quF48zi93CXN8t6Ir3Pk2TdF23upX6fIvtlF311M/E3k8/5Xbhn4r4lb8cf+pDNa6MP+UJRlsPL7ky/r7vk953URTBh6ikfib2MV3E78Rfjf+Rx2mddeTRZfaxZVfFHxuVj83H3t9iz9bfn/idSL1BZurTf0JBH/lZ+1x3+wDRvfdwNn47jbIsF7vW4zjK7XZb7YLHHHlqkn301daDU+/3+2pLvffg1JTPRD9xh/id0U9P/Uvx6+fipTxC+9H49e8LLfz2UCT2GLMj8eufjT0Q1e4hbE079pnoFawe3yB+J1Jva/3q+I9Ec0X8+t/HHkaqw4s9bDL1feir8FJWKiLLY/WtvZDQZ6IPq4qiWCwHxO+E/qPvPVpZ5PXxH1kYr3wwaKrU35f6uek9sJTDCZH1CsNenhuaR73iGIaB+D3Su7shr47fHv/Op7e2VlDPij91MPSKPSYdX1VVyfOoD0HsfOx9Jvp9zYdUxO/QPOBz1e7rVfGLHBt9/6b4j1xnr6efGv/8N8+y7HdlSvzOTNO02gLseUf8IudOoV3lG+PXg3y3223z9xO/A/o486pR66vjF/m3kjqyEniFv7LbH5oP+5nYQb6930/8DuhBn9h3ud8Zvz2tpb+TLvL4Mb9eCcYOf0TW4xFXDJReMeBn58N+JnaQTyN+R0JbgS3vit+GtnV48mj8sVFzS4cSC/WvnOrbGuTbe0/E/+X0sV/KgvaO+KdpWlx8sncl2xWj/fr9hXa77cqoaZrk6b7zIp952nqQTyN+J/RWP3UXM2UhthE+Gr89zt+b3qsu723bdnFqLcuyyw6XRJ57ee/80oN8GvE7sLVAnH21bRscET8yL7Hz/KEt7FXn+Y+eWbhyj2n2rC/2xFb0xO/Aq+KP7Q7bebHx6y+c7G3ZZlde5GO/UPRI+CLH4xdJ/0pvWZbJX+nd+ow14nfg6vjtFjrP8+SFfG/BTN3dn119hd84jtI0zeobb3mer840xJyJX2R5ExP7TcK6rqOficjy842dPiR+B84siJoOzcsdX/E9iJ/44RTxEz+cIn7ih1PET/xwynX8gGfEDzhF/IBTxA84RfyAU8QPOEX8gFPEDzhF/IBTxA84RfxvMD/ltizLxX359l57t5sCHkH8LzRN06kn7xy5YQaQivhfZJqmzee/772yLJOqqpLuUgOcQfwvoh8CmmWZNE0jwzCwVcfbEP8L6Hv7xe5BD7wK8b+APs5PvdMt8GzE/wL6MdDAX0H8CeYn1OhbT//8/HuuX13X0d34rVtGD8MgVVUtbkVdFIU0TXPoyTdHby8eMgyDNE2zmn6WZVKWpdxut+AzA+xnVtf16pkDoVttn31f+hbl+u5Ksdtu29uce7sbE/FHpD65pqqqzTD0QyfbtpVpmhaDf2dCvTr+aZqSp5kyZpFyOnNrXl4dv73Ggvjxyz4HLvYqimK1AtALY9d1hxbwrSfIilwb/9FTkPMKYG8P4MhnZi9eemX8Wyt14oeIrB9Vlee5dF232CXv+361wNqnwdiFUa8o+r7/jWiaJun7fhXi1tV9Z592u/WzNgL7MMz5Pdiot+ar7/vVylA/4NO+v9BKRNPTPPLEor34x3HcfAQY8WPx5N69Lbpmw9AL6Nbz+2KPi7LXBNjffWX8+n3GLiPW73MrLB12URSb07CPGk+5dPnq+PXnq+eF+LF6OmzKhTh6IdK76zb+lK2dXfnY04NXxa/nLeXx5KGw9NhG7DPTe1Upz8K7Mn79/+3gJvFjMWC1d9xt6RWGDsnGn/LEXjsPdk/hyi3/EaGw9C7/3lb/rCvjn1fS80qY+LGgF4jUb9TZJ/TObPyp1+rrmOxC/Kr47/e7DMMgbdtKVVWr0XFNjx3EDmuOuip+PY/z3hTxY0EvEEe+WHNl/KGF+Bnx63P8W4NhWy9Nh3V1RFfErwf59H8nfixcGf80TX86/iPn+D85fj3Ip89mED8Wzuz22y28dib+0KDYVfGHzvEXRSFlWUpd19K2rQzDsDqVp/3l3X47yKcRPxYeHfCzA15nViZ6S2Xn4ar49QomyzJp2zY4Sh9awYXe/xY9ndTLo8/Gbwf5NOLHwpWn+kSWkaWcUrODh/pCGZHr4tf/L+XbhvayXe3IqT4daMqXnR6Jf2uQTyN+LFx5kc/W9EJ7E3ZXfGtl8Y747RWPNn6R5UU+ofP3+udS9qzOxl8UxeYgn0b8WLnq8t696RVFIV3XLS7v7bpudTrNLuzjOB66Ki20cOuV1tZu/ziOwe8jWLHLe4dhWE0rZa/qbPwphxbEj01XfLHnkenphXHvZ2IxpF7hd+a19V4f+WLPnkfjD+1dED92pX6lt67rpC+ppMZhw9hb2cTEFm47vrH3yvNc+r5fHL7YsYhZyld6j9yO/JH4Y5dTEz+CxnHcvMlF6s03rPlbcvY0W2h6Orosy5JXNikL99aNN+b5qet6EbleeYW2qKGbeRz9vB6JP7aSIX4A7hA/4BTxA04RP+AU8QNOET/gFPEDThE/4BTxA04RP+AU8QNOET/gFPEDThE/4BTxA04RP+AU8QNOET/gFPEDThE/4BTxA04RP+AU8QNOET/gFPEDThE/4BTxA04RP+AU8QNOET/gFPEDThE/4BTxA04RP+AU8QNOET/gFPEDThE/4BTxA04RP+AU8QNOET/gFPEDThE/4BTxA04RP+AU8QNOET/gFPEDThE/4BTxA04RP+AU8QNOET/gFPEDThE/4BTxA04RP+AU8QNOET/gFPEDThE/4BTxA04RP+AU8QNOET/gFPEDThE/4BTxA04RP+AU8QNOET/gFPEDThE/4BTxA04RP+AU8QNOET/gFPEDThE/4BTxA04RP+DU/wG2vHbPp13bEwAAAABJRU5ErkJggg=="}), a.TileLayer.include({overZoom: !0, overZoomLevel: 8, _createTile: function () {
        var b = a.tileWithLoader(this.options.tileSize);
        return b.setStyle({width: this._getTileSize() + "px"}), b.setData("galleryimg", "no"), b.setData("onselectstart", a.Util.falseFn), b.setData("onmousemove", a.Util.falseFn), a.Browser.ielt9 && void 0 !== this.options.opacity && b.setOpacity(this.options.opacity), a.Browser.mobileWebkit3d && b.setStyle("WebkitBackfaceVisibility", "hidden"), b
    }, initialize: function () {
        this._posiotion = {}, this._zooms = {}, this._tileSizes = {}, b.apply(this, arguments), this._origin = this.options.crs && this.options.crs._originLat || a.latLng(this.options.crs && this.options.crs.projection.MAX_LATITUDE || a.Projection.SphericalMercator.MAX_LATITUDE, -180)
    }, refreshTile: function (a) {
        var b;
        return this._tiles.hasOwnProperty(a) && (b = this._tiles[a], this._isTileLoaded(b) && (b.src = this._appendIndex(b.realSrc || b.src))), b
    }, _getTileSize: function (a) {
        var b, c, d, e, f, g, h = (void 0 !== a ? a : this.getLayerZoom()) + this.options.zoomOffset;
        return b = this._map, g = b.getZoom() + ":" + h, this._tileSizes[g] || (c = this.options.maxNativeZoom, d = this.options.tileSize, c && h > c && (d = Math.round(b.getZoomScale(h) / b.getZoomScale(c) * d)), this.isAdditionalLayer() && (e = this._mapScale(this.options.crs, h), f = this._mapScale(b.options.crs, b.getZoom()), Math.abs(1 - e / f) > i && (d = Math.round(f / e * d))), this._tileSizes[g] = d), this._tileSizes[g]
    }, _getZoomForUrl: function () {
        var a = this.options, b = this.getLayerZoom();
        return a.zoomReverse && (b = a.maxZoom - b), b += a.zoomOffset, a.maxNativeZoom ? Math.min(b, a.maxNativeZoom) : b
    }, getURL: function () {
        return this._url
    }, getLayerZoom: function () {
        var a, b, c, d, e = this._map;
        if (c = e.getZoom(), this.isAdditionalLayer()) {
            if (!Gis.Util.isDefine(this._zooms[c]) && (a = this._mapScale(this.options.crs, c), b = this._mapScale(e.options.crs, c), void 0 !== a && Math.abs(1 - a / b) < i && (this._zooms[c] = c), !Gis.Util.isDefine(this._zooms[c]))) {
                var f = this.getMinZoom(), g = this.getMaxZoom();
                for (d = f; g >= d; d += 1)if (a = this._mapScale(this.options.crs, d), a >= b) {
                    this._zooms[c] = d;
                    break
                }
                Gis.Util.isDefine(this._zooms[c]) || (this._zooms[c] = g)
            }
            return this._zooms[c]
        }
        return c
    }, _getTilePos: function (a) {
        var b = g.call(this, a);
        return this.isAdditionalLayer() && b._add(this.getGlobalLayerPosition(this._map.getZoom())), b
    }, _isTileLoaded: function (a) {
        return a.classList.contains("leaflet-tile-loaded")
    }, _reset: function () {
        var a;
        for (var b in this._tiles)this._tiles.hasOwnProperty(b) && (a = this._tiles[b], a.removeEventListener && (a.removeEventListener("error", this._tileOnError), a.removeEventListener("load", this._tileOnLoad)));
        d.call(this), this._updateTileLayerPosition()
    }, refreshAllVisibleTiles: function () {
        var a, b = this._tiles;
        for (a in b)b.hasOwnProperty(a) && this.refreshTile(a)
    }, _updateTileLayerPosition: function () {
    }, getMaxZoom: function () {
        return Gis.Util.isDefine(this.options.maxZoom) ? this.options.maxZoom : this._map && this._map.getMaxZoom()
    }, getMinZoom: function () {
        return Gis.Util.isDefine(this.options.minZoom) ? this.options.minZoom : this._map && this._map.getMinZoom()
    }, _update: function () {
        if (this._map) {
            var b, c, d = this._map, e = d.getPixelBounds(), f = this.getLayerZoom(), g = this._getTileSize();
            f > this.getMaxZoom() || f < this.getMinZoom() || (this.isAdditionalLayer() && (c = this.getGlobalLayerPosition(this._map.getZoom()), e.min = e.min.subtract(c), e.max = e.max.subtract(c)), b = a.bounds(e.min.divideBy(g)._floor(), e.max.divideBy(g)._floor()), this._addTilesFromCenterOut(b), (this.options.unloadInvisibleTiles || this.options.reuseTiles) && this._removeOtherTiles(b), this._updateTileLayerPosition())
        }
    }, getDelimeter: function (a) {
        return a.indexOf("?") < 0 ? "?" : "&"
    }, _appendIndex: function (a) {
        var b = this.getDelimeter(a);
        return a.indexOf("ctime=") < 0 ? a + b + "ctime=" + (new Date).getTime() : a.replace(/ctime=[\d]+/g, "ctime=" + (new Date).getTime())
    }, getGlobalLayerPosition: function (a) {
        return a = void 0 !== a ? a : this._map.getZoom(), this._posiotion[a] || (this._posiotion[a] = this._map.project(this._origin)), this._posiotion[a].clone()
    }, isAdditionalLayer: function () {
        return this.options.crs && this._map.options.crs !== this.options.crs
    }, loading: function () {
        this._loading || (this._loading = !0, Gis.EventBus.fire("tilesloading"))
    }, loadEnd: function () {
        this._loading && (this._loading = !1, Gis.EventBus.fire("tilesloaded"))
    }, onAdd: function () {
        c.apply(this, arguments), this.on("tileloadstart", this.loading, this), this.on("load", this.loadEnd, this), this.options.autoRefresh && (this.tileUpdater = new a.TileUpdater(this))
    }, onRemove: function () {
        e.apply(this, arguments), this.loadEnd(), this.off("tileloadstart", this.loading, this), this.off("load", this.loadEnd, this), this.tileUpdater && this.tileUpdater.stop()
    }, _animateZoom: function () {
        f.apply(this, arguments), this.tileUpdater && this.tileUpdater.stop()
    }, _endZoomAnim: function () {
        h.apply(this, arguments), this.tileUpdater && this.tileUpdater.run()
    }, _addTile: function (b, c, d) {
        d = d || {};
        var e = this._getTilePos(b), f = this._getTile();
        f.setData("lastUpdate", (new Date).toUTCString()), f = a.extend(f, d), f.key = f.key || b.x + ":" + b.y, this._tiles[f.key] || (f.setPosition(e, a.Browser.chrome), this._tiles[f.key] = f, this._loadTile(f, b), f.notChildOf(this._tileContainer) && f.appendTo(c))
    }, calculateLeftCornerLatlng: function (b, c) {
        var d, e, f = b.latlng, g = this.options.crs || this._map.options.crs;
        return f || (e = a.point(c.x * this._getTileSize(), c.y * this._getTileSize()), this._getDelta && (d = this._getDelta(this.getLayerZoom()), d && (e = e.subtract(d))), f = g.pointToLatLng(e, this.getLayerZoom())), f
    }, _loadTile: function (a, b) {
        a._layer = this, a.countError = a.countError || 0, a.tilePoint = a.tilePoint || b, a.latlng = this.calculateLeftCornerLatlng(a, b), a.zoom = void 0 !== a.zoom ? a.zoom : this.getLayerZoom(), a.replaceTilePoint = this.calculateReplaceTilePoint(a), a.addEventListener("error", this._tileOnError), a.addEventListener("load", this._tileOnLoad), a.src = this._getZoomedTileUrl(b, a), a.realSrc = a.realSrc || a.src, this.fire("tileloadstart", {tile: a.tile, url: a.src})
    }, _getZoomedTileUrl: function (a, b) {
        var c = this._getPointForTile(a, b);
        return this._adjustTilePoint(c, b.zoom), this.getTileUrl(c, b.zoom)
    }, _getPointForTile: function (a, b) {
        return b.replaceTilePoint || a
    }, zoomedTileName: function (a, b) {
        return b = b || 0, "z-" + b + "-p-x-" + a.x + "-p-y-" + a.y
    }, isAfterReplaceTile: function (a) {
        return a.countError && !a.afterError && this._map && a.zoom !== this.getLayerZoom() && a.src.indexOf(this.options.errorTileUrl) < 0
    }, _positionReplacedTile: function () {
        var b, c, d, e, f, g, h, i, j = this.container, k = j._layer;
        f = k._map, i = k.options.crs || f.options.crs, c = k._mapScale(f.options.crs, f.getZoom()) / k._mapScale(i, j.zoom), k._adjustTilePoint(j.replaceTilePoint, j.zoom), k._tileAlreadyLoaded(j) ? k._removeTile(j.key) : (b = k.options.tileSize, d = k.zoomedTileName(j.replaceTilePoint || j.tilePoint, j.zoom), e = i.pointToLatLng(j.replaceTilePoint.multiplyBy(b), j.zoom), g = f.project(e), j.addClass(d), j.setStyle({height: b * c + "px", width: b * c + "px"}), g = g.subtract(k._map.getPixelOrigin()), k._getDelta && (h = k._getDelta(j.zoom, !0), h && (g = g.subtract(h.floor().multiplyBy(c)))), j.setPosition(g, a.Browser.chrome))
    }, _tileOnLoad: function () {
        try {
            var b = this.container, c = b._layer;
            this.src !== a.Util.emptyImageUrl && (b.showImg(), c.isAfterReplaceTile(b) ? c._positionReplacedTile.call(this) : this.src.indexOf(c.options.errorTileUrl) > -1 && (b.zoom = 1), b.setStyle({zIndex: b.zoom}), c.fire("tileload", {tile: this, url: this.src}), this.src.indexOf(c.options.errorTileUrl) < 0 && c.fire("tileloadok", {tile: this, url: this.src})), c._tileLoaded()
        } catch (d) {
            console.log("    "), console.log(d.message), console.log(d.stack)
        }
    }, _tileAlreadyLoaded: function (a) {
        return a && a.parentNode && a.parentNode.querySelector("." + this.zoomedTileName(a.replaceTilePoint, Math.floor(a.zoom)))
    }, _removeTile: function (b, c) {
        var d = this._tiles[b];
        this.fire("tileunload", {tile: d.tile, url: d.src}), this.options.reuseTiles ? (d.removeClass("leaflet-tile-loaded"), this._unusedTiles.push(d)) : d.parentNode === this._tileContainer && d.removeFrom(this._tileContainer), a.Browser.android || (d.removeEventListener && (d.removeEventListener("error", this._tileOnError), d.removeEventListener("load", this._tileOnLoad)), d.src = a.Util.emptyImageUrl), c ? this._tiles[b] = !0 : delete this._tiles[b]
    }, isOverZoom: function () {
        return this.overZoom
    }, _mapScale: function (a, b) {
        return 256 === a.scale(0) ? Math.pow(2, b) / 156543.03392804097 : a.scale(b)
    }, calculateReplaceTilePoint: function (b) {
        var c, d, e, f = this.options.crs || this._map.options.crs;
        return b.countError && (c = f.latLngToPoint(b.latlng, b.zoom), this._getDelta && (e = this._getDelta(b.zoom, !0), e && (e.x = 0, c = c.add(e))), c.x += 1, c.y += 1, d = a.point(Math.floor(c.x / this.options.tileSize), Math.floor(c.y / this.options.tileSize)), d.z = b.zoom), d
    }, _tileOnError: function () {
        var a, b, c, d = this.container, e = d._layer;
        try {
            if (d.countError += 1, e._map && (c = e.getMinZoom(), e.isOverZoom() && e.overZoomLevel > e.getLayerZoom() - d.zoom && d.zoom > c))return d.zoom -= 1, d.replaceTilePoint = e.calculateReplaceTilePoint(d), a = e._tileAlreadyLoaded(d), void(e._tileContainer !== d.parentNode || a ? a && (e._removeTile(d.key, !0), e._tileLoaded()) : (e._adjustTilePoint(d.tilePoint), e._removeTile(d.key), e._addTile(d.tilePoint, e._tileContainer, {key: d.key, countError: d.countError, realSrc: d.realSrc, latlng: d.latlng, zoom: d.zoom})));
            d.showImg(), d.afterError = !0, e.fire("tileerror", {tile: this, url: this.src})
        } catch (f) {
            console.log(f), console.log(f.stack)
        }
        b = e.options.errorTileUrl, b && (this.src = b), e._tileLoaded()
    }, getTileUrl: function (b, c) {
        c = void 0 !== c ? c : this._getZoomForUrl();
        var d = a.Util.template(this._url, a.extend({s: this._getSubdomain(b), z: c, x: b.x, y: b.y}, this.options));
        return this.options.autoRefresh && (d = this._appendIndex(d)), d
    }, _adjustTilePoint: function (a, b) {
        b = void 0 !== b ? b : a.z;
        var c = this._getWrapTileNum(b);
        this.options.continuousWorld || this.options.noWrap || (a.x = (a.x % c.x + c.x) % c.x), this.options.tms && (a.y = c.y - a.y - 1), a.z = void 0 !== b ? b : this._getZoomForUrl()
    }, _getWrapTileNum: function (a) {
        a = void 0 !== a ? a : this.getLayerZoom();
        var b = this.options.crs || this._map.options.crs, c = b.getSize(a);
        return c.divideBy(this._getTileSize()).ceil()
    }})
}(L), window.Modernizr = function (a, b, c) {
    function d(a) {
        t.cssText = a
    }

    function e(a, b) {
        return d(x.join(a + ";") + (b || ""))
    }

    function f(a, b) {
        return typeof a === b
    }

    function g(a, b) {
        return!!~("" + a).indexOf(b)
    }

    function h(a, b) {
        for (var d in a) {
            var e = a[d];
            if (!g(e, "-") && t[e] !== c)return"pfx" == b ? e : !0
        }
        return!1
    }

    function i(a, b, d) {
        for (var e in a) {
            var g = b[a[e]];
            if (g !== c)return d === !1 ? a[e] : f(g, "function") ? g.bind(d || b) : g
        }
        return!1
    }

    function j(a, b, c) {
        var d = a.charAt(0).toUpperCase() + a.slice(1), e = (a + " " + z.join(d + " ") + d).split(" ");
        return f(b, "string") || f(b, "undefined") ? h(e, b) : (e = (a + " " + A.join(d + " ") + d).split(" "), i(e, b, c))
    }

    function k() {
        o.input = function (c) {
            for (var d = 0, e = c.length; e > d; d++)E[c[d]] = !!(c[d]in u);
            return E.list && (E.list = !(!b.createElement("datalist") || !a.HTMLDataListElement)), E
        }("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")), o.inputtypes = function (a) {
            for (var d, e, f, g = 0, h = a.length; h > g; g++)u.setAttribute("type", e = a[g]), d = "text" !== u.type, d && (u.value = v, u.style.cssText = "position:absolute;visibility:hidden;", /^range$/.test(e) && u.style.WebkitAppearance !== c ? (q.appendChild(u), f = b.defaultView, d = f.getComputedStyle && "textfield" !== f.getComputedStyle(u, null).WebkitAppearance && 0 !== u.offsetHeight, q.removeChild(u)) : /^(search|tel)$/.test(e) || (d = /^(url|email)$/.test(e) ? u.checkValidity && u.checkValidity() === !1 : u.value != v)), D[a[g]] = !!d;
            return D
        }("search tel url email datetime date month week time datetime-local number range color".split(" "))
    }

    var l, m, n = "2.6.3", o = {}, p = !0, q = b.documentElement, r = "modernizr", s = b.createElement(r), t = s.style, u = b.createElement("input"), v = ":)", w = {}.toString, x = " -webkit- -moz- -o- -ms- ".split(" "), y = "Webkit Moz O ms", z = y.split(" "), A = y.toLowerCase().split(" "), B = {svg: "http://www.w3.org/2000/svg"}, C = {}, D = {}, E = {}, F = [], G = F.slice, H = function (a, c, d, e) {
        var f, g, h, i, j = b.createElement("div"), k = b.body, l = k || b.createElement("body");
        if (parseInt(d, 10))for (; d--;)h = b.createElement("div"), h.id = e ? e[d] : r + (d + 1), j.appendChild(h);
        return f = ["&#173;", '<style id="s', r, '">', a, "</style>"].join(""), j.id = r, (k ? j : l).innerHTML += f, l.appendChild(j), k || (l.style.background = "", l.style.overflow = "hidden", i = q.style.overflow, q.style.overflow = "hidden", q.appendChild(l)), g = c(j, a), k ? j.parentNode.removeChild(j) : (l.parentNode.removeChild(l), q.style.overflow = i), !!g
    }, I = function (b) {
        var c = a.matchMedia || a.msMatchMedia;
        if (c)return c(b).matches;
        var d;
        return H("@media " + b + " { #" + r + " { position: absolute; } }", function (b) {
            d = "absolute" == (a.getComputedStyle ? getComputedStyle(b, null) : b.currentStyle).position
        }), d
    }, J = function () {
        function a(a, e) {
            e = e || b.createElement(d[a] || "div"), a = "on" + a;
            var g = a in e;
            return g || (e.setAttribute || (e = b.createElement("div")), e.setAttribute && e.removeAttribute && (e.setAttribute(a, ""), g = f(e[a], "function"), f(e[a], "undefined") || (e[a] = c), e.removeAttribute(a))), e = null, g
        }

        var d = {select: "input", change: "input", submit: "form", reset: "form", error: "img", load: "img", abort: "img"};
        return a
    }(), K = {}.hasOwnProperty;
    m = f(K, "undefined") || f(K.call, "undefined") ? function (a, b) {
        return b in a && f(a.constructor.prototype[b], "undefined")
    } : function (a, b) {
        return K.call(a, b)
    }, Function.prototype.bind || (Function.prototype.bind = function (a) {
        var b = this;
        if ("function" != typeof b)throw new TypeError;
        var c = G.call(arguments, 1), d = function () {
            if (this instanceof d) {
                var e = function () {
                };
                e.prototype = b.prototype;
                var f = new e, g = b.apply(f, c.concat(G.call(arguments)));
                return Object(g) === g ? g : f
            }
            return b.apply(a, c.concat(G.call(arguments)))
        };
        return d
    }), C.flexbox = function () {
        return j("flexWrap")
    }, C.flexboxlegacy = function () {
        return j("boxDirection")
    }, C.canvas = function () {
        var a = b.createElement("canvas");
        return!(!a.getContext || !a.getContext("2d"))
    }, C.canvastext = function () {
        return!(!o.canvas || !f(b.createElement("canvas").getContext("2d").fillText, "function"))
    }, C.webgl = function () {
        return!!a.WebGLRenderingContext
    }, C.touch = function () {
        var c;
        return"ontouchstart"in a || a.DocumentTouch && b instanceof DocumentTouch ? c = !0 : H(["@media (", x.join("touch-enabled),("), r, ")", "{#modernizr{top:9px;position:absolute}}"].join(""), function (a) {
            c = 9 === a.offsetTop
        }), c
    }, C.geolocation = function () {
        return"geolocation"in navigator
    }, C.postmessage = function () {
        return!!a.postMessage
    }, C.websqldatabase = function () {
        return!!a.openDatabase
    }, C.indexedDB = function () {
        return!!j("indexedDB", a)
    }, C.hashchange = function () {
        return J("hashchange", a) && (b.documentMode === c || b.documentMode > 7)
    }, C.history = function () {
        return!(!a.history || !history.pushState)
    }, C.draganddrop = function () {
        var a = b.createElement("div");
        return"draggable"in a || "ondragstart"in a && "ondrop"in a
    }, C.websockets = function () {
        return"WebSocket"in a || "MozWebSocket"in a
    }, C.rgba = function () {
        return d("background-color:rgba(150,255,150,.5)"), g(t.backgroundColor, "rgba")
    }, C.hsla = function () {
        return d("background-color:hsla(120,40%,100%,.5)"), g(t.backgroundColor, "rgba") || g(t.backgroundColor, "hsla")
    }, C.multiplebgs = function () {
        return d("background:url(https://),url(https://),red url(https://)"), /(url\s*\(.*?){3}/.test(t.background)
    }, C.backgroundsize = function () {
        return j("backgroundSize")
    }, C.borderimage = function () {
        return j("borderImage")
    }, C.borderradius = function () {
        return j("borderRadius")
    }, C.boxshadow = function () {
        return j("boxShadow")
    }, C.textshadow = function () {
        return"" === b.createElement("div").style.textShadow
    }, C.opacity = function () {
        return e("opacity:.55"), /^0.55$/.test(t.opacity)
    }, C.cssanimations = function () {
        return j("animationName")
    }, C.csscolumns = function () {
        return j("columnCount")
    }, C.cssgradients = function () {
        var a = "background-image:", b = "gradient(linear,left top,right bottom,from(#9f9),to(white));", c = "linear-gradient(left top,#9f9, white);";
        return d((a + "-webkit- ".split(" ").join(b + a) + x.join(c + a)).slice(0, -a.length)), g(t.backgroundImage, "gradient")
    }, C.cssreflections = function () {
        return j("boxReflect")
    }, C.csstransforms = function () {
        return!!j("transform")
    }, C.csstransforms3d = function () {
        var a = !!j("perspective");
        return a && "webkitPerspective"in q.style && H("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}", function (b) {
            a = 9 === b.offsetLeft && 3 === b.offsetHeight
        }), a
    }, C.csstransitions = function () {
        return j("transition")
    }, C.fontface = function () {
        var a;
        return H('@font-face {font-family:"font";src:url("https://")}', function (c, d) {
            var e = b.getElementById("smodernizr"), f = e.sheet || e.styleSheet, g = f ? f.cssRules && f.cssRules[0] ? f.cssRules[0].cssText : f.cssText || "" : "";
            a = /src/i.test(g) && 0 === g.indexOf(d.split(" ")[0])
        }), a
    }, C.generatedcontent = function () {
        var a;
        return H(["#", r, "{font:0/0 a}#", r, ':after{content:"', v, '";visibility:hidden;font:3px/1 a}'].join(""), function (b) {
            a = b.offsetHeight >= 3
        }), a
    }, C.video = function () {
        var a = b.createElement("video"), c = !1;
        try {
            (c = !!a.canPlayType) && (c = new Boolean(c), c.ogg = a.canPlayType('video/ogg; codecs="theora"').replace(/^no$/, ""), c.h264 = a.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/, ""), c.webm = a.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/, ""))
        } catch (d) {
        }
        return c
    }, C.audio = function () {
        var a = b.createElement("audio"), c = !1;
        try {
            (c = !!a.canPlayType) && (c = new Boolean(c), c.ogg = a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/, ""), c.mp3 = a.canPlayType("audio/mpeg;").replace(/^no$/, ""), c.wav = a.canPlayType('audio/wav; codecs="1"').replace(/^no$/, ""), c.m4a = (a.canPlayType("audio/x-m4a;") || a.canPlayType("audio/aac;")).replace(/^no$/, ""))
        } catch (d) {
        }
        return c
    }, C.localstorage = function () {
        try {
            return localStorage.setItem(r, r), localStorage.removeItem(r), !0
        } catch (a) {
            return!1
        }
    }, C.sessionstorage = function () {
        try {
            return sessionStorage.setItem(r, r), sessionStorage.removeItem(r), !0
        } catch (a) {
            return!1
        }
    }, C.webworkers = function () {
        return!!a.Worker
    }, C.applicationcache = function () {
        return!!a.applicationCache
    }, C.svg = function () {
        return!!b.createElementNS && !!b.createElementNS(B.svg, "svg").createSVGRect
    }, C.inlinesvg = function () {
        var a = b.createElement("div");
        return a.innerHTML = "<svg/>", (a.firstChild && a.firstChild.namespaceURI) == B.svg
    }, C.smil = function () {
        return!!b.createElementNS && /SVGAnimate/.test(w.call(b.createElementNS(B.svg, "animate")))
    }, C.svgclippaths = function () {
        return!!b.createElementNS && /SVGClipPath/.test(w.call(b.createElementNS(B.svg, "clipPath")))
    };
    for (var L in C)m(C, L) && (l = L.toLowerCase(), o[l] = C[L](), F.push((o[l] ? "" : "no-") + l));
    return o.input || k(), o.addTest = function (a, b) {
        if ("object" == typeof a)for (var d in a)m(a, d) && o.addTest(d, a[d]); else {
            if (a = a.toLowerCase(), o[a] !== c)return o;
            b = "function" == typeof b ? b() : b, "undefined" != typeof p && p && (q.className += " " + (b ? "" : "no-") + a), o[a] = b
        }
        return o
    }, d(""), s = u = null, function (a, b) {
        function c(a, b) {
            var c = a.createElement("p"), d = a.getElementsByTagName("head")[0] || a.documentElement;
            return c.innerHTML = "x<style>" + b + "</style>", d.insertBefore(c.lastChild, d.firstChild)
        }

        function d() {
            var a = r.elements;
            return"string" == typeof a ? a.split(" ") : a
        }

        function e(a) {
            var b = q[a[o]];
            return b || (b = {}, p++, a[o] = p, q[p] = b), b
        }

        function f(a, c, d) {
            if (c || (c = b), k)return c.createElement(a);
            d || (d = e(c));
            var f;
            return f = d.cache[a] ? d.cache[a].cloneNode() : n.test(a) ? (d.cache[a] = d.createElem(a)).cloneNode() : d.createElem(a), f.canHaveChildren && !m.test(a) ? d.frag.appendChild(f) : f
        }

        function g(a, c) {
            if (a || (a = b), k)return a.createDocumentFragment();
            c = c || e(a);
            for (var f = c.frag.cloneNode(), g = 0, h = d(), i = h.length; i > g; g++)f.createElement(h[g]);
            return f
        }

        function h(a, b) {
            b.cache || (b.cache = {}, b.createElem = a.createElement, b.createFrag = a.createDocumentFragment, b.frag = b.createFrag()), a.createElement = function (c) {
                return r.shivMethods ? f(c, a, b) : b.createElem(c)
            }, a.createDocumentFragment = Function("h,f", "return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&(" + d().join().replace(/\w+/g, function (a) {
                return b.createElem(a), b.frag.createElement(a), 'c("' + a + '")'
            }) + ");return n}")(r, b.frag)
        }

        function i(a) {
            a || (a = b);
            var d = e(a);
            return!r.shivCSS || j || d.hasCSS || (d.hasCSS = !!c(a, "article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")), k || h(a, d), a
        }

        var j, k, l = a.html5 || {}, m = /^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i, n = /^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i, o = "_html5shiv", p = 0, q = {};
        !function () {
            try {
                var a = b.createElement("a");
                a.innerHTML = "<xyz></xyz>", j = "hidden"in a, k = 1 == a.childNodes.length || function () {
                    b.createElement("a");
                    var a = b.createDocumentFragment();
                    return"undefined" == typeof a.cloneNode || "undefined" == typeof a.createDocumentFragment || "undefined" == typeof a.createElement
                }()
            } catch (c) {
                j = !0, k = !0
            }
        }();
        var r = {elements: l.elements || "abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video", shivCSS: l.shivCSS !== !1, supportsUnknownElements: k, shivMethods: l.shivMethods !== !1, type: "default", shivDocument: i, createElement: f, createDocumentFragment: g};
        a.html5 = r, i(b)
    }(this, b), o._version = n, o._prefixes = x, o._domPrefixes = A, o._cssomPrefixes = z, o.mq = I, o.hasEvent = J, o.testProp = function (a) {
        return h([a])
    }, o.testAllProps = j, o.testStyles = H, o.prefixed = function (a, b, c) {
        return b ? j(a, b, c) : j(a, "pfx")
    }, q.className = q.className.replace(/(^|\s)no-js(\s|$)/, "$1$2") + (p ? " js " + F.join(" ") : ""), o
}(this, this.document), "undefined" == typeof document ? (self._noTransferable = !0, self.onmessage = function (e) {
    eval(e.data)
}) : !function (a) {
    "use strict";
    function b() {
        var a, b = 0, c = G;
        for (G = []; a = c[b++];)a()
    }

    function c() {
        function a() {
            this.then = function (a, c) {
                return b(a, c)
            }
        }

        var b = function (a, g, h) {
            if (a !== b) {
                var i = d();
                return b.queue.push({deferred: i, resolve: a, reject: g}), i.promise
            }
            for (var j = g ? "resolve" : "reject", k = 0, l = b.queue.length; l > k; k++) {
                var m = b.queue[k], n = m.deferred, o = m[j];
                typeof o !== H ? n[j](h) : f(o, h, n)
            }
            b = e(c, h, g)
        }, c = new a;
        this.promise = c, b.queue = [], this.resolve = function (a) {
            b.queue && b(b, !0, a)
        }, this.fulfill = this.resolve, this.reject = function (a) {
            b.queue && b(b, !1, a)
        }
    }

    function d() {
        return new c
    }

    function e(a, b, c) {
        return function (e, g) {
            var h = c ? e : g;
            if (typeof h !== H)return a;
            var i = d();
            return f(h, b, i), i.promise
        }
    }

    function f(a, b, c) {
        z.nextTick(function () {
            try {
                var d = a(b);
                d && typeof d.then === H ? d.then(c.resolve, c.reject) : c.resolve(d)
            } catch (e) {
                c.reject(e)
            }
        })
    }

    function g(a) {
        for (var b = a, c = !0, d = {}, e = function (a, b) {
            b && "importScripts(" + b.split(",").forEach(function (a) {
                d[z.makeUrl(a.match(/\s*[\'\"](\S*)[\'\"]\s*/)[1])] = !0
            }) + ");\n"
        }; c;)c = b.match(/(importScripts\(.*?\);?)/), b = b.replace(/(importScripts\(\s*(?:[\'\"].*?[\'\"])?\s*\);?)/, "\n"), c && c[0].replace(/importScripts\(\s*([\'\"].*?[\'\"])?\s*\);?/g, e);
        return d = Object.keys(d), [d, b]
    }

    function h(a, b) {
        var c = g(a), d = c[0], e = c[1];
        return d.length > 0 ? "importScripts('" + d.join("','") + b + e : e
    }

    function i() {
        if ("undefined" != typeof SHIM_WORKER_PATH)return SHIM_WORKER_PATH;
        if ("SHIM_WORKER_PATH"in z)return z.SHIM_WORKER_PATH;
        for (var a = document.getElementsByTagName("script"), b = a.length, c = 0; b > c;) {
            if (/catiline(\.min)?\.js/.test(a[c].src))return a[c].src;
            c++
        }
    }

    function j(a, b) {
        var c = a.createElement("script");
        "undefined" != typeof c.text ? c.text = b : c.innerHTML = b, "complete" === a.readyState ? a.documentElement.appendChild(c) : a.onreadystatechange = function () {
            "complete" === a.readyState && a.documentElement.appendChild(c)
        }
    }

    function k(a, b) {
        var c = document.createElement("iframe");
        c.style.display = "none", document.body.appendChild(c);
        var d = c.contentWindow.document, e = ["try{ ", "var __scripts__='';function importScripts(scripts){", "	if(Array.isArray(scripts)&&scripts.length>0){", "		scripts.forEach(function(url){", "			var ajax = new XMLHttpRequest();", "			ajax.open('GET',url,false);", "			ajax.send();__scripts__+=ajax.responseText;", "			__scripts__+='\\n;';", "		});", "	}", "};", a, "}catch(e){", "	window.parent.postMessage(['" + b + "','error'],'*')", "}"].join("\n");
        return j(d, e), c
    }

    function l(a, b) {
        var c = z.deferred();
        return"complete" === document.readyState ? c.resolve(k(a, b)) : window.addEventListener("load", function () {
            c.resolve(k(a, b))
        }, !1), c.promise
    }

    function m(a) {
        z._noTransferable = !0;
        var b = new Worker(i());
        return b.postMessage(a), b
    }

    function n(a) {
        var b = "{", c = !0;
        for (var d in a)c ? c = !1 : b += ",", b += d, b += ":", b += z.stringify(a[d]);
        return b += "}"
    }

    function o(a) {
        if (a.length) {
            var b = "[";
            b += z.stringify(a[0]);
            for (var c = 0, d = a.length; ++c < d;)b += ",", b += z.stringify(a[c]);
            return b += "]"
        }
        return"[]"
    }

    function p(a, b) {
        var c, d = {};
        "undefined" != typeof __self__ ? c = __self__.postMessage : b && (c = b), a.on = function (b, c, e) {
            if (e = e || a, b.indexOf(" ") > 0)return b.split(" ").map(function (b) {
                return a.on(b, c, e)
            }, this), a;
            b in d || (d[b] = []);
            var f = function (a) {
                c.call(e, a, e)
            };
            return f.orig = c, d[b].push(f), a
        }, a.one = function (b, c, d) {
            function e(f) {
                a.off(b, e), c.call(d, f, d)
            }

            return d = d || a, a.on(b, e)
        }, a.trigger = function (b, c) {
            return b.indexOf(" ") > 0 ? (b.split(" ").forEach(function (b) {
                a.trigger(b, c)
            }), a) : b in d ? (d[b].forEach(function (a) {
                a(c)
            }), a) : a
        }, a.fire = function (b, d, e) {
            return c([
                [b],
                d
            ], e), a
        }, a.off = function (b, c) {
            return b.indexOf(" ") > 0 ? (b.split(" ").map(function (b) {
                return a.off(b, c)
            }), a) : b in d ? (c ? d[b] = d[b].map(function (a) {
                return a.orig === c ? !1 : a
            }).filter(function (a) {
                return a
            }) : delete d[b], a) : a
        }
    }

    function q(a) {
        if ("undefined" != typeof console) {
            var b = console[a[0]] ? a[0] : "log";
            "undefined" == typeof console[b].apply ? console[b](a[1].join(" ")) : console[b].apply(console, a[1])
        }
    }

    function r(a) {
        function b(b) {
            return function () {
                for (var c = arguments.length, d = [], e = 0; c > e;)d.push(arguments[e]), e++;
                a.fire("console", [b, d])
            }
        }

        ["log", "debug", "error", "info", "warn", "time", "timeEnd"].forEach(function (a) {
            console[a] = b(a)
        })
    }

    function s(a) {
        "function" == typeof a && (a = {data: a});
        var b = "com.catilinejs." + (s._hasWorker ? "iframe" : "worker") + Math.random(), c = this, d = [];
        p(c, function (a, b) {
            z._noTransferable ? l.postMessage(a) : l.postMessage(a, b)
        });
        var e = function (a) {
            "string" != typeof a && "preventDefault"in a && (a.preventDefault(), a = a.message), d.forEach(function (b) {
                b && b.reject(a)
            })
        };
        if (a.__codeWord__ = b, a.__initialize__ = [I, p, r], "initialize"in a ? a.__initialize__.push(a.initialize) : "init"in a && a.__initialize__.push(a.init), "events"in a || (a.events = {}), "listners"in a && "function" != typeof a.listners)for (var f in a.listners)c.on(f, a.listners[f]);
        var g = "var _db = {\n	", h = function (a) {
            var c = function (c, e) {
                var f = d.length;
                return d[f] = z.deferred(), z._noTransferable ? l.postMessage([
                    [b, f],
                    a,
                    c
                ]) : l.postMessage([
                    [b, f],
                    a,
                    c
                ], e), d[f].promise
            };
            return c
        }, i = !1;
        for (var j in a)if (!(["listners", "initialize", "init"].indexOf(j) > -1))if (i ? g += ",\n	" : i = !0, "function" == typeof a[j])g = g + j + ":" + a[j].toString(), c[j] = h(j); else {
            var k = z.stringify(a[j]);
            "undefined" != typeof k && (g = g + j + ":" + k)
        }
        g += "};";
        var l = z.makeWorker(["'use strict';", "", g, "_db.__initialize__.forEach(function(f){", "	f.call(_db,_db);", "});", "for(var key in _db.events){", "	_db.on(key,_db.events[key]);", "}"], b);
        l.onmessage = function (a) {
            c.trigger("message", a.data[1]), a.data[0][0] === b ? (d[a.data[0][1]].resolve(a.data[1]), d[a.data[0][1]] = 0) : c.trigger(a.data[0][0], a.data[1])
        }, c.on("error", e), l.onerror = function (a) {
            c.trigger("error", a)
        }, c.on("console", q), c._close = function () {
            return l.terminate(), e("closed"), z.resolve()
        }, "close"in c || (c.close = c._close)
    }

    function t(a, b) {
        return{keyFunc: function (b) {
            return function (c, d) {
                return a(b, c, d)
            }
        }, keyFuncBatch: function (b) {
            return function (c) {
                return z.all(c.map(function (c) {
                    return a(b, c)
                }))
            }
        }, keyFuncBatchCB: function (c) {
            return function (d) {
                return z.all(d.map(function (d) {
                    return a(c, d).then(b.__cb__)
                }))
            }
        }, keyFuncBatchTransfer: function (b) {
            return function (c) {
                return z.all(c.map(function (c) {
                    return a(b, c[0], c[1])
                }))
            }
        }, keyFuncBatchTransferCB: function (c) {
            return function (d) {
                return z.all(d.map(function (d) {
                    return a(c, d[0], d[1]).then(b.__cb__)
                }))
            }
        }}
    }

    function u(a, b, c) {
        var d = t(a, b);
        for (var e in c)b[e] = d.keyFunc(e), b.batch[e] = d.keyFuncBatch(e), b.__batchcb__[e] = d.keyFuncBatchCB(e), b.batchTransfer[e] = d.keyFuncBatchTransfer(e), b.__batchtcb__[e] = d.keyFuncBatchTransferCB(e)
    }

    function v(a, b, c) {
        a.on = function (c, d, e) {
            return b.forEach(function (a) {
                a.on(c, d, e)
            }), a
        }, a.off = function (c, d, e) {
            return b.forEach(function (a) {
                a.off(c, d, e)
            }), a
        }, a.fire = function (d, e) {
            return b[~~(Math.random() * c)].fire(d, e), a
        }
    }

    function w(a, b) {
        return function (c, d, e, f) {
            return f.promise.cancel = function (a) {
                return f.reject(a)
            }, a[~~(Math.random() * b)][c](d, e).then(function (a) {
                return f.resolve(a)
            }, function (a) {
                return f.reject(a)
            }), f.promise
        }
    }

    function x(a, b, c) {
        for (var d = [], e = -1; ++e < a;)d[e] = new z.Worker(c), b.push(e);
        return d
    }

    function y(a, b, c) {
        function d(a) {
            a = a || "canceled", k = 0;
            var b = j;
            return j = [], b.forEach(function (b) {
                b[3].reject(a)
            }), g
        }

        function e(a) {
            if (k) {
                var b = j.shift();
                k--, l[a][b[0]](b[1], b[2]).then(function (c) {
                    e(a), b[3].resolve(c)
                }, function (c) {
                    e(a), b[3].reject(c)
                })
            } else h++, i.push(a)
        }

        function f(a, b, d) {
            var f = z.deferred();
            if (c)return n(a, b, d, f);
            if (!k && h) {
                var g = i.pop();
                h--, f.promise.cancel = function (a) {
                    return f.reject(a)
                }, l[g][a](b, d).then(function (a) {
                    e(g), f.resolve(a)
                }, function (a) {
                    e(g), f.reject(a)
                })
            } else if (k || !h) {
                var m = [a, b, d, f];
                f.promise.cancel = function (a) {
                    var b = j.indexOf(m);
                    return b > -1 && (j.splice(b, 1), k--), f.reject(a)
                }, k = j.push(m)
            }
            return f.promise
        }

        var g = this, h = b, i = [], j = [], k = 0, l = x(b, i, a);
        v(g, l, b);
        var m = function (a, b) {
            return l.forEach(function (c) {
                c.fire(a, b)
            }), g
        };
        g.batch.fire = m, g.batchTransfer.fire = m, g.clearQueue = d, u(f, g, a);
        var n;
        c && (n = w(l, b)), g._close = function () {
            return z.all(l.map(function (a) {
                return a._close()
            }))
        }, "close"in g || (g.close = g._close)
    }

    function z(a, b, c) {
        return 1 === arguments.length || !b || 1 >= b ? new z.Worker(a) : new z.Queue(a, b, c)
    }

    function A(b) {
        var c = a.cw;
        b.noConflict = function (d) {
            a.cw = c, d && (a[d] = b)
        }, a.catiline = b, a.cw = b, "communist"in a || (a.communist = b)
    }

    var B, C = a.MutationObserver || a.WebKitMutationObserver;
    if (C) {
        var D = new C(b), E = document.createElement("div");
        D.observe(E, {attributes: !0}), addEventListener("unload", function () {
            D.disconnect(), D = null
        }, !1), B = function () {
            E.setAttribute("drainQueue", "drainQueue")
        }
    } else {
        var F = "com.catiline.setImmediate" + Math.random();
        addEventListener("message", function (a) {
            a.source === window && a.data === F && b()
        }, !1), B = function () {
            postMessage(F, "*")
        }
    }
    var G = [];
    z.nextTick = function (a) {
        1 === G.push(a) && B()
    };
    var H = "function";
    z.deferred = d, z.resolve = function (a) {
        var b = {};
        return b.then = e(b, a, !0), b
    }, z.reject = function (a) {
        var b = {};
        return b.then = e(b, a, !1), b
    }, z.all = function (a) {
        var b = d(), c = a.length, e = 0, f = [], g = function (a) {
            return function (d) {
                f[a] = d, e++, e === c && b.resolve(f)
            }
        };
        return a.forEach(function (a, c) {
            a.then(g(c), function (a) {
                b.reject(a)
            })
        }), b.promise
    }, z._hasWorker = "undefined" != typeof Worker && "undefined" == typeof fakeLegacy, z.URL = window.URL || window.webkitURL, z._noTransferable = !z.URL, z.makeIWorker = function (a, b) {
        var c = h(a.join(""), "');eval(__scripts__);\n"), d = {onmessage: function () {
        }}, e = l(c, b);
        return window.addEventListener("message", function (a) {
            a.data.slice && a.data.slice(0, b.length) === b && d.onmessage({data: JSON.parse(a.data.slice(b.length))})
        }), d.postMessage = function (a) {
            e.then(function (b) {
                b.contentWindow.postMessage(JSON.stringify(a), "*")
            })
        }, d.terminate = function () {
            e.then(function (a) {
                document.body.removeChild(a)
            })
        }, d
    }, z.makeWorker = function (a, b) {
        if (!z._hasWorker)return z.makeIWorker(a, b);
        var c, d = h(a.join("\n"), "');\n");
        if (z._noTransferable)return m(d);
        try {
            c = new Worker(z.URL.createObjectURL(new Blob([d], {type: "text/javascript"})))
        } catch (e) {
            try {
                c = m(d)
            } catch (f) {
                c = z.makeIWorker(a, b)
            }
        } finally {
            return c
        }
    }, z.makeUrl = function (a) {
        var b = document.createElement("link");
        return b.href = a, b.href
    }, z.stringify = function (a) {
        return Array.isArray(a) ? o(a) : "function" == typeof a || "number" == typeof a || "boolean" == typeof a ? a.toString() : "string" == typeof a ? '"' + a + '"' : "[object Object]" === a.toString() ? n(a) : void 0
    };
    var I = function (a) {
        self.__iFrame__ = "undefined" != typeof document, self.__self__ = {onmessage: function (c) {
            return a.trigger("messege", c.data[1]), c.data[0][0] === a.__codeWord__ ? b(c) : void a.trigger(c.data[0][0], c.data[1])
        }}, __iFrame__ ? window.onmessage = function (a) {
            "string" == typeof a.data && (a = {data: JSON.parse(a.data)}), __self__.onmessage(a)
        } : self.onmessage = __self__.onmessage, __self__.postMessage = function (b, c) {
            if (self._noTransferable || __iFrame__)if (__iFrame__) {
                var d = a.__codeWord__ + JSON.stringify(b);
                window.parent.postMessage(d, "*")
            } else self._noTransferable && self.postMessage(b); else self.postMessage(b, c)
        }, self.console = {};
        var b = function (b) {
            var c, d = function (a, c) {
                __self__.postMessage([b.data[0], a], c)
            };
            if (__iFrame__)try {
                c = a[b.data[1]](b.data[2], d, a)
            } catch (e) {
                a.fire("error", JSON.stringify(e))
            } else c = a[b.data[1]](b.data[2], d, a);
            "undefined" != typeof c && d(c)
        }
    };
    z.Worker = s, z.worker = function (a) {
        return new s(a)
    }, y.prototype.__batchcb__ = {}, y.prototype.__batchtcb__ = {}, y.prototype.batch = function (a) {
        return"function" == typeof a ? (this.__cb__ = a, this.__batchcb__) : this.clearQueue(a)
    }, y.prototype.batchTransfer = function (a) {
        return"function" == typeof a ? (this.__batchtcb__.__cb__ = a, this.__batchtcb__) : this.clearQueue(a)
    }, z.Queue = y, z.queue = function (a, b, c) {
        return new z.Queue(a, b, c)
    }, z.setImmediate = z.nextTick, "function" == typeof define ? define(function (a) {
        return z.SHIM_WORKER_PATH = a.toUrl("./catiline.js"), z
    }) : "undefined" != typeof module && "exports"in module ? module.exports = z : A(z), z.version = "2.9.3"
}(this), function (a, b) {
    function c(a) {
        var b = a.length, c = fb.type(a);
        return fb.isWindow(a) ? !1 : 1 === a.nodeType && b ? !0 : "array" === c || "function" !== c && (0 === b || "number" == typeof b && b > 0 && b - 1 in a)
    }

    function d(a) {
        var b = ob[a] = {};
        return fb.each(a.match(hb) || [], function (a, c) {
            b[c] = !0
        }), b
    }

    function e() {
        Object.defineProperty(this.cache = {}, 0, {get: function () {
            return{}
        }}), this.expando = fb.expando + Math.random()
    }

    function f(a, c, d) {
        var e;
        if (d === b && 1 === a.nodeType)if (e = "data-" + c.replace(sb, "-$1").toLowerCase(), d = a.getAttribute(e), "string" == typeof d) {
            try {
                d = "true" === d ? !0 : "false" === d ? !1 : "null" === d ? null : +d + "" === d ? +d : rb.test(d) ? JSON.parse(d) : d
            } catch (f) {
            }
            pb.set(a, c, d)
        } else d = b;
        return d
    }

    function g() {
        return!0
    }

    function h() {
        return!1
    }

    function i() {
        try {
            return T.activeElement
        } catch (a) {
        }
    }

    function j(a, b) {
        for (; (a = a[b]) && 1 !== a.nodeType;);
        return a
    }

    function k(a, b, c) {
        if (fb.isFunction(b))return fb.grep(a, function (a, d) {
            return!!b.call(a, d, a) !== c
        });
        if (b.nodeType)return fb.grep(a, function (a) {
            return a === b !== c
        });
        if ("string" == typeof b) {
            if (Cb.test(b))return fb.filter(b, a, c);
            b = fb.filter(b, a)
        }
        return fb.grep(a, function (a) {
            return bb.call(b, a) >= 0 !== c
        })
    }

    function l(a, b) {
        return fb.nodeName(a, "table") && fb.nodeName(1 === b.nodeType ? b : b.firstChild, "tr") ? a.getElementsByTagName("tbody")[0] || a.appendChild(a.ownerDocument.createElement("tbody")) : a
    }

    function m(a) {
        return a.type = (null !== a.getAttribute("type")) + "/" + a.type, a
    }

    function n(a) {
        var b = Nb.exec(a.type);
        return b ? a.type = b[1] : a.removeAttribute("type"), a
    }

    function o(a, b) {
        for (var c = a.length, d = 0; c > d; d++)qb.set(a[d], "globalEval", !b || qb.get(b[d], "globalEval"))
    }

    function p(a, b) {
        var c, d, e, f, g, h, i, j;
        if (1 === b.nodeType) {
            if (qb.hasData(a) && (f = qb.access(a), g = qb.set(b, f), j = f.events)) {
                delete g.handle, g.events = {};
                for (e in j)for (c = 0, d = j[e].length; d > c; c++)fb.event.add(b, e, j[e][c])
            }
            pb.hasData(a) && (h = pb.access(a), i = fb.extend({}, h), pb.set(b, i))
        }
    }

    function q(a, c) {
        var d = a.getElementsByTagName ? a.getElementsByTagName(c || "*") : a.querySelectorAll ? a.querySelectorAll(c || "*") : [];
        return c === b || c && fb.nodeName(a, c) ? fb.merge([a], d) : d
    }

    function r(a, b) {
        var c = b.nodeName.toLowerCase();
        "input" === c && Kb.test(a.type) ? b.checked = a.checked : ("input" === c || "textarea" === c) && (b.defaultValue = a.defaultValue)
    }

    function s(a, b) {
        if (b in a)return b;
        for (var c = b.charAt(0).toUpperCase() + b.slice(1), d = b, e = _b.length; e--;)if (b = _b[e] + c, b in a)return b;
        return d
    }

    function t(a, b) {
        return a = b || a, "none" === fb.css(a, "display") || !fb.contains(a.ownerDocument, a)
    }

    function u(b) {
        return a.getComputedStyle(b, null)
    }

    function v(a, b) {
        for (var c, d, e, f = [], g = 0, h = a.length; h > g; g++)d = a[g], d.style && (f[g] = qb.get(d, "olddisplay"), c = d.style.display, b ? (f[g] || "none" !== c || (d.style.display = ""), "" === d.style.display && t(d) && (f[g] = qb.access(d, "olddisplay", z(d.nodeName)))) : f[g] || (e = t(d), (c && "none" !== c || !e) && qb.set(d, "olddisplay", e ? c : fb.css(d, "display"))));
        for (g = 0; h > g; g++)d = a[g], d.style && (b && "none" !== d.style.display && "" !== d.style.display || (d.style.display = b ? f[g] || "" : "none"));
        return a
    }

    function w(a, b, c) {
        var d = Ub.exec(b);
        return d ? Math.max(0, d[1] - (c || 0)) + (d[2] || "px") : b
    }

    function x(a, b, c, d, e) {
        for (var f = c === (d ? "border" : "content") ? 4 : "width" === b ? 1 : 0, g = 0; 4 > f; f += 2)"margin" === c && (g += fb.css(a, c + $b[f], !0, e)), d ? ("content" === c && (g -= fb.css(a, "padding" + $b[f], !0, e)), "margin" !== c && (g -= fb.css(a, "border" + $b[f] + "Width", !0, e))) : (g += fb.css(a, "padding" + $b[f], !0, e), "padding" !== c && (g += fb.css(a, "border" + $b[f] + "Width", !0, e)));
        return g
    }

    function y(a, b, c) {
        var d = !0, e = "width" === b ? a.offsetWidth : a.offsetHeight, f = u(a), g = fb.support.boxSizing && "border-box" === fb.css(a, "boxSizing", !1, f);
        if (0 >= e || null == e) {
            if (e = Qb(a, b, f), (0 > e || null == e) && (e = a.style[b]), Vb.test(e))return e;
            d = g && (fb.support.boxSizingReliable || e === a.style[b]), e = parseFloat(e) || 0
        }
        return e + x(a, b, c || (g ? "border" : "content"), d, f) + "px"
    }

    function z(a) {
        var b = T, c = Xb[a];
        return c || (c = A(a, b), "none" !== c && c || (Rb = (Rb || fb("<iframe frameborder='0' width='0' height='0'/>").css("cssText", "display:block !important")).appendTo(b.documentElement), b = (Rb[0].contentWindow || Rb[0].contentDocument).document, b.write("<!doctype html><html><body>"), b.close(), c = A(a, b), Rb.detach()), Xb[a] = c), c
    }

    function A(a, b) {
        var c = fb(b.createElement(a)).appendTo(b.body), d = fb.css(c[0], "display");
        return c.remove(), d
    }

    function B(a, b, c, d) {
        var e;
        if (fb.isArray(b))fb.each(b, function (b, e) {
            c || bc.test(a) ? d(a, e) : B(a + "[" + ("object" == typeof e ? b : "") + "]", e, c, d)
        }); else if (c || "object" !== fb.type(b))d(a, b); else for (e in b)B(a + "[" + e + "]", b[e], c, d)
    }

    function C(a) {
        return function (b, c) {
            "string" != typeof b && (c = b, b = "*");
            var d, e = 0, f = b.toLowerCase().match(hb) || [];
            if (fb.isFunction(c))for (; d = f[e++];)"+" === d[0] ? (d = d.slice(1) || "*", (a[d] = a[d] || []).unshift(c)) : (a[d] = a[d] || []).push(c)
        }
    }

    function D(a, b, c, d) {
        function e(h) {
            var i;
            return f[h] = !0, fb.each(a[h] || [], function (a, h) {
                var j = h(b, c, d);
                return"string" != typeof j || g || f[j] ? g ? !(i = j) : void 0 : (b.dataTypes.unshift(j), e(j), !1)
            }), i
        }

        var f = {}, g = a === sc;
        return e(b.dataTypes[0]) || !f["*"] && e("*")
    }

    function E(a, c) {
        var d, e, f = fb.ajaxSettings.flatOptions || {};
        for (d in c)c[d] !== b && ((f[d] ? a : e || (e = {}))[d] = c[d]);
        return e && fb.extend(!0, a, e), a
    }

    function F(a, c, d) {
        for (var e, f, g, h, i = a.contents, j = a.dataTypes; "*" === j[0];)j.shift(), e === b && (e = a.mimeType || c.getResponseHeader("Content-Type"));
        if (e)for (f in i)if (i[f] && i[f].test(e)) {
            j.unshift(f);
            break
        }
        if (j[0]in d)g = j[0]; else {
            for (f in d) {
                if (!j[0] || a.converters[f + " " + j[0]]) {
                    g = f;
                    break
                }
                h || (h = f)
            }
            g = g || h
        }
        return g ? (g !== j[0] && j.unshift(g), d[g]) : void 0
    }

    function G(a, b, c, d) {
        var e, f, g, h, i, j = {}, k = a.dataTypes.slice();
        if (k[1])for (g in a.converters)j[g.toLowerCase()] = a.converters[g];
        for (f = k.shift(); f;)if (a.responseFields[f] && (c[a.responseFields[f]] = b), !i && d && a.dataFilter && (b = a.dataFilter(b, a.dataType)), i = f, f = k.shift())if ("*" === f)f = i; else if ("*" !== i && i !== f) {
            if (g = j[i + " " + f] || j["* " + f], !g)for (e in j)if (h = e.split(" "), h[1] === f && (g = j[i + " " + h[0]] || j["* " + h[0]])) {
                g === !0 ? g = j[e] : j[e] !== !0 && (f = h[0], k.unshift(h[1]));
                break
            }
            if (g !== !0)if (g && a["throws"])b = g(b); else try {
                b = g(b)
            } catch (l) {
                return{state: "parsererror", error: g ? l : "No conversion from " + i + " to " + f}
            }
        }
        return{state: "success", data: b}
    }

    function H() {
        return setTimeout(function () {
            Bc = b
        }), Bc = fb.now()
    }

    function I(a, b, c) {
        for (var d, e = (Hc[b] || []).concat(Hc["*"]), f = 0, g = e.length; g > f; f++)if (d = e[f].call(c, b, a))return d
    }

    function J(a, b, c) {
        var d, e, f = 0, g = Gc.length, h = fb.Deferred().always(function () {
            delete i.elem
        }), i = function () {
            if (e)return!1;
            for (var b = Bc || H(), c = Math.max(0, j.startTime + j.duration - b), d = c / j.duration || 0, f = 1 - d, g = 0, i = j.tweens.length; i > g; g++)j.tweens[g].run(f);
            return h.notifyWith(a, [j, f, c]), 1 > f && i ? c : (h.resolveWith(a, [j]), !1)
        }, j = h.promise({elem: a, props: fb.extend({}, b), opts: fb.extend(!0, {specialEasing: {}}, c), originalProperties: b, originalOptions: c, startTime: Bc || H(), duration: c.duration, tweens: [], createTween: function (b, c) {
            var d = fb.Tween(a, j.opts, b, c, j.opts.specialEasing[b] || j.opts.easing);
            return j.tweens.push(d), d
        }, stop: function (b) {
            var c = 0, d = b ? j.tweens.length : 0;
            if (e)return this;
            for (e = !0; d > c; c++)j.tweens[c].run(1);
            return b ? h.resolveWith(a, [j, b]) : h.rejectWith(a, [j, b]), this
        }}), k = j.props;
        for (K(k, j.opts.specialEasing); g > f; f++)if (d = Gc[f].call(j, a, k, j.opts))return d;
        return fb.map(k, I, j), fb.isFunction(j.opts.start) && j.opts.start.call(a, j), fb.fx.timer(fb.extend(i, {elem: a, anim: j, queue: j.opts.queue})), j.progress(j.opts.progress).done(j.opts.done, j.opts.complete).fail(j.opts.fail).always(j.opts.always)
    }

    function K(a, b) {
        var c, d, e, f, g;
        for (c in a)if (d = fb.camelCase(c), e = b[d], f = a[c], fb.isArray(f) && (e = f[1], f = a[c] = f[0]), c !== d && (a[d] = f, delete a[c]), g = fb.cssHooks[d], g && "expand"in g) {
            f = g.expand(f), delete a[d];
            for (c in f)c in a || (a[c] = f[c], b[c] = e)
        } else b[d] = e
    }

    function L(a, c, d) {
        var e, f, g, h, i, j, k = this, l = {}, m = a.style, n = a.nodeType && t(a), o = qb.get(a, "fxshow");
        d.queue || (i = fb._queueHooks(a, "fx"), null == i.unqueued && (i.unqueued = 0, j = i.empty.fire, i.empty.fire = function () {
            i.unqueued || j()
        }), i.unqueued++, k.always(function () {
            k.always(function () {
                i.unqueued--, fb.queue(a, "fx").length || i.empty.fire()
            })
        })), 1 === a.nodeType && ("height"in c || "width"in c) && (d.overflow = [m.overflow, m.overflowX, m.overflowY], "inline" === fb.css(a, "display") && "none" === fb.css(a, "float") && (m.display = "inline-block")), d.overflow && (m.overflow = "hidden", k.always(function () {
            m.overflow = d.overflow[0], m.overflowX = d.overflow[1], m.overflowY = d.overflow[2]
        }));
        for (e in c)if (f = c[e], Dc.exec(f)) {
            if (delete c[e], g = g || "toggle" === f, f === (n ? "hide" : "show")) {
                if ("show" !== f || !o || o[e] === b)continue;
                n = !0
            }
            l[e] = o && o[e] || fb.style(a, e)
        }
        if (!fb.isEmptyObject(l)) {
            o ? "hidden"in o && (n = o.hidden) : o = qb.access(a, "fxshow", {}), g && (o.hidden = !n), n ? fb(a).show() : k.done(function () {
                fb(a).hide()
            }), k.done(function () {
                var b;
                qb.remove(a, "fxshow");
                for (b in l)fb.style(a, b, l[b])
            });
            for (e in l)h = I(n ? o[e] : 0, e, k), e in o || (o[e] = h.start, n && (h.end = h.start, h.start = "width" === e || "height" === e ? 1 : 0))
        }
    }

    function M(a, b, c, d, e) {
        return new M.prototype.init(a, b, c, d, e)
    }

    function N(a, b) {
        var c, d = {height: a}, e = 0;
        for (b = b ? 1 : 0; 4 > e; e += 2 - b)c = $b[e], d["margin" + c] = d["padding" + c] = a;
        return b && (d.opacity = d.width = a), d
    }

    function O(a) {
        return fb.isWindow(a) ? a : 9 === a.nodeType && a.defaultView
    }

    var P, Q, R = typeof b, S = a.location, T = a.document, U = T.documentElement, V = a.jQuery, W = a.$, X = {}, Y = [], Z = "2.0.3", $ = Y.concat, _ = Y.push, ab = Y.slice, bb = Y.indexOf, cb = X.toString, db = X.hasOwnProperty, eb = Z.trim, fb = function (a, b) {
        return new fb.fn.init(a, b, P)
    }, gb = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source, hb = /\S+/g, ib = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/, jb = /^<(\w+)\s*\/?>(?:<\/\1>|)$/, kb = /^-ms-/, lb = /-([\da-z])/gi, mb = function (a, b) {
        return b.toUpperCase()
    }, nb = function () {
        T.removeEventListener("DOMContentLoaded", nb, !1), a.removeEventListener("load", nb, !1), fb.ready()
    };
    fb.fn = fb.prototype = {jquery: Z, constructor: fb, init: function (a, c, d) {
        var e, f;
        if (!a)return this;
        if ("string" == typeof a) {
            if (e = "<" === a.charAt(0) && ">" === a.charAt(a.length - 1) && a.length >= 3 ? [null, a, null] : ib.exec(a), !e || !e[1] && c)return!c || c.jquery ? (c || d).find(a) : this.constructor(c).find(a);
            if (e[1]) {
                if (c = c instanceof fb ? c[0] : c, fb.merge(this, fb.parseHTML(e[1], c && c.nodeType ? c.ownerDocument || c : T, !0)), jb.test(e[1]) && fb.isPlainObject(c))for (e in c)fb.isFunction(this[e]) ? this[e](c[e]) : this.attr(e, c[e]);
                return this
            }
            return f = T.getElementById(e[2]), f && f.parentNode && (this.length = 1, this[0] = f), this.context = T, this.selector = a, this
        }
        return a.nodeType ? (this.context = this[0] = a, this.length = 1, this) : fb.isFunction(a) ? d.ready(a) : (a.selector !== b && (this.selector = a.selector, this.context = a.context), fb.makeArray(a, this))
    }, selector: "", length: 0, toArray: function () {
        return ab.call(this)
    }, get: function (a) {
        return null == a ? this.toArray() : 0 > a ? this[this.length + a] : this[a]
    }, pushStack: function (a) {
        var b = fb.merge(this.constructor(), a);
        return b.prevObject = this, b.context = this.context, b
    }, each: function (a, b) {
        return fb.each(this, a, b)
    }, ready: function (a) {
        return fb.ready.promise().done(a), this
    }, slice: function () {
        return this.pushStack(ab.apply(this, arguments))
    }, first: function () {
        return this.eq(0)
    }, last: function () {
        return this.eq(-1)
    }, eq: function (a) {
        var b = this.length, c = +a + (0 > a ? b : 0);
        return this.pushStack(c >= 0 && b > c ? [this[c]] : [])
    }, map: function (a) {
        return this.pushStack(fb.map(this, function (b, c) {
            return a.call(b, c, b)
        }))
    }, end: function () {
        return this.prevObject || this.constructor(null)
    }, push: _, sort: [].sort, splice: [].splice}, fb.fn.init.prototype = fb.fn, fb.extend = fb.fn.extend = function () {
        var a, c, d, e, f, g, h = arguments[0] || {}, i = 1, j = arguments.length, k = !1;
        for ("boolean" == typeof h && (k = h, h = arguments[1] || {}, i = 2), "object" == typeof h || fb.isFunction(h) || (h = {}), j === i && (h = this, --i); j > i; i++)if (null != (a = arguments[i]))for (c in a)d = h[c], e = a[c], h !== e && (k && e && (fb.isPlainObject(e) || (f = fb.isArray(e))) ? (f ? (f = !1, g = d && fb.isArray(d) ? d : []) : g = d && fb.isPlainObject(d) ? d : {}, h[c] = fb.extend(k, g, e)) : e !== b && (h[c] = e));
        return h
    }, fb.extend({expando: "jQuery" + (Z + Math.random()).replace(/\D/g, ""), noConflict: function (b) {
        return a.$ === fb && (a.$ = W), b && a.jQuery === fb && (a.jQuery = V), fb
    }, isReady: !1, readyWait: 1, holdReady: function (a) {
        a ? fb.readyWait++ : fb.ready(!0)
    }, ready: function (a) {
        (a === !0 ? --fb.readyWait : fb.isReady) || (fb.isReady = !0, a !== !0 && --fb.readyWait > 0 || (Q.resolveWith(T, [fb]), fb.fn.trigger && fb(T).trigger("ready").off("ready")))
    }, isFunction: function (a) {
        return"function" === fb.type(a)
    }, isArray: Array.isArray, isWindow: function (a) {
        return null != a && a === a.window
    }, isNumeric: function (a) {
        return!isNaN(parseFloat(a)) && isFinite(a)
    }, type: function (a) {
        return null == a ? String(a) : "object" == typeof a || "function" == typeof a ? X[cb.call(a)] || "object" : typeof a
    }, isPlainObject: function (a) {
        if ("object" !== fb.type(a) || a.nodeType || fb.isWindow(a))return!1;
        try {
            if (a.constructor && !db.call(a.constructor.prototype, "isPrototypeOf"))return!1
        } catch (b) {
            return!1
        }
        return!0
    }, isEmptyObject: function (a) {
        var b;
        for (b in a)return!1;
        return!0
    }, error: function (a) {
        throw new Error(a)
    }, parseHTML: function (a, b, c) {
        if (!a || "string" != typeof a)return null;
        "boolean" == typeof b && (c = b, b = !1), b = b || T;
        var d = jb.exec(a), e = !c && [];
        return d ? [b.createElement(d[1])] : (d = fb.buildFragment([a], b, e), e && fb(e).remove(), fb.merge([], d.childNodes))
    }, parseJSON: JSON.parse, parseXML: function (a) {
        var c, d;
        if (!a || "string" != typeof a)return null;
        try {
            d = new DOMParser, c = d.parseFromString(a, "text/xml")
        } catch (e) {
            c = b
        }
        return(!c || c.getElementsByTagName("parsererror").length) && fb.error("Invalid XML: " + a), c
    }, noop: function () {
    }, globalEval: function (a) {
        var b, c = eval;
        a = fb.trim(a), a && (1 === a.indexOf("use strict") ? (b = T.createElement("script"), b.text = a, T.head.appendChild(b).parentNode.removeChild(b)) : c(a))
    }, camelCase: function (a) {
        return a.replace(kb, "ms-").replace(lb, mb)
    }, nodeName: function (a, b) {
        return a.nodeName && a.nodeName.toLowerCase() === b.toLowerCase()
    }, each: function (a, b, d) {
        var e, f = 0, g = a.length, h = c(a);
        if (d) {
            if (h)for (; g > f && (e = b.apply(a[f], d), e !== !1); f++); else for (f in a)if (e = b.apply(a[f], d), e === !1)break
        } else if (h)for (; g > f && (e = b.call(a[f], f, a[f]), e !== !1); f++); else for (f in a)if (e = b.call(a[f], f, a[f]), e === !1)break;
        return a
    }, trim: function (a) {
        return null == a ? "" : eb.call(a)
    }, makeArray: function (a, b) {
        var d = b || [];
        return null != a && (c(Object(a)) ? fb.merge(d, "string" == typeof a ? [a] : a) : _.call(d, a)), d
    }, inArray: function (a, b, c) {
        return null == b ? -1 : bb.call(b, a, c)
    }, merge: function (a, c) {
        var d = c.length, e = a.length, f = 0;
        if ("number" == typeof d)for (; d > f; f++)a[e++] = c[f]; else for (; c[f] !== b;)a[e++] = c[f++];
        return a.length = e, a
    }, grep: function (a, b, c) {
        var d, e = [], f = 0, g = a.length;
        for (c = !!c; g > f; f++)d = !!b(a[f], f), c !== d && e.push(a[f]);
        return e
    }, map: function (a, b, d) {
        var e, f = 0, g = a.length, h = c(a), i = [];
        if (h)for (; g > f; f++)e = b(a[f], f, d), null != e && (i[i.length] = e); else for (f in a)e = b(a[f], f, d), null != e && (i[i.length] = e);
        return $.apply([], i)
    }, guid: 1, proxy: function (a, c) {
        var d, e, f;
        return"string" == typeof c && (d = a[c], c = a, a = d), fb.isFunction(a) ? (e = ab.call(arguments, 2), f = function () {
            return a.apply(c || this, e.concat(ab.call(arguments)))
        }, f.guid = a.guid = a.guid || fb.guid++, f) : b
    }, access: function (a, c, d, e, f, g, h) {
        var i = 0, j = a.length, k = null == d;
        if ("object" === fb.type(d)) {
            f = !0;
            for (i in d)fb.access(a, c, i, d[i], !0, g, h)
        } else if (e !== b && (f = !0, fb.isFunction(e) || (h = !0), k && (h ? (c.call(a, e), c = null) : (k = c, c = function (a, b, c) {
            return k.call(fb(a), c)
        })), c))for (; j > i; i++)c(a[i], d, h ? e : e.call(a[i], i, c(a[i], d)));
        return f ? a : k ? c.call(a) : j ? c(a[0], d) : g
    }, now: Date.now, swap: function (a, b, c, d) {
        var e, f, g = {};
        for (f in b)g[f] = a.style[f], a.style[f] = b[f];
        e = c.apply(a, d || []);
        for (f in b)a.style[f] = g[f];
        return e
    }}), fb.ready.promise = function (b) {
        return Q || (Q = fb.Deferred(), "complete" === T.readyState ? setTimeout(fb.ready) : (T.addEventListener("DOMContentLoaded", nb, !1), a.addEventListener("load", nb, !1))), Q.promise(b)
    }, fb.each("Boolean Number String Function Array Date RegExp Object Error".split(" "), function (a, b) {
        X["[object " + b + "]"] = b.toLowerCase()
    }), P = fb(T), function (a, b) {
        function c(a, b, c, d) {
            var e, f, g, h, i, j, k, l, o, p;
            if ((b ? b.ownerDocument || b : O) !== G && F(b), b = b || G, c = c || [], !a || "string" != typeof a)return c;
            if (1 !== (h = b.nodeType) && 9 !== h)return[];
            if (I && !d) {
                if (e = tb.exec(a))if (g = e[1]) {
                    if (9 === h) {
                        if (f = b.getElementById(g), !f || !f.parentNode)return c;
                        if (f.id === g)return c.push(f), c
                    } else if (b.ownerDocument && (f = b.ownerDocument.getElementById(g)) && M(b, f) && f.id === g)return c.push(f), c
                } else {
                    if (e[2])return ab.apply(c, b.getElementsByTagName(a)), c;
                    if ((g = e[3]) && x.getElementsByClassName && b.getElementsByClassName)return ab.apply(c, b.getElementsByClassName(g)), c
                }
                if (x.qsa && (!J || !J.test(a))) {
                    if (l = k = N, o = b, p = 9 === h && a, 1 === h && "object" !== b.nodeName.toLowerCase()) {
                        for (j = m(a), (k = b.getAttribute("id")) ? l = k.replace(wb, "\\$&") : b.setAttribute("id", l), l = "[id='" + l + "'] ", i = j.length; i--;)j[i] = l + n(j[i]);
                        o = nb.test(a) && b.parentNode || b, p = j.join(",")
                    }
                    if (p)try {
                        return ab.apply(c, o.querySelectorAll(p)), c
                    } catch (q) {
                    } finally {
                        k || b.removeAttribute("id")
                    }
                }
            }
            return v(a.replace(kb, "$1"), b, c, d)
        }

        function d() {
            function a(c, d) {
                return b.push(c += " ") > z.cacheLength && delete a[b.shift()], a[c] = d
            }

            var b = [];
            return a
        }

        function e(a) {
            return a[N] = !0, a
        }

        function f(a) {
            var b = G.createElement("div");
            try {
                return!!a(b)
            } catch (c) {
                return!1
            } finally {
                b.parentNode && b.parentNode.removeChild(b), b = null
            }
        }

        function g(a, b) {
            for (var c = a.split("|"), d = a.length; d--;)z.attrHandle[c[d]] = b
        }

        function h(a, b) {
            var c = b && a, d = c && 1 === a.nodeType && 1 === b.nodeType && (~b.sourceIndex || X) - (~a.sourceIndex || X);
            if (d)return d;
            if (c)for (; c = c.nextSibling;)if (c === b)return-1;
            return a ? 1 : -1
        }

        function i(a) {
            return function (b) {
                var c = b.nodeName.toLowerCase();
                return"input" === c && b.type === a
            }
        }

        function j(a) {
            return function (b) {
                var c = b.nodeName.toLowerCase();
                return("input" === c || "button" === c) && b.type === a
            }
        }

        function k(a) {
            return e(function (b) {
                return b = +b, e(function (c, d) {
                    for (var e, f = a([], c.length, b), g = f.length; g--;)c[e = f[g]] && (c[e] = !(d[e] = c[e]))
                })
            })
        }

        function l() {
        }

        function m(a, b) {
            var d, e, f, g, h, i, j, k = S[a + " "];
            if (k)return b ? 0 : k.slice(0);
            for (h = a, i = [], j = z.preFilter; h;) {
                (!d || (e = lb.exec(h))) && (e && (h = h.slice(e[0].length) || h), i.push(f = [])), d = !1, (e = mb.exec(h)) && (d = e.shift(), f.push({value: d, type: e[0].replace(kb, " ")}), h = h.slice(d.length));
                for (g in z.filter)!(e = rb[g].exec(h)) || j[g] && !(e = j[g](e)) || (d = e.shift(), f.push({value: d, type: g, matches: e}), h = h.slice(d.length));
                if (!d)break
            }
            return b ? h.length : h ? c.error(a) : S(a, i).slice(0)
        }

        function n(a) {
            for (var b = 0, c = a.length, d = ""; c > b; b++)d += a[b].value;
            return d
        }

        function o(a, b, c) {
            var d = b.dir, e = c && "parentNode" === d, f = Q++;
            return b.first ? function (b, c, f) {
                for (; b = b[d];)if (1 === b.nodeType || e)return a(b, c, f)
            } : function (b, c, g) {
                var h, i, j, k = P + " " + f;
                if (g) {
                    for (; b = b[d];)if ((1 === b.nodeType || e) && a(b, c, g))return!0
                } else for (; b = b[d];)if (1 === b.nodeType || e)if (j = b[N] || (b[N] = {}), (i = j[d]) && i[0] === k) {
                    if ((h = i[1]) === !0 || h === y)return h === !0
                } else if (i = j[d] = [k], i[1] = a(b, c, g) || y, i[1] === !0)return!0
            }
        }

        function p(a) {
            return a.length > 1 ? function (b, c, d) {
                for (var e = a.length; e--;)if (!a[e](b, c, d))return!1;
                return!0
            } : a[0]
        }

        function q(a, b, c, d, e) {
            for (var f, g = [], h = 0, i = a.length, j = null != b; i > h; h++)(f = a[h]) && (!c || c(f, d, e)) && (g.push(f), j && b.push(h));
            return g
        }

        function r(a, b, c, d, f, g) {
            return d && !d[N] && (d = r(d)), f && !f[N] && (f = r(f, g)), e(function (e, g, h, i) {
                var j, k, l, m = [], n = [], o = g.length, p = e || u(b || "*", h.nodeType ? [h] : h, []), r = !a || !e && b ? p : q(p, m, a, h, i), s = c ? f || (e ? a : o || d) ? [] : g : r;
                if (c && c(r, s, h, i), d)for (j = q(s, n), d(j, [], h, i), k = j.length; k--;)(l = j[k]) && (s[n[k]] = !(r[n[k]] = l));
                if (e) {
                    if (f || a) {
                        if (f) {
                            for (j = [], k = s.length; k--;)(l = s[k]) && j.push(r[k] = l);
                            f(null, s = [], j, i)
                        }
                        for (k = s.length; k--;)(l = s[k]) && (j = f ? cb.call(e, l) : m[k]) > -1 && (e[j] = !(g[j] = l))
                    }
                } else s = q(s === g ? s.splice(o, s.length) : s), f ? f(null, g, s, i) : ab.apply(g, s)
            })
        }

        function s(a) {
            for (var b, c, d, e = a.length, f = z.relative[a[0].type], g = f || z.relative[" "], h = f ? 1 : 0, i = o(function (a) {
                return a === b
            }, g, !0), j = o(function (a) {
                return cb.call(b, a) > -1
            }, g, !0), k = [function (a, c, d) {
                return!f && (d || c !== D) || ((b = c).nodeType ? i(a, c, d) : j(a, c, d))
            }]; e > h; h++)if (c = z.relative[a[h].type])k = [o(p(k), c)]; else {
                if (c = z.filter[a[h].type].apply(null, a[h].matches), c[N]) {
                    for (d = ++h; e > d && !z.relative[a[d].type]; d++);
                    return r(h > 1 && p(k), h > 1 && n(a.slice(0, h - 1).concat({value: " " === a[h - 2].type ? "*" : ""})).replace(kb, "$1"), c, d > h && s(a.slice(h, d)), e > d && s(a = a.slice(d)), e > d && n(a))
                }
                k.push(c)
            }
            return p(k)
        }

        function t(a, b) {
            var d = 0, f = b.length > 0, g = a.length > 0, h = function (e, h, i, j, k) {
                var l, m, n, o = [], p = 0, r = "0", s = e && [], t = null != k, u = D, v = e || g && z.find.TAG("*", k && h.parentNode || h), w = P += null == u ? 1 : Math.random() || .1;
                for (t && (D = h !== G && h, y = d); null != (l = v[r]); r++) {
                    if (g && l) {
                        for (m = 0; n = a[m++];)if (n(l, h, i)) {
                            j.push(l);
                            break
                        }
                        t && (P = w, y = ++d)
                    }
                    f && ((l = !n && l) && p--, e && s.push(l))
                }
                if (p += r, f && r !== p) {
                    for (m = 0; n = b[m++];)n(s, o, h, i);
                    if (e) {
                        if (p > 0)for (; r--;)s[r] || o[r] || (o[r] = $.call(j));
                        o = q(o)
                    }
                    ab.apply(j, o), t && !e && o.length > 0 && p + b.length > 1 && c.uniqueSort(j)
                }
                return t && (P = w, D = u), s
            };
            return f ? e(h) : h
        }

        function u(a, b, d) {
            for (var e = 0, f = b.length; f > e; e++)c(a, b[e], d);
            return d
        }

        function v(a, b, c, d) {
            var e, f, g, h, i, j = m(a);
            if (!d && 1 === j.length) {
                if (f = j[0] = j[0].slice(0), f.length > 2 && "ID" === (g = f[0]).type && x.getById && 9 === b.nodeType && I && z.relative[f[1].type]) {
                    if (b = (z.find.ID(g.matches[0].replace(xb, yb), b) || [])[0], !b)return c;
                    a = a.slice(f.shift().value.length)
                }
                for (e = rb.needsContext.test(a) ? 0 : f.length; e-- && (g = f[e], !z.relative[h = g.type]);)if ((i = z.find[h]) && (d = i(g.matches[0].replace(xb, yb), nb.test(f[0].type) && b.parentNode || b))) {
                    if (f.splice(e, 1), a = d.length && n(f), !a)return ab.apply(c, d), c;
                    break
                }
            }
            return C(a, j)(d, b, !I, c, nb.test(a)), c
        }

        var w, x, y, z, A, B, C, D, E, F, G, H, I, J, K, L, M, N = "sizzle" + -new Date, O = a.document, P = 0, Q = 0, R = d(), S = d(), T = d(), U = !1, V = function (a, b) {
            return a === b ? (U = !0, 0) : 0
        }, W = typeof b, X = 1 << 31, Y = {}.hasOwnProperty, Z = [], $ = Z.pop, _ = Z.push, ab = Z.push, bb = Z.slice, cb = Z.indexOf || function (a) {
            for (var b = 0, c = this.length; c > b; b++)if (this[b] === a)return b;
            return-1
        }, db = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped", eb = "[\\x20\\t\\r\\n\\f]", gb = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+", hb = gb.replace("w", "w#"), ib = "\\[" + eb + "*(" + gb + ")" + eb + "*(?:([*^$|!~]?=)" + eb + "*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|(" + hb + ")|)|)" + eb + "*\\]", jb = ":(" + gb + ")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|" + ib.replace(3, 8) + ")*)|.*)\\)|)", kb = new RegExp("^" + eb + "+|((?:^|[^\\\\])(?:\\\\.)*)" + eb + "+$", "g"), lb = new RegExp("^" + eb + "*," + eb + "*"), mb = new RegExp("^" + eb + "*([>+~]|" + eb + ")" + eb + "*"), nb = new RegExp(eb + "*[+~]"), ob = new RegExp("=" + eb + "*([^\\]'\"]*)" + eb + "*\\]", "g"), pb = new RegExp(jb), qb = new RegExp("^" + hb + "$"), rb = {ID: new RegExp("^#(" + gb + ")"), CLASS: new RegExp("^\\.(" + gb + ")"), TAG: new RegExp("^(" + gb.replace("w", "w*") + ")"), ATTR: new RegExp("^" + ib), PSEUDO: new RegExp("^" + jb), CHILD: new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + eb + "*(even|odd|(([+-]|)(\\d*)n|)" + eb + "*(?:([+-]|)" + eb + "*(\\d+)|))" + eb + "*\\)|)", "i"), bool: new RegExp("^(?:" + db + ")$", "i"), needsContext: new RegExp("^" + eb + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + eb + "*((?:-\\d)?\\d*)" + eb + "*\\)|)(?=[^-]|$)", "i")}, sb = /^[^{]+\{\s*\[native \w/, tb = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/, ub = /^(?:input|select|textarea|button)$/i, vb = /^h\d$/i, wb = /'|\\/g, xb = new RegExp("\\\\([\\da-f]{1,6}" + eb + "?|(" + eb + ")|.)", "ig"), yb = function (a, b, c) {
            var d = "0x" + b - 65536;
            return d !== d || c ? b : 0 > d ? String.fromCharCode(d + 65536) : String.fromCharCode(d >> 10 | 55296, 1023 & d | 56320)
        };
        try {
            ab.apply(Z = bb.call(O.childNodes), O.childNodes), Z[O.childNodes.length].nodeType
        } catch (zb) {
            ab = {apply: Z.length ? function (a, b) {
                _.apply(a, bb.call(b))
            } : function (a, b) {
                for (var c = a.length, d = 0; a[c++] = b[d++];);
                a.length = c - 1
            }}
        }
        B = c.isXML = function (a) {
            var b = a && (a.ownerDocument || a).documentElement;
            return b ? "HTML" !== b.nodeName : !1
        }, x = c.support = {}, F = c.setDocument = function (a) {
            var b = a ? a.ownerDocument || a : O, c = b.defaultView;
            return b !== G && 9 === b.nodeType && b.documentElement ? (G = b, H = b.documentElement, I = !B(b), c && c.attachEvent && c !== c.top && c.attachEvent("onbeforeunload", function () {
                F()
            }), x.attributes = f(function (a) {
                return a.className = "i", !a.getAttribute("className")
            }), x.getElementsByTagName = f(function (a) {
                return a.appendChild(b.createComment("")), !a.getElementsByTagName("*").length
            }), x.getElementsByClassName = f(function (a) {
                return a.innerHTML = "<div class='a'></div><div class='a i'></div>", a.firstChild.className = "i", 2 === a.getElementsByClassName("i").length
            }), x.getById = f(function (a) {
                return H.appendChild(a).id = N, !b.getElementsByName || !b.getElementsByName(N).length
            }), x.getById ? (z.find.ID = function (a, b) {
                if (typeof b.getElementById !== W && I) {
                    var c = b.getElementById(a);
                    return c && c.parentNode ? [c] : []
                }
            }, z.filter.ID = function (a) {
                var b = a.replace(xb, yb);
                return function (a) {
                    return a.getAttribute("id") === b
                }
            }) : (delete z.find.ID, z.filter.ID = function (a) {
                var b = a.replace(xb, yb);
                return function (a) {
                    var c = typeof a.getAttributeNode !== W && a.getAttributeNode("id");
                    return c && c.value === b
                }
            }), z.find.TAG = x.getElementsByTagName ? function (a, b) {
                return typeof b.getElementsByTagName !== W ? b.getElementsByTagName(a) : void 0
            } : function (a, b) {
                var c, d = [], e = 0, f = b.getElementsByTagName(a);
                if ("*" === a) {
                    for (; c = f[e++];)1 === c.nodeType && d.push(c);
                    return d
                }
                return f
            }, z.find.CLASS = x.getElementsByClassName && function (a, b) {
                return typeof b.getElementsByClassName !== W && I ? b.getElementsByClassName(a) : void 0
            }, K = [], J = [], (x.qsa = sb.test(b.querySelectorAll)) && (f(function (a) {
                a.innerHTML = "<select><option selected=''></option></select>", a.querySelectorAll("[selected]").length || J.push("\\[" + eb + "*(?:value|" + db + ")"), a.querySelectorAll(":checked").length || J.push(":checked")
            }), f(function (a) {
                var c = b.createElement("input");
                c.setAttribute("type", "hidden"), a.appendChild(c).setAttribute("t", ""), a.querySelectorAll("[t^='']").length && J.push("[*^$]=" + eb + "*(?:''|\"\")"), a.querySelectorAll(":enabled").length || J.push(":enabled", ":disabled"), a.querySelectorAll("*,:x"), J.push(",.*:")
            })), (x.matchesSelector = sb.test(L = H.webkitMatchesSelector || H.mozMatchesSelector || H.oMatchesSelector || H.msMatchesSelector)) && f(function (a) {
                x.disconnectedMatch = L.call(a, "div"), L.call(a, "[s!='']:x"), K.push("!=", jb)
            }), J = J.length && new RegExp(J.join("|")), K = K.length && new RegExp(K.join("|")), M = sb.test(H.contains) || H.compareDocumentPosition ? function (a, b) {
                var c = 9 === a.nodeType ? a.documentElement : a, d = b && b.parentNode;
                return a === d || !(!d || 1 !== d.nodeType || !(c.contains ? c.contains(d) : a.compareDocumentPosition && 16 & a.compareDocumentPosition(d)))
            } : function (a, b) {
                if (b)for (; b = b.parentNode;)if (b === a)return!0;
                return!1
            }, V = H.compareDocumentPosition ? function (a, c) {
                if (a === c)return U = !0, 0;
                var d = c.compareDocumentPosition && a.compareDocumentPosition && a.compareDocumentPosition(c);
                return d ? 1 & d || !x.sortDetached && c.compareDocumentPosition(a) === d ? a === b || M(O, a) ? -1 : c === b || M(O, c) ? 1 : E ? cb.call(E, a) - cb.call(E, c) : 0 : 4 & d ? -1 : 1 : a.compareDocumentPosition ? -1 : 1
            } : function (a, c) {
                var d, e = 0, f = a.parentNode, g = c.parentNode, i = [a], j = [c];
                if (a === c)return U = !0, 0;
                if (!f || !g)return a === b ? -1 : c === b ? 1 : f ? -1 : g ? 1 : E ? cb.call(E, a) - cb.call(E, c) : 0;
                if (f === g)return h(a, c);
                for (d = a; d = d.parentNode;)i.unshift(d);
                for (d = c; d = d.parentNode;)j.unshift(d);
                for (; i[e] === j[e];)e++;
                return e ? h(i[e], j[e]) : i[e] === O ? -1 : j[e] === O ? 1 : 0
            }, b) : G
        }, c.matches = function (a, b) {
            return c(a, null, null, b)
        }, c.matchesSelector = function (a, b) {
            if ((a.ownerDocument || a) !== G && F(a), b = b.replace(ob, "='$1']"), !(!x.matchesSelector || !I || K && K.test(b) || J && J.test(b)))try {
                var d = L.call(a, b);
                if (d || x.disconnectedMatch || a.document && 11 !== a.document.nodeType)return d
            } catch (e) {
            }
            return c(b, G, null, [a]).length > 0
        }, c.contains = function (a, b) {
            return(a.ownerDocument || a) !== G && F(a), M(a, b)
        }, c.attr = function (a, c) {
            (a.ownerDocument || a) !== G && F(a);
            var d = z.attrHandle[c.toLowerCase()], e = d && Y.call(z.attrHandle, c.toLowerCase()) ? d(a, c, !I) : b;
            return e === b ? x.attributes || !I ? a.getAttribute(c) : (e = a.getAttributeNode(c)) && e.specified ? e.value : null : e
        }, c.error = function (a) {
            throw new Error("Syntax error, unrecognized expression: " + a)
        }, c.uniqueSort = function (a) {
            var b, c = [], d = 0, e = 0;
            if (U = !x.detectDuplicates, E = !x.sortStable && a.slice(0), a.sort(V), U) {
                for (; b = a[e++];)b === a[e] && (d = c.push(e));
                for (; d--;)a.splice(c[d], 1)
            }
            return a
        }, A = c.getText = function (a) {
            var b, c = "", d = 0, e = a.nodeType;
            if (e) {
                if (1 === e || 9 === e || 11 === e) {
                    if ("string" == typeof a.textContent)return a.textContent;
                    for (a = a.firstChild; a; a = a.nextSibling)c += A(a)
                } else if (3 === e || 4 === e)return a.nodeValue
            } else for (; b = a[d]; d++)c += A(b);
            return c
        }, z = c.selectors = {cacheLength: 50, createPseudo: e, match: rb, attrHandle: {}, find: {}, relative: {">": {dir: "parentNode", first: !0}, " ": {dir: "parentNode"}, "+": {dir: "previousSibling", first: !0}, "~": {dir: "previousSibling"}}, preFilter: {ATTR: function (a) {
            return a[1] = a[1].replace(xb, yb), a[3] = (a[4] || a[5] || "").replace(xb, yb), "~=" === a[2] && (a[3] = " " + a[3] + " "), a.slice(0, 4)
        }, CHILD: function (a) {
            return a[1] = a[1].toLowerCase(), "nth" === a[1].slice(0, 3) ? (a[3] || c.error(a[0]), a[4] = +(a[4] ? a[5] + (a[6] || 1) : 2 * ("even" === a[3] || "odd" === a[3])), a[5] = +(a[7] + a[8] || "odd" === a[3])) : a[3] && c.error(a[0]), a
        }, PSEUDO: function (a) {
            var c, d = !a[5] && a[2];
            return rb.CHILD.test(a[0]) ? null : (a[3] && a[4] !== b ? a[2] = a[4] : d && pb.test(d) && (c = m(d, !0)) && (c = d.indexOf(")", d.length - c) - d.length) && (a[0] = a[0].slice(0, c), a[2] = d.slice(0, c)), a.slice(0, 3))
        }}, filter: {TAG: function (a) {
            var b = a.replace(xb, yb).toLowerCase();
            return"*" === a ? function () {
                return!0
            } : function (a) {
                return a.nodeName && a.nodeName.toLowerCase() === b
            }
        }, CLASS: function (a) {
            var b = R[a + " "];
            return b || (b = new RegExp("(^|" + eb + ")" + a + "(" + eb + "|$)")) && R(a, function (a) {
                return b.test("string" == typeof a.className && a.className || typeof a.getAttribute !== W && a.getAttribute("class") || "")
            })
        }, ATTR: function (a, b, d) {
            return function (e) {
                var f = c.attr(e, a);
                return null == f ? "!=" === b : b ? (f += "", "=" === b ? f === d : "!=" === b ? f !== d : "^=" === b ? d && 0 === f.indexOf(d) : "*=" === b ? d && f.indexOf(d) > -1 : "$=" === b ? d && f.slice(-d.length) === d : "~=" === b ? (" " + f + " ").indexOf(d) > -1 : "|=" === b ? f === d || f.slice(0, d.length + 1) === d + "-" : !1) : !0
            }
        }, CHILD: function (a, b, c, d, e) {
            var f = "nth" !== a.slice(0, 3), g = "last" !== a.slice(-4), h = "of-type" === b;
            return 1 === d && 0 === e ? function (a) {
                return!!a.parentNode
            } : function (b, c, i) {
                var j, k, l, m, n, o, p = f !== g ? "nextSibling" : "previousSibling", q = b.parentNode, r = h && b.nodeName.toLowerCase(), s = !i && !h;
                if (q) {
                    if (f) {
                        for (; p;) {
                            for (l = b; l = l[p];)if (h ? l.nodeName.toLowerCase() === r : 1 === l.nodeType)return!1;
                            o = p = "only" === a && !o && "nextSibling"
                        }
                        return!0
                    }
                    if (o = [g ? q.firstChild : q.lastChild], g && s) {
                        for (k = q[N] || (q[N] = {}), j = k[a] || [], n = j[0] === P && j[1], m = j[0] === P && j[2], l = n && q.childNodes[n]; l = ++n && l && l[p] || (m = n = 0) || o.pop();)if (1 === l.nodeType && ++m && l === b) {
                            k[a] = [P, n, m];
                            break
                        }
                    } else if (s && (j = (b[N] || (b[N] = {}))[a]) && j[0] === P)m = j[1]; else for (; (l = ++n && l && l[p] || (m = n = 0) || o.pop()) && ((h ? l.nodeName.toLowerCase() !== r : 1 !== l.nodeType) || !++m || (s && ((l[N] || (l[N] = {}))[a] = [P, m]), l !== b)););
                    return m -= e, m === d || m % d === 0 && m / d >= 0
                }
            }
        }, PSEUDO: function (a, b) {
            var d, f = z.pseudos[a] || z.setFilters[a.toLowerCase()] || c.error("unsupported pseudo: " + a);
            return f[N] ? f(b) : f.length > 1 ? (d = [a, a, "", b], z.setFilters.hasOwnProperty(a.toLowerCase()) ? e(function (a, c) {
                for (var d, e = f(a, b), g = e.length; g--;)d = cb.call(a, e[g]), a[d] = !(c[d] = e[g])
            }) : function (a) {
                return f(a, 0, d)
            }) : f
        }}, pseudos: {not: e(function (a) {
            var b = [], c = [], d = C(a.replace(kb, "$1"));
            return d[N] ? e(function (a, b, c, e) {
                for (var f, g = d(a, null, e, []), h = a.length; h--;)(f = g[h]) && (a[h] = !(b[h] = f))
            }) : function (a, e, f) {
                return b[0] = a, d(b, null, f, c), !c.pop()
            }
        }), has: e(function (a) {
            return function (b) {
                return c(a, b).length > 0
            }
        }), contains: e(function (a) {
            return function (b) {
                return(b.textContent || b.innerText || A(b)).indexOf(a) > -1
            }
        }), lang: e(function (a) {
            return qb.test(a || "") || c.error("unsupported lang: " + a), a = a.replace(xb, yb).toLowerCase(), function (b) {
                var c;
                do if (c = I ? b.lang : b.getAttribute("xml:lang") || b.getAttribute("lang"))return c = c.toLowerCase(), c === a || 0 === c.indexOf(a + "-"); while ((b = b.parentNode) && 1 === b.nodeType);
                return!1
            }
        }), target: function (b) {
            var c = a.location && a.location.hash;
            return c && c.slice(1) === b.id
        }, root: function (a) {
            return a === H
        }, focus: function (a) {
            return a === G.activeElement && (!G.hasFocus || G.hasFocus()) && !!(a.type || a.href || ~a.tabIndex)
        }, enabled: function (a) {
            return a.disabled === !1
        }, disabled: function (a) {
            return a.disabled === !0
        }, checked: function (a) {
            var b = a.nodeName.toLowerCase();
            return"input" === b && !!a.checked || "option" === b && !!a.selected
        }, selected: function (a) {
            return a.parentNode && a.parentNode.selectedIndex, a.selected === !0
        }, empty: function (a) {
            for (a = a.firstChild; a; a = a.nextSibling)if (a.nodeName > "@" || 3 === a.nodeType || 4 === a.nodeType)return!1;
            return!0
        }, parent: function (a) {
            return!z.pseudos.empty(a)
        }, header: function (a) {
            return vb.test(a.nodeName)
        }, input: function (a) {
            return ub.test(a.nodeName)
        }, button: function (a) {
            var b = a.nodeName.toLowerCase();
            return"input" === b && "button" === a.type || "button" === b
        }, text: function (a) {
            var b;
            return"input" === a.nodeName.toLowerCase() && "text" === a.type && (null == (b = a.getAttribute("type")) || b.toLowerCase() === a.type)
        }, first: k(function () {
            return[0]
        }), last: k(function (a, b) {
            return[b - 1]
        }), eq: k(function (a, b, c) {
            return[0 > c ? c + b : c]
        }), even: k(function (a, b) {
            for (var c = 0; b > c; c += 2)a.push(c);
            return a
        }), odd: k(function (a, b) {
            for (var c = 1; b > c; c += 2)a.push(c);
            return a
        }), lt: k(function (a, b, c) {
            for (var d = 0 > c ? c + b : c; --d >= 0;)a.push(d);
            return a
        }), gt: k(function (a, b, c) {
            for (var d = 0 > c ? c + b : c; ++d < b;)a.push(d);
            return a
        })}}, z.pseudos.nth = z.pseudos.eq;
        for (w in{radio: !0, checkbox: !0, file: !0, password: !0, image: !0})z.pseudos[w] = i(w);
        for (w in{submit: !0, reset: !0})z.pseudos[w] = j(w);
        l.prototype = z.filters = z.pseudos, z.setFilters = new l, C = c.compile = function (a, b) {
            var c, d = [], e = [], f = T[a + " "];
            if (!f) {
                for (b || (b = m(a)), c = b.length; c--;)f = s(b[c]), f[N] ? d.push(f) : e.push(f);
                f = T(a, t(e, d))
            }
            return f
        }, x.sortStable = N.split("").sort(V).join("") === N, x.detectDuplicates = U, F(), x.sortDetached = f(function (a) {
            return 1 & a.compareDocumentPosition(G.createElement("div"))
        }), f(function (a) {
            return a.innerHTML = "<a href='#'></a>", "#" === a.firstChild.getAttribute("href")
        }) || g("type|href|height|width", function (a, b, c) {
            return c ? void 0 : a.getAttribute(b, "type" === b.toLowerCase() ? 1 : 2)
        }), x.attributes && f(function (a) {
            return a.innerHTML = "<input/>", a.firstChild.setAttribute("value", ""), "" === a.firstChild.getAttribute("value")
        }) || g("value", function (a, b, c) {
            return c || "input" !== a.nodeName.toLowerCase() ? void 0 : a.defaultValue
        }), f(function (a) {
            return null == a.getAttribute("disabled")
        }) || g(db, function (a, b, c) {
            var d;
            return c ? void 0 : (d = a.getAttributeNode(b)) && d.specified ? d.value : a[b] === !0 ? b.toLowerCase() : null
        }), fb.find = c, fb.expr = c.selectors, fb.expr[":"] = fb.expr.pseudos, fb.unique = c.uniqueSort, fb.text = c.getText, fb.isXMLDoc = c.isXML, fb.contains = c.contains
    }(a);
    var ob = {};
    fb.Callbacks = function (a) {
        a = "string" == typeof a ? ob[a] || d(a) : fb.extend({}, a);
        var c, e, f, g, h, i, j = [], k = !a.once && [], l = function (b) {
            for (c = a.memory && b, e = !0, i = g || 0, g = 0, h = j.length, f = !0; j && h > i; i++)if (j[i].apply(b[0], b[1]) === !1 && a.stopOnFalse) {
                c = !1;
                break
            }
            f = !1, j && (k ? k.length && l(k.shift()) : c ? j = [] : m.disable())
        }, m = {add: function () {
            if (j) {
                var b = j.length;
                !function d(b) {
                    fb.each(b, function (b, c) {
                        var e = fb.type(c);
                        "function" === e ? a.unique && m.has(c) || j.push(c) : c && c.length && "string" !== e && d(c)
                    })
                }(arguments), f ? h = j.length : c && (g = b, l(c))
            }
            return this
        }, remove: function () {
            return j && fb.each(arguments, function (a, b) {
                for (var c; (c = fb.inArray(b, j, c)) > -1;)j.splice(c, 1), f && (h >= c && h--, i >= c && i--)
            }), this
        }, has: function (a) {
            return a ? fb.inArray(a, j) > -1 : !(!j || !j.length)
        }, empty: function () {
            return j = [], h = 0, this
        }, disable: function () {
            return j = k = c = b, this
        }, disabled: function () {
            return!j
        }, lock: function () {
            return k = b, c || m.disable(), this
        }, locked: function () {
            return!k
        }, fireWith: function (a, b) {
            return!j || e && !k || (b = b || [], b = [a, b.slice ? b.slice() : b], f ? k.push(b) : l(b)), this
        }, fire: function () {
            return m.fireWith(this, arguments), this
        }, fired: function () {
            return!!e
        }};
        return m
    }, fb.extend({Deferred: function (a) {
        var b = [
            ["resolve", "done", fb.Callbacks("once memory"), "resolved"],
            ["reject", "fail", fb.Callbacks("once memory"), "rejected"],
            ["notify", "progress", fb.Callbacks("memory")]
        ], c = "pending", d = {state: function () {
            return c
        }, always: function () {
            return e.done(arguments).fail(arguments), this
        }, then: function () {
            var a = arguments;
            return fb.Deferred(function (c) {
                fb.each(b, function (b, f) {
                    var g = f[0], h = fb.isFunction(a[b]) && a[b];
                    e[f[1]](function () {
                        var a = h && h.apply(this, arguments);
                        a && fb.isFunction(a.promise) ? a.promise().done(c.resolve).fail(c.reject).progress(c.notify) : c[g + "With"](this === d ? c.promise() : this, h ? [a] : arguments)
                    })
                }), a = null
            }).promise()
        }, promise: function (a) {
            return null != a ? fb.extend(a, d) : d
        }}, e = {};
        return d.pipe = d.then, fb.each(b, function (a, f) {
            var g = f[2], h = f[3];
            d[f[1]] = g.add, h && g.add(function () {
                c = h
            }, b[1 ^ a][2].disable, b[2][2].lock), e[f[0]] = function () {
                return e[f[0] + "With"](this === e ? d : this, arguments), this
            }, e[f[0] + "With"] = g.fireWith
        }), d.promise(e), a && a.call(e, e), e
    }, when: function (a) {
        var b, c, d, e = 0, f = ab.call(arguments), g = f.length, h = 1 !== g || a && fb.isFunction(a.promise) ? g : 0, i = 1 === h ? a : fb.Deferred(), j = function (a, c, d) {
            return function (e) {
                c[a] = this, d[a] = arguments.length > 1 ? ab.call(arguments) : e, d === b ? i.notifyWith(c, d) : --h || i.resolveWith(c, d)
            }
        };
        if (g > 1)for (b = new Array(g), c = new Array(g), d = new Array(g); g > e; e++)f[e] && fb.isFunction(f[e].promise) ? f[e].promise().done(j(e, d, f)).fail(i.reject).progress(j(e, c, b)) : --h;
        return h || i.resolveWith(d, f), i.promise()
    }}), fb.support = function (b) {
        var c = T.createElement("input"), d = T.createDocumentFragment(), e = T.createElement("div"), f = T.createElement("select"), g = f.appendChild(T.createElement("option"));
        return c.type ? (c.type = "checkbox", b.checkOn = "" !== c.value, b.optSelected = g.selected, b.reliableMarginRight = !0, b.boxSizingReliable = !0, b.pixelPosition = !1, c.checked = !0, b.noCloneChecked = c.cloneNode(!0).checked, f.disabled = !0, b.optDisabled = !g.disabled, c = T.createElement("input"), c.value = "t", c.type = "radio", b.radioValue = "t" === c.value, c.setAttribute("checked", "t"), c.setAttribute("name", "t"), d.appendChild(c), b.checkClone = d.cloneNode(!0).cloneNode(!0).lastChild.checked, b.focusinBubbles = "onfocusin"in a, e.style.backgroundClip = "content-box", e.cloneNode(!0).style.backgroundClip = "", b.clearCloneStyle = "content-box" === e.style.backgroundClip, fb(function () {
            var c, d, f = "padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box", g = T.getElementsByTagName("body")[0];
            g && (c = T.createElement("div"), c.style.cssText = "border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px", g.appendChild(c).appendChild(e), e.innerHTML = "", e.style.cssText = "-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%", fb.swap(g, null != g.style.zoom ? {zoom: 1} : {}, function () {
                b.boxSizing = 4 === e.offsetWidth
            }), a.getComputedStyle && (b.pixelPosition = "1%" !== (a.getComputedStyle(e, null) || {}).top, b.boxSizingReliable = "4px" === (a.getComputedStyle(e, null) || {width: "4px"}).width, d = e.appendChild(T.createElement("div")), d.style.cssText = e.style.cssText = f, d.style.marginRight = d.style.width = "0", e.style.width = "1px", b.reliableMarginRight = !parseFloat((a.getComputedStyle(d, null) || {}).marginRight)), g.removeChild(c))
        }), b) : b
    }({});
    var pb, qb, rb = /(?:\{[\s\S]*\}|\[[\s\S]*\])$/, sb = /([A-Z])/g;
    e.uid = 1, e.accepts = function (a) {
        return a.nodeType ? 1 === a.nodeType || 9 === a.nodeType : !0
    }, e.prototype = {key: function (a) {
        if (!e.accepts(a))return 0;
        var b = {}, c = a[this.expando];
        if (!c) {
            c = e.uid++;
            try {
                b[this.expando] = {value: c}, Object.defineProperties(a, b)
            } catch (d) {
                b[this.expando] = c, fb.extend(a, b)
            }
        }
        return this.cache[c] || (this.cache[c] = {}), c
    }, set: function (a, b, c) {
        var d, e = this.key(a), f = this.cache[e];
        if ("string" == typeof b)f[b] = c; else if (fb.isEmptyObject(f))fb.extend(this.cache[e], b); else for (d in b)f[d] = b[d];
        return f
    }, get: function (a, c) {
        var d = this.cache[this.key(a)];
        return c === b ? d : d[c]
    }, access: function (a, c, d) {
        var e;
        return c === b || c && "string" == typeof c && d === b ? (e = this.get(a, c), e !== b ? e : this.get(a, fb.camelCase(c))) : (this.set(a, c, d), d !== b ? d : c)
    }, remove: function (a, c) {
        var d, e, f, g = this.key(a), h = this.cache[g];
        if (c === b)this.cache[g] = {}; else {
            fb.isArray(c) ? e = c.concat(c.map(fb.camelCase)) : (f = fb.camelCase(c), c in h ? e = [c, f] : (e = f, e = e in h ? [e] : e.match(hb) || [])), d = e.length;
            for (; d--;)delete h[e[d]]
        }
    }, hasData: function (a) {
        return!fb.isEmptyObject(this.cache[a[this.expando]] || {})
    }, discard: function (a) {
        a[this.expando] && delete this.cache[a[this.expando]]
    }}, pb = new e, qb = new e, fb.extend({acceptData: e.accepts, hasData: function (a) {
        return pb.hasData(a) || qb.hasData(a)
    }, data: function (a, b, c) {
        return pb.access(a, b, c)
    }, removeData: function (a, b) {
        pb.remove(a, b)
    }, _data: function (a, b, c) {
        return qb.access(a, b, c)
    }, _removeData: function (a, b) {
        qb.remove(a, b)
    }}), fb.fn.extend({data: function (a, c) {
        var d, e, g = this[0], h = 0, i = null;
        if (a === b) {
            if (this.length && (i = pb.get(g), 1 === g.nodeType && !qb.get(g, "hasDataAttrs"))) {
                for (d = g.attributes; h < d.length; h++)e = d[h].name, 0 === e.indexOf("data-") && (e = fb.camelCase(e.slice(5)), f(g, e, i[e]));
                qb.set(g, "hasDataAttrs", !0)
            }
            return i
        }
        return"object" == typeof a ? this.each(function () {
            pb.set(this, a)
        }) : fb.access(this, function (c) {
            var d, e = fb.camelCase(a);
            if (g && c === b) {
                if (d = pb.get(g, a), d !== b)return d;
                if (d = pb.get(g, e), d !== b)return d;
                if (d = f(g, e, b), d !== b)return d
            } else this.each(function () {
                var d = pb.get(this, e);
                pb.set(this, e, c), -1 !== a.indexOf("-") && d !== b && pb.set(this, a, c)
            })
        }, null, c, arguments.length > 1, null, !0)
    }, removeData: function (a) {
        return this.each(function () {
            pb.remove(this, a)
        })
    }}), fb.extend({queue: function (a, b, c) {
        var d;
        return a ? (b = (b || "fx") + "queue", d = qb.get(a, b), c && (!d || fb.isArray(c) ? d = qb.access(a, b, fb.makeArray(c)) : d.push(c)), d || []) : void 0
    }, dequeue: function (a, b) {
        b = b || "fx";
        var c = fb.queue(a, b), d = c.length, e = c.shift(), f = fb._queueHooks(a, b), g = function () {
            fb.dequeue(a, b)
        };
        "inprogress" === e && (e = c.shift(), d--), e && ("fx" === b && c.unshift("inprogress"), delete f.stop, e.call(a, g, f)), !d && f && f.empty.fire()
    }, _queueHooks: function (a, b) {
        var c = b + "queueHooks";
        return qb.get(a, c) || qb.access(a, c, {empty: fb.Callbacks("once memory").add(function () {
            qb.remove(a, [b + "queue", c])
        })})
    }}), fb.fn.extend({queue: function (a, c) {
        var d = 2;
        return"string" != typeof a && (c = a, a = "fx", d--), arguments.length < d ? fb.queue(this[0], a) : c === b ? this : this.each(function () {
            var b = fb.queue(this, a, c);
            fb._queueHooks(this, a), "fx" === a && "inprogress" !== b[0] && fb.dequeue(this, a)
        })
    }, dequeue: function (a) {
        return this.each(function () {
            fb.dequeue(this, a)
        })
    }, delay: function (a, b) {
        return a = fb.fx ? fb.fx.speeds[a] || a : a, b = b || "fx", this.queue(b, function (b, c) {
            var d = setTimeout(b, a);
            c.stop = function () {
                clearTimeout(d)
            }
        })
    }, clearQueue: function (a) {
        return this.queue(a || "fx", [])
    }, promise: function (a, c) {
        var d, e = 1, f = fb.Deferred(), g = this, h = this.length, i = function () {
            --e || f.resolveWith(g, [g])
        };
        for ("string" != typeof a && (c = a, a = b), a = a || "fx"; h--;)d = qb.get(g[h], a + "queueHooks"), d && d.empty && (e++, d.empty.add(i));
        return i(), f.promise(c)
    }});
    var tb, ub, vb = /[\t\r\n\f]/g, wb = /\r/g, xb = /^(?:input|select|textarea|button)$/i;
    fb.fn.extend({attr: function (a, b) {
        return fb.access(this, fb.attr, a, b, arguments.length > 1)
    }, removeAttr: function (a) {
        return this.each(function () {
            fb.removeAttr(this, a)
        })
    }, prop: function (a, b) {
        return fb.access(this, fb.prop, a, b, arguments.length > 1)
    }, removeProp: function (a) {
        return this.each(function () {
            delete this[fb.propFix[a] || a]
        })
    }, addClass: function (a) {
        var b, c, d, e, f, g = 0, h = this.length, i = "string" == typeof a && a;
        if (fb.isFunction(a))return this.each(function (b) {
            fb(this).addClass(a.call(this, b, this.className))
        });
        if (i)for (b = (a || "").match(hb) || []; h > g; g++)if (c = this[g], d = 1 === c.nodeType && (c.className ? (" " + c.className + " ").replace(vb, " ") : " ")) {
            for (f = 0; e = b[f++];)d.indexOf(" " + e + " ") < 0 && (d += e + " ");
            c.className = fb.trim(d)
        }
        return this
    }, removeClass: function (a) {
        var b, c, d, e, f, g = 0, h = this.length, i = 0 === arguments.length || "string" == typeof a && a;
        if (fb.isFunction(a))return this.each(function (b) {
            fb(this).removeClass(a.call(this, b, this.className))
        });
        if (i)for (b = (a || "").match(hb) || []; h > g; g++)if (c = this[g], d = 1 === c.nodeType && (c.className ? (" " + c.className + " ").replace(vb, " ") : "")) {
            for (f = 0; e = b[f++];)for (; d.indexOf(" " + e + " ") >= 0;)d = d.replace(" " + e + " ", " ");
            c.className = a ? fb.trim(d) : ""
        }
        return this
    }, toggleClass: function (a, b) {
        var c = typeof a;
        return"boolean" == typeof b && "string" === c ? b ? this.addClass(a) : this.removeClass(a) : this.each(fb.isFunction(a) ? function (c) {
            fb(this).toggleClass(a.call(this, c, this.className, b), b)
        } : function () {
            if ("string" === c)for (var b, d = 0, e = fb(this), f = a.match(hb) || []; b = f[d++];)e.hasClass(b) ? e.removeClass(b) : e.addClass(b); else(c === R || "boolean" === c) && (this.className && qb.set(this, "__className__", this.className), this.className = this.className || a === !1 ? "" : qb.get(this, "__className__") || "")
        })
    }, hasClass: function (a) {
        for (var b = " " + a + " ", c = 0, d = this.length; d > c; c++)if (1 === this[c].nodeType && (" " + this[c].className + " ").replace(vb, " ").indexOf(b) >= 0)return!0;
        return!1
    }, val: function (a) {
        var c, d, e, f = this[0];
        {
            if (arguments.length)return e = fb.isFunction(a), this.each(function (d) {
                var f;
                1 === this.nodeType && (f = e ? a.call(this, d, fb(this).val()) : a, null == f ? f = "" : "number" == typeof f ? f += "" : fb.isArray(f) && (f = fb.map(f, function (a) {
                    return null == a ? "" : a + ""
                })), c = fb.valHooks[this.type] || fb.valHooks[this.nodeName.toLowerCase()], c && "set"in c && c.set(this, f, "value") !== b || (this.value = f))
            });
            if (f)return c = fb.valHooks[f.type] || fb.valHooks[f.nodeName.toLowerCase()], c && "get"in c && (d = c.get(f, "value")) !== b ? d : (d = f.value, "string" == typeof d ? d.replace(wb, "") : null == d ? "" : d)
        }
    }}), fb.extend({valHooks: {option: {get: function (a) {
        var b = a.attributes.value;
        return!b || b.specified ? a.value : a.text
    }}, select: {get: function (a) {
        for (var b, c, d = a.options, e = a.selectedIndex, f = "select-one" === a.type || 0 > e, g = f ? null : [], h = f ? e + 1 : d.length, i = 0 > e ? h : f ? e : 0; h > i; i++)if (c = d[i], !(!c.selected && i !== e || (fb.support.optDisabled ? c.disabled : null !== c.getAttribute("disabled")) || c.parentNode.disabled && fb.nodeName(c.parentNode, "optgroup"))) {
            if (b = fb(c).val(), f)return b;
            g.push(b)
        }
        return g
    }, set: function (a, b) {
        for (var c, d, e = a.options, f = fb.makeArray(b), g = e.length; g--;)d = e[g], (d.selected = fb.inArray(fb(d).val(), f) >= 0) && (c = !0);
        return c || (a.selectedIndex = -1), f
    }}}, attr: function (a, c, d) {
        var e, f, g = a.nodeType;
        if (a && 3 !== g && 8 !== g && 2 !== g)return typeof a.getAttribute === R ? fb.prop(a, c, d) : (1 === g && fb.isXMLDoc(a) || (c = c.toLowerCase(), e = fb.attrHooks[c] || (fb.expr.match.bool.test(c) ? ub : tb)), d === b ? e && "get"in e && null !== (f = e.get(a, c)) ? f : (f = fb.find.attr(a, c), null == f ? b : f) : null !== d ? e && "set"in e && (f = e.set(a, d, c)) !== b ? f : (a.setAttribute(c, d + ""), d) : void fb.removeAttr(a, c))
    }, removeAttr: function (a, b) {
        var c, d, e = 0, f = b && b.match(hb);
        if (f && 1 === a.nodeType)for (; c = f[e++];)d = fb.propFix[c] || c, fb.expr.match.bool.test(c) && (a[d] = !1), a.removeAttribute(c)
    }, attrHooks: {type: {set: function (a, b) {
        if (!fb.support.radioValue && "radio" === b && fb.nodeName(a, "input")) {
            var c = a.value;
            return a.setAttribute("type", b), c && (a.value = c), b
        }
    }}}, propFix: {"for": "htmlFor", "class": "className"}, prop: function (a, c, d) {
        var e, f, g, h = a.nodeType;
        if (a && 3 !== h && 8 !== h && 2 !== h)return g = 1 !== h || !fb.isXMLDoc(a), g && (c = fb.propFix[c] || c, f = fb.propHooks[c]), d !== b ? f && "set"in f && (e = f.set(a, d, c)) !== b ? e : a[c] = d : f && "get"in f && null !== (e = f.get(a, c)) ? e : a[c]
    }, propHooks: {tabIndex: {get: function (a) {
        return a.hasAttribute("tabindex") || xb.test(a.nodeName) || a.href ? a.tabIndex : -1
    }}}}), ub = {set: function (a, b, c) {
        return b === !1 ? fb.removeAttr(a, c) : a.setAttribute(c, c), c
    }}, fb.each(fb.expr.match.bool.source.match(/\w+/g), function (a, c) {
        var d = fb.expr.attrHandle[c] || fb.find.attr;
        fb.expr.attrHandle[c] = function (a, c, e) {
            var f = fb.expr.attrHandle[c], g = e ? b : (fb.expr.attrHandle[c] = b) != d(a, c, e) ? c.toLowerCase() : null;
            return fb.expr.attrHandle[c] = f, g
        }
    }), fb.support.optSelected || (fb.propHooks.selected = {get: function (a) {
        var b = a.parentNode;
        return b && b.parentNode && b.parentNode.selectedIndex, null
    }}), fb.each(["tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable"], function () {
        fb.propFix[this.toLowerCase()] = this
    }), fb.each(["radio", "checkbox"], function () {
        fb.valHooks[this] = {set: function (a, b) {
            return fb.isArray(b) ? a.checked = fb.inArray(fb(a).val(), b) >= 0 : void 0
        }}, fb.support.checkOn || (fb.valHooks[this].get = function (a) {
            return null === a.getAttribute("value") ? "on" : a.value
        })
    });
    var yb = /^key/, zb = /^(?:mouse|contextmenu)|click/, Ab = /^(?:focusinfocus|focusoutblur)$/, Bb = /^([^.]*)(?:\.(.+)|)$/;
    fb.event = {global: {}, add: function (a, c, d, e, f) {
        var g, h, i, j, k, l, m, n, o, p, q, r = qb.get(a);
        if (r) {
            for (d.handler && (g = d, d = g.handler, f = g.selector), d.guid || (d.guid = fb.guid++), (j = r.events) || (j = r.events = {}), (h = r.handle) || (h = r.handle = function (a) {
                return typeof fb === R || a && fb.event.triggered === a.type ? b : fb.event.dispatch.apply(h.elem, arguments)
            }, h.elem = a), c = (c || "").match(hb) || [""], k = c.length; k--;)i = Bb.exec(c[k]) || [], o = q = i[1], p = (i[2] || "").split(".").sort(), o && (m = fb.event.special[o] || {}, o = (f ? m.delegateType : m.bindType) || o, m = fb.event.special[o] || {}, l = fb.extend({type: o, origType: q, data: e, handler: d, guid: d.guid, selector: f, needsContext: f && fb.expr.match.needsContext.test(f), namespace: p.join(".")}, g), (n = j[o]) || (n = j[o] = [], n.delegateCount = 0, m.setup && m.setup.call(a, e, p, h) !== !1 || a.addEventListener && a.addEventListener(o, h, !1)), m.add && (m.add.call(a, l), l.handler.guid || (l.handler.guid = d.guid)), f ? n.splice(n.delegateCount++, 0, l) : n.push(l), fb.event.global[o] = !0);
            a = null
        }
    }, remove: function (a, b, c, d, e) {
        var f, g, h, i, j, k, l, m, n, o, p, q = qb.hasData(a) && qb.get(a);
        if (q && (i = q.events)) {
            for (b = (b || "").match(hb) || [""], j = b.length; j--;)if (h = Bb.exec(b[j]) || [], n = p = h[1], o = (h[2] || "").split(".").sort(), n) {
                for (l = fb.event.special[n] || {}, n = (d ? l.delegateType : l.bindType) || n, m = i[n] || [], h = h[2] && new RegExp("(^|\\.)" + o.join("\\.(?:.*\\.|)") + "(\\.|$)"), g = f = m.length; f--;)k = m[f], !e && p !== k.origType || c && c.guid !== k.guid || h && !h.test(k.namespace) || d && d !== k.selector && ("**" !== d || !k.selector) || (m.splice(f, 1), k.selector && m.delegateCount--, l.remove && l.remove.call(a, k));
                g && !m.length && (l.teardown && l.teardown.call(a, o, q.handle) !== !1 || fb.removeEvent(a, n, q.handle), delete i[n])
            } else for (n in i)fb.event.remove(a, n + b[j], c, d, !0);
            fb.isEmptyObject(i) && (delete q.handle, qb.remove(a, "events"))
        }
    }, trigger: function (c, d, e, f) {
        var g, h, i, j, k, l, m, n = [e || T], o = db.call(c, "type") ? c.type : c, p = db.call(c, "namespace") ? c.namespace.split(".") : [];
        if (h = i = e = e || T, 3 !== e.nodeType && 8 !== e.nodeType && !Ab.test(o + fb.event.triggered) && (o.indexOf(".") >= 0 && (p = o.split("."), o = p.shift(), p.sort()), k = o.indexOf(":") < 0 && "on" + o, c = c[fb.expando] ? c : new fb.Event(o, "object" == typeof c && c), c.isTrigger = f ? 2 : 3, c.namespace = p.join("."), c.namespace_re = c.namespace ? new RegExp("(^|\\.)" + p.join("\\.(?:.*\\.|)") + "(\\.|$)") : null, c.result = b, c.target || (c.target = e), d = null == d ? [c] : fb.makeArray(d, [c]), m = fb.event.special[o] || {}, f || !m.trigger || m.trigger.apply(e, d) !== !1)) {
            if (!f && !m.noBubble && !fb.isWindow(e)) {
                for (j = m.delegateType || o, Ab.test(j + o) || (h = h.parentNode); h; h = h.parentNode)n.push(h), i = h;
                i === (e.ownerDocument || T) && n.push(i.defaultView || i.parentWindow || a)
            }
            for (g = 0; (h = n[g++]) && !c.isPropagationStopped();)c.type = g > 1 ? j : m.bindType || o, l = (qb.get(h, "events") || {})[c.type] && qb.get(h, "handle"), l && l.apply(h, d), l = k && h[k], l && fb.acceptData(h) && l.apply && l.apply(h, d) === !1 && c.preventDefault();
            return c.type = o, f || c.isDefaultPrevented() || m._default && m._default.apply(n.pop(), d) !== !1 || !fb.acceptData(e) || k && fb.isFunction(e[o]) && !fb.isWindow(e) && (i = e[k], i && (e[k] = null), fb.event.triggered = o, e[o](), fb.event.triggered = b, i && (e[k] = i)), c.result
        }
    }, dispatch: function (a) {
        a = fb.event.fix(a);
        var c, d, e, f, g, h = [], i = ab.call(arguments), j = (qb.get(this, "events") || {})[a.type] || [], k = fb.event.special[a.type] || {};
        if (i[0] = a, a.delegateTarget = this, !k.preDispatch || k.preDispatch.call(this, a) !== !1) {
            for (h = fb.event.handlers.call(this, a, j), c = 0; (f = h[c++]) && !a.isPropagationStopped();)for (a.currentTarget = f.elem, d = 0; (g = f.handlers[d++]) && !a.isImmediatePropagationStopped();)(!a.namespace_re || a.namespace_re.test(g.namespace)) && (a.handleObj = g, a.data = g.data, e = ((fb.event.special[g.origType] || {}).handle || g.handler).apply(f.elem, i), e !== b && (a.result = e) === !1 && (a.preventDefault(), a.stopPropagation()));
            return k.postDispatch && k.postDispatch.call(this, a), a.result
        }
    }, handlers: function (a, c) {
        var d, e, f, g, h = [], i = c.delegateCount, j = a.target;
        if (i && j.nodeType && (!a.button || "click" !== a.type))for (; j !== this; j = j.parentNode || this)if (j.disabled !== !0 || "click" !== a.type) {
            for (e = [], d = 0; i > d; d++)g = c[d], f = g.selector + " ", e[f] === b && (e[f] = g.needsContext ? fb(f, this).index(j) >= 0 : fb.find(f, this, null, [j]).length), e[f] && e.push(g);
            e.length && h.push({elem: j, handlers: e})
        }
        return i < c.length && h.push({elem: this, handlers: c.slice(i)}), h
    }, props: "altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "), fixHooks: {}, keyHooks: {props: "char charCode key keyCode".split(" "), filter: function (a, b) {
        return null == a.which && (a.which = null != b.charCode ? b.charCode : b.keyCode), a
    }}, mouseHooks: {props: "button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "), filter: function (a, c) {
        var d, e, f, g = c.button;
        return null == a.pageX && null != c.clientX && (d = a.target.ownerDocument || T, e = d.documentElement, f = d.body, a.pageX = c.clientX + (e && e.scrollLeft || f && f.scrollLeft || 0) - (e && e.clientLeft || f && f.clientLeft || 0), a.pageY = c.clientY + (e && e.scrollTop || f && f.scrollTop || 0) - (e && e.clientTop || f && f.clientTop || 0)), a.which || g === b || (a.which = 1 & g ? 1 : 2 & g ? 3 : 4 & g ? 2 : 0), a
    }}, fix: function (a) {
        if (a[fb.expando])return a;
        var b, c, d, e = a.type, f = a, g = this.fixHooks[e];
        for (g || (this.fixHooks[e] = g = zb.test(e) ? this.mouseHooks : yb.test(e) ? this.keyHooks : {}), d = g.props ? this.props.concat(g.props) : this.props, a = new fb.Event(f), b = d.length; b--;)c = d[b], a[c] = f[c];
        return a.target || (a.target = T), 3 === a.target.nodeType && (a.target = a.target.parentNode), g.filter ? g.filter(a, f) : a
    }, special: {load: {noBubble: !0}, focus: {trigger: function () {
        return this !== i() && this.focus ? (this.focus(), !1) : void 0
    }, delegateType: "focusin"}, blur: {trigger: function () {
        return this === i() && this.blur ? (this.blur(), !1) : void 0
    }, delegateType: "focusout"}, click: {trigger: function () {
        return"checkbox" === this.type && this.click && fb.nodeName(this, "input") ? (this.click(), !1) : void 0
    }, _default: function (a) {
        return fb.nodeName(a.target, "a")
    }}, beforeunload: {postDispatch: function (a) {
        a.result !== b && (a.originalEvent.returnValue = a.result)
    }}}, simulate: function (a, b, c, d) {
        var e = fb.extend(new fb.Event, c, {type: a, isSimulated: !0, originalEvent: {}});
        d ? fb.event.trigger(e, null, b) : fb.event.dispatch.call(b, e), e.isDefaultPrevented() && c.preventDefault()
    }}, fb.removeEvent = function (a, b, c) {
        a.removeEventListener && a.removeEventListener(b, c, !1)
    }, fb.Event = function (a, b) {
        return this instanceof fb.Event ? (a && a.type ? (this.originalEvent = a, this.type = a.type, this.isDefaultPrevented = a.defaultPrevented || a.getPreventDefault && a.getPreventDefault() ? g : h) : this.type = a, b && fb.extend(this, b), this.timeStamp = a && a.timeStamp || fb.now(), void(this[fb.expando] = !0)) : new fb.Event(a, b)
    }, fb.Event.prototype = {isDefaultPrevented: h, isPropagationStopped: h, isImmediatePropagationStopped: h, preventDefault: function () {
        var a = this.originalEvent;
        this.isDefaultPrevented = g, a && a.preventDefault && a.preventDefault()
    }, stopPropagation: function () {
        var a = this.originalEvent;
        this.isPropagationStopped = g, a && a.stopPropagation && a.stopPropagation()
    }, stopImmediatePropagation: function () {
        this.isImmediatePropagationStopped = g, this.stopPropagation()
    }}, fb.each({mouseenter: "mouseover", mouseleave: "mouseout"}, function (a, b) {
        fb.event.special[a] = {delegateType: b, bindType: b, handle: function (a) {
            var c, d = this, e = a.relatedTarget, f = a.handleObj;
            return(!e || e !== d && !fb.contains(d, e)) && (a.type = f.origType, c = f.handler.apply(this, arguments), a.type = b), c
        }}
    }), fb.support.focusinBubbles || fb.each({focus: "focusin", blur: "focusout"}, function (a, b) {
        var c = 0, d = function (a) {
            fb.event.simulate(b, a.target, fb.event.fix(a), !0)
        };
        fb.event.special[b] = {setup: function () {
            0 === c++ && T.addEventListener(a, d, !0)
        }, teardown: function () {
            0 === --c && T.removeEventListener(a, d, !0)
        }}
    }), fb.fn.extend({on: function (a, c, d, e, f) {
        var g, i;
        if ("object" == typeof a) {
            "string" != typeof c && (d = d || c, c = b);
            for (i in a)this.on(i, c, d, a[i], f);
            return this
        }
        if (null == d && null == e ? (e = c, d = c = b) : null == e && ("string" == typeof c ? (e = d, d = b) : (e = d, d = c, c = b)), e === !1)e = h; else if (!e)return this;
        return 1 === f && (g = e, e = function (a) {
            return fb().off(a), g.apply(this, arguments)
        }, e.guid = g.guid || (g.guid = fb.guid++)), this.each(function () {
            fb.event.add(this, a, e, d, c)
        })
    }, one: function (a, b, c, d) {
        return this.on(a, b, c, d, 1)
    }, off: function (a, c, d) {
        var e, f;
        if (a && a.preventDefault && a.handleObj)return e = a.handleObj, fb(a.delegateTarget).off(e.namespace ? e.origType + "." + e.namespace : e.origType, e.selector, e.handler), this;
        if ("object" == typeof a) {
            for (f in a)this.off(f, c, a[f]);
            return this
        }
        return(c === !1 || "function" == typeof c) && (d = c, c = b), d === !1 && (d = h), this.each(function () {
            fb.event.remove(this, a, d, c)
        })
    }, trigger: function (a, b) {
        return this.each(function () {
            fb.event.trigger(a, b, this)
        })
    }, triggerHandler: function (a, b) {
        var c = this[0];
        return c ? fb.event.trigger(a, b, c, !0) : void 0
    }});
    var Cb = /^.[^:#\[\.,]*$/, Db = /^(?:parents|prev(?:Until|All))/, Eb = fb.expr.match.needsContext, Fb = {children: !0, contents: !0, next: !0, prev: !0};
    fb.fn.extend({find: function (a) {
        var b, c = [], d = this, e = d.length;
        if ("string" != typeof a)return this.pushStack(fb(a).filter(function () {
            for (b = 0; e > b; b++)if (fb.contains(d[b], this))return!0
        }));
        for (b = 0; e > b; b++)fb.find(a, d[b], c);
        return c = this.pushStack(e > 1 ? fb.unique(c) : c), c.selector = this.selector ? this.selector + " " + a : a, c
    }, has: function (a) {
        var b = fb(a, this), c = b.length;
        return this.filter(function () {
            for (var a = 0; c > a; a++)if (fb.contains(this, b[a]))return!0
        })
    }, not: function (a) {
        return this.pushStack(k(this, a || [], !0))
    }, filter: function (a) {
        return this.pushStack(k(this, a || [], !1))
    }, is: function (a) {
        return!!k(this, "string" == typeof a && Eb.test(a) ? fb(a) : a || [], !1).length
    }, closest: function (a, b) {
        for (var c, d = 0, e = this.length, f = [], g = Eb.test(a) || "string" != typeof a ? fb(a, b || this.context) : 0; e > d; d++)for (c = this[d]; c && c !== b; c = c.parentNode)if (c.nodeType < 11 && (g ? g.index(c) > -1 : 1 === c.nodeType && fb.find.matchesSelector(c, a))) {
            c = f.push(c);
            break
        }
        return this.pushStack(f.length > 1 ? fb.unique(f) : f)
    }, index: function (a) {
        return a ? "string" == typeof a ? bb.call(fb(a), this[0]) : bb.call(this, a.jquery ? a[0] : a) : this[0] && this[0].parentNode ? this.first().prevAll().length : -1
    }, add: function (a, b) {
        var c = "string" == typeof a ? fb(a, b) : fb.makeArray(a && a.nodeType ? [a] : a), d = fb.merge(this.get(), c);
        return this.pushStack(fb.unique(d))
    }, addBack: function (a) {
        return this.add(null == a ? this.prevObject : this.prevObject.filter(a))
    }}), fb.each({parent: function (a) {
        var b = a.parentNode;
        return b && 11 !== b.nodeType ? b : null
    }, parents: function (a) {
        return fb.dir(a, "parentNode")
    }, parentsUntil: function (a, b, c) {
        return fb.dir(a, "parentNode", c)
    }, next: function (a) {
        return j(a, "nextSibling")
    }, prev: function (a) {
        return j(a, "previousSibling")
    }, nextAll: function (a) {
        return fb.dir(a, "nextSibling")
    }, prevAll: function (a) {
        return fb.dir(a, "previousSibling")
    }, nextUntil: function (a, b, c) {
        return fb.dir(a, "nextSibling", c)
    }, prevUntil: function (a, b, c) {
        return fb.dir(a, "previousSibling", c)
    }, siblings: function (a) {
        return fb.sibling((a.parentNode || {}).firstChild, a)
    }, children: function (a) {
        return fb.sibling(a.firstChild)
    }, contents: function (a) {
        return a.contentDocument || fb.merge([], a.childNodes)
    }}, function (a, b) {
        fb.fn[a] = function (c, d) {
            var e = fb.map(this, b, c);
            return"Until" !== a.slice(-5) && (d = c), d && "string" == typeof d && (e = fb.filter(d, e)), this.length > 1 && (Fb[a] || fb.unique(e), Db.test(a) && e.reverse()), this.pushStack(e)
        }
    }), fb.extend({filter: function (a, b, c) {
        var d = b[0];
        return c && (a = ":not(" + a + ")"), 1 === b.length && 1 === d.nodeType ? fb.find.matchesSelector(d, a) ? [d] : [] : fb.find.matches(a, fb.grep(b, function (a) {
            return 1 === a.nodeType
        }))
    }, dir: function (a, c, d) {
        for (var e = [], f = d !== b; (a = a[c]) && 9 !== a.nodeType;)if (1 === a.nodeType) {
            if (f && fb(a).is(d))break;
            e.push(a)
        }
        return e
    }, sibling: function (a, b) {
        for (var c = []; a; a = a.nextSibling)1 === a.nodeType && a !== b && c.push(a);
        return c
    }});
    var Gb = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi, Hb = /<([\w:]+)/, Ib = /<|&#?\w+;/, Jb = /<(?:script|style|link)/i, Kb = /^(?:checkbox|radio)$/i, Lb = /checked\s*(?:[^=]|=\s*.checked.)/i, Mb = /^$|\/(?:java|ecma)script/i, Nb = /^true\/(.*)/, Ob = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g, Pb = {option: [1, "<select multiple='multiple'>", "</select>"], thead: [1, "<table>", "</table>"], col: [2, "<table><colgroup>", "</colgroup></table>"], tr: [2, "<table><tbody>", "</tbody></table>"], td: [3, "<table><tbody><tr>", "</tr></tbody></table>"], _default: [0, "", ""]};
    Pb.optgroup = Pb.option, Pb.tbody = Pb.tfoot = Pb.colgroup = Pb.caption = Pb.thead, Pb.th = Pb.td, fb.fn.extend({text: function (a) {
        return fb.access(this, function (a) {
            return a === b ? fb.text(this) : this.empty().append((this[0] && this[0].ownerDocument || T).createTextNode(a))
        }, null, a, arguments.length)
    }, append: function () {
        return this.domManip(arguments, function (a) {
            if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
                var b = l(this, a);
                b.appendChild(a)
            }
        })
    }, prepend: function () {
        return this.domManip(arguments, function (a) {
            if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
                var b = l(this, a);
                b.insertBefore(a, b.firstChild)
            }
        })
    }, before: function () {
        return this.domManip(arguments, function (a) {
            this.parentNode && this.parentNode.insertBefore(a, this)
        })
    }, after: function () {
        return this.domManip(arguments, function (a) {
            this.parentNode && this.parentNode.insertBefore(a, this.nextSibling)
        })
    }, remove: function (a, b) {
        for (var c, d = a ? fb.filter(a, this) : this, e = 0; null != (c = d[e]); e++)b || 1 !== c.nodeType || fb.cleanData(q(c)), c.parentNode && (b && fb.contains(c.ownerDocument, c) && o(q(c, "script")), c.parentNode.removeChild(c));
        return this
    }, empty: function () {
        for (var a, b = 0; null != (a = this[b]); b++)1 === a.nodeType && (fb.cleanData(q(a, !1)), a.textContent = "");
        return this
    }, clone: function (a, b) {
        return a = null == a ? !1 : a, b = null == b ? a : b, this.map(function () {
            return fb.clone(this, a, b)
        })
    }, html: function (a) {
        return fb.access(this, function (a) {
            var c = this[0] || {}, d = 0, e = this.length;
            if (a === b && 1 === c.nodeType)return c.innerHTML;
            if ("string" == typeof a && !Jb.test(a) && !Pb[(Hb.exec(a) || ["", ""])[1].toLowerCase()]) {
                a = a.replace(Gb, "<$1></$2>");
                try {
                    for (; e > d; d++)c = this[d] || {}, 1 === c.nodeType && (fb.cleanData(q(c, !1)), c.innerHTML = a);
                    c = 0
                } catch (f) {
                }
            }
            c && this.empty().append(a)
        }, null, a, arguments.length)
    }, replaceWith: function () {
        var a = fb.map(this, function (a) {
            return[a.nextSibling, a.parentNode]
        }), b = 0;
        return this.domManip(arguments, function (c) {
            var d = a[b++], e = a[b++];
            e && (d && d.parentNode !== e && (d = this.nextSibling), fb(this).remove(), e.insertBefore(c, d))
        }, !0), b ? this : this.remove()
    }, detach: function (a) {
        return this.remove(a, !0)
    }, domManip: function (a, b, c) {
        a = $.apply([], a);
        var d, e, f, g, h, i, j = 0, k = this.length, l = this, o = k - 1, p = a[0], r = fb.isFunction(p);
        if (r || !(1 >= k || "string" != typeof p || fb.support.checkClone) && Lb.test(p))return this.each(function (d) {
            var e = l.eq(d);
            r && (a[0] = p.call(this, d, e.html())), e.domManip(a, b, c)
        });
        if (k && (d = fb.buildFragment(a, this[0].ownerDocument, !1, !c && this), e = d.firstChild, 1 === d.childNodes.length && (d = e), e)) {
            for (f = fb.map(q(d, "script"), m), g = f.length; k > j; j++)h = d, j !== o && (h = fb.clone(h, !0, !0), g && fb.merge(f, q(h, "script"))), b.call(this[j], h, j);
            if (g)for (i = f[f.length - 1].ownerDocument, fb.map(f, n), j = 0; g > j; j++)h = f[j], Mb.test(h.type || "") && !qb.access(h, "globalEval") && fb.contains(i, h) && (h.src ? fb._evalUrl(h.src) : fb.globalEval(h.textContent.replace(Ob, "")))
        }
        return this
    }}), fb.each({appendTo: "append", prependTo: "prepend", insertBefore: "before", insertAfter: "after", replaceAll: "replaceWith"}, function (a, b) {
        fb.fn[a] = function (a) {
            for (var c, d = [], e = fb(a), f = e.length - 1, g = 0; f >= g; g++)c = g === f ? this : this.clone(!0), fb(e[g])[b](c), _.apply(d, c.get());
            return this.pushStack(d)
        }
    }), fb.extend({clone: function (a, b, c) {
        var d, e, f, g, h = a.cloneNode(!0), i = fb.contains(a.ownerDocument, a);
        if (!(fb.support.noCloneChecked || 1 !== a.nodeType && 11 !== a.nodeType || fb.isXMLDoc(a)))for (g = q(h), f = q(a), d = 0, e = f.length; e > d; d++)r(f[d], g[d]);
        if (b)if (c)for (f = f || q(a), g = g || q(h), d = 0, e = f.length; e > d; d++)p(f[d], g[d]); else p(a, h);
        return g = q(h, "script"), g.length > 0 && o(g, !i && q(a, "script")), h
    }, buildFragment: function (a, b, c, d) {
        for (var e, f, g, h, i, j, k = 0, l = a.length, m = b.createDocumentFragment(), n = []; l > k; k++)if (e = a[k], e || 0 === e)if ("object" === fb.type(e))fb.merge(n, e.nodeType ? [e] : e); else if (Ib.test(e)) {
            for (f = f || m.appendChild(b.createElement("div")), g = (Hb.exec(e) || ["", ""])[1].toLowerCase(), h = Pb[g] || Pb._default, f.innerHTML = h[1] + e.replace(Gb, "<$1></$2>") + h[2], j = h[0]; j--;)f = f.lastChild;
            fb.merge(n, f.childNodes), f = m.firstChild, f.textContent = ""
        } else n.push(b.createTextNode(e));
        for (m.textContent = "", k = 0; e = n[k++];)if ((!d || -1 === fb.inArray(e, d)) && (i = fb.contains(e.ownerDocument, e), f = q(m.appendChild(e), "script"), i && o(f), c))for (j = 0; e = f[j++];)Mb.test(e.type || "") && c.push(e);
        return m
    }, cleanData: function (a) {
        for (var c, d, f, g, h, i, j = fb.event.special, k = 0; (d = a[k]) !== b; k++) {
            if (e.accepts(d) && (h = d[qb.expando], h && (c = qb.cache[h]))) {
                if (f = Object.keys(c.events || {}), f.length)for (i = 0; (g = f[i]) !== b; i++)j[g] ? fb.event.remove(d, g) : fb.removeEvent(d, g, c.handle);
                qb.cache[h] && delete qb.cache[h]
            }
            delete pb.cache[d[pb.expando]]
        }
    }, _evalUrl: function (a) {
        return fb.ajax({url: a, type: "GET", dataType: "script", async: !1, global: !1, "throws": !0})
    }}), fb.fn.extend({wrapAll: function (a) {
        var b;
        return fb.isFunction(a) ? this.each(function (b) {
            fb(this).wrapAll(a.call(this, b))
        }) : (this[0] && (b = fb(a, this[0].ownerDocument).eq(0).clone(!0), this[0].parentNode && b.insertBefore(this[0]), b.map(function () {
            for (var a = this; a.firstElementChild;)a = a.firstElementChild;
            return a
        }).append(this)), this)
    }, wrapInner: function (a) {
        return this.each(fb.isFunction(a) ? function (b) {
            fb(this).wrapInner(a.call(this, b))
        } : function () {
            var b = fb(this), c = b.contents();
            c.length ? c.wrapAll(a) : b.append(a)
        })
    }, wrap: function (a) {
        var b = fb.isFunction(a);
        return this.each(function (c) {
            fb(this).wrapAll(b ? a.call(this, c) : a)
        })
    }, unwrap: function () {
        return this.parent().each(function () {
            fb.nodeName(this, "body") || fb(this).replaceWith(this.childNodes)
        }).end()
    }});
    var Qb, Rb, Sb = /^(none|table(?!-c[ea]).+)/, Tb = /^margin/, Ub = new RegExp("^(" + gb + ")(.*)$", "i"), Vb = new RegExp("^(" + gb + ")(?!px)[a-z%]+$", "i"), Wb = new RegExp("^([+-])=(" + gb + ")", "i"), Xb = {BODY: "block"}, Yb = {position: "absolute", visibility: "hidden", display: "block"}, Zb = {letterSpacing: 0, fontWeight: 400}, $b = ["Top", "Right", "Bottom", "Left"], _b = ["Webkit", "O", "Moz", "ms"];
    fb.fn.extend({css: function (a, c) {
        return fb.access(this, function (a, c, d) {
            var e, f, g = {}, h = 0;
            if (fb.isArray(c)) {
                for (e = u(a), f = c.length; f > h; h++)g[c[h]] = fb.css(a, c[h], !1, e);
                return g
            }
            return d !== b ? fb.style(a, c, d) : fb.css(a, c)
        }, a, c, arguments.length > 1)
    }, show: function () {
        return v(this, !0)
    }, hide: function () {
        return v(this)
    }, toggle: function (a) {
        return"boolean" == typeof a ? a ? this.show() : this.hide() : this.each(function () {
            t(this) ? fb(this).show() : fb(this).hide()
        })
    }}), fb.extend({cssHooks: {opacity: {get: function (a, b) {
        if (b) {
            var c = Qb(a, "opacity");
            return"" === c ? "1" : c
        }
    }}}, cssNumber: {columnCount: !0, fillOpacity: !0, fontWeight: !0, lineHeight: !0, opacity: !0, order: !0, orphans: !0, widows: !0, zIndex: !0, zoom: !0}, cssProps: {"float": "cssFloat"}, style: function (a, c, d, e) {
        if (a && 3 !== a.nodeType && 8 !== a.nodeType && a.style) {
            var f, g, h, i = fb.camelCase(c), j = a.style;
            return c = fb.cssProps[i] || (fb.cssProps[i] = s(j, i)), h = fb.cssHooks[c] || fb.cssHooks[i], d === b ? h && "get"in h && (f = h.get(a, !1, e)) !== b ? f : j[c] : (g = typeof d, "string" === g && (f = Wb.exec(d)) && (d = (f[1] + 1) * f[2] + parseFloat(fb.css(a, c)), g = "number"), null == d || "number" === g && isNaN(d) || ("number" !== g || fb.cssNumber[i] || (d += "px"), fb.support.clearCloneStyle || "" !== d || 0 !== c.indexOf("background") || (j[c] = "inherit"), h && "set"in h && (d = h.set(a, d, e)) === b || (j[c] = d)), void 0)
        }
    }, css: function (a, c, d, e) {
        var f, g, h, i = fb.camelCase(c);
        return c = fb.cssProps[i] || (fb.cssProps[i] = s(a.style, i)), h = fb.cssHooks[c] || fb.cssHooks[i], h && "get"in h && (f = h.get(a, !0, d)), f === b && (f = Qb(a, c, e)), "normal" === f && c in Zb && (f = Zb[c]), "" === d || d ? (g = parseFloat(f), d === !0 || fb.isNumeric(g) ? g || 0 : f) : f
    }}), Qb = function (a, c, d) {
        var e, f, g, h = d || u(a), i = h ? h.getPropertyValue(c) || h[c] : b, j = a.style;
        return h && ("" !== i || fb.contains(a.ownerDocument, a) || (i = fb.style(a, c)), Vb.test(i) && Tb.test(c) && (e = j.width, f = j.minWidth, g = j.maxWidth, j.minWidth = j.maxWidth = j.width = i, i = h.width, j.width = e, j.minWidth = f, j.maxWidth = g)), i
    }, fb.each(["height", "width"], function (a, b) {
        fb.cssHooks[b] = {get: function (a, c, d) {
            return c ? 0 === a.offsetWidth && Sb.test(fb.css(a, "display")) ? fb.swap(a, Yb, function () {
                return y(a, b, d)
            }) : y(a, b, d) : void 0
        }, set: function (a, c, d) {
            var e = d && u(a);
            return w(a, c, d ? x(a, b, d, fb.support.boxSizing && "border-box" === fb.css(a, "boxSizing", !1, e), e) : 0)
        }}
    }), fb(function () {
        fb.support.reliableMarginRight || (fb.cssHooks.marginRight = {get: function (a, b) {
            return b ? fb.swap(a, {display: "inline-block"}, Qb, [a, "marginRight"]) : void 0
        }}), !fb.support.pixelPosition && fb.fn.position && fb.each(["top", "left"], function (a, b) {
            fb.cssHooks[b] = {get: function (a, c) {
                return c ? (c = Qb(a, b), Vb.test(c) ? fb(a).position()[b] + "px" : c) : void 0
            }}
        })
    }), fb.expr && fb.expr.filters && (fb.expr.filters.hidden = function (a) {
        return a.offsetWidth <= 0 && a.offsetHeight <= 0
    }, fb.expr.filters.visible = function (a) {
        return!fb.expr.filters.hidden(a)
    }), fb.each({margin: "", padding: "", border: "Width"}, function (a, b) {
        fb.cssHooks[a + b] = {expand: function (c) {
            for (var d = 0, e = {}, f = "string" == typeof c ? c.split(" ") : [c]; 4 > d; d++)e[a + $b[d] + b] = f[d] || f[d - 2] || f[0];
            return e
        }}, Tb.test(a) || (fb.cssHooks[a + b].set = w)
    });
    var ac = /%20/g, bc = /\[\]$/, cc = /\r?\n/g, dc = /^(?:submit|button|image|reset|file)$/i, ec = /^(?:input|select|textarea|keygen)/i;
    fb.fn.extend({serialize: function () {
        return fb.param(this.serializeArray())
    }, serializeArray: function () {
        return this.map(function () {
            var a = fb.prop(this, "elements");
            return a ? fb.makeArray(a) : this
        }).filter(function () {
            var a = this.type;
            return this.name && !fb(this).is(":disabled") && ec.test(this.nodeName) && !dc.test(a) && (this.checked || !Kb.test(a))
        }).map(function (a, b) {
            var c = fb(this).val();
            return null == c ? null : fb.isArray(c) ? fb.map(c, function (a) {
                return{name: b.name, value: a.replace(cc, "\r\n")}
            }) : {name: b.name, value: c.replace(cc, "\r\n")}
        }).get()
    }}), fb.param = function (a, c) {
        var d, e = [], f = function (a, b) {
            b = fb.isFunction(b) ? b() : null == b ? "" : b, e[e.length] = encodeURIComponent(a) + "=" + encodeURIComponent(b)
        };
        if (c === b && (c = fb.ajaxSettings && fb.ajaxSettings.traditional), fb.isArray(a) || a.jquery && !fb.isPlainObject(a))fb.each(a, function () {
            f(this.name, this.value)
        }); else for (d in a)B(d, a[d], c, f);
        return e.join("&").replace(ac, "+")
    }, fb.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "), function (a, b) {
        fb.fn[b] = function (a, c) {
            return arguments.length > 0 ? this.on(b, null, a, c) : this.trigger(b)
        }
    }), fb.fn.extend({hover: function (a, b) {
        return this.mouseenter(a).mouseleave(b || a)
    }, bind: function (a, b, c) {
        return this.on(a, null, b, c)
    }, unbind: function (a, b) {
        return this.off(a, null, b)
    }, delegate: function (a, b, c, d) {
        return this.on(b, a, c, d)
    }, undelegate: function (a, b, c) {
        return 1 === arguments.length ? this.off(a, "**") : this.off(b, a || "**", c)
    }});
    var fc, gc, hc = fb.now(), ic = /\?/, jc = /#.*$/, kc = /([?&])_=[^&]*/, lc = /^(.*?):[ \t]*([^\r\n]*)$/gm, mc = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/, nc = /^(?:GET|HEAD)$/, oc = /^\/\//, pc = /^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/, qc = fb.fn.load, rc = {}, sc = {}, tc = "*/".concat("*");
    try {
        gc = S.href
    } catch (uc) {
        gc = T.createElement("a"), gc.href = "", gc = gc.href
    }
    fc = pc.exec(gc.toLowerCase()) || [], fb.fn.load = function (a, c, d) {
        if ("string" != typeof a && qc)return qc.apply(this, arguments);
        var e, f, g, h = this, i = a.indexOf(" ");
        return i >= 0 && (e = a.slice(i), a = a.slice(0, i)), fb.isFunction(c) ? (d = c, c = b) : c && "object" == typeof c && (f = "POST"), h.length > 0 && fb.ajax({url: a, type: f, dataType: "html", data: c}).done(function (a) {
            g = arguments, h.html(e ? fb("<div>").append(fb.parseHTML(a)).find(e) : a)
        }).complete(d && function (a, b) {
            h.each(d, g || [a.responseText, b, a])
        }), this
    }, fb.each(["ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend"], function (a, b) {
        fb.fn[b] = function (a) {
            return this.on(b, a)
        }
    }), fb.extend({active: 0, lastModified: {}, etag: {}, ajaxSettings: {url: gc, type: "GET", isLocal: mc.test(fc[1]), global: !0, processData: !0, async: !0, contentType: "application/x-www-form-urlencoded; charset=UTF-8", accepts: {"*": tc, text: "text/plain", html: "text/html", xml: "application/xml, text/xml", json: "application/json, text/javascript"}, contents: {xml: /xml/, html: /html/, json: /json/}, responseFields: {xml: "responseXML", text: "responseText", json: "responseJSON"}, converters: {"* text": String, "text html": !0, "text json": fb.parseJSON, "text xml": fb.parseXML}, flatOptions: {url: !0, context: !0}}, ajaxSetup: function (a, b) {
        return b ? E(E(a, fb.ajaxSettings), b) : E(fb.ajaxSettings, a)
    }, ajaxPrefilter: C(rc), ajaxTransport: C(sc), ajax: function (a, c) {
        function d(a, c, d, h) {
            var j, l, s, t, v, x = c;
            2 !== u && (u = 2, i && clearTimeout(i), e = b, g = h || "", w.readyState = a > 0 ? 4 : 0, j = a >= 200 && 300 > a || 304 === a, d && (t = F(m, w, d)), t = G(m, t, w, j), j ? (m.ifModified && (v = w.getResponseHeader("Last-Modified"), v && (fb.lastModified[f] = v), v = w.getResponseHeader("etag"), v && (fb.etag[f] = v)), 204 === a || "HEAD" === m.type ? x = "nocontent" : 304 === a ? x = "notmodified" : (x = t.state, l = t.data, s = t.error, j = !s)) : (s = x, (a || !x) && (x = "error", 0 > a && (a = 0))), w.status = a, w.statusText = (c || x) + "", j ? p.resolveWith(n, [l, x, w]) : p.rejectWith(n, [w, x, s]), w.statusCode(r), r = b, k && o.trigger(j ? "ajaxSuccess" : "ajaxError", [w, m, j ? l : s]), q.fireWith(n, [w, x]), k && (o.trigger("ajaxComplete", [w, m]), --fb.active || fb.event.trigger("ajaxStop")))
        }

        "object" == typeof a && (c = a, a = b), c = c || {};
        var e, f, g, h, i, j, k, l, m = fb.ajaxSetup({}, c), n = m.context || m, o = m.context && (n.nodeType || n.jquery) ? fb(n) : fb.event, p = fb.Deferred(), q = fb.Callbacks("once memory"), r = m.statusCode || {}, s = {}, t = {}, u = 0, v = "canceled", w = {readyState: 0, getResponseHeader: function (a) {
            var b;
            if (2 === u) {
                if (!h)for (h = {}; b = lc.exec(g);)h[b[1].toLowerCase()] = b[2];
                b = h[a.toLowerCase()]
            }
            return null == b ? null : b
        }, getAllResponseHeaders: function () {
            return 2 === u ? g : null
        }, setRequestHeader: function (a, b) {
            var c = a.toLowerCase();
            return u || (a = t[c] = t[c] || a, s[a] = b), this
        }, overrideMimeType: function (a) {
            return u || (m.mimeType = a), this
        }, statusCode: function (a) {
            var b;
            if (a)if (2 > u)for (b in a)r[b] = [r[b], a[b]]; else w.always(a[w.status]);
            return this
        }, abort: function (a) {
            var b = a || v;
            return e && e.abort(b), d(0, b), this
        }};
        if (p.promise(w).complete = q.add, w.success = w.done, w.error = w.fail, m.url = ((a || m.url || gc) + "").replace(jc, "").replace(oc, fc[1] + "//"), m.type = c.method || c.type || m.method || m.type, m.dataTypes = fb.trim(m.dataType || "*").toLowerCase().match(hb) || [""], null == m.crossDomain && (j = pc.exec(m.url.toLowerCase()), m.crossDomain = !(!j || j[1] === fc[1] && j[2] === fc[2] && (j[3] || ("http:" === j[1] ? "80" : "443")) === (fc[3] || ("http:" === fc[1] ? "80" : "443")))), m.data && m.processData && "string" != typeof m.data && (m.data = fb.param(m.data, m.traditional)), D(rc, m, c, w), 2 === u)return w;
        k = m.global, k && 0 === fb.active++ && fb.event.trigger("ajaxStart"), m.type = m.type.toUpperCase(), m.hasContent = !nc.test(m.type), f = m.url, m.hasContent || (m.data && (f = m.url += (ic.test(f) ? "&" : "?") + m.data, delete m.data), m.cache === !1 && (m.url = kc.test(f) ? f.replace(kc, "$1_=" + hc++) : f + (ic.test(f) ? "&" : "?") + "_=" + hc++)), m.ifModified && (fb.lastModified[f] && w.setRequestHeader("If-Modified-Since", fb.lastModified[f]), fb.etag[f] && w.setRequestHeader("If-None-Match", fb.etag[f])), (m.data && m.hasContent && m.contentType !== !1 || c.contentType) && w.setRequestHeader("Content-Type", m.contentType), w.setRequestHeader("Accept", m.dataTypes[0] && m.accepts[m.dataTypes[0]] ? m.accepts[m.dataTypes[0]] + ("*" !== m.dataTypes[0] ? ", " + tc + "; q=0.01" : "") : m.accepts["*"]);
        for (l in m.headers)w.setRequestHeader(l, m.headers[l]);
        if (m.beforeSend && (m.beforeSend.call(n, w, m) === !1 || 2 === u))return w.abort();
        v = "abort";
        for (l in{success: 1, error: 1, complete: 1})w[l](m[l]);
        if (e = D(sc, m, c, w)) {
            w.readyState = 1, k && o.trigger("ajaxSend", [w, m]), m.async && m.timeout > 0 && (i = setTimeout(function () {
                w.abort("timeout")
            }, m.timeout));
            try {
                u = 1, e.send(s, d)
            } catch (x) {
                if (!(2 > u))throw x;
                d(-1, x)
            }
        } else d(-1, "No Transport");
        return w
    }, getJSON: function (a, b, c) {
        return fb.get(a, b, c, "json")
    }, getScript: function (a, c) {
        return fb.get(a, b, c, "script")
    }}), fb.each(["get", "post"], function (a, c) {
        fb[c] = function (a, d, e, f) {
            return fb.isFunction(d) && (f = f || e, e = d, d = b), fb.ajax({url: a, type: c, dataType: f, data: d, success: e})
        }
    }), fb.ajaxSetup({accepts: {script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"}, contents: {script: /(?:java|ecma)script/}, converters: {"text script": function (a) {
        return fb.globalEval(a), a
    }}}), fb.ajaxPrefilter("script", function (a) {
        a.cache === b && (a.cache = !1), a.crossDomain && (a.type = "GET")
    }), fb.ajaxTransport("script", function (a) {
        if (a.crossDomain) {
            var b, c;
            return{send: function (d, e) {
                b = fb("<script>").prop({async: !0, charset: a.scriptCharset, src: a.url}).on("load error", c = function (a) {
                    b.remove(), c = null, a && e("error" === a.type ? 404 : 200, a.type)
                }), T.head.appendChild(b[0])
            }, abort: function () {
                c && c()
            }}
        }
    });
    var vc = [], wc = /(=)\?(?=&|$)|\?\?/;
    fb.ajaxSetup({jsonp: "callback", jsonpCallback: function () {
        var a = vc.pop() || fb.expando + "_" + hc++;
        return this[a] = !0, a
    }}), fb.ajaxPrefilter("json jsonp", function (c, d, e) {
        var f, g, h, i = c.jsonp !== !1 && (wc.test(c.url) ? "url" : "string" == typeof c.data && !(c.contentType || "").indexOf("application/x-www-form-urlencoded") && wc.test(c.data) && "data");
        return i || "jsonp" === c.dataTypes[0] ? (f = c.jsonpCallback = fb.isFunction(c.jsonpCallback) ? c.jsonpCallback() : c.jsonpCallback, i ? c[i] = c[i].replace(wc, "$1" + f) : c.jsonp !== !1 && (c.url += (ic.test(c.url) ? "&" : "?") + c.jsonp + "=" + f), c.converters["script json"] = function () {
            return h || fb.error(f + " was not called"), h[0]
        }, c.dataTypes[0] = "json", g = a[f], a[f] = function () {
            h = arguments
        }, e.always(function () {
            a[f] = g, c[f] && (c.jsonpCallback = d.jsonpCallback, vc.push(f)), h && fb.isFunction(g) && g(h[0]), h = g = b
        }), "script") : void 0
    }), fb.ajaxSettings.xhr = function () {
        try {
            return new XMLHttpRequest
        } catch (a) {
        }
    };
    var xc = fb.ajaxSettings.xhr(), yc = {0: 200, 1223: 204}, zc = 0, Ac = {};
    a.ActiveXObject && fb(a).on("unload", function () {
        for (var a in Ac)Ac[a]();
        Ac = b
    }), fb.support.cors = !!xc && "withCredentials"in xc, fb.support.ajax = xc = !!xc, fb.ajaxTransport(function (a) {
        var c;
        return fb.support.cors || xc && !a.crossDomain ? {send: function (d, e) {
            var f, g, h = a.xhr();
            if (h.open(a.type, a.url, a.async, a.username, a.password), a.xhrFields)for (f in a.xhrFields)h[f] = a.xhrFields[f];
            a.mimeType && h.overrideMimeType && h.overrideMimeType(a.mimeType), a.crossDomain || d["X-Requested-With"] || (d["X-Requested-With"] = "XMLHttpRequest");
            for (f in d)h.setRequestHeader(f, d[f]);
            c = function (a) {
                return function () {
                    c && (delete Ac[g], c = h.onload = h.onerror = null, "abort" === a ? h.abort() : "error" === a ? e(h.status || 404, h.statusText) : e(yc[h.status] || h.status, h.statusText, "string" == typeof h.responseText ? {text: h.responseText} : b, h.getAllResponseHeaders()))
                }
            }, h.onload = c(), h.onerror = c("error"), c = Ac[g = zc++] = c("abort"), h.send(a.hasContent && a.data || null)
        }, abort: function () {
            c && c()
        }} : void 0
    });
    var Bc, Cc, Dc = /^(?:toggle|show|hide)$/, Ec = new RegExp("^(?:([+-])=|)(" + gb + ")([a-z%]*)$", "i"), Fc = /queueHooks$/, Gc = [L], Hc = {"*": [function (a, b) {
        var c = this.createTween(a, b), d = c.cur(), e = Ec.exec(b), f = e && e[3] || (fb.cssNumber[a] ? "" : "px"), g = (fb.cssNumber[a] || "px" !== f && +d) && Ec.exec(fb.css(c.elem, a)), h = 1, i = 20;
        if (g && g[3] !== f) {
            f = f || g[3], e = e || [], g = +d || 1;
            do h = h || ".5", g /= h, fb.style(c.elem, a, g + f); while (h !== (h = c.cur() / d) && 1 !== h && --i)
        }
        return e && (g = c.start = +g || +d || 0, c.unit = f, c.end = e[1] ? g + (e[1] + 1) * e[2] : +e[2]), c
    }]};
    fb.Animation = fb.extend(J, {tweener: function (a, b) {
        fb.isFunction(a) ? (b = a, a = ["*"]) : a = a.split(" ");
        for (var c, d = 0, e = a.length; e > d; d++)c = a[d], Hc[c] = Hc[c] || [], Hc[c].unshift(b)
    }, prefilter: function (a, b) {
        b ? Gc.unshift(a) : Gc.push(a)
    }}), fb.Tween = M, M.prototype = {constructor: M, init: function (a, b, c, d, e, f) {
        this.elem = a, this.prop = c, this.easing = e || "swing", this.options = b, this.start = this.now = this.cur(), this.end = d, this.unit = f || (fb.cssNumber[c] ? "" : "px")
    }, cur: function () {
        var a = M.propHooks[this.prop];
        return a && a.get ? a.get(this) : M.propHooks._default.get(this)
    }, run: function (a) {
        var b, c = M.propHooks[this.prop];
        return this.pos = b = this.options.duration ? fb.easing[this.easing](a, this.options.duration * a, 0, 1, this.options.duration) : a, this.now = (this.end - this.start) * b + this.start, this.options.step && this.options.step.call(this.elem, this.now, this), c && c.set ? c.set(this) : M.propHooks._default.set(this), this
    }}, M.prototype.init.prototype = M.prototype, M.propHooks = {_default: {get: function (a) {
        var b;
        return null == a.elem[a.prop] || a.elem.style && null != a.elem.style[a.prop] ? (b = fb.css(a.elem, a.prop, ""), b && "auto" !== b ? b : 0) : a.elem[a.prop]
    }, set: function (a) {
        fb.fx.step[a.prop] ? fb.fx.step[a.prop](a) : a.elem.style && (null != a.elem.style[fb.cssProps[a.prop]] || fb.cssHooks[a.prop]) ? fb.style(a.elem, a.prop, a.now + a.unit) : a.elem[a.prop] = a.now
    }}}, M.propHooks.scrollTop = M.propHooks.scrollLeft = {set: function (a) {
        a.elem.nodeType && a.elem.parentNode && (a.elem[a.prop] = a.now)
    }}, fb.each(["toggle", "show", "hide"], function (a, b) {
        var c = fb.fn[b];
        fb.fn[b] = function (a, d, e) {
            return null == a || "boolean" == typeof a ? c.apply(this, arguments) : this.animate(N(b, !0), a, d, e)
        }
    }), fb.fn.extend({fadeTo: function (a, b, c, d) {
        return this.filter(t).css("opacity", 0).show().end().animate({opacity: b}, a, c, d)
    }, animate: function (a, b, c, d) {
        var e = fb.isEmptyObject(a), f = fb.speed(b, c, d), g = function () {
            var b = J(this, fb.extend({}, a), f);
            (e || qb.get(this, "finish")) && b.stop(!0)
        };
        return g.finish = g, e || f.queue === !1 ? this.each(g) : this.queue(f.queue, g)
    }, stop: function (a, c, d) {
        var e = function (a) {
            var b = a.stop;
            delete a.stop, b(d)
        };
        return"string" != typeof a && (d = c, c = a, a = b), c && a !== !1 && this.queue(a || "fx", []), this.each(function () {
            var b = !0, c = null != a && a + "queueHooks", f = fb.timers, g = qb.get(this);
            if (c)g[c] && g[c].stop && e(g[c]); else for (c in g)g[c] && g[c].stop && Fc.test(c) && e(g[c]);
            for (c = f.length; c--;)f[c].elem !== this || null != a && f[c].queue !== a || (f[c].anim.stop(d), b = !1, f.splice(c, 1));
            (b || !d) && fb.dequeue(this, a)
        })
    }, finish: function (a) {
        return a !== !1 && (a = a || "fx"), this.each(function () {
            var b, c = qb.get(this), d = c[a + "queue"], e = c[a + "queueHooks"], f = fb.timers, g = d ? d.length : 0;
            for (c.finish = !0, fb.queue(this, a, []), e && e.stop && e.stop.call(this, !0), b = f.length; b--;)f[b].elem === this && f[b].queue === a && (f[b].anim.stop(!0), f.splice(b, 1));
            for (b = 0; g > b; b++)d[b] && d[b].finish && d[b].finish.call(this);
            delete c.finish
        })
    }}), fb.each({slideDown: N("show"), slideUp: N("hide"), slideToggle: N("toggle"), fadeIn: {opacity: "show"}, fadeOut: {opacity: "hide"}, fadeToggle: {opacity: "toggle"}}, function (a, b) {
        fb.fn[a] = function (a, c, d) {
            return this.animate(b, a, c, d)
        }
    }), fb.speed = function (a, b, c) {
        var d = a && "object" == typeof a ? fb.extend({}, a) : {complete: c || !c && b || fb.isFunction(a) && a, duration: a, easing: c && b || b && !fb.isFunction(b) && b};
        return d.duration = fb.fx.off ? 0 : "number" == typeof d.duration ? d.duration : d.duration in fb.fx.speeds ? fb.fx.speeds[d.duration] : fb.fx.speeds._default, (null == d.queue || d.queue === !0) && (d.queue = "fx"), d.old = d.complete, d.complete = function () {
            fb.isFunction(d.old) && d.old.call(this), d.queue && fb.dequeue(this, d.queue)
        }, d
    }, fb.easing = {linear: function (a) {
        return a
    }, swing: function (a) {
        return.5 - Math.cos(a * Math.PI) / 2
    }}, fb.timers = [], fb.fx = M.prototype.init, fb.fx.tick = function () {
        var a, c = fb.timers, d = 0;
        for (Bc = fb.now(); d < c.length; d++)a = c[d], a() || c[d] !== a || c.splice(d--, 1);
        c.length || fb.fx.stop(), Bc = b
    }, fb.fx.timer = function (a) {
        a() && fb.timers.push(a) && fb.fx.start()
    }, fb.fx.interval = 13, fb.fx.start = function () {
        Cc || (Cc = setInterval(fb.fx.tick, fb.fx.interval))
    }, fb.fx.stop = function () {
        clearInterval(Cc), Cc = null
    }, fb.fx.speeds = {slow: 600, fast: 200, _default: 400}, fb.fx.step = {}, fb.expr && fb.expr.filters && (fb.expr.filters.animated = function (a) {
        return fb.grep(fb.timers,function (b) {
            return a === b.elem
        }).length
    }), fb.fn.offset = function (a) {
        if (arguments.length)return a === b ? this : this.each(function (b) {
            fb.offset.setOffset(this, a, b)
        });
        var c, d, e = this[0], f = {top: 0, left: 0}, g = e && e.ownerDocument;
        if (g)return c = g.documentElement, fb.contains(c, e) ? (typeof e.getBoundingClientRect !== R && (f = e.getBoundingClientRect()), d = O(g), {top: f.top + d.pageYOffset - c.clientTop, left: f.left + d.pageXOffset - c.clientLeft}) : f
    }, fb.offset = {setOffset: function (a, b, c) {
        var d, e, f, g, h, i, j, k = fb.css(a, "position"), l = fb(a), m = {};
        "static" === k && (a.style.position = "relative"), h = l.offset(), f = fb.css(a, "top"), i = fb.css(a, "left"), j = ("absolute" === k || "fixed" === k) && (f + i).indexOf("auto") > -1, j ? (d = l.position(), g = d.top, e = d.left) : (g = parseFloat(f) || 0, e = parseFloat(i) || 0), fb.isFunction(b) && (b = b.call(a, c, h)), null != b.top && (m.top = b.top - h.top + g), null != b.left && (m.left = b.left - h.left + e), "using"in b ? b.using.call(a, m) : l.css(m)
    }}, fb.fn.extend({position: function () {
        if (this[0]) {
            var a, b, c = this[0], d = {top: 0, left: 0};
            return"fixed" === fb.css(c, "position") ? b = c.getBoundingClientRect() : (a = this.offsetParent(), b = this.offset(), fb.nodeName(a[0], "html") || (d = a.offset()), d.top += fb.css(a[0], "borderTopWidth", !0), d.left += fb.css(a[0], "borderLeftWidth", !0)), {top: b.top - d.top - fb.css(c, "marginTop", !0), left: b.left - d.left - fb.css(c, "marginLeft", !0)}
        }
    }, offsetParent: function () {
        return this.map(function () {
            for (var a = this.offsetParent || U; a && !fb.nodeName(a, "html") && "static" === fb.css(a, "position");)a = a.offsetParent;
            return a || U
        })
    }}), fb.each({scrollLeft: "pageXOffset", scrollTop: "pageYOffset"}, function (c, d) {
        var e = "pageYOffset" === d;
        fb.fn[c] = function (f) {
            return fb.access(this, function (c, f, g) {
                var h = O(c);
                return g === b ? h ? h[d] : c[f] : void(h ? h.scrollTo(e ? a.pageXOffset : g, e ? g : a.pageYOffset) : c[f] = g)
            }, c, f, arguments.length, null)
        }
    }), fb.each({Height: "height", Width: "width"}, function (a, c) {
        fb.each({padding: "inner" + a, content: c, "": "outer" + a}, function (d, e) {
            fb.fn[e] = function (e, f) {
                var g = arguments.length && (d || "boolean" != typeof e), h = d || (e === !0 || f === !0 ? "margin" : "border");
                return fb.access(this, function (c, d, e) {
                    var f;
                    return fb.isWindow(c) ? c.document.documentElement["client" + a] : 9 === c.nodeType ? (f = c.documentElement, Math.max(c.body["scroll" + a], f["scroll" + a], c.body["offset" + a], f["offset" + a], f["client" + a])) : e === b ? fb.css(c, d, h) : fb.style(c, d, e, h)
                }, c, g ? e : b, g, null)
            }
        })
    }), fb.fn.size = function () {
        return this.length
    }, fb.fn.andSelf = fb.fn.addBack, "object" == typeof module && module && "object" == typeof module.exports ? module.exports = fb : "function" == typeof define && define.amd && define("jquery", [], function () {
        return fb
    }), "object" == typeof a && "object" == typeof a.document && (a.jQuery = a.$ = fb)
}(window),
    !function (a) {
    "object" == typeof exports ? module.exports = a() : "function" == typeof define && define.amd ? define(a) : "undefined" != typeof window ? window.proj4 = a() : "undefined" != typeof global ? global.proj4 = a() : "undefined" != typeof self && (self.proj4 = a())
}(function () {
    return function a(b, c, d) {
        function e(g, h) {
            if (!c[g]) {
                if (!b[g]) {
                    var i = "function" == typeof require && require;
                    if (!h && i)return i(g, !0);
                    if (f)return f(g, !0);
                    throw new Error("Cannot find module '" + g + "'")
                }
                var j = c[g] = {exports: {}};
                b[g][0].call(j.exports, function (a) {
                    var c = b[g][1][a];
                    return e(c ? c : a)
                }, j, j.exports, a, b, c, d)
            }
            return c[g].exports
        }

        for (var f = "function" == typeof require && require, g = 0; g < d.length; g++)e(d[g]);
        return e
    }({1: [function (a, b) {
        function c(a, b, d) {
            if (!(this instanceof c))return new c(a, b, d);
            if (Array.isArray(a))this.x = a[0], this.y = a[1], this.z = a[2] || 0; else if ("object" == typeof a)this.x = a.x, this.y = a.y, this.z = a.z || 0; else if ("string" == typeof a && "undefined" == typeof b) {
                var e = a.split(",");
                this.x = parseFloat(e[0], 10), this.y = parseFloat(e[1], 10), this.z = parseFloat(e[2], 10) || 0
            } else this.x = a, this.y = b, this.z = d || 0;
            this.clone = function () {
                return new c(this.x, this.y, this.z)
            }, this.toArray = function () {
                return this.z ? [this.x, this.y, this.z] : [this.x, this.y]
            }, this.toString = function () {
                return this.z ? "x=" + this.x + ",y=" + this.y + ",z=" + this.z : "x=" + this.x + ",y=" + this.y
            }, this.toShortString = function () {
                return this.z ? this.x + "," + this.y + "," + this.z : this.x + "," + this.y
            }
        }

        var d = a("mgrs");
        c.fromMGRS = function (a) {
            return new c(d.toPoint(a))
        }, c.prototype.toMGRS = function (a) {
            return d.forward([this.x, this.y], a)
        }, b.exports = c
    }, {mgrs: 65}], 2: [function (a, b) {
        function c(a) {
            if (!(this instanceof c))return new c(a);
            this.srsCodeInput = a, this.x0 = 0, this.y0 = 0;
            var b;
            "string" == typeof a ? a in e ? (this.deriveConstants(e[a]), d(this, e[a])) : a.indexOf("GEOGCS") >= 0 || a.indexOf("GEOCCS") >= 0 || a.indexOf("PROJCS") >= 0 || a.indexOf("LOCAL_CS") >= 0 ? (b = i(a), this.deriveConstants(b), d(this, b)) : "+" === a[0] && (b = j(a), this.deriveConstants(b), d(this, b)) : (this.deriveConstants(a), d(this, a)), this.initTransforms(this.projName)
        }

        var d = a("./extend"), e = a("./defs"), f = {};
        f.grids = a("./constants/grids"), f.Datum = a("./constants/Datum"), f.Ellipsoid = a("./constants/Ellipsoid");
        var g = a("./datum"), h = a("./projections/index"), i = a("./wkt"), j = a("./projString"), k = 1e-10, l = .16666666666666666, m = .04722222222222222, n = .022156084656084655;
        c.projections = h, c.projections.start(), c.prototype = {initTransforms: function (a) {
            var b = c.projections.get(a);
            if (!b)throw"unknown projection " + a;
            d(this, b), this.init()
        }, deriveConstants: function (a) {
            if (a.nadgrids && 0 === a.nadgrids.length && (a.nadgrids = null), a.nadgrids) {
                a.grids = a.nadgrids.split(",");
                var b = null, c = a.grids.length;
                if (c > 0)for (var e = 0; c > e; e++) {
                    b = a.grids[e];
                    var h = b.split("@");
                    "" !== h[h.length - 1] && (a.grids[e] = {mandatory: 1 === h.length, name: h[h.length - 1], grid: f.grids[h[h.length - 1]]}, a.grids[e].mandatory && !a.grids[e].grid)
                }
            }
            if (a.datumCode && "none" !== a.datumCode) {
                var i = f.Datum[a.datumCode];
                i && (a.datum_params = i.towgs84 ? i.towgs84.split(",") : null, a.ellps = i.ellipse, a.datumName = i.datumName ? i.datumName : a.datumCode)
            }
            if (!a.a) {
                var j = f.Ellipsoid[a.ellps] ? f.Ellipsoid[a.ellps] : f.Ellipsoid.WGS84;
                d(a, j)
            }
            a.rf && !a.b && (a.b = (1 - 1 / a.rf) * a.a), (0 === a.rf || Math.abs(a.a - a.b) < k) && (a.sphere = !0, a.b = a.a), a.a2 = a.a * a.a, a.b2 = a.b * a.b, a.es = (a.a2 - a.b2) / a.a2, a.e = Math.sqrt(a.es), a.R_A && (a.a *= 1 - a.es * (l + a.es * (m + a.es * n)), a.a2 = a.a * a.a, a.b2 = a.b * a.b, a.es = 0), a.ep2 = (a.a2 - a.b2) / a.b2, a.k0 || (a.k0 = 1), a.axis || (a.axis = "enu"), a.datum = g(a)
        }}, b.exports = c
    }, {"./constants/Datum": 24, "./constants/Ellipsoid": 25, "./constants/grids": 27, "./datum": 29, "./defs": 31, "./extend": 32, "./projString": 35, "./projections/index": 44, "./wkt": 64}], 3: [function (a, b) {
        b.exports = function (a, b, c) {
            var d, e, f, g = c.x, h = c.y, i = c.z || 0;
            for (f = 0; 3 > f; f++)if (!b || 2 !== f || void 0 !== c.z)switch (0 === f ? (d = g, e = "x") : 1 === f ? (d = h, e = "y") : (d = i, e = "z"), a.axis[f]) {
                case"e":
                    c[e] = d;
                    break;
                case"w":
                    c[e] = -d;
                    break;
                case"n":
                    c[e] = d;
                    break;
                case"s":
                    c[e] = -d;
                    break;
                case"u":
                    void 0 !== c[e] && (c.z = d);
                    break;
                case"d":
                    void 0 !== c[e] && (c.z = -d);
                    break;
                default:
                    return null
            }
            return c
        }
    }, {}], 4: [function (a, b) {
        var c = Math.PI / 2, d = a("./sign");
        b.exports = function (a) {
            return Math.abs(a) < c ? a : a - d(a) * Math.PI
        }
    }, {"./sign": 21}], 5: [function (a, b) {
        var c = 2 * Math.PI, d = a("./sign");
        b.exports = function (a) {
            return Math.abs(a) < Math.PI ? a : a - d(a) * c
        }
    }, {"./sign": 21}], 6: [function (a, b) {
        b.exports = function (a) {
            return Math.abs(a) > 1 && (a = a > 1 ? 1 : -1), Math.asin(a)
        }
    }, {}], 7: [function (a, b) {
        b.exports = function (a) {
            return 1 - .25 * a * (1 + a / 16 * (3 + 1.25 * a))
        }
    }, {}], 8: [function (a, b) {
        b.exports = function (a) {
            return.375 * a * (1 + .25 * a * (1 + .46875 * a))
        }
    }, {}], 9: [function (a, b) {
        b.exports = function (a) {
            return.05859375 * a * a * (1 + .75 * a)
        }
    }, {}], 10: [function (a, b) {
        b.exports = function (a) {
            return a * a * a * (35 / 3072)
        }
    }, {}], 11: [function (a, b) {
        b.exports = function (a, b, c) {
            var d = b * c;
            return a / Math.sqrt(1 - d * d)
        }
    }, {}], 12: [function (a, b) {
        b.exports = function (a, b, c, d, e) {
            var f, g;
            f = a / b;
            for (var h = 0; 15 > h; h++)if (g = (a - (b * f - c * Math.sin(2 * f) + d * Math.sin(4 * f) - e * Math.sin(6 * f))) / (b - 2 * c * Math.cos(2 * f) + 4 * d * Math.cos(4 * f) - 6 * e * Math.cos(6 * f)), f += g, Math.abs(g) <= 1e-10)return f;
            return 0 / 0
        }
    }, {}], 13: [function (a, b) {
        var c = Math.PI / 2;
        b.exports = function (a, b) {
            var d = 1 - (1 - a * a) / (2 * a) * Math.log((1 - a) / (1 + a));
            if (Math.abs(Math.abs(b) - d) < 1e-6)return 0 > b ? -1 * c : c;
            for (var e, f, g, h, i = Math.asin(.5 * b), j = 0; 30 > j; j++)if (f = Math.sin(i), g = Math.cos(i), h = a * f, e = Math.pow(1 - h * h, 2) / (2 * g) * (b / (1 - a * a) - f / (1 - h * h) + .5 / a * Math.log((1 - h) / (1 + h))), i += e, Math.abs(e) <= 1e-10)return i;
            return 0 / 0
        }
    }, {}], 14: [function (a, b) {
        b.exports = function (a, b, c, d, e) {
            return a * e - b * Math.sin(2 * e) + c * Math.sin(4 * e) - d * Math.sin(6 * e)
        }
    }, {}], 15: [function (a, b) {
        b.exports = function (a, b, c) {
            var d = a * b;
            return c / Math.sqrt(1 - d * d)
        }
    }, {}], 16: [function (a, b) {
        var c = Math.PI / 2;
        b.exports = function (a, b) {
            for (var d, e, f = .5 * a, g = c - 2 * Math.atan(b), h = 0; 15 >= h; h++)if (d = a * Math.sin(g), e = c - 2 * Math.atan(b * Math.pow((1 - d) / (1 + d), f)) - g, g += e, Math.abs(e) <= 1e-10)return g;
            return-9999
        }
    }, {}], 17: [function (a, b) {
        var c = 1, d = .25, e = .046875, f = .01953125, g = .01068115234375, h = .75, i = .46875, j = .013020833333333334, k = .007120768229166667, l = .3645833333333333, m = .005696614583333333, n = .3076171875;
        b.exports = function (a) {
            var b = [];
            b[0] = c - a * (d + a * (e + a * (f + a * g))), b[1] = a * (h - a * (e + a * (f + a * g)));
            var o = a * a;
            return b[2] = o * (i - a * (j + a * k)), o *= a, b[3] = o * (l - a * m), b[4] = o * a * n, b
        }
    }, {}], 18: [function (a, b) {
        var c = a("./pj_mlfn"), d = 1e-10, e = 20;
        b.exports = function (a, b, f) {
            for (var g = 1 / (1 - b), h = a, i = e; i; --i) {
                var j = Math.sin(h), k = 1 - b * j * j;
                if (k = (c(h, j, Math.cos(h), f) - a) * k * Math.sqrt(k) * g, h -= k, Math.abs(k) < d)return h
            }
            return h
        }
    }, {"./pj_mlfn": 19}], 19: [function (a, b) {
        b.exports = function (a, b, c, d) {
            return c *= b, b *= b, d[0] * a - c * (d[1] + b * (d[2] + b * (d[3] + b * d[4])))
        }
    }, {}], 20: [function (a, b) {
        b.exports = function (a, b) {
            var c;
            return a > 1e-7 ? (c = a * b, (1 - a * a) * (b / (1 - c * c) - .5 / a * Math.log((1 - c) / (1 + c)))) : 2 * b
        }
    }, {}], 21: [function (a, b) {
        b.exports = function (a) {
            return 0 > a ? -1 : 1
        }
    }, {}], 22: [function (a, b) {
        b.exports = function (a, b) {
            return Math.pow((1 - a) / (1 + a), b)
        }
    }, {}], 23: [function (a, b) {
        var c = Math.PI / 2;
        b.exports = function (a, b, d) {
            var e = a * d, f = .5 * a;
            return e = Math.pow((1 - e) / (1 + e), f), Math.tan(.5 * (c - b)) / e
        }
    }, {}], 24: [function (a, b, c) {
        c.wgs84 = {towgs84: "0,0,0", ellipse: "WGS84", datumName: "WGS84"}, c.ch1903 = {towgs84: "674.374,15.056,405.346", ellipse: "bessel", datumName: "swiss"}, c.ggrs87 = {towgs84: "-199.87,74.79,246.62", ellipse: "GRS80", datumName: "Greek_Geodetic_Reference_System_1987"}, c.nad83 = {towgs84: "0,0,0", ellipse: "GRS80", datumName: "North_American_Datum_1983"}, c.nad27 = {nadgrids: "@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat", ellipse: "clrk66", datumName: "North_American_Datum_1927"}, c.potsdam = {towgs84: "606.0,23.0,413.0", ellipse: "bessel", datumName: "Potsdam Rauenberg 1950 DHDN"}, c.carthage = {towgs84: "-263.0,6.0,431.0", ellipse: "clark80", datumName: "Carthage 1934 Tunisia"}, c.hermannskogel = {towgs84: "653.0,-212.0,449.0", ellipse: "bessel", datumName: "Hermannskogel"}, c.ire65 = {towgs84: "482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15", ellipse: "mod_airy", datumName: "Ireland 1965"}, c.rassadiran = {towgs84: "-133.63,-157.5,-158.62", ellipse: "intl", datumName: "Rassadiran"}, c.nzgd49 = {towgs84: "59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993", ellipse: "intl", datumName: "New Zealand Geodetic Datum 1949"}, c.osgb36 = {towgs84: "446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894", ellipse: "airy", datumName: "Airy 1830"}, c.s_jtsk = {towgs84: "589,76,480", ellipse: "bessel", datumName: "S-JTSK (Ferro)"}, c.beduaram = {towgs84: "-106,-87,188", ellipse: "clrk80", datumName: "Beduaram"}, c.gunung_segara = {towgs84: "-403,684,41", ellipse: "bessel", datumName: "Gunung Segara Jakarta"}
    }, {}], 25: [function (a, b, c) {
        c.MERIT = {a: 6378137, rf: 298.257, ellipseName: "MERIT 1983"}, c.SGS85 = {a: 6378136, rf: 298.257, ellipseName: "Soviet Geodetic System 85"}, c.GRS80 = {a: 6378137, rf: 298.257222101, ellipseName: "GRS 1980(IUGG, 1980)"}, c.IAU76 = {a: 6378140, rf: 298.257, ellipseName: "IAU 1976"}, c.airy = {a: 6377563.396, b: 6356256.91, ellipseName: "Airy 1830"}, c.APL4 = {a: 6378137, rf: 298.25, ellipseName: "Appl. Physics. 1965"}, c.NWL9D = {a: 6378145, rf: 298.25, ellipseName: "Naval Weapons Lab., 1965"}, c.mod_airy = {a: 6377340.189, b: 6356034.446, ellipseName: "Modified Airy"}, c.andrae = {a: 6377104.43, rf: 300, ellipseName: "Andrae 1876 (Den., Iclnd.)"}, c.aust_SA = {a: 6378160, rf: 298.25, ellipseName: "Australian Natl & S. Amer. 1969"}, c.GRS67 = {a: 6378160, rf: 298.247167427, ellipseName: "GRS 67(IUGG 1967)"}, c.bessel = {a: 6377397.155, rf: 299.1528128, ellipseName: "Bessel 1841"}, c.bess_nam = {a: 6377483.865, rf: 299.1528128, ellipseName: "Bessel 1841 (Namibia)"}, c.clrk66 = {a: 6378206.4, b: 6356583.8, ellipseName: "Clarke 1866"}, c.clrk80 = {a: 6378249.145, rf: 293.4663, ellipseName: "Clarke 1880 mod."}, c.clrk58 = {a: 6378293.645208759, rf: 294.2606763692654, ellipseName: "Clarke 1858"}, c.CPM = {a: 6375738.7, rf: 334.29, ellipseName: "Comm. des Poids et Mesures 1799"}, c.delmbr = {a: 6376428, rf: 311.5, ellipseName: "Delambre 1810 (Belgium)"}, c.engelis = {a: 6378136.05, rf: 298.2566, ellipseName: "Engelis 1985"}, c.evrst30 = {a: 6377276.345, rf: 300.8017, ellipseName: "Everest 1830"}, c.evrst48 = {a: 6377304.063, rf: 300.8017, ellipseName: "Everest 1948"}, c.evrst56 = {a: 6377301.243, rf: 300.8017, ellipseName: "Everest 1956"}, c.evrst69 = {a: 6377295.664, rf: 300.8017, ellipseName: "Everest 1969"}, c.evrstSS = {a: 6377298.556, rf: 300.8017, ellipseName: "Everest (Sabah & Sarawak)"}, c.fschr60 = {a: 6378166, rf: 298.3, ellipseName: "Fischer (Mercury Datum) 1960"}, c.fschr60m = {a: 6378155, rf: 298.3, ellipseName: "Fischer 1960"}, c.fschr68 = {a: 6378150, rf: 298.3, ellipseName: "Fischer 1968"}, c.helmert = {a: 6378200, rf: 298.3, ellipseName: "Helmert 1906"}, c.hough = {a: 6378270, rf: 297, ellipseName: "Hough"}, c.intl = {a: 6378388, rf: 297, ellipseName: "International 1909 (Hayford)"}, c.kaula = {a: 6378163, rf: 298.24, ellipseName: "Kaula 1961"}, c.lerch = {a: 6378139, rf: 298.257, ellipseName: "Lerch 1979"}, c.mprts = {a: 6397300, rf: 191, ellipseName: "Maupertius 1738"}, c.new_intl = {a: 6378157.5, b: 6356772.2, ellipseName: "New International 1967"}, c.plessis = {a: 6376523, rf: 6355863, ellipseName: "Plessis 1817 (France)"}, c.krass = {a: 6378245, rf: 298.3, ellipseName: "Krassovsky, 1942"}, c.SEasia = {a: 6378155, b: 6356773.3205, ellipseName: "Southeast Asia"}, c.walbeck = {a: 6376896, b: 6355834.8467, ellipseName: "Walbeck"}, c.WGS60 = {a: 6378165, rf: 298.3, ellipseName: "WGS 60"}, c.WGS66 = {a: 6378145, rf: 298.25, ellipseName: "WGS 66"}, c.WGS7 = {a: 6378135, rf: 298.26, ellipseName: "WGS 72"}, c.WGS84 = {a: 6378137, rf: 298.257223563, ellipseName: "WGS 84"}, c.sphere = {a: 6370997, b: 6370997, ellipseName: "Normal Sphere (r=6370997)"}
    }, {}], 26: [function (a, b, c) {
        c.greenwich = 0, c.lisbon = -9.131906111111, c.paris = 2.337229166667, c.bogota = -74.080916666667, c.madrid = -3.687938888889, c.rome = 12.452333333333, c.bern = 7.439583333333, c.jakarta = 106.807719444444, c.ferro = -17.666666666667, c.brussels = 4.367975, c.stockholm = 18.058277777778, c.athens = 23.7163375, c.oslo = 10.722916666667
    }, {}], 27: [function (a, b, c) {
        c["null"] = {ll: [-3.14159265, -1.57079633], del: [3.14159265, 1.57079633], lim: [3, 3], count: 9, cvs: [
            [0, 0],
            [0, 0],
            [0, 0],
            [0, 0],
            [0, 0],
            [0, 0],
            [0, 0],
            [0, 0],
            [0, 0]
        ]}
    }, {}], 28: [function (a, b) {
        function c(a, b, c) {
            var d;
            return Array.isArray(c) ? (d = h(a, b, f(c)), 3 === c.length ? [d.x, d.y, d.z] : [d.x, d.y]) : h(a, b, c)
        }

        function d(a) {
            return a instanceof g ? a : a.oProj ? a.oProj : g(a)
        }

        function e(a, b, e) {
            a = d(a);
            var f, g = !1;
            return"undefined" == typeof b ? (b = a, a = i, g = !0) : ("undefined" != typeof b.x || Array.isArray(b)) && (e = b, b = a, a = i, g = !0), b = d(b), e ? c(a, b, e) : (f = {forward: function (d) {
                return c(a, b, d)
            }, inverse: function (d) {
                return c(b, a, d)
            }}, g && (f.oProj = b), f)
        }

        var f = a("./Point"), g = a("./Proj"), h = a("./transform"), i = g("WGS84");
        b.exports = e
    }, {"./Point": 1, "./Proj": 2, "./transform": 62}], 29: [function (a, b) {
        var c = Math.PI / 2, d = 1, e = 2, f = 3, g = 4, h = 5, i = 484813681109536e-20, j = 1.0026, k = .3826834323650898, l = function (a) {
            if (!(this instanceof l))return new l(a);
            if (this.datum_type = g, a) {
                if (a.datumCode && "none" === a.datumCode && (this.datum_type = h), a.datum_params) {
                    for (var b = 0; b < a.datum_params.length; b++)a.datum_params[b] = parseFloat(a.datum_params[b]);
                    (0 !== a.datum_params[0] || 0 !== a.datum_params[1] || 0 !== a.datum_params[2]) && (this.datum_type = d), a.datum_params.length > 3 && (0 !== a.datum_params[3] || 0 !== a.datum_params[4] || 0 !== a.datum_params[5] || 0 !== a.datum_params[6]) && (this.datum_type = e, a.datum_params[3] *= i, a.datum_params[4] *= i, a.datum_params[5] *= i, a.datum_params[6] = a.datum_params[6] / 1e6 + 1)
                }
                this.datum_type = a.grids ? f : this.datum_type, this.a = a.a, this.b = a.b, this.es = a.es, this.ep2 = a.ep2, this.datum_params = a.datum_params, this.datum_type === f && (this.grids = a.grids)
            }
        };
        l.prototype = {compare_datums: function (a) {
            return this.datum_type !== a.datum_type ? !1 : this.a !== a.a || Math.abs(this.es - a.es) > 5e-11 ? !1 : this.datum_type === d ? this.datum_params[0] === a.datum_params[0] && this.datum_params[1] === a.datum_params[1] && this.datum_params[2] === a.datum_params[2] : this.datum_type === e ? this.datum_params[0] === a.datum_params[0] && this.datum_params[1] === a.datum_params[1] && this.datum_params[2] === a.datum_params[2] && this.datum_params[3] === a.datum_params[3] && this.datum_params[4] === a.datum_params[4] && this.datum_params[5] === a.datum_params[5] && this.datum_params[6] === a.datum_params[6] : this.datum_type === f || a.datum_type === f ? this.nadgrids === a.nadgrids : !0
        }, geodetic_to_geocentric: function (a) {
            var b, d, e, f, g, h, i, j = a.x, k = a.y, l = a.z ? a.z : 0, m = 0;
            if (-c > k && k > -1.001 * c)k = -c; else if (k > c && 1.001 * c > k)k = c; else if (-c > k || k > c)return null;
            return j > Math.PI && (j -= 2 * Math.PI), g = Math.sin(k), i = Math.cos(k), h = g * g, f = this.a / Math.sqrt(1 - this.es * h), b = (f + l) * i * Math.cos(j), d = (f + l) * i * Math.sin(j), e = (f * (1 - this.es) + l) * g, a.x = b, a.y = d, a.z = e, m
        }, geocentric_to_geodetic: function (a) {
            var b, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t = 1e-12, u = t * t, v = 30, w = a.x, x = a.y, y = a.z ? a.z : 0;
            if (o = !1, b = Math.sqrt(w * w + x * x), d = Math.sqrt(w * w + x * x + y * y), b / this.a < t) {
                if (o = !0, q = 0, d / this.a < t)return r = c, void(s = -this.b)
            } else q = Math.atan2(x, w);
            e = y / d, f = b / d, g = 1 / Math.sqrt(1 - this.es * (2 - this.es) * f * f), j = f * (1 - this.es) * g, k = e * g, p = 0;
            do p++, i = this.a / Math.sqrt(1 - this.es * k * k), s = b * j + y * k - i * (1 - this.es * k * k), h = this.es * i / (i + s), g = 1 / Math.sqrt(1 - h * (2 - h) * f * f), l = f * (1 - h) * g, m = e * g, n = m * j - l * k, j = l, k = m; while (n * n > u && v > p);
            return r = Math.atan(m / Math.abs(l)), a.x = q, a.y = r, a.z = s, a
        }, geocentric_to_geodetic_noniter: function (a) {
            var b, d, e, f, g, h, i, l, m, n, o, p, q, r, s, t, u, v = a.x, w = a.y, x = a.z ? a.z : 0;
            if (v = parseFloat(v), w = parseFloat(w), x = parseFloat(x), u = !1, 0 !== v)b = Math.atan2(w, v); else if (w > 0)b = c; else if (0 > w)b = -c; else if (u = !0, b = 0, x > 0)d = c; else {
                if (!(0 > x))return d = c, void(e = -this.b);
                d = -c
            }
            return g = v * v + w * w, f = Math.sqrt(g), h = x * j, l = Math.sqrt(h * h + g), n = h / l, p = f / l, o = n * n * n, i = x + this.b * this.ep2 * o, t = f - this.a * this.es * p * p * p, m = Math.sqrt(i * i + t * t), q = i / m, r = t / m, s = this.a / Math.sqrt(1 - this.es * q * q), e = r >= k ? f / r - s : -k >= r ? f / -r - s : x / q + s * (this.es - 1), u === !1 && (d = Math.atan(q / r)), a.x = b, a.y = d, a.z = e, a
        }, geocentric_to_wgs84: function (a) {
            if (this.datum_type === d)a.x += this.datum_params[0], a.y += this.datum_params[1], a.z += this.datum_params[2]; else if (this.datum_type === e) {
                var b = this.datum_params[0], c = this.datum_params[1], f = this.datum_params[2], g = this.datum_params[3], h = this.datum_params[4], i = this.datum_params[5], j = this.datum_params[6], k = j * (a.x - i * a.y + h * a.z) + b, l = j * (i * a.x + a.y - g * a.z) + c, m = j * (-h * a.x + g * a.y + a.z) + f;
                a.x = k, a.y = l, a.z = m
            }
        }, geocentric_from_wgs84: function (a) {
            if (this.datum_type === d)a.x -= this.datum_params[0], a.y -= this.datum_params[1], a.z -= this.datum_params[2]; else if (this.datum_type === e) {
                var b = this.datum_params[0], c = this.datum_params[1], f = this.datum_params[2], g = this.datum_params[3], h = this.datum_params[4], i = this.datum_params[5], j = this.datum_params[6], k = (a.x - b) / j, l = (a.y - c) / j, m = (a.z - f) / j;
                a.x = k + i * l - h * m, a.y = -i * k + l + g * m, a.z = h * k - g * l + m
            }
        }}, b.exports = l
    }, {}], 30: [function (a, b) {
        var c = 1, d = 2, e = 3, f = 5, g = 6378137, h = .006694379990141316;
        b.exports = function (a, b, i) {
            function j(a) {
                return a === c || a === d
            }

            var k, l, m;
            if (a.compare_datums(b))return i;
            if (a.datum_type === f || b.datum_type === f)return i;
            var n = a.a, o = a.es, p = b.a, q = b.es, r = a.datum_type;
            if (r === e)if (0 === this.apply_gridshift(a, 0, i))a.a = g, a.es = h; else {
                if (!a.datum_params)return a.a = n, a.es = a.es, i;
                for (k = 1, l = 0, m = a.datum_params.length; m > l; l++)k *= a.datum_params[l];
                if (0 === k)return a.a = n, a.es = a.es, i;
                r = a.datum_params.length > 3 ? d : c
            }
            return b.datum_type === e && (b.a = g, b.es = h), (a.es !== b.es || a.a !== b.a || j(r) || j(b.datum_type)) && (a.geodetic_to_geocentric(i), j(a.datum_type) && a.geocentric_to_wgs84(i), j(b.datum_type) && b.geocentric_from_wgs84(i), b.geocentric_to_geodetic(i)), b.datum_type === e && this.apply_gridshift(b, 1, i), a.a = n, a.es = o, b.a = p, b.es = q, i
        }
    }, {}], 31: [function (a, b) {
        function c(a) {
            var b = this;
            if (2 === arguments.length)c[a] = "+" === arguments[1][0] ? e(arguments[1]) : f(arguments[1]); else if (1 === arguments.length)return Array.isArray(a) ? a.map(function (a) {
                Array.isArray(a) ? c.apply(b, a) : c(a)
            }) : void("string" == typeof a || ("EPSG"in a ? c["EPSG:" + a.EPSG] = a : "ESRI"in a ? c["ESRI:" + a.ESRI] = a : "IAU2000"in a ? c["IAU2000:" + a.IAU2000] = a : console.log(a)))
        }

        var d = a("./global"), e = a("./projString"), f = a("./wkt");
        d(c), b.exports = c
    }, {"./global": 33, "./projString": 35, "./wkt": 64}], 32: [function (a, b) {
        b.exports = function (a, b) {
            a = a || {};
            var c, d;
            if (!b)return a;
            for (d in b)c = b[d], void 0 !== c && (a[d] = c);
            return a
        }
    }, {}], 33: [function (a, b) {
        b.exports = function (a) {
            a("WGS84", "+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"), a("EPSG:4326", "+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"), a("EPSG:4269", "+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"), a("EPSG:3857", "+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"), a["EPSG:3785"] = a["EPSG:3857"], a.GOOGLE = a["EPSG:3857"], a["EPSG:900913"] = a["EPSG:3857"], a["EPSG:102113"] = a["EPSG:3857"]
        }
    }, {}], 34: [function (a, b) {
        var c = a("./core");
        c.defaultDatum = "WGS84", c.Proj = a("./Proj"), c.WGS84 = new c.Proj("WGS84"), c.Point = a("./Point"), c.defs = a("./defs"), c.transform = a("./transform"), c.mgrs = a("mgrs"), c.version = a("./version"), b.exports = c
    }, {"./Point": 1, "./Proj": 2, "./core": 28, "./defs": 31, "./transform": 62, "./version": 63, mgrs: 65}], 35: [function (a, b) {
        var c = .017453292519943295, d = a("./constants/PrimeMeridian");
        b.exports = function (a) {
            var b = {}, e = {};
            a.split("+").map(function (a) {
                return a.trim()
            }).filter(function (a) {
                return a
            }).forEach(function (a) {
                var b = a.split("=");
                b.push(!0), e[b[0].toLowerCase()] = b[1]
            });
            var f, g, h, i = {proj: "projName", datum: "datumCode", rf: function (a) {
                b.rf = parseFloat(a, 10)
            }, lat_0: function (a) {
                b.lat0 = a * c
            }, lat_1: function (a) {
                b.lat1 = a * c
            }, lat_2: function (a) {
                b.lat2 = a * c
            }, lat_ts: function (a) {
                b.lat_ts = a * c
            }, lon_0: function (a) {
                b.long0 = a * c
            }, lon_1: function (a) {
                b.long1 = a * c
            }, lon_2: function (a) {
                b.long2 = a * c
            }, alpha: function (a) {
                b.alpha = parseFloat(a) * c
            }, lonc: function (a) {
                b.longc = a * c
            }, x_0: function (a) {
                b.x0 = parseFloat(a, 10)
            }, y_0: function (a) {
                b.y0 = parseFloat(a, 10)
            }, k_0: function (a) {
                b.k0 = parseFloat(a, 10)
            }, k: function (a) {
                b.k0 = parseFloat(a, 10)
            }, r_a: function () {
                b.R_A = !0
            }, zone: function (a) {
                b.zone = parseInt(a, 10)
            }, south: function () {
                b.utmSouth = !0
            }, towgs84: function (a) {
                b.datum_params = a.split(",").map(function (a) {
                    return parseFloat(a, 10)
                })
            }, to_meter: function (a) {
                b.to_meter = parseFloat(a, 10)
            }, from_greenwich: function (a) {
                b.from_greenwich = a * c
            }, pm: function (a) {
                b.from_greenwich = (d[a] ? d[a] : parseFloat(a, 10)) * c
            }, nadgrids: function (a) {
                "@null" === a ? b.datumCode = "none" : b.nadgrids = a
            }, axis: function (a) {
                var c = "ewnsud";
                3 === a.length && -1 !== c.indexOf(a.substr(0, 1)) && -1 !== c.indexOf(a.substr(1, 1)) && -1 !== c.indexOf(a.substr(2, 1)) && (b.axis = a)
            }};
            for (f in e)g = e[f], f in i ? (h = i[f], "function" == typeof h ? h(g) : b[h] = g) : b[f] = g;
            return b
        }
    }, {"./constants/PrimeMeridian": 26}], 36: [function (a, b, c) {
        var d = 1e-10, e = a("../common/msfnz"), f = a("../common/qsfnz"), g = a("../common/adjust_lon"), h = a("../common/asinz");
        c.init = function () {
            Math.abs(this.lat1 + this.lat2) < d || (this.temp = this.b / this.a, this.es = 1 - Math.pow(this.temp, 2), this.e3 = Math.sqrt(this.es), this.sin_po = Math.sin(this.lat1), this.cos_po = Math.cos(this.lat1), this.t1 = this.sin_po, this.con = this.sin_po, this.ms1 = e(this.e3, this.sin_po, this.cos_po), this.qs1 = f(this.e3, this.sin_po, this.cos_po), this.sin_po = Math.sin(this.lat2), this.cos_po = Math.cos(this.lat2), this.t2 = this.sin_po, this.ms2 = e(this.e3, this.sin_po, this.cos_po), this.qs2 = f(this.e3, this.sin_po, this.cos_po), this.sin_po = Math.sin(this.lat0), this.cos_po = Math.cos(this.lat0), this.t3 = this.sin_po, this.qs0 = f(this.e3, this.sin_po, this.cos_po), this.ns0 = Math.abs(this.lat1 - this.lat2) > d ? (this.ms1 * this.ms1 - this.ms2 * this.ms2) / (this.qs2 - this.qs1) : this.con, this.c = this.ms1 * this.ms1 + this.ns0 * this.qs1, this.rh = this.a * Math.sqrt(this.c - this.ns0 * this.qs0) / this.ns0)
        }, c.forward = function (a) {
            var b = a.x, c = a.y;
            this.sin_phi = Math.sin(c), this.cos_phi = Math.cos(c);
            var d = f(this.e3, this.sin_phi, this.cos_phi), e = this.a * Math.sqrt(this.c - this.ns0 * d) / this.ns0, h = this.ns0 * g(b - this.long0), i = e * Math.sin(h) + this.x0, j = this.rh - e * Math.cos(h) + this.y0;
            return a.x = i, a.y = j, a
        }, c.inverse = function (a) {
            var b, c, d, e, f, h;
            return a.x -= this.x0, a.y = this.rh - a.y + this.y0, this.ns0 >= 0 ? (b = Math.sqrt(a.x * a.x + a.y * a.y), d = 1) : (b = -Math.sqrt(a.x * a.x + a.y * a.y), d = -1), e = 0, 0 !== b && (e = Math.atan2(d * a.x, d * a.y)), d = b * this.ns0 / this.a, this.sphere ? h = Math.asin((this.c - d * d) / (2 * this.ns0)) : (c = (this.c - d * d) / this.ns0, h = this.phi1z(this.e3, c)), f = g(e / this.ns0 + this.long0), a.x = f, a.y = h, a
        }, c.phi1z = function (a, b) {
            var c, e, f, g, i, j = h(.5 * b);
            if (d > a)return j;
            for (var k = a * a, l = 1; 25 >= l; l++)if (c = Math.sin(j), e = Math.cos(j), f = a * c, g = 1 - f * f, i = .5 * g * g / e * (b / (1 - k) - c / g + .5 / a * Math.log((1 - f) / (1 + f))), j += i, Math.abs(i) <= 1e-7)return j;
            return null
        }, c.names = ["Albers_Conic_Equal_Area", "Albers", "aea"]
    }, {"../common/adjust_lon": 5, "../common/asinz": 6, "../common/msfnz": 15, "../common/qsfnz": 20}], 37: [function (a, b, c) {
        var d = a("../common/adjust_lon"), e = Math.PI / 2, f = 1e-10, g = a("../common/mlfn"), h = a("../common/e0fn"), i = a("../common/e1fn"), j = a("../common/e2fn"), k = a("../common/e3fn"), l = a("../common/gN"), m = a("../common/asinz"), n = a("../common/imlfn");
        c.init = function () {
            this.sin_p12 = Math.sin(this.lat0), this.cos_p12 = Math.cos(this.lat0)
        }, c.forward = function (a) {
            var b, c, m, n, o, p, q, r, s, t, u, v, w, x, y, z, A, B, C, D, E, F, G, H = a.x, I = a.y, J = Math.sin(a.y), K = Math.cos(a.y), L = d(H - this.long0);
            return this.sphere ? Math.abs(this.sin_p12 - 1) <= f ? (a.x = this.x0 + this.a * (e - I) * Math.sin(L), a.y = this.y0 - this.a * (e - I) * Math.cos(L), a) : Math.abs(this.sin_p12 + 1) <= f ? (a.x = this.x0 + this.a * (e + I) * Math.sin(L), a.y = this.y0 + this.a * (e + I) * Math.cos(L), a) : (B = this.sin_p12 * J + this.cos_p12 * K * Math.cos(L), z = Math.acos(B), A = z / Math.sin(z), a.x = this.x0 + this.a * A * K * Math.sin(L), a.y = this.y0 + this.a * A * (this.cos_p12 * J - this.sin_p12 * K * Math.cos(L)), a) : (b = h(this.es), c = i(this.es), m = j(this.es), n = k(this.es), Math.abs(this.sin_p12 - 1) <= f ? (o = this.a * g(b, c, m, n, e), p = this.a * g(b, c, m, n, I), a.x = this.x0 + (o - p) * Math.sin(L), a.y = this.y0 - (o - p) * Math.cos(L), a) : Math.abs(this.sin_p12 + 1) <= f ? (o = this.a * g(b, c, m, n, e), p = this.a * g(b, c, m, n, I), a.x = this.x0 + (o + p) * Math.sin(L), a.y = this.y0 + (o + p) * Math.cos(L), a) : (q = J / K, r = l(this.a, this.e, this.sin_p12), s = l(this.a, this.e, J), t = Math.atan((1 - this.es) * q + this.es * r * this.sin_p12 / (s * K)), u = Math.atan2(Math.sin(L), this.cos_p12 * Math.tan(t) - this.sin_p12 * Math.cos(L)), C = 0 === u ? Math.asin(this.cos_p12 * Math.sin(t) - this.sin_p12 * Math.cos(t)) : Math.abs(Math.abs(u) - Math.PI) <= f ? -Math.asin(this.cos_p12 * Math.sin(t) - this.sin_p12 * Math.cos(t)) : Math.asin(Math.sin(L) * Math.cos(t) / Math.sin(u)), v = this.e * this.sin_p12 / Math.sqrt(1 - this.es), w = this.e * this.cos_p12 * Math.cos(u) / Math.sqrt(1 - this.es), x = v * w, y = w * w, D = C * C, E = D * C, F = E * C, G = F * C, z = r * C * (1 - D * y * (1 - y) / 6 + E / 8 * x * (1 - 2 * y) + F / 120 * (y * (4 - 7 * y) - 3 * v * v * (1 - 7 * y)) - G / 48 * x), a.x = this.x0 + z * Math.sin(u), a.y = this.y0 + z * Math.cos(u), a))
        }, c.inverse = function (a) {
            a.x -= this.x0, a.y -= this.y0;
            var b, c, o, p, q, r, s, t, u, v, w, x, y, z, A, B, C, D, E, F, G, H, I;
            if (this.sphere) {
                if (b = Math.sqrt(a.x * a.x + a.y * a.y), b > 2 * e * this.a)return;
                return c = b / this.a, o = Math.sin(c), p = Math.cos(c), q = this.long0, Math.abs(b) <= f ? r = this.lat0 : (r = m(p * this.sin_p12 + a.y * o * this.cos_p12 / b), s = Math.abs(this.lat0) - e, q = d(Math.abs(s) <= f ? this.lat0 >= 0 ? this.long0 + Math.atan2(a.x, -a.y) : this.long0 - Math.atan2(-a.x, a.y) : this.long0 + Math.atan2(a.x * o, b * this.cos_p12 * p - a.y * this.sin_p12 * o))), a.x = q, a.y = r, a
            }
            return t = h(this.es), u = i(this.es), v = j(this.es), w = k(this.es), Math.abs(this.sin_p12 - 1) <= f ? (x = this.a * g(t, u, v, w, e), b = Math.sqrt(a.x * a.x + a.y * a.y), y = x - b, r = n(y / this.a, t, u, v, w), q = d(this.long0 + Math.atan2(a.x, -1 * a.y)), a.x = q, a.y = r, a) : Math.abs(this.sin_p12 + 1) <= f ? (x = this.a * g(t, u, v, w, e), b = Math.sqrt(a.x * a.x + a.y * a.y), y = b - x, r = n(y / this.a, t, u, v, w), q = d(this.long0 + Math.atan2(a.x, a.y)), a.x = q, a.y = r, a) : (b = Math.sqrt(a.x * a.x + a.y * a.y), B = Math.atan2(a.x, a.y), z = l(this.a, this.e, this.sin_p12), C = Math.cos(B), D = this.e * this.cos_p12 * C, E = -D * D / (1 - this.es), F = 3 * this.es * (1 - E) * this.sin_p12 * this.cos_p12 * C / (1 - this.es), G = b / z, H = G - E * (1 + E) * Math.pow(G, 3) / 6 - F * (1 + 3 * E) * Math.pow(G, 4) / 24, I = 1 - E * H * H / 2 - G * H * H * H / 6, A = Math.asin(this.sin_p12 * Math.cos(H) + this.cos_p12 * Math.sin(H) * C), q = d(this.long0 + Math.asin(Math.sin(B) * Math.sin(H) / Math.cos(A))), r = Math.atan((1 - this.es * I * this.sin_p12 / Math.sin(A)) * Math.tan(A) / (1 - this.es)), a.x = q, a.y = r, a)
        }, c.names = ["Azimuthal_Equidistant", "aeqd"]
    }, {"../common/adjust_lon": 5, "../common/asinz": 6, "../common/e0fn": 7, "../common/e1fn": 8, "../common/e2fn": 9, "../common/e3fn": 10, "../common/gN": 11, "../common/imlfn": 12, "../common/mlfn": 14}], 38: [function (a, b, c) {
        var d = a("../common/mlfn"), e = a("../common/e0fn"), f = a("../common/e1fn"), g = a("../common/e2fn"), h = a("../common/e3fn"), i = a("../common/gN"), j = a("../common/adjust_lon"), k = a("../common/adjust_lat"), l = a("../common/imlfn"), m = Math.PI / 2, n = 1e-10;
        c.init = function () {
            this.sphere || (this.e0 = e(this.es), this.e1 = f(this.es), this.e2 = g(this.es), this.e3 = h(this.es), this.ml0 = this.a * d(this.e0, this.e1, this.e2, this.e3, this.lat0))
        }, c.forward = function (a) {
            var b, c, e = a.x, f = a.y;
            if (e = j(e - this.long0), this.sphere)b = this.a * Math.asin(Math.cos(f) * Math.sin(e)), c = this.a * (Math.atan2(Math.tan(f), Math.cos(e)) - this.lat0); else {
                var g = Math.sin(f), h = Math.cos(f), k = i(this.a, this.e, g), l = Math.tan(f) * Math.tan(f), m = e * Math.cos(f), n = m * m, o = this.es * h * h / (1 - this.es), p = this.a * d(this.e0, this.e1, this.e2, this.e3, f);
                b = k * m * (1 - n * l * (1 / 6 - (8 - l + 8 * o) * n / 120)), c = p - this.ml0 + k * g / h * n * (.5 + (5 - l + 6 * o) * n / 24)
            }
            return a.x = b + this.x0, a.y = c + this.y0, a
        }, c.inverse = function (a) {
            a.x -= this.x0, a.y -= this.y0;
            var b, c, d = a.x / this.a, e = a.y / this.a;
            if (this.sphere) {
                var f = e + this.lat0;
                b = Math.asin(Math.sin(f) * Math.cos(d)), c = Math.atan2(Math.tan(d), Math.cos(f))
            } else {
                var g = this.ml0 / this.a + e, h = l(g, this.e0, this.e1, this.e2, this.e3);
                if (Math.abs(Math.abs(h) - m) <= n)return a.x = this.long0, a.y = m, 0 > e && (a.y *= -1), a;
                var o = i(this.a, this.e, Math.sin(h)), p = o * o * o / this.a / this.a * (1 - this.es), q = Math.pow(Math.tan(h), 2), r = d * this.a / o, s = r * r;
                b = h - o * Math.tan(h) / p * r * r * (.5 - (1 + 3 * q) * r * r / 24), c = r * (1 - s * (q / 3 + (1 + 3 * q) * q * s / 15)) / Math.cos(h)
            }
            return a.x = j(c + this.long0), a.y = k(b), a
        }, c.names = ["Cassini", "Cassini_Soldner", "cass"]
    }, {"../common/adjust_lat": 4, "../common/adjust_lon": 5, "../common/e0fn": 7, "../common/e1fn": 8, "../common/e2fn": 9, "../common/e3fn": 10, "../common/gN": 11, "../common/imlfn": 12, "../common/mlfn": 14}], 39: [function (a, b, c) {
        var d = a("../common/adjust_lon"), e = a("../common/qsfnz"), f = a("../common/msfnz"), g = a("../common/iqsfnz");
        c.init = function () {
            this.sphere || (this.k0 = f(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)))
        }, c.forward = function (a) {
            var b, c, f = a.x, g = a.y, h = d(f - this.long0);
            if (this.sphere)b = this.x0 + this.a * h * Math.cos(this.lat_ts), c = this.y0 + this.a * Math.sin(g) / Math.cos(this.lat_ts); else {
                var i = e(this.e, Math.sin(g));
                b = this.x0 + this.a * this.k0 * h, c = this.y0 + this.a * i * .5 / this.k0
            }
            return a.x = b, a.y = c, a
        }, c.inverse = function (a) {
            a.x -= this.x0, a.y -= this.y0;
            var b, c;
            return this.sphere ? (b = d(this.long0 + a.x / this.a / Math.cos(this.lat_ts)), c = Math.asin(a.y / this.a * Math.cos(this.lat_ts))) : (c = g(this.e, 2 * a.y * this.k0 / this.a), b = d(this.long0 + a.x / (this.a * this.k0))), a.x = b, a.y = c, a
        }, c.names = ["cea"]
    }, {"../common/adjust_lon": 5, "../common/iqsfnz": 13, "../common/msfnz": 15, "../common/qsfnz": 20}], 40: [function (a, b, c) {
        var d = a("../common/adjust_lon"), e = a("../common/adjust_lat");
        c.init = function () {
            this.x0 = this.x0 || 0, this.y0 = this.y0 || 0, this.lat0 = this.lat0 || 0, this.long0 = this.long0 || 0, this.lat_ts = this.lat_ts || 0, this.title = this.title || "Equidistant Cylindrical (Plate Carre)", this.rc = Math.cos(this.lat_ts)
        }, c.forward = function (a) {
            var b = a.x, c = a.y, f = d(b - this.long0), g = e(c - this.lat0);
            return a.x = this.x0 + this.a * f * this.rc, a.y = this.y0 + this.a * g, a
        }, c.inverse = function (a) {
            var b = a.x, c = a.y;
            return a.x = d(this.long0 + (b - this.x0) / (this.a * this.rc)), a.y = e(this.lat0 + (c - this.y0) / this.a), a
        }, c.names = ["Equirectangular", "Equidistant_Cylindrical", "eqc"]
    }, {"../common/adjust_lat": 4, "../common/adjust_lon": 5}], 41: [function (a, b, c) {
        var d = a("../common/e0fn"), e = a("../common/e1fn"), f = a("../common/e2fn"), g = a("../common/e3fn"), h = a("../common/msfnz"), i = a("../common/mlfn"), j = a("../common/adjust_lon"), k = a("../common/adjust_lat"), l = a("../common/imlfn"), m = 1e-10;
        c.init = function () {
            Math.abs(this.lat1 + this.lat2) < m || (this.lat2 = this.lat2 || this.lat1, this.temp = this.b / this.a, this.es = 1 - Math.pow(this.temp, 2), this.e = Math.sqrt(this.es), this.e0 = d(this.es), this.e1 = e(this.es), this.e2 = f(this.es), this.e3 = g(this.es), this.sinphi = Math.sin(this.lat1), this.cosphi = Math.cos(this.lat1), this.ms1 = h(this.e, this.sinphi, this.cosphi), this.ml1 = i(this.e0, this.e1, this.e2, this.e3, this.lat1), Math.abs(this.lat1 - this.lat2) < m ? this.ns = this.sinphi : (this.sinphi = Math.sin(this.lat2), this.cosphi = Math.cos(this.lat2), this.ms2 = h(this.e, this.sinphi, this.cosphi), this.ml2 = i(this.e0, this.e1, this.e2, this.e3, this.lat2), this.ns = (this.ms1 - this.ms2) / (this.ml2 - this.ml1)), this.g = this.ml1 + this.ms1 / this.ns, this.ml0 = i(this.e0, this.e1, this.e2, this.e3, this.lat0), this.rh = this.a * (this.g - this.ml0))
        }, c.forward = function (a) {
            var b, c = a.x, d = a.y;
            if (this.sphere)b = this.a * (this.g - d); else {
                var e = i(this.e0, this.e1, this.e2, this.e3, d);
                b = this.a * (this.g - e)
            }
            var f = this.ns * j(c - this.long0), g = this.x0 + b * Math.sin(f), h = this.y0 + this.rh - b * Math.cos(f);
            return a.x = g, a.y = h, a
        }, c.inverse = function (a) {
            a.x -= this.x0, a.y = this.rh - a.y + this.y0;
            var b, c, d, e;
            this.ns >= 0 ? (c = Math.sqrt(a.x * a.x + a.y * a.y), b = 1) : (c = -Math.sqrt(a.x * a.x + a.y * a.y), b = -1);
            var f = 0;
            if (0 !== c && (f = Math.atan2(b * a.x, b * a.y)), this.sphere)return e = j(this.long0 + f / this.ns), d = k(this.g - c / this.a), a.x = e, a.y = d, a;
            var g = this.g - c / this.a;
            return d = l(g, this.e0, this.e1, this.e2, this.e3), e = j(this.long0 + f / this.ns), a.x = e, a.y = d, a
        }, c.names = ["Equidistant_Conic", "eqdc"]
    }, {"../common/adjust_lat": 4, "../common/adjust_lon": 5, "../common/e0fn": 7, "../common/e1fn": 8, "../common/e2fn": 9, "../common/e3fn": 10, "../common/imlfn": 12, "../common/mlfn": 14, "../common/msfnz": 15}], 42: [function (a, b, c) {
        var d = Math.PI / 4, e = a("../common/srat"), f = Math.PI / 2, g = 20;
        c.init = function () {
            var a = Math.sin(this.lat0), b = Math.cos(this.lat0);
            b *= b, this.rc = Math.sqrt(1 - this.es) / (1 - this.es * a * a), this.C = Math.sqrt(1 + this.es * b * b / (1 - this.es)), this.phic0 = Math.asin(a / this.C), this.ratexp = .5 * this.C * this.e, this.K = Math.tan(.5 * this.phic0 + d) / (Math.pow(Math.tan(.5 * this.lat0 + d), this.C) * e(this.e * a, this.ratexp))
        }, c.forward = function (a) {
            var b = a.x, c = a.y;
            return a.y = 2 * Math.atan(this.K * Math.pow(Math.tan(.5 * c + d), this.C) * e(this.e * Math.sin(c), this.ratexp)) - f, a.x = this.C * b, a
        }, c.inverse = function (a) {
            for (var b = 1e-14, c = a.x / this.C, h = a.y, i = Math.pow(Math.tan(.5 * h + d) / this.K, 1 / this.C), j = g; j > 0 && (h = 2 * Math.atan(i * e(this.e * Math.sin(a.y), -.5 * this.e)) - f, !(Math.abs(h - a.y) < b)); --j)a.y = h;
            return j ? (a.x = c, a.y = h, a) : null
        }, c.names = ["gauss"]
    }, {"../common/srat": 22}], 43: [function (a, b, c) {
        var d = a("../common/adjust_lon"), e = 1e-10, f = a("../common/asinz");
        c.init = function () {
            this.sin_p14 = Math.sin(this.lat0), this.cos_p14 = Math.cos(this.lat0), this.infinity_dist = 1e3 * this.a, this.rc = 1
        }, c.forward = function (a) {
            var b, c, f, g, h, i, j, k, l = a.x, m = a.y;
            return f = d(l - this.long0), b = Math.sin(m), c = Math.cos(m), g = Math.cos(f), i = this.sin_p14 * b + this.cos_p14 * c * g, h = 1, i > 0 || Math.abs(i) <= e ? (j = this.x0 + this.a * h * c * Math.sin(f) / i, k = this.y0 + this.a * h * (this.cos_p14 * b - this.sin_p14 * c * g) / i) : (j = this.x0 + this.infinity_dist * c * Math.sin(f), k = this.y0 + this.infinity_dist * (this.cos_p14 * b - this.sin_p14 * c * g)), a.x = j, a.y = k, a
        }, c.inverse = function (a) {
            var b, c, e, g, h, i;
            return a.x = (a.x - this.x0) / this.a, a.y = (a.y - this.y0) / this.a, a.x /= this.k0, a.y /= this.k0, (b = Math.sqrt(a.x * a.x + a.y * a.y)) ? (g = Math.atan2(b, this.rc), c = Math.sin(g), e = Math.cos(g), i = f(e * this.sin_p14 + a.y * c * this.cos_p14 / b), h = Math.atan2(a.x * c, b * this.cos_p14 * e - a.y * this.sin_p14 * c), h = d(this.long0 + h)) : (i = this.phic0, h = 0), a.x = h, a.y = i, a
        }, c.names = ["gnom"]
    }, {"../common/adjust_lon": 5, "../common/asinz": 6}], 44: [function (a, b, c) {
        function d(a, b) {
            var c = g.length;
            return a.names ? (g[c] = a, a.names.forEach(function (a) {
                f[a.toLowerCase()] = c
            }), this) : (console.log(b), !0)
        }

        var e = [a("./tmerc"), a("./utm"), a("./sterea"), a("./stere"), a("./somerc"), a("./omerc"), a("./lcc"), a("./krovak"), a("./cass"), a("./laea"), a("./merc"), a("./aea"), a("./gnom"), a("./cea"), a("./eqc"), a("./poly"), a("./nzmg"), a("./mill"), a("./sinu"), a("./moll"), a("./eqdc"), a("./vandg"), a("./aeqd"), a("./longlat")], f = {}, g = [];
        c.add = d, c.get = function (a) {
            if (!a)return!1;
            var b = a.toLowerCase();
            return"undefined" != typeof f[b] && g[f[b]] ? g[f[b]] : void 0
        }, c.start = function () {
            e.forEach(d)
        }
    }, {"./aea": 36, "./aeqd": 37, "./cass": 38, "./cea": 39, "./eqc": 40, "./eqdc": 41, "./gnom": 43, "./krovak": 45, "./laea": 46, "./lcc": 47, "./longlat": 48, "./merc": 49, "./mill": 50, "./moll": 51, "./nzmg": 52, "./omerc": 53, "./poly": 54, "./sinu": 55, "./somerc": 56, "./stere": 57, "./sterea": 58, "./tmerc": 59, "./utm": 60, "./vandg": 61}], 45: [function (a, b, c) {
        var d = a("../common/adjust_lon");
        c.init = function () {
            this.a = 6377397.155, this.es = .006674372230614, this.e = Math.sqrt(this.es), this.lat0 || (this.lat0 = .863937979737193), this.long0 || (this.long0 = .4334234309119251), this.k0 || (this.k0 = .9999), this.s45 = .785398163397448, this.s90 = 2 * this.s45, this.fi0 = this.lat0, this.e2 = this.es, this.e = Math.sqrt(this.e2), this.alfa = Math.sqrt(1 + this.e2 * Math.pow(Math.cos(this.fi0), 4) / (1 - this.e2)), this.uq = 1.04216856380474, this.u0 = Math.asin(Math.sin(this.fi0) / this.alfa), this.g = Math.pow((1 + this.e * Math.sin(this.fi0)) / (1 - this.e * Math.sin(this.fi0)), this.alfa * this.e / 2), this.k = Math.tan(this.u0 / 2 + this.s45) / Math.pow(Math.tan(this.fi0 / 2 + this.s45), this.alfa) * this.g, this.k1 = this.k0, this.n0 = this.a * Math.sqrt(1 - this.e2) / (1 - this.e2 * Math.pow(Math.sin(this.fi0), 2)), this.s0 = 1.37008346281555, this.n = Math.sin(this.s0), this.ro0 = this.k1 * this.n0 / Math.tan(this.s0), this.ad = this.s90 - this.uq
        }, c.forward = function (a) {
            var b, c, e, f, g, h, i, j = a.x, k = a.y, l = d(j - this.long0);
            return b = Math.pow((1 + this.e * Math.sin(k)) / (1 - this.e * Math.sin(k)), this.alfa * this.e / 2), c = 2 * (Math.atan(this.k * Math.pow(Math.tan(k / 2 + this.s45), this.alfa) / b) - this.s45), e = -l * this.alfa, f = Math.asin(Math.cos(this.ad) * Math.sin(c) + Math.sin(this.ad) * Math.cos(c) * Math.cos(e)), g = Math.asin(Math.cos(c) * Math.sin(e) / Math.cos(f)), h = this.n * g, i = this.ro0 * Math.pow(Math.tan(this.s0 / 2 + this.s45), this.n) / Math.pow(Math.tan(f / 2 + this.s45), this.n), a.y = i * Math.cos(h) / 1, a.x = i * Math.sin(h) / 1, this.czech || (a.y *= -1, a.x *= -1), a
        }, c.inverse = function (a) {
            var b, c, d, e, f, g, h, i, j = a.x;
            a.x = a.y, a.y = j, this.czech || (a.y *= -1, a.x *= -1), g = Math.sqrt(a.x * a.x + a.y * a.y), f = Math.atan2(a.y, a.x), e = f / Math.sin(this.s0), d = 2 * (Math.atan(Math.pow(this.ro0 / g, 1 / this.n) * Math.tan(this.s0 / 2 + this.s45)) - this.s45), b = Math.asin(Math.cos(this.ad) * Math.sin(d) - Math.sin(this.ad) * Math.cos(d) * Math.cos(e)), c = Math.asin(Math.cos(d) * Math.sin(e) / Math.cos(b)), a.x = this.long0 - c / this.alfa, h = b, i = 0;
            var k = 0;
            do a.y = 2 * (Math.atan(Math.pow(this.k, -1 / this.alfa) * Math.pow(Math.tan(b / 2 + this.s45), 1 / this.alfa) * Math.pow((1 + this.e * Math.sin(h)) / (1 - this.e * Math.sin(h)), this.e / 2)) - this.s45), Math.abs(h - a.y) < 1e-10 && (i = 1), h = a.y, k += 1; while (0 === i && 15 > k);
            return k >= 15 ? null : a
        }, c.names = ["Krovak", "krovak"]
    }, {"../common/adjust_lon": 5}], 46: [function (a, b, c) {
        var d = Math.PI / 2, e = Math.PI / 4, f = 1e-10, g = a("../common/qsfnz"), h = a("../common/adjust_lon");
        c.S_POLE = 1, c.N_POLE = 2, c.EQUIT = 3, c.OBLIQ = 4, c.init = function () {
            var a = Math.abs(this.lat0);
            if (this.mode = Math.abs(a - d) < f ? this.lat0 < 0 ? this.S_POLE : this.N_POLE : Math.abs(a) < f ? this.EQUIT : this.OBLIQ, this.es > 0) {
                var b;
                switch (this.qp = g(this.e, 1), this.mmf = .5 / (1 - this.es), this.apa = this.authset(this.es), this.mode) {
                    case this.N_POLE:
                        this.dd = 1;
                        break;
                    case this.S_POLE:
                        this.dd = 1;
                        break;
                    case this.EQUIT:
                        this.rq = Math.sqrt(.5 * this.qp), this.dd = 1 / this.rq, this.xmf = 1, this.ymf = .5 * this.qp;
                        break;
                    case this.OBLIQ:
                        this.rq = Math.sqrt(.5 * this.qp), b = Math.sin(this.lat0), this.sinb1 = g(this.e, b) / this.qp, this.cosb1 = Math.sqrt(1 - this.sinb1 * this.sinb1), this.dd = Math.cos(this.lat0) / (Math.sqrt(1 - this.es * b * b) * this.rq * this.cosb1), this.ymf = (this.xmf = this.rq) / this.dd, this.xmf *= this.dd
                }
            } else this.mode === this.OBLIQ && (this.sinph0 = Math.sin(this.lat0), this.cosph0 = Math.cos(this.lat0))
        }, c.forward = function (a) {
            var b, c, i, j, k, l, m, n, o, p, q = a.x, r = a.y;
            if (q = h(q - this.long0), this.sphere) {
                if (k = Math.sin(r), p = Math.cos(r), i = Math.cos(q), this.mode === this.OBLIQ || this.mode === this.EQUIT) {
                    if (c = this.mode === this.EQUIT ? 1 + p * i : 1 + this.sinph0 * k + this.cosph0 * p * i, f >= c)return null;
                    c = Math.sqrt(2 / c), b = c * p * Math.sin(q), c *= this.mode === this.EQUIT ? k : this.cosph0 * k - this.sinph0 * p * i
                } else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {
                    if (this.mode === this.N_POLE && (i = -i), Math.abs(r + this.phi0) < f)return null;
                    c = e - .5 * r, c = 2 * (this.mode === this.S_POLE ? Math.cos(c) : Math.sin(c)), b = c * Math.sin(q), c *= i
                }
            } else {
                switch (m = 0, n = 0, o = 0, i = Math.cos(q), j = Math.sin(q), k = Math.sin(r), l = g(this.e, k), (this.mode === this.OBLIQ || this.mode === this.EQUIT) && (m = l / this.qp, n = Math.sqrt(1 - m * m)), this.mode) {
                    case this.OBLIQ:
                        o = 1 + this.sinb1 * m + this.cosb1 * n * i;
                        break;
                    case this.EQUIT:
                        o = 1 + n * i;
                        break;
                    case this.N_POLE:
                        o = d + r, l = this.qp - l;
                        break;
                    case this.S_POLE:
                        o = r - d, l = this.qp + l
                }
                if (Math.abs(o) < f)return null;
                switch (this.mode) {
                    case this.OBLIQ:
                    case this.EQUIT:
                        o = Math.sqrt(2 / o), c = this.mode === this.OBLIQ ? this.ymf * o * (this.cosb1 * m - this.sinb1 * n * i) : (o = Math.sqrt(2 / (1 + n * i))) * m * this.ymf, b = this.xmf * o * n * j;
                        break;
                    case this.N_POLE:
                    case this.S_POLE:
                        l >= 0 ? (b = (o = Math.sqrt(l)) * j, c = i * (this.mode === this.S_POLE ? o : -o)) : b = c = 0
                }
            }
            return a.x = this.a * b + this.x0, a.y = this.a * c + this.y0, a
        }, c.inverse = function (a) {
            a.x -= this.x0, a.y -= this.y0;
            var b, c, e, g, i, j, k, l = a.x / this.a, m = a.y / this.a;
            if (this.sphere) {
                var n, o = 0, p = 0;
                if (n = Math.sqrt(l * l + m * m), c = .5 * n, c > 1)return null;
                switch (c = 2 * Math.asin(c), (this.mode === this.OBLIQ || this.mode === this.EQUIT) && (p = Math.sin(c), o = Math.cos(c)), this.mode) {
                    case this.EQUIT:
                        c = Math.abs(n) <= f ? 0 : Math.asin(m * p / n), l *= p, m = o * n;
                        break;
                    case this.OBLIQ:
                        c = Math.abs(n) <= f ? this.phi0 : Math.asin(o * this.sinph0 + m * p * this.cosph0 / n), l *= p * this.cosph0, m = (o - Math.sin(c) * this.sinph0) * n;
                        break;
                    case this.N_POLE:
                        m = -m, c = d - c;
                        break;
                    case this.S_POLE:
                        c -= d
                }
                b = 0 !== m || this.mode !== this.EQUIT && this.mode !== this.OBLIQ ? Math.atan2(l, m) : 0
            } else {
                if (k = 0, this.mode === this.OBLIQ || this.mode === this.EQUIT) {
                    if (l /= this.dd, m *= this.dd, j = Math.sqrt(l * l + m * m), f > j)return a.x = 0, a.y = this.phi0, a;
                    g = 2 * Math.asin(.5 * j / this.rq), e = Math.cos(g), l *= g = Math.sin(g), this.mode === this.OBLIQ ? (k = e * this.sinb1 + m * g * this.cosb1 / j, i = this.qp * k, m = j * this.cosb1 * e - m * this.sinb1 * g) : (k = m * g / j, i = this.qp * k, m = j * e)
                } else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {
                    if (this.mode === this.N_POLE && (m = -m), i = l * l + m * m, !i)return a.x = 0, a.y = this.phi0, a;
                    k = 1 - i / this.qp, this.mode === this.S_POLE && (k = -k)
                }
                b = Math.atan2(l, m), c = this.authlat(Math.asin(k), this.apa)
            }
            return a.x = h(this.long0 + b), a.y = c, a
        }, c.P00 = .3333333333333333, c.P01 = .17222222222222222, c.P02 = .10257936507936508, c.P10 = .06388888888888888, c.P11 = .0664021164021164, c.P20 = .016415012942191543, c.authset = function (a) {
            var b, c = [];
            return c[0] = a * this.P00, b = a * a, c[0] += b * this.P01, c[1] = b * this.P10, b *= a, c[0] += b * this.P02, c[1] += b * this.P11, c[2] = b * this.P20, c
        }, c.authlat = function (a, b) {
            var c = a + a;
            return a + b[0] * Math.sin(c) + b[1] * Math.sin(c + c) + b[2] * Math.sin(c + c + c)
        }, c.names = ["Lambert Azimuthal Equal Area", "Lambert_Azimuthal_Equal_Area", "laea"]
    }, {"../common/adjust_lon": 5, "../common/qsfnz": 20}], 47: [function (a, b, c) {
        var d = 1e-10, e = a("../common/msfnz"), f = a("../common/tsfnz"), g = Math.PI / 2, h = a("../common/sign"), i = a("../common/adjust_lon"), j = a("../common/phi2z");
        c.init = function () {
            if (this.lat2 || (this.lat2 = this.lat1), this.k0 || (this.k0 = 1), !(Math.abs(this.lat1 + this.lat2) < d)) {
                var a = this.b / this.a;
                this.e = Math.sqrt(1 - a * a);
                var b = Math.sin(this.lat1), c = Math.cos(this.lat1), g = e(this.e, b, c), h = f(this.e, this.lat1, b), i = Math.sin(this.lat2), j = Math.cos(this.lat2), k = e(this.e, i, j), l = f(this.e, this.lat2, i), m = f(this.e, this.lat0, Math.sin(this.lat0));
                this.ns = Math.abs(this.lat1 - this.lat2) > d ? Math.log(g / k) / Math.log(h / l) : b, isNaN(this.ns) && (this.ns = b), this.f0 = g / (this.ns * Math.pow(h, this.ns)), this.rh = this.a * this.f0 * Math.pow(m, this.ns), this.title || (this.title = "Lambert Conformal Conic")
            }
        }, c.forward = function (a) {
            var b = a.x, c = a.y;
            Math.abs(2 * Math.abs(c) - Math.PI) <= d && (c = h(c) * (g - 2 * d));
            var e, j, k = Math.abs(Math.abs(c) - g);
            if (k > d)e = f(this.e, c, Math.sin(c)), j = this.a * this.f0 * Math.pow(e, this.ns); else {
                if (k = c * this.ns, 0 >= k)return null;
                j = 0
            }
            var l = this.ns * i(b - this.long0);
            return a.x = this.k0 * j * Math.sin(l) + this.x0, a.y = this.k0 * (this.rh - j * Math.cos(l)) + this.y0, a
        }, c.inverse = function (a) {
            var b, c, d, e, f, h = (a.x - this.x0) / this.k0, k = this.rh - (a.y - this.y0) / this.k0;
            this.ns > 0 ? (b = Math.sqrt(h * h + k * k), c = 1) : (b = -Math.sqrt(h * h + k * k), c = -1);
            var l = 0;
            if (0 !== b && (l = Math.atan2(c * h, c * k)), 0 !== b || this.ns > 0) {
                if (c = 1 / this.ns, d = Math.pow(b / (this.a * this.f0), c), e = j(this.e, d), -9999 === e)return null
            } else e = -g;
            return f = i(l / this.ns + this.long0), a.x = f, a.y = e, a
        }, c.names = ["Lambert Tangential Conformal Conic Projection", "Lambert_Conformal_Conic", "Lambert_Conformal_Conic_2SP", "lcc"]
    }, {"../common/adjust_lon": 5, "../common/msfnz": 15, "../common/phi2z": 16, "../common/sign": 21, "../common/tsfnz": 23}], 48: [function (a, b, c) {
        function d(a) {
            return a
        }

        c.init = function () {
        }, c.forward = d, c.inverse = d, c.names = ["longlat", "identity"]
    }, {}], 49: [function (a, b, c) {
        var d = a("../common/msfnz"), e = Math.PI / 2, f = 1e-10, g = 57.29577951308232, h = a("../common/adjust_lon"), i = Math.PI / 4, j = a("../common/tsfnz"), k = a("../common/phi2z");
        c.init = function () {
            var a = this.b / this.a;
            this.es = 1 - a * a, this.e = Math.sqrt(this.es), this.lat_ts ? this.k0 = this.sphere ? Math.cos(this.lat_ts) : d(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)) : this.k0 || (this.k0 = this.k ? this.k : 1)
        }, c.forward = function (a) {
            var b = a.x, c = a.y;
            if (c * g > 90 && -90 > c * g && b * g > 180 && -180 > b * g)return null;
            var d, k;
            if (Math.abs(Math.abs(c) - e) <= f)return null;
            if (this.sphere)d = this.x0 + this.a * this.k0 * h(b - this.long0), k = this.y0 + this.a * this.k0 * Math.log(Math.tan(i + .5 * c)); else {
                var l = Math.sin(c), m = j(this.e, c, l);
                d = this.x0 + this.a * this.k0 * h(b - this.long0), k = this.y0 - this.a * this.k0 * Math.log(m)
            }
            return a.x = d, a.y = k, a
        }, c.inverse = function (a) {
            var b, c, d = a.x - this.x0, f = a.y - this.y0;
            if (this.sphere)c = e - 2 * Math.atan(Math.exp(-f / (this.a * this.k0))); else {
                var g = Math.exp(-f / (this.a * this.k0));
                if (c = k(this.e, g), -9999 === c)return null
            }
            return b = h(this.long0 + d / (this.a * this.k0)), a.x = b, a.y = c, a
        }, c.names = ["Mercator", "Popular Visualisation Pseudo Mercator", "Mercator_1SP", "Mercator_Auxiliary_Sphere", "merc"]
    }, {"../common/adjust_lon": 5, "../common/msfnz": 15, "../common/phi2z": 16, "../common/tsfnz": 23}], 50: [function (a, b, c) {
        var d = a("../common/adjust_lon");
        c.init = function () {
        }, c.forward = function (a) {
            var b = a.x, c = a.y, e = d(b - this.long0), f = this.x0 + this.a * e, g = this.y0 + this.a * Math.log(Math.tan(Math.PI / 4 + c / 2.5)) * 1.25;
            return a.x = f, a.y = g, a
        }, c.inverse = function (a) {
            a.x -= this.x0, a.y -= this.y0;
            var b = d(this.long0 + a.x / this.a), c = 2.5 * (Math.atan(Math.exp(.8 * a.y / this.a)) - Math.PI / 4);
            return a.x = b, a.y = c, a
        }, c.names = ["Miller_Cylindrical", "mill"]
    }, {"../common/adjust_lon": 5}], 51: [function (a, b, c) {
        var d = a("../common/adjust_lon"), e = 1e-10;
        c.init = function () {
        }, c.forward = function (a) {
            for (var b = a.x, c = a.y, f = d(b - this.long0), g = c, h = Math.PI * Math.sin(c), i = 0; !0; i++) {
                var j = -(g + Math.sin(g) - h) / (1 + Math.cos(g));
                if (g += j, Math.abs(j) < e)break
            }
            g /= 2, Math.PI / 2 - Math.abs(c) < e && (f = 0);
            var k = .900316316158 * this.a * f * Math.cos(g) + this.x0, l = 1.4142135623731 * this.a * Math.sin(g) + this.y0;
            return a.x = k, a.y = l, a
        }, c.inverse = function (a) {
            var b, c;
            a.x -= this.x0, a.y -= this.y0, c = a.y / (1.4142135623731 * this.a), Math.abs(c) > .999999999999 && (c = .999999999999), b = Math.asin(c);
            var e = d(this.long0 + a.x / (.900316316158 * this.a * Math.cos(b)));
            e < -Math.PI && (e = -Math.PI), e > Math.PI && (e = Math.PI), c = (2 * b + Math.sin(2 * b)) / Math.PI, Math.abs(c) > 1 && (c = 1);
            var f = Math.asin(c);
            return a.x = e, a.y = f, a
        }, c.names = ["Mollweide", "moll"]
    }, {"../common/adjust_lon": 5}], 52: [function (a, b, c) {
        var d = 484813681109536e-20;
        c.iterations = 1, c.init = function () {
            this.A = [], this.A[1] = .6399175073, this.A[2] = -.1358797613, this.A[3] = .063294409, this.A[4] = -.02526853, this.A[5] = .0117879, this.A[6] = -.0055161, this.A[7] = .0026906, this.A[8] = -.001333, this.A[9] = 67e-5, this.A[10] = -34e-5, this.B_re = [], this.B_im = [], this.B_re[1] = .7557853228, this.B_im[1] = 0, this.B_re[2] = .249204646, this.B_im[2] = .003371507, this.B_re[3] = -.001541739, this.B_im[3] = .04105856, this.B_re[4] = -.10162907, this.B_im[4] = .01727609, this.B_re[5] = -.26623489, this.B_im[5] = -.36249218, this.B_re[6] = -.6870983, this.B_im[6] = -1.1651967, this.C_re = [], this.C_im = [], this.C_re[1] = 1.3231270439, this.C_im[1] = 0, this.C_re[2] = -.577245789, this.C_im[2] = -.007809598, this.C_re[3] = .508307513, this.C_im[3] = -.112208952, this.C_re[4] = -.15094762, this.C_im[4] = .18200602, this.C_re[5] = 1.01418179, this.C_im[5] = 1.64497696, this.C_re[6] = 1.9660549, this.C_im[6] = 2.5127645, this.D = [], this.D[1] = 1.5627014243, this.D[2] = .5185406398, this.D[3] = -.03333098, this.D[4] = -.1052906, this.D[5] = -.0368594, this.D[6] = .007317, this.D[7] = .0122, this.D[8] = .00394, this.D[9] = -.0013
        }, c.forward = function (a) {
            var b, c = a.x, e = a.y, f = e - this.lat0, g = c - this.long0, h = f / d * 1e-5, i = g, j = 1, k = 0;
            for (b = 1; 10 >= b; b++)j *= h, k += this.A[b] * j;
            var l, m, n = k, o = i, p = 1, q = 0, r = 0, s = 0;
            for (b = 1; 6 >= b; b++)l = p * n - q * o, m = q * n + p * o, p = l, q = m, r = r + this.B_re[b] * p - this.B_im[b] * q, s = s + this.B_im[b] * p + this.B_re[b] * q;
            return a.x = s * this.a + this.x0, a.y = r * this.a + this.y0, a
        }, c.inverse = function (a) {
            var b, c, e, f = a.x, g = a.y, h = f - this.x0, i = g - this.y0, j = i / this.a, k = h / this.a, l = 1, m = 0, n = 0, o = 0;
            for (b = 1; 6 >= b; b++)c = l * j - m * k, e = m * j + l * k, l = c, m = e, n = n + this.C_re[b] * l - this.C_im[b] * m, o = o + this.C_im[b] * l + this.C_re[b] * m;
            for (var p = 0; p < this.iterations; p++) {
                var q, r, s = n, t = o, u = j, v = k;
                for (b = 2; 6 >= b; b++)q = s * n - t * o, r = t * n + s * o, s = q, t = r, u += (b - 1) * (this.B_re[b] * s - this.B_im[b] * t), v += (b - 1) * (this.B_im[b] * s + this.B_re[b] * t);
                s = 1, t = 0;
                var w = this.B_re[1], x = this.B_im[1];
                for (b = 2; 6 >= b; b++)q = s * n - t * o, r = t * n + s * o, s = q, t = r, w += b * (this.B_re[b] * s - this.B_im[b] * t), x += b * (this.B_im[b] * s + this.B_re[b] * t);
                var y = w * w + x * x;
                n = (u * w + v * x) / y, o = (v * w - u * x) / y
            }
            var z = n, A = o, B = 1, C = 0;
            for (b = 1; 9 >= b; b++)B *= z, C += this.D[b] * B;
            var D = this.lat0 + C * d * 1e5, E = this.long0 + A;
            return a.x = E, a.y = D, a
        }, c.names = ["New_Zealand_Map_Grid", "nzmg"]
    }, {}], 53: [function (a, b, c) {
        var d = a("../common/tsfnz"), e = a("../common/adjust_lon"), f = a("../common/phi2z"), g = Math.PI / 2, h = Math.PI / 4, i = 1e-10;
        c.init = function () {
            this.no_off = this.no_off || !1, this.no_rot = this.no_rot || !1, isNaN(this.k0) && (this.k0 = 1);
            var a = Math.sin(this.lat0), b = Math.cos(this.lat0), c = this.e * a;
            this.bl = Math.sqrt(1 + this.es / (1 - this.es) * Math.pow(b, 4)), this.al = this.a * this.bl * this.k0 * Math.sqrt(1 - this.es) / (1 - c * c);
            var f = d(this.e, this.lat0, a), g = this.bl / b * Math.sqrt((1 - this.es) / (1 - c * c));
            1 > g * g && (g = 1);
            var h, i;
            if (isNaN(this.longc)) {
                var j = d(this.e, this.lat1, Math.sin(this.lat1)), k = d(this.e, this.lat2, Math.sin(this.lat2));
                this.el = this.lat0 >= 0 ? (g + Math.sqrt(g * g - 1)) * Math.pow(f, this.bl) : (g - Math.sqrt(g * g - 1)) * Math.pow(f, this.bl);
                var l = Math.pow(j, this.bl), m = Math.pow(k, this.bl);
                h = this.el / l, i = .5 * (h - 1 / h);
                var n = (this.el * this.el - m * l) / (this.el * this.el + m * l), o = (m - l) / (m + l), p = e(this.long1 - this.long2);
                this.long0 = .5 * (this.long1 + this.long2) - Math.atan(n * Math.tan(.5 * this.bl * p) / o) / this.bl, this.long0 = e(this.long0);
                var q = e(this.long1 - this.long0);
                this.gamma0 = Math.atan(Math.sin(this.bl * q) / i), this.alpha = Math.asin(g * Math.sin(this.gamma0))
            } else h = this.lat0 >= 0 ? g + Math.sqrt(g * g - 1) : g - Math.sqrt(g * g - 1), this.el = h * Math.pow(f, this.bl), i = .5 * (h - 1 / h), this.gamma0 = Math.asin(Math.sin(this.alpha) / g), this.long0 = this.longc - Math.asin(i * Math.tan(this.gamma0)) / this.bl;
            this.uc = this.no_off ? 0 : this.lat0 >= 0 ? this.al / this.bl * Math.atan2(Math.sqrt(g * g - 1), Math.cos(this.alpha)) : -1 * this.al / this.bl * Math.atan2(Math.sqrt(g * g - 1), Math.cos(this.alpha))
        }, c.forward = function (a) {
            var b, c, f, j = a.x, k = a.y, l = e(j - this.long0);
            if (Math.abs(Math.abs(k) - g) <= i)f = k > 0 ? -1 : 1, c = this.al / this.bl * Math.log(Math.tan(h + f * this.gamma0 * .5)), b = -1 * f * g * this.al / this.bl; else {
                var m = d(this.e, k, Math.sin(k)), n = this.el / Math.pow(m, this.bl), o = .5 * (n - 1 / n), p = .5 * (n + 1 / n), q = Math.sin(this.bl * l), r = (o * Math.sin(this.gamma0) - q * Math.cos(this.gamma0)) / p;
                c = Math.abs(Math.abs(r) - 1) <= i ? Number.POSITIVE_INFINITY : .5 * this.al * Math.log((1 - r) / (1 + r)) / this.bl, b = Math.abs(Math.cos(this.bl * l)) <= i ? this.al * this.bl * l : this.al * Math.atan2(o * Math.cos(this.gamma0) + q * Math.sin(this.gamma0), Math.cos(this.bl * l)) / this.bl
            }
            return this.no_rot ? (a.x = this.x0 + b, a.y = this.y0 + c) : (b -= this.uc, a.x = this.x0 + c * Math.cos(this.alpha) + b * Math.sin(this.alpha), a.y = this.y0 + b * Math.cos(this.alpha) - c * Math.sin(this.alpha)), a
        }, c.inverse = function (a) {
            var b, c;
            this.no_rot ? (c = a.y - this.y0, b = a.x - this.x0) : (c = (a.x - this.x0) * Math.cos(this.alpha) - (a.y - this.y0) * Math.sin(this.alpha), b = (a.y - this.y0) * Math.cos(this.alpha) + (a.x - this.x0) * Math.sin(this.alpha), b += this.uc);
            var d = Math.exp(-1 * this.bl * c / this.al), h = .5 * (d - 1 / d), j = .5 * (d + 1 / d), k = Math.sin(this.bl * b / this.al), l = (k * Math.cos(this.gamma0) + h * Math.sin(this.gamma0)) / j, m = Math.pow(this.el / Math.sqrt((1 + l) / (1 - l)), 1 / this.bl);
            return Math.abs(l - 1) < i ? (a.x = this.long0, a.y = g) : Math.abs(l + 1) < i ? (a.x = this.long0, a.y = -1 * g) : (a.y = f(this.e, m), a.x = e(this.long0 - Math.atan2(h * Math.cos(this.gamma0) - k * Math.sin(this.gamma0), Math.cos(this.bl * b / this.al)) / this.bl)), a
        }, c.names = ["Hotine_Oblique_Mercator", "Hotine Oblique Mercator", "Hotine_Oblique_Mercator_Azimuth_Natural_Origin", "Hotine_Oblique_Mercator_Azimuth_Center", "omerc"]
    }, {"../common/adjust_lon": 5, "../common/phi2z": 16, "../common/tsfnz": 23}], 54: [function (a, b, c) {
        var d = a("../common/e0fn"), e = a("../common/e1fn"), f = a("../common/e2fn"), g = a("../common/e3fn"), h = a("../common/adjust_lon"), i = a("../common/adjust_lat"), j = a("../common/mlfn"), k = 1e-10, l = a("../common/gN"), m = 20;
        c.init = function () {
            this.temp = this.b / this.a, this.es = 1 - Math.pow(this.temp, 2), this.e = Math.sqrt(this.es), this.e0 = d(this.es), this.e1 = e(this.es), this.e2 = f(this.es), this.e3 = g(this.es), this.ml0 = this.a * j(this.e0, this.e1, this.e2, this.e3, this.lat0)
        }, c.forward = function (a) {
            var b, c, d, e = a.x, f = a.y, g = h(e - this.long0);
            if (d = g * Math.sin(f), this.sphere)Math.abs(f) <= k ? (b = this.a * g, c = -1 * this.a * this.lat0) : (b = this.a * Math.sin(d) / Math.tan(f), c = this.a * (i(f - this.lat0) + (1 - Math.cos(d)) / Math.tan(f))); else if (Math.abs(f) <= k)b = this.a * g, c = -1 * this.ml0; else {
                var m = l(this.a, this.e, Math.sin(f)) / Math.tan(f);
                b = m * Math.sin(d), c = this.a * j(this.e0, this.e1, this.e2, this.e3, f) - this.ml0 + m * (1 - Math.cos(d))
            }
            return a.x = b + this.x0, a.y = c + this.y0, a
        }, c.inverse = function (a) {
            var b, c, d, e, f, g, i, l, n;
            if (d = a.x - this.x0, e = a.y - this.y0, this.sphere)if (Math.abs(e + this.a * this.lat0) <= k)b = h(d / this.a + this.long0), c = 0; else {
                g = this.lat0 + e / this.a, i = d * d / this.a / this.a + g * g, l = g;
                var o;
                for (f = m; f; --f)if (o = Math.tan(l), n = -1 * (g * (l * o + 1) - l - .5 * (l * l + i) * o) / ((l - g) / o - 1), l += n, Math.abs(n) <= k) {
                    c = l;
                    break
                }
                b = h(this.long0 + Math.asin(d * Math.tan(l) / this.a) / Math.sin(c))
            } else if (Math.abs(e + this.ml0) <= k)c = 0, b = h(this.long0 + d / this.a); else {
                g = (this.ml0 + e) / this.a, i = d * d / this.a / this.a + g * g, l = g;
                var p, q, r, s, t;
                for (f = m; f; --f)if (t = this.e * Math.sin(l), p = Math.sqrt(1 - t * t) * Math.tan(l), q = this.a * j(this.e0, this.e1, this.e2, this.e3, l), r = this.e0 - 2 * this.e1 * Math.cos(2 * l) + 4 * this.e2 * Math.cos(4 * l) - 6 * this.e3 * Math.cos(6 * l), s = q / this.a, n = (g * (p * s + 1) - s - .5 * p * (s * s + i)) / (this.es * Math.sin(2 * l) * (s * s + i - 2 * g * s) / (4 * p) + (g - s) * (p * r - 2 / Math.sin(2 * l)) - r), l -= n, Math.abs(n) <= k) {
                    c = l;
                    break
                }
                p = Math.sqrt(1 - this.es * Math.pow(Math.sin(c), 2)) * Math.tan(c), b = h(this.long0 + Math.asin(d * p / this.a) / Math.sin(c))
            }
            return a.x = b, a.y = c, a
        }, c.names = ["Polyconic", "poly"]
    }, {"../common/adjust_lat": 4, "../common/adjust_lon": 5, "../common/e0fn": 7, "../common/e1fn": 8, "../common/e2fn": 9, "../common/e3fn": 10, "../common/gN": 11, "../common/mlfn": 14}], 55: [function (a, b, c) {
        var d = a("../common/adjust_lon"), e = a("../common/adjust_lat"), f = a("../common/pj_enfn"), g = 20, h = a("../common/pj_mlfn"), i = a("../common/pj_inv_mlfn"), j = Math.PI / 2, k = 1e-10, l = a("../common/asinz");
        c.init = function () {
            this.sphere ? (this.n = 1, this.m = 0, this.es = 0, this.C_y = Math.sqrt((this.m + 1) / this.n), this.C_x = this.C_y / (this.m + 1)) : this.en = f(this.es)
        }, c.forward = function (a) {
            var b, c, e = a.x, f = a.y;
            if (e = d(e - this.long0), this.sphere) {
                if (this.m)for (var i = this.n * Math.sin(f), j = g; j; --j) {
                    var l = (this.m * f + Math.sin(f) - i) / (this.m + Math.cos(f));
                    if (f -= l, Math.abs(l) < k)break
                } else f = 1 !== this.n ? Math.asin(this.n * Math.sin(f)) : f;
                b = this.a * this.C_x * e * (this.m + Math.cos(f)), c = this.a * this.C_y * f
            } else {
                var m = Math.sin(f), n = Math.cos(f);
                c = this.a * h(f, m, n, this.en), b = this.a * e * n / Math.sqrt(1 - this.es * m * m)
            }
            return a.x = b, a.y = c, a
        }, c.inverse = function (a) {
            var b, c, f, g;
            return a.x -= this.x0, f = a.x / this.a, a.y -= this.y0, b = a.y / this.a, this.sphere ? (b /= this.C_y, f /= this.C_x * (this.m + Math.cos(b)), this.m ? b = l((this.m * b + Math.sin(b)) / this.n) : 1 !== this.n && (b = l(Math.sin(b) / this.n)), f = d(f + this.long0), b = e(b)) : (b = i(a.y / this.a, this.es, this.en), g = Math.abs(b), j > g ? (g = Math.sin(b), c = this.long0 + a.x * Math.sqrt(1 - this.es * g * g) / (this.a * Math.cos(b)), f = d(c)) : j > g - k && (f = this.long0)), a.x = f, a.y = b, a
        }, c.names = ["Sinusoidal", "sinu"]
    }, {"../common/adjust_lat": 4, "../common/adjust_lon": 5, "../common/asinz": 6, "../common/pj_enfn": 17, "../common/pj_inv_mlfn": 18, "../common/pj_mlfn": 19}], 56: [function (a, b, c) {
        c.init = function () {
            var a = this.lat0;
            this.lambda0 = this.long0;
            var b = Math.sin(a), c = this.a, d = this.rf, e = 1 / d, f = 2 * e - Math.pow(e, 2), g = this.e = Math.sqrt(f);
            this.R = this.k0 * c * Math.sqrt(1 - f) / (1 - f * Math.pow(b, 2)), this.alpha = Math.sqrt(1 + f / (1 - f) * Math.pow(Math.cos(a), 4)), this.b0 = Math.asin(b / this.alpha);
            var h = Math.log(Math.tan(Math.PI / 4 + this.b0 / 2)), i = Math.log(Math.tan(Math.PI / 4 + a / 2)), j = Math.log((1 + g * b) / (1 - g * b));
            this.K = h - this.alpha * i + this.alpha * g / 2 * j
        }, c.forward = function (a) {
            var b = Math.log(Math.tan(Math.PI / 4 - a.y / 2)), c = this.e / 2 * Math.log((1 + this.e * Math.sin(a.y)) / (1 - this.e * Math.sin(a.y))), d = -this.alpha * (b + c) + this.K, e = 2 * (Math.atan(Math.exp(d)) - Math.PI / 4), f = this.alpha * (a.x - this.lambda0), g = Math.atan(Math.sin(f) / (Math.sin(this.b0) * Math.tan(e) + Math.cos(this.b0) * Math.cos(f))), h = Math.asin(Math.cos(this.b0) * Math.sin(e) - Math.sin(this.b0) * Math.cos(e) * Math.cos(f));
            return a.y = this.R / 2 * Math.log((1 + Math.sin(h)) / (1 - Math.sin(h))) + this.y0, a.x = this.R * g + this.x0, a
        }, c.inverse = function (a) {
            for (var b = a.x - this.x0, c = a.y - this.y0, d = b / this.R, e = 2 * (Math.atan(Math.exp(c / this.R)) - Math.PI / 4), f = Math.asin(Math.cos(this.b0) * Math.sin(e) + Math.sin(this.b0) * Math.cos(e) * Math.cos(d)), g = Math.atan(Math.sin(d) / (Math.cos(this.b0) * Math.cos(d) - Math.sin(this.b0) * Math.tan(e))), h = this.lambda0 + g / this.alpha, i = 0, j = f, k = -1e3, l = 0; Math.abs(j - k) > 1e-7;) {
                if (++l > 20)return;
                i = 1 / this.alpha * (Math.log(Math.tan(Math.PI / 4 + f / 2)) - this.K) + this.e * Math.log(Math.tan(Math.PI / 4 + Math.asin(this.e * Math.sin(j)) / 2)), k = j, j = 2 * Math.atan(Math.exp(i)) - Math.PI / 2
            }
            return a.x = h, a.y = j, a
        }, c.names = ["somerc"]
    }, {}], 57: [function (a, b, c) {
        var d = Math.PI / 2, e = 1e-10, f = a("../common/sign"), g = a("../common/msfnz"), h = a("../common/tsfnz"), i = a("../common/phi2z"), j = a("../common/adjust_lon");
        c.ssfn_ = function (a, b, c) {
            return b *= c, Math.tan(.5 * (d + a)) * Math.pow((1 - b) / (1 + b), .5 * c)
        }, c.init = function () {
            this.coslat0 = Math.cos(this.lat0), this.sinlat0 = Math.sin(this.lat0), this.sphere ? 1 === this.k0 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= e && (this.k0 = .5 * (1 + f(this.lat0) * Math.sin(this.lat_ts))) : (Math.abs(this.coslat0) <= e && (this.con = this.lat0 > 0 ? 1 : -1), this.cons = Math.sqrt(Math.pow(1 + this.e, 1 + this.e) * Math.pow(1 - this.e, 1 - this.e)), 1 === this.k0 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= e && (this.k0 = .5 * this.cons * g(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)) / h(this.e, this.con * this.lat_ts, this.con * Math.sin(this.lat_ts))), this.ms1 = g(this.e, this.sinlat0, this.coslat0), this.X0 = 2 * Math.atan(this.ssfn_(this.lat0, this.sinlat0, this.e)) - d, this.cosX0 = Math.cos(this.X0), this.sinX0 = Math.sin(this.X0))
        }, c.forward = function (a) {
            var b, c, f, g, i, k, l = a.x, m = a.y, n = Math.sin(m), o = Math.cos(m), p = j(l - this.long0);
            return Math.abs(Math.abs(l - this.long0) - Math.PI) <= e && Math.abs(m + this.lat0) <= e ? (a.x = 0 / 0, a.y = 0 / 0, a) : this.sphere ? (b = 2 * this.k0 / (1 + this.sinlat0 * n + this.coslat0 * o * Math.cos(p)), a.x = this.a * b * o * Math.sin(p) + this.x0, a.y = this.a * b * (this.coslat0 * n - this.sinlat0 * o * Math.cos(p)) + this.y0, a) : (c = 2 * Math.atan(this.ssfn_(m, n, this.e)) - d, g = Math.cos(c), f = Math.sin(c), Math.abs(this.coslat0) <= e ? (i = h(this.e, m * this.con, this.con * n), k = 2 * this.a * this.k0 * i / this.cons, a.x = this.x0 + k * Math.sin(l - this.long0), a.y = this.y0 - this.con * k * Math.cos(l - this.long0), a) : (Math.abs(this.sinlat0) < e ? (b = 2 * this.a * this.k0 / (1 + g * Math.cos(p)), a.y = b * f) : (b = 2 * this.a * this.k0 * this.ms1 / (this.cosX0 * (1 + this.sinX0 * f + this.cosX0 * g * Math.cos(p))), a.y = b * (this.cosX0 * f - this.sinX0 * g * Math.cos(p)) + this.y0), a.x = b * g * Math.sin(p) + this.x0, a))
        }, c.inverse = function (a) {
            a.x -= this.x0, a.y -= this.y0;
            var b, c, f, g, h, k = Math.sqrt(a.x * a.x + a.y * a.y);
            if (this.sphere) {
                var l = 2 * Math.atan(k / (.5 * this.a * this.k0));
                return b = this.long0, c = this.lat0, e >= k ? (a.x = b, a.y = c, a) : (c = Math.asin(Math.cos(l) * this.sinlat0 + a.y * Math.sin(l) * this.coslat0 / k), b = j(Math.abs(this.coslat0) < e ? this.lat0 > 0 ? this.long0 + Math.atan2(a.x, -1 * a.y) : this.long0 + Math.atan2(a.x, a.y) : this.long0 + Math.atan2(a.x * Math.sin(l), k * this.coslat0 * Math.cos(l) - a.y * this.sinlat0 * Math.sin(l))), a.x = b, a.y = c, a)
            }
            if (Math.abs(this.coslat0) <= e) {
                if (e >= k)return c = this.lat0, b = this.long0, a.x = b, a.y = c, a;
                a.x *= this.con, a.y *= this.con, f = k * this.cons / (2 * this.a * this.k0), c = this.con * i(this.e, f), b = this.con * j(this.con * this.long0 + Math.atan2(a.x, -1 * a.y))
            } else g = 2 * Math.atan(k * this.cosX0 / (2 * this.a * this.k0 * this.ms1)), b = this.long0, e >= k ? h = this.X0 : (h = Math.asin(Math.cos(g) * this.sinX0 + a.y * Math.sin(g) * this.cosX0 / k), b = j(this.long0 + Math.atan2(a.x * Math.sin(g), k * this.cosX0 * Math.cos(g) - a.y * this.sinX0 * Math.sin(g)))), c = -1 * i(this.e, Math.tan(.5 * (d + h)));
            return a.x = b, a.y = c, a
        }, c.names = ["stere"]
    }, {"../common/adjust_lon": 5, "../common/msfnz": 15, "../common/phi2z": 16, "../common/sign": 21, "../common/tsfnz": 23}], 58: [function (a, b, c) {
        var d = a("./gauss"), e = a("../common/adjust_lon");
        c.init = function () {
            d.init.apply(this), this.rc && (this.sinc0 = Math.sin(this.phic0), this.cosc0 = Math.cos(this.phic0), this.R2 = 2 * this.rc, this.title || (this.title = "Oblique Stereographic Alternative"))
        }, c.forward = function (a) {
            var b, c, f, g;
            return a.x = e(a.x - this.long0), d.forward.apply(this, [a]), b = Math.sin(a.y), c = Math.cos(a.y), f = Math.cos(a.x), g = this.k0 * this.R2 / (1 + this.sinc0 * b + this.cosc0 * c * f), a.x = g * c * Math.sin(a.x), a.y = g * (this.cosc0 * b - this.sinc0 * c * f), a.x = this.a * a.x + this.x0, a.y = this.a * a.y + this.y0, a
        }, c.inverse = function (a) {
            var b, c, f, g, h;
            if (a.x = (a.x - this.x0) / this.a, a.y = (a.y - this.y0) / this.a, a.x /= this.k0, a.y /= this.k0, h = Math.sqrt(a.x * a.x + a.y * a.y)) {
                var i = 2 * Math.atan2(h, this.R2);
                b = Math.sin(i), c = Math.cos(i), g = Math.asin(c * this.sinc0 + a.y * b * this.cosc0 / h), f = Math.atan2(a.x * b, h * this.cosc0 * c - a.y * this.sinc0 * b)
            } else g = this.phic0, f = 0;
            return a.x = f, a.y = g, d.inverse.apply(this, [a]), a.x = e(a.x + this.long0), a
        }, c.names = ["Stereographic_North_Pole", "Oblique_Stereographic", "Polar_Stereographic", "sterea", "Oblique Stereographic Alternative"]
    }, {"../common/adjust_lon": 5, "./gauss": 42}], 59: [function (a, b, c) {
        var d = a("../common/e0fn"), e = a("../common/e1fn"), f = a("../common/e2fn"), g = a("../common/e3fn"), h = a("../common/mlfn"), i = a("../common/adjust_lon"), j = Math.PI / 2, k = 1e-10, l = a("../common/sign"), m = a("../common/asinz");
        c.init = function () {
            this.e0 = d(this.es), this.e1 = e(this.es), this.e2 = f(this.es), this.e3 = g(this.es), this.ml0 = this.a * h(this.e0, this.e1, this.e2, this.e3, this.lat0)
        }, c.forward = function (a) {
            var b, c, d, e = a.x, f = a.y, g = i(e - this.long0), j = Math.sin(f), k = Math.cos(f);
            if (this.sphere) {
                var l = k * Math.sin(g);
                if (Math.abs(Math.abs(l) - 1) < 1e-10)return 93;
                c = .5 * this.a * this.k0 * Math.log((1 + l) / (1 - l)), b = Math.acos(k * Math.cos(g) / Math.sqrt(1 - l * l)), 0 > f && (b = -b), d = this.a * this.k0 * (b - this.lat0)
            } else {
                var m = k * g, n = Math.pow(m, 2), o = this.ep2 * Math.pow(k, 2), p = Math.tan(f), q = Math.pow(p, 2);
                b = 1 - this.es * Math.pow(j, 2);
                var r = this.a / Math.sqrt(b), s = this.a * h(this.e0, this.e1, this.e2, this.e3, f);
                c = this.k0 * r * m * (1 + n / 6 * (1 - q + o + n / 20 * (5 - 18 * q + Math.pow(q, 2) + 72 * o - 58 * this.ep2))) + this.x0, d = this.k0 * (s - this.ml0 + r * p * n * (.5 + n / 24 * (5 - q + 9 * o + 4 * Math.pow(o, 2) + n / 30 * (61 - 58 * q + Math.pow(q, 2) + 600 * o - 330 * this.ep2)))) + this.y0
            }
            return a.x = c, a.y = d, a
        }, c.inverse = function (a) {
            var b, c, d, e, f, g, h = 6;
            if (this.sphere) {
                var n = Math.exp(a.x / (this.a * this.k0)), o = .5 * (n - 1 / n), p = this.lat0 + a.y / (this.a * this.k0), q = Math.cos(p);
                b = Math.sqrt((1 - q * q) / (1 + o * o)), f = m(b), 0 > p && (f = -f), g = 0 === o && 0 === q ? this.long0 : i(Math.atan2(o, q) + this.long0)
            } else {
                var r = a.x - this.x0, s = a.y - this.y0;
                for (b = (this.ml0 + s / this.k0) / this.a, c = b, e = 0; d = (b + this.e1 * Math.sin(2 * c) - this.e2 * Math.sin(4 * c) + this.e3 * Math.sin(6 * c)) / this.e0 - c, c += d, !(Math.abs(d) <= k); e++)if (e >= h)return 95;
                if (Math.abs(c) < j) {
                    var t = Math.sin(c), u = Math.cos(c), v = Math.tan(c), w = this.ep2 * Math.pow(u, 2), x = Math.pow(w, 2), y = Math.pow(v, 2), z = Math.pow(y, 2);
                    b = 1 - this.es * Math.pow(t, 2);
                    var A = this.a / Math.sqrt(b), B = A * (1 - this.es) / b, C = r / (A * this.k0), D = Math.pow(C, 2);
                    f = c - A * v * D / B * (.5 - D / 24 * (5 + 3 * y + 10 * w - 4 * x - 9 * this.ep2 - D / 30 * (61 + 90 * y + 298 * w + 45 * z - 252 * this.ep2 - 3 * x))), g = i(this.long0 + C * (1 - D / 6 * (1 + 2 * y + w - D / 20 * (5 - 2 * w + 28 * y - 3 * x + 8 * this.ep2 + 24 * z))) / u)
                } else f = j * l(s), g = this.long0
            }
            return a.x = g, a.y = f, a
        }, c.names = ["Transverse_Mercator", "Transverse Mercator", "tmerc"]
    }, {"../common/adjust_lon": 5, "../common/asinz": 6, "../common/e0fn": 7, "../common/e1fn": 8, "../common/e2fn": 9, "../common/e3fn": 10, "../common/mlfn": 14, "../common/sign": 21}], 60: [function (a, b, c) {
        var d = .017453292519943295, e = a("./tmerc");
        c.dependsOn = "tmerc", c.init = function () {
            this.zone && (this.lat0 = 0, this.long0 = (6 * Math.abs(this.zone) - 183) * d, this.x0 = 5e5, this.y0 = this.utmSouth ? 1e7 : 0, this.k0 = .9996, e.init.apply(this), this.forward = e.forward, this.inverse = e.inverse)
        }, c.names = ["Universal Transverse Mercator System", "utm"]
    }, {"./tmerc": 59}], 61: [function (a, b, c) {
        var d = a("../common/adjust_lon"), e = Math.PI / 2, f = 1e-10, g = a("../common/asinz");
        c.init = function () {
            this.R = this.a
        }, c.forward = function (a) {
            var b, c, h = a.x, i = a.y, j = d(h - this.long0);
            Math.abs(i) <= f && (b = this.x0 + this.R * j, c = this.y0);
            var k = g(2 * Math.abs(i / Math.PI));
            (Math.abs(j) <= f || Math.abs(Math.abs(i) - e) <= f) && (b = this.x0, c = i >= 0 ? this.y0 + Math.PI * this.R * Math.tan(.5 * k) : this.y0 + Math.PI * this.R * -Math.tan(.5 * k));
            var l = .5 * Math.abs(Math.PI / j - j / Math.PI), m = l * l, n = Math.sin(k), o = Math.cos(k), p = o / (n + o - 1), q = p * p, r = p * (2 / n - 1), s = r * r, t = Math.PI * this.R * (l * (p - s) + Math.sqrt(m * (p - s) * (p - s) - (s + m) * (q - s))) / (s + m);
            0 > j && (t = -t), b = this.x0 + t;
            var u = m + p;
            return t = Math.PI * this.R * (r * u - l * Math.sqrt((s + m) * (m + 1) - u * u)) / (s + m), c = i >= 0 ? this.y0 + t : this.y0 - t, a.x = b, a.y = c, a
        }, c.inverse = function (a) {
            var b, c, e, g, h, i, j, k, l, m, n, o, p;
            return a.x -= this.x0, a.y -= this.y0, n = Math.PI * this.R, e = a.x / n, g = a.y / n, h = e * e + g * g, i = -Math.abs(g) * (1 + h), j = i - 2 * g * g + e * e, k = -2 * i + 1 + 2 * g * g + h * h, p = g * g / k + (2 * j * j * j / k / k / k - 9 * i * j / k / k) / 27, l = (i - j * j / 3 / k) / k, m = 2 * Math.sqrt(-l / 3), n = 3 * p / l / m, Math.abs(n) > 1 && (n = n >= 0 ? 1 : -1), o = Math.acos(n) / 3, c = a.y >= 0 ? (-m * Math.cos(o + Math.PI / 3) - j / 3 / k) * Math.PI : -(-m * Math.cos(o + Math.PI / 3) - j / 3 / k) * Math.PI, b = Math.abs(e) < f ? this.long0 : d(this.long0 + Math.PI * (h - 1 + Math.sqrt(1 + 2 * (e * e - g * g) + h * h)) / 2 / e), a.x = b, a.y = c, a
        }, c.names = ["Van_der_Grinten_I", "VanDerGrinten", "vandg"]
    }, {"../common/adjust_lon": 5, "../common/asinz": 6}], 62: [function (a, b) {
        var c = .017453292519943295, d = 57.29577951308232, e = 1, f = 2, g = a("./datum_transform"), h = a("./adjust_axis"), i = a("./Proj");
        b.exports = function j(a, b, k) {
            function l(a, b) {
                return(a.datum.datum_type === e || a.datum.datum_type === f) && "WGS84" !== b.datumCode
            }

            var m;
            return a.datum && b.datum && (l(a, b) || l(b, a)) && (m = new i("WGS84"), j(a, m, k), a = m), "enu" !== a.axis && h(a, !1, k), "longlat" === a.projName ? (k.x *= c, k.y *= c) : (a.to_meter && (k.x *= a.to_meter, k.y *= a.to_meter), a.inverse(k)), a.from_greenwich && (k.x += a.from_greenwich), k = g(a.datum, b.datum, k), b.from_greenwich && (k.x -= b.from_greenwich), "longlat" === b.projName ? (k.x *= d, k.y *= d) : (b.forward(k), b.to_meter && (k.x /= b.to_meter, k.y /= b.to_meter)), "enu" !== b.axis && h(b, !0, k), k
        }
    }, {"./Proj": 2, "./adjust_axis": 3, "./datum_transform": 30}], 63: [function (a, b) {
        b.exports = "2.0.3"
    }, {}], 64: [function (a, b) {
        function c(a, b, c) {
            a[b] = c.map(function (a) {
                var b = {};
                return d(a, b), b
            }).reduce(function (a, b) {
                return i(a, b)
            }, {})
        }

        function d(a, b) {
            var e;
            return Array.isArray(a) ? (e = a.shift(), "PARAMETER" === e && (e = a.shift()), void(1 === a.length ? Array.isArray(a[0]) ? (b[e] = {}, d(a[0], b[e])) : b[e] = a[0] : a.length ? "TOWGS84" === e ? b[e] = a : (b[e] = {}, ["UNIT", "PRIMEM", "VERT_DATUM"].indexOf(e) > -1 ? (b[e] = {name: a[0].toLowerCase(), convert: a[1]}, 3 === a.length && (b[e].auth = a[2])) : "SPHEROID" === e ? (b[e] = {name: a[0], a: a[1], rf: a[2]}, 4 === a.length && (b[e].auth = a[3])) : ["GEOGCS", "GEOCCS", "DATUM", "VERT_CS", "COMPD_CS", "LOCAL_CS", "FITTED_CS", "LOCAL_DATUM"].indexOf(e) > -1 ? (a[0] = ["name", a[0]], c(b, e, a)) : a.every(function (a) {
                return Array.isArray(a)
            }) ? c(b, e, a) : d(a, b[e])) : b[e] = !0)) : void(b[a] = !0)
        }

        function e(a, b) {
            var c = b[0], d = b[1];
            !(c in a) && d in a && (a[c] = a[d], 3 === b.length && (a[c] = b[2](a[c])))
        }

        function f(a) {
            return a * h
        }

        function g(a) {
            function b(b) {
                var c = a.to_meter || 1;
                return parseFloat(b, 10) * c
            }

            "GEOGCS" === a.type ? a.projName = "longlat" : "LOCAL_CS" === a.type ? (a.projName = "identity", a.local = !0) : a.projName = "object" == typeof a.PROJECTION ? Object.keys(a.PROJECTION)[0] : a.PROJECTION, a.UNIT && (a.units = a.UNIT.name.toLowerCase(), "metre" === a.units && (a.units = "meter"), a.UNIT.convert && (a.to_meter = parseFloat(a.UNIT.convert, 10))), a.GEOGCS && (a.datumCode = a.GEOGCS.DATUM ? a.GEOGCS.DATUM.name.toLowerCase() : a.GEOGCS.name.toLowerCase(), "d_" === a.datumCode.slice(0, 2) && (a.datumCode = a.datumCode.slice(2)), ("new_zealand_geodetic_datum_1949" === a.datumCode || "new_zealand_1949" === a.datumCode) && (a.datumCode = "nzgd49"), "wgs_1984" === a.datumCode && ("Mercator_Auxiliary_Sphere" === a.PROJECTION && (a.sphere = !0), a.datumCode = "wgs84"), "_ferro" === a.datumCode.slice(-6) && (a.datumCode = a.datumCode.slice(0, -6)), "_jakarta" === a.datumCode.slice(-8) && (a.datumCode = a.datumCode.slice(0, -8)), a.GEOGCS.DATUM && a.GEOGCS.DATUM.SPHEROID && (a.ellps = a.GEOGCS.DATUM.SPHEROID.name.replace("_19", "").replace(/[Cc]larke\_18/, "clrk"), "international" === a.ellps.toLowerCase().slice(0, 13) && (a.ellps = "intl"), a.a = a.GEOGCS.DATUM.SPHEROID.a, a.rf = parseFloat(a.GEOGCS.DATUM.SPHEROID.rf, 10))), a.b && !isFinite(a.b) && (a.b = a.a);
            var c = function (b) {
                return e(a, b)
            }, d = [
                ["standard_parallel_1", "Standard_Parallel_1"],
                ["standard_parallel_2", "Standard_Parallel_2"],
                ["false_easting", "False_Easting"],
                ["false_northing", "False_Northing"],
                ["central_meridian", "Central_Meridian"],
                ["latitude_of_origin", "Latitude_Of_Origin"],
                ["scale_factor", "Scale_Factor"],
                ["k0", "scale_factor"],
                ["latitude_of_center", "Latitude_of_center"],
                ["lat0", "latitude_of_center", f],
                ["longitude_of_center", "Longitude_Of_Center"],
                ["longc", "longitude_of_center", f],
                ["x0", "false_easting", b],
                ["y0", "false_northing", b],
                ["long0", "central_meridian", f],
                ["lat0", "latitude_of_origin", f],
                ["lat0", "standard_parallel_1", f],
                ["lat1", "standard_parallel_1", f],
                ["lat2", "standard_parallel_2", f],
                ["alpha", "azimuth", f],
                ["srsCode", "name"]
            ];
            d.forEach(c), a.long0 || !a.longc || "Albers_Conic_Equal_Area" !== a.PROJECTION && "Lambert_Azimuthal_Equal_Area" !== a.PROJECTION || (a.long0 = a.longc)
        }

        var h = .017453292519943295, i = a("./extend");
        b.exports = function (a, b) {
            var c = JSON.parse(("," + a).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g, ',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g, ',"$1"]')), e = c.shift(), f = c.shift();
            c.unshift(["name", f]), c.unshift(["type", e]), c.unshift("output");
            var h = {};
            return d(c, h), g(h.output), i(b, h.output)
        }
    }, {"./extend": 32}], 65: [function (a, b, c) {
        function d(a) {
            return a * (Math.PI / 180)
        }

        function e(a) {
            return 180 * (a / Math.PI)
        }

        function f(a) {
            var b, c, e, f, g, i, j, k, l, m = a.lat, n = a.lon, o = 6378137, p = .00669438, q = .9996, r = d(m), s = d(n);
            l = Math.floor((n + 180) / 6) + 1, 180 === n && (l = 60), m >= 56 && 64 > m && n >= 3 && 12 > n && (l = 32), m >= 72 && 84 > m && (n >= 0 && 9 > n ? l = 31 : n >= 9 && 21 > n ? l = 33 : n >= 21 && 33 > n ? l = 35 : n >= 33 && 42 > n && (l = 37)), b = 6 * (l - 1) - 180 + 3, k = d(b), c = p / (1 - p), e = o / Math.sqrt(1 - p * Math.sin(r) * Math.sin(r)), f = Math.tan(r) * Math.tan(r), g = c * Math.cos(r) * Math.cos(r), i = Math.cos(r) * (s - k), j = o * ((1 - p / 4 - 3 * p * p / 64 - 5 * p * p * p / 256) * r - (3 * p / 8 + 3 * p * p / 32 + 45 * p * p * p / 1024) * Math.sin(2 * r) + (15 * p * p / 256 + 45 * p * p * p / 1024) * Math.sin(4 * r) - 35 * p * p * p / 3072 * Math.sin(6 * r));
            var t = q * e * (i + (1 - f + g) * i * i * i / 6 + (5 - 18 * f + f * f + 72 * g - 58 * c) * i * i * i * i * i / 120) + 5e5, u = q * (j + e * Math.tan(r) * (i * i / 2 + (5 - f + 9 * g + 4 * g * g) * i * i * i * i / 24 + (61 - 58 * f + f * f + 600 * g - 330 * c) * i * i * i * i * i * i / 720));
            return 0 > m && (u += 1e7), {northing: Math.round(u), easting: Math.round(t), zoneNumber: l, zoneLetter: h(m)}
        }

        function g(a) {
            var b = a.northing, c = a.easting, d = a.zoneLetter, f = a.zoneNumber;
            if (0 > f || f > 60)return null;
            var h, i, j, k, l, m, n, o, p, q, r = .9996, s = 6378137, t = .00669438, u = (1 - Math.sqrt(1 - t)) / (1 + Math.sqrt(1 - t)), v = c - 5e5, w = b;
            "N" > d && (w -= 1e7), o = 6 * (f - 1) - 180 + 3, h = t / (1 - t), n = w / r, p = n / (s * (1 - t / 4 - 3 * t * t / 64 - 5 * t * t * t / 256)), q = p + (3 * u / 2 - 27 * u * u * u / 32) * Math.sin(2 * p) + (21 * u * u / 16 - 55 * u * u * u * u / 32) * Math.sin(4 * p) + 151 * u * u * u / 96 * Math.sin(6 * p), i = s / Math.sqrt(1 - t * Math.sin(q) * Math.sin(q)), j = Math.tan(q) * Math.tan(q), k = h * Math.cos(q) * Math.cos(q), l = s * (1 - t) / Math.pow(1 - t * Math.sin(q) * Math.sin(q), 1.5), m = v / (i * r);
            var x = q - i * Math.tan(q) / l * (m * m / 2 - (5 + 3 * j + 10 * k - 4 * k * k - 9 * h) * m * m * m * m / 24 + (61 + 90 * j + 298 * k + 45 * j * j - 252 * h - 3 * k * k) * m * m * m * m * m * m / 720);
            x = e(x);
            var y = (m - (1 + 2 * j + k) * m * m * m / 6 + (5 - 2 * k + 28 * j - 3 * k * k + 8 * h + 24 * j * j) * m * m * m * m * m / 120) / Math.cos(q);
            y = o + e(y);
            var z;
            if (a.accuracy) {
                var A = g({northing: a.northing + a.accuracy, easting: a.easting + a.accuracy, zoneLetter: a.zoneLetter, zoneNumber: a.zoneNumber});
                z = {top: A.lat, right: A.lon, bottom: x, left: y}
            } else z = {lat: x, lon: y};
            return z
        }

        function h(a) {
            var b = "Z";
            return 84 >= a && a >= 72 ? b = "X" : 72 > a && a >= 64 ? b = "W" : 64 > a && a >= 56 ? b = "V" : 56 > a && a >= 48 ? b = "U" : 48 > a && a >= 40 ? b = "T" : 40 > a && a >= 32 ? b = "S" : 32 > a && a >= 24 ? b = "R" : 24 > a && a >= 16 ? b = "Q" : 16 > a && a >= 8 ? b = "P" : 8 > a && a >= 0 ? b = "N" : 0 > a && a >= -8 ? b = "M" : -8 > a && a >= -16 ? b = "L" : -16 > a && a >= -24 ? b = "K" : -24 > a && a >= -32 ? b = "J" : -32 > a && a >= -40 ? b = "H" : -40 > a && a >= -48 ? b = "G" : -48 > a && a >= -56 ? b = "F" : -56 > a && a >= -64 ? b = "E" : -64 > a && a >= -72 ? b = "D" : -72 > a && a >= -80 && (b = "C"), b
        }

        function i(a, b) {
            var c = "" + a.easting, d = "" + a.northing;
            return a.zoneNumber + a.zoneLetter + j(a.easting, a.northing, a.zoneNumber) + c.substr(c.length - 5, b) + d.substr(d.length - 5, b)
        }

        function j(a, b, c) {
            var d = k(c), e = Math.floor(a / 1e5), f = Math.floor(b / 1e5) % 20;
            return l(e, f, d)
        }

        function k(a) {
            var b = a % q;
            return 0 === b && (b = q), b
        }

        function l(a, b, c) {
            var d = c - 1, e = r.charCodeAt(d), f = s.charCodeAt(d), g = e + a - 1, h = f + b, i = !1;
            g > x && (g = g - x + t - 1, i = !0), (g === u || u > e && g > u || (g > u || u > e) && i) && g++, (g === v || v > e && g > v || (g > v || v > e) && i) && (g++, g === u && g++), g > x && (g = g - x + t - 1), h > w ? (h = h - w + t - 1, i = !0) : i = !1, (h === u || u > f && h > u || (h > u || u > f) && i) && h++, (h === v || v > f && h > v || (h > v || v > f) && i) && (h++, h === u && h++), h > w && (h = h - w + t - 1);
            var j = String.fromCharCode(g) + String.fromCharCode(h);
            return j
        }

        function m(a) {
            if (a && 0 === a.length)throw"MGRSPoint coverting from nothing";
            for (var b, c = a.length, d = null, e = "", f = 0; !/[A-Z]/.test(b = a.charAt(f));) {
                if (f >= 2)throw"MGRSPoint bad conversion from: " + a;
                e += b, f++
            }
            var g = parseInt(e, 10);
            if (0 === f || f + 3 > c)throw"MGRSPoint bad conversion from: " + a;
            var h = a.charAt(f++);
            if ("A" >= h || "B" === h || "Y" === h || h >= "Z" || "I" === h || "O" === h)throw"MGRSPoint zone letter " + h + " not handled: " + a;
            d = a.substring(f, f += 2);
            for (var i = k(g), j = n(d.charAt(0), i), l = o(d.charAt(1), i); l < p(h);)l += 2e6;
            var m = c - f;
            if (m % 2 !== 0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters" + a;
            var q, r, s, t, u, v = m / 2, w = 0, x = 0;
            return v > 0 && (q = 1e5 / Math.pow(10, v), r = a.substring(f, f + v), w = parseFloat(r) * q, s = a.substring(f + v), x = parseFloat(s) * q), t = w + j, u = x + l, {easting: t, northing: u, zoneLetter: h, zoneNumber: g, accuracy: q}
        }

        function n(a, b) {
            for (var c = r.charCodeAt(b - 1), d = 1e5, e = !1; c !== a.charCodeAt(0);) {
                if (c++, c === u && c++, c === v && c++, c > x) {
                    if (e)throw"Bad character: " + a;
                    c = t, e = !0
                }
                d += 1e5
            }
            return d
        }

        function o(a, b) {
            if (a > "V")throw"MGRSPoint given invalid Northing " + a;
            for (var c = s.charCodeAt(b - 1), d = 0, e = !1; c !== a.charCodeAt(0);) {
                if (c++, c === u && c++, c === v && c++, c > w) {
                    if (e)throw"Bad character: " + a;
                    c = t, e = !0
                }
                d += 1e5
            }
            return d
        }

        function p(a) {
            var b;
            switch (a) {
                case"C":
                    b = 11e5;
                    break;
                case"D":
                    b = 2e6;
                    break;
                case"E":
                    b = 28e5;
                    break;
                case"F":
                    b = 37e5;
                    break;
                case"G":
                    b = 46e5;
                    break;
                case"H":
                    b = 55e5;
                    break;
                case"J":
                    b = 64e5;
                    break;
                case"K":
                    b = 73e5;
                    break;
                case"L":
                    b = 82e5;
                    break;
                case"M":
                    b = 91e5;
                    break;
                case"N":
                    b = 0;
                    break;
                case"P":
                    b = 8e5;
                    break;
                case"Q":
                    b = 17e5;
                    break;
                case"R":
                    b = 26e5;
                    break;
                case"S":
                    b = 35e5;
                    break;
                case"T":
                    b = 44e5;
                    break;
                case"U":
                    b = 53e5;
                    break;
                case"V":
                    b = 62e5;
                    break;
                case"W":
                    b = 7e6;
                    break;
                case"X":
                    b = 79e5;
                    break;
                default:
                    b = -1
            }
            if (b >= 0)return b;
            throw"Invalid zone letter: " + a
        }

        var q = 6, r = "AJSAJS", s = "AFAFAF", t = 65, u = 73, v = 79, w = 86, x = 90;
        c.forward = function (a, b) {
            return b = b || 5, i(f({lat: a[1], lon: a[0]}), b)
        }, c.inverse = function (a) {
            var b = g(m(a.toUpperCase()));
            return[b.left, b.bottom, b.right, b.top]
        }, c.toPoint = function (a) {
            var b = c.inverse(a);
            return[(b[2] + b[0]) / 2, (b[3] + b[1]) / 2]
        }
    }, {}]}, {}, [34])(34)
}), function (a) {
    //here is the problem
    var b, c;
    if ("function" == typeof define && define.amd){
        console.info(['var']);
        //define(["leaflet", "proj4"], a);
        //b = require("leaflet"), c = require("proj4"), module.exports = a(b, c);
        a(window.L, window.proj4)
    }else if ("undefined" != typeof module){
        console.info(['var 2']);
        b = require("leaflet"), c = require("proj4"), module.exports = a(b, c);
    }
    else {
        console.info(['var 3']);
        if ("undefined" == typeof window.L || "undefined" == typeof window.proj4){
            console.info(['var throw']);
            throw"Leaflet and proj4 must be loaded first";
        }
        a(window.L, window.proj4)
    }
}(function (a, b) {
    return a.Proj = {}, a.Proj._isProj4Obj = function (a) {
        return"undefined" != typeof a.inverse && "undefined" != typeof a.forward
    }, a.Proj.ScaleDependantTransformation = function (a) {
        this.scaleTransforms = a
    }, a.Proj.ScaleDependantTransformation.prototype.transform = function (a, b) {
        return this.scaleTransforms[b].transform(a, b)
    }, a.Proj.ScaleDependantTransformation.prototype.untransform = function (a, b) {
        return this.scaleTransforms[b].untransform(a, b)
    }, a.Proj.Projection = a.Class.extend({initialize: function (c, d) {
        if (a.Proj._isProj4Obj(c))this._proj = c; else {
            var e = c;
            if (d)d.projName || b.defs(e, d); else if (void 0 === b.defs[e]) {
                var f = e.split(":");
                if (f.length > 3 && (e = f[f.length - 3] + ":" + f[f.length - 1]), void 0 === b.defs[e])throw"No projection definition for code " + e
            }
            this._proj = b(e)
        }
    }, project: function (b) {
        var c = this._proj.forward([b.lng, b.lat]);
        return new a.Point(c[0], c[1])
    }, unproject: function (b, c) {
        var d = this._proj.inverse([b.x, b.y]);
        return new a.LatLng(d[1], d[0], c)
    }}), a.Proj.CRS = a.Class.extend({includes: a.CRS, options: {transformation: new a.Transformation(1, 0, -1, 0)}, initialize: function (b, c, d) {
        var e, f, g, h;
        if (a.Proj._isProj4Obj(b) ? (f = b, e = f.srsCode, h = c || {}, this.projection = new a.Proj.Projection(f)) : (e = b, g = c, h = d || {}, this.projection = new a.Proj.Projection(e, g)), a.Util.setOptions(this, h), this.code = e, this.transformation = this.options.transformation, this.options.origin && (this.transformation = new a.Transformation(1, -this.options.origin[0], -1, this.options.origin[1])), this.options.scales) {
            this._scales = this.options.scales, this.resolutions = [];
            for (var i = this.options._scales.length - 1; i >= 0; i--)this.options._scales[i] && (this.resolutions[i] = 1 / this.options._scales[i])
        } else if (this.options.resolutions) {
            this._scales = [];
            for (var i = this.options.resolutions.length - 1; i >= 0; i--)this.options.resolutions[i] && (this._scales[i] = 1 / this.options.resolutions[i])
        }
    }, scale: function (a) {
        return this._scales[a]
    }, getSize: function (b) {
        var c, d, e, f = this.options.bounds;
        return f ? (c = this.scale(b), d = this.transformation.transform(f.min, c), e = this.transformation.transform(f.max, c), a.point(Math.abs(e.x - d.x), Math.abs(e.y - d.y))) : (c = 256 * Math.pow(2, b), a.point(c, c))
    }}), a.Proj.CRS.TMS = a.Proj.CRS.extend({options: {tileSize: 256}, initialize: function (b, c, d, e) {
        var f, g, h, i, j;
        a.Proj._isProj4Obj(b) ? (h = b, i = c, j = a.extend({}, d), j.origin = [i[0], i[3]], a.Proj.CRS.prototype.initialize.call(this, h, j)) : (f = b, g = c, i = d, j = a.extend({}, e), j.origin = [i[0], i[3]], a.Proj.CRS.prototype.initialize.call(this, f, g, j)), this.projectedBounds = i, this._sizes = this._calculateSizes()
    }, _calculateSizes: function () {
        var b, c, d, e = [], f = this.projectedBounds, g = this.options.resolutions;
        for (b = g.length - 1; b >= 0; b--)g[b] && (c = Math.ceil(parseFloat((f[2] - f[0]) / g[b]).toPrecision(3)), d = Math.ceil(parseFloat((f[3] - f[1]) / g[b]).toPrecision(3)), e[b] = a.point(c, d));
        return e
    }, getSize: function (a) {
        return this._sizes[a]
    }}), a.Proj.TileLayer = {}, a.TileLayer && (a.Proj.TileLayer.TMS = a.TileLayer.extend({options: {continuousWorld: !0}, initialize: function (b, c, d) {
        var e, f, g, h, i = !0;
        if (!(c instanceof a.Proj.CRS.TMS))throw"CRS is not L.Proj.CRS.TMS.";
        for (a.TileLayer.prototype.initialize.call(this, b, d), this.options.tms = !1, this.crs = c, g = this.crs.projectedBounds, h = this.options.minZoom; h < this.options.maxZoom && i; h++) {
            var j = (g[3] - g[1]) / this._projectedTileSize(h);
            i = Math.abs(j - Math.round(j)) > .001
        }
        if (!i) {
            for (e = {}, h = this.options.minZoom; h < this.options.maxZoom; h++)f = g[1] + Math.ceil((g[3] - g[1]) / this._projectedTileSize(h)) * this._projectedTileSize(h), e[this.crs.scale(h)] = new a.Transformation(1, -g[0], -1, f);
            this.crs = new a.Proj.CRS.TMS(this.crs.projection._proj, g, this.crs.options), this.crs.transformation = new a.Proj.ScaleDependantTransformation(e)
        }
    }, getTileUrl: function (b) {
        var c = this._map.getZoom(), d = Math.ceil((this.crs.projectedBounds[3] - this.crs.projectedBounds[1]) / this._projectedTileSize(c));
        return a.Util.template(this._url, a.Util.extend({s: this._getSubdomain(b), z: this._getZoomForUrl(), x: b.x, y: d - b.y - 1}, this.options))
    }, _projectedTileSize: function (a) {
        return this.options.tileSize / this.crs.scale(a)
    }})), a.GeoJSON && (a.Proj.GeoJSON = a.GeoJSON.extend({initialize: function (b, c) {
        a.GeoJSON.prototype.initialize.call(this, null, c), this.addData(b)
    }, addData: function (b) {
        var c;
        b && (b.crs && "name" === b.crs.type ? c = new a.Proj.CRS(b.crs.properties.name) : b.crs && b.crs.type && (c = new a.Proj.CRS(b.crs.type + ":" + b.crs.properties.code)), void 0 !== c ? this.options.coordsToLatLng = function (b) {
            var d = a.point(b[0], b[1]);
            return c.projection.unproject(d)
        } : delete this.options.coordsToLatLng), a.GeoJSON.prototype.addData.call(this, b)
    }})), a.Proj.geoJson = function (b, c) {
        return new a.Proj.GeoJSON(b, c)
    }, "undefined" != typeof a.CRS && (a.CRS.proj4js = function () {
        return function (b, c, d, e) {
            return e = e || {}, d && (e.transformation = d), new a.Proj.CRS(b, c, e)
        }
    }()), a.Proj
}), "undefined" != typeof module && module.exports && (module.exports.BitSet = BitSet);
var requirejs, require, define;
!function (global) {
    function isFunction(a) {
        return"[object Function]" === ostring.call(a)
    }

    function isArray(a) {
        return"[object Array]" === ostring.call(a)
    }

    function each(a, b) {
        if (a) {
            var c;
            for (c = 0; c < a.length && (!a[c] || !b(a[c], c, a)); c += 1);
        }
    }

    function eachReverse(a, b) {
        if (a) {
            var c;
            for (c = a.length - 1; c > -1 && (!a[c] || !b(a[c], c, a)); c -= 1);
        }
    }

    function hasProp(a, b) {
        return hasOwn.call(a, b)
    }

    function getOwn(a, b) {
        return hasProp(a, b) && a[b]
    }

    function eachProp(a, b) {
        var c;
        for (c in a)if (hasProp(a, c) && b(a[c], c))break
    }

    function mixin(a, b, c, d) {
        return b && eachProp(b, function (b, e) {
            (c || !hasProp(a, e)) && (!d || "object" != typeof b || !b || isArray(b) || isFunction(b) || b instanceof RegExp ? a[e] = b : (a[e] || (a[e] = {}), mixin(a[e], b, c, d)))
        }), a
    }

    function bind(a, b) {
        return function () {
            return b.apply(a, arguments)
        }
    }

    function scripts() {
        return document.getElementsByTagName("script")
    }

    function defaultOnError(a) {
        throw a
    }

    function getGlobal(a) {
        if (!a)return a;
        var b = global;
        return each(a.split("."), function (a) {
            b = b[a]
        }), b
    }

    function makeError(a, b, c, d) {
        var e = new Error(b + "\nhttp://requirejs.org/docs/errors.html#" + a);
        return e.requireType = a, e.requireModules = d, c && (e.originalError = c), e
    }

    function newContext(a) {
        function b(a) {
            var b, c, d = a.length;
            for (b = 0; d > b; b++)if (c = a[b], "." === c)a.splice(b, 1), b -= 1; else if (".." === c) {
                if (1 === b && (".." === a[2] || ".." === a[0]))break;
                b > 0 && (a.splice(b - 1, 2), b -= 2)
            }
        }

        function c(a, c, d) {
            var e, f, g, h, i, j, k, l, m, n, o, p = c && c.split("/"), q = p, r = x.map, s = r && r["*"];
            if (a && "." === a.charAt(0) && (c ? (q = p.slice(0, p.length - 1), a = a.split("/"), k = a.length - 1, x.nodeIdCompat && jsSuffixRegExp.test(a[k]) && (a[k] = a[k].replace(jsSuffixRegExp, "")), a = q.concat(a), b(a), a = a.join("/")) : 0 === a.indexOf("./") && (a = a.substring(2))), d && r && (p || s)) {
                g = a.split("/");
                a:for (h = g.length; h > 0; h -= 1) {
                    if (j = g.slice(0, h).join("/"), p)for (i = p.length; i > 0; i -= 1)if (f = getOwn(r, p.slice(0, i).join("/")), f && (f = getOwn(f, j))) {
                        l = f, m = h;
                        break a
                    }
                    !n && s && getOwn(s, j) && (n = getOwn(s, j), o = h)
                }
                !l && n && (l = n, m = o), l && (g.splice(0, m, l), a = g.join("/"))
            }
            return e = getOwn(x.pkgs, a), e ? e : a
        }

        function d(a) {
            isBrowser && each(scripts(), function (b) {
                return b.getAttribute("data-requiremodule") === a && b.getAttribute("data-requirecontext") === u.contextName ? (b.parentNode.removeChild(b), !0) : void 0
            })
        }

        function e(a) {
            var b = getOwn(x.paths, a);
            return b && isArray(b) && b.length > 1 ? (b.shift(), u.require.undef(a), u.require([a]), !0) : void 0
        }

        function f(a) {
            return[void 0, a]
        }

        function g(a, b, d, e) {
            var g, h, i, j, k = null, l = b ? b.name : null, m = a, n = !0, o = "";
            return a || (n = !1, a = "_@r" + (F += 1)), j = f(a), k = j[0], a = j[1], k && (k = c(k, l, e), h = getOwn(C, k)), a && (k ? o = h && h.normalize ? h.normalize(a, function (a) {
                return c(a, l, e)
            }) : c(a, l, e) : (o = c(a, l, e), j = f(o), k = j[0], o = j[1], d = !0, g = u.nameToUrl(o))), i = !k || h || d ? "" : "_unnormalized" + (G += 1), {prefix: k, name: o, parentMap: b, unnormalized: !!i, url: g, originalName: m, isDefine: n, id: (k ? k + "!" + o : o) + i}
        }

        function h(a) {
            var b = a.id, c = getOwn(y, b);
            return c || (c = y[b] = new u.Module(a)), c
        }

        function i(a, b, c) {
            var d = a.id, e = getOwn(y, d);
            !hasProp(C, d) || e && !e.defineEmitComplete ? (e = h(a), e.error && "error" === b ? c(e.error) : e.on(b, c)) : "defined" === b && c(C[d])
        }

        function j(a, b) {
            var c = a.requireModules, d = !1;
            b ? b(a) : (each(c, function (b) {
                var c = getOwn(y, b);
                c && (c.error = a, c.events.error && (d = !0, c.emit("error", a)))
            }), d || req.onError(a))
        }

        function k() {
            globalDefQueue.length && (apsp.apply(B, [B.length, 0].concat(globalDefQueue)), globalDefQueue = [])
        }

        function l(a) {
            delete y[a], delete z[a]
        }

        function m(a, b, c) {
            var d = a.map.id;
            a.error ? a.emit("error", a.error) : (b[d] = !0, each(a.depMaps, function (d, e) {
                var f = d.id, g = getOwn(y, f);
                !g || a.depMatched[e] || c[f] || (getOwn(b, f) ? (a.defineDep(e, C[f]), a.check()) : m(g, b, c))
            }), c[d] = !0)
        }

        function n() {
            var a, b, c = 1e3 * x.waitSeconds, f = c && u.startTime + c < (new Date).getTime(), g = [], h = [], i = !1, k = !0;
            if (!s) {
                if (s = !0, eachProp(z, function (a) {
                    var c = a.map, j = c.id;
                    if (a.enabled && (c.isDefine || h.push(a), !a.error))if (!a.inited && f)e(j) ? (b = !0, i = !0) : (g.push(j), d(j)); else if (!a.inited && a.fetched && c.isDefine && (i = !0, !c.prefix))return k = !1
                }), f && g.length)return a = makeError("timeout", "Load timeout for modules: " + g, null, g), a.contextName = u.contextName, j(a);
                k && each(h, function (a) {
                    m(a, {}, {})
                }), f && !b || !i || !isBrowser && !isWebWorker || w || (w = setTimeout(function () {
                    w = 0, n()
                }, 50)), s = !1
            }
        }

        function o(a) {
            hasProp(C, a[0]) || h(g(a[0], null, !0)).init(a[1], a[2])
        }

        function p(a, b, c, d) {
            a.detachEvent && !isOpera ? d && a.detachEvent(d, b) : a.removeEventListener(c, b, !1)
        }

        function q(a) {
            var b = a.currentTarget || a.srcElement;
            return p(b, u.onScriptLoad, "load", "onreadystatechange"), p(b, u.onScriptError, "error"), {node: b, id: b && b.getAttribute("data-requiremodule")}
        }

        function r() {
            var a;
            for (k(); B.length;) {
                if (a = B.shift(), null === a[0])return j(makeError("mismatch", "Mismatched anonymous define() module: " + a[a.length - 1]));
                o(a)
            }
        }

        var s, t, u, v, w, x = {waitSeconds: 7, baseUrl: "./", paths: {}, bundles: {}, pkgs: {}, shim: {}, config: {}}, y = {}, z = {}, A = {}, B = [], C = {}, D = {}, E = {}, F = 1, G = 1;
        return v = {require: function (a) {
            return a.require ? a.require : a.require = u.makeRequire(a.map)
        }, exports: function (a) {
            return a.usingExports = !0, a.map.isDefine ? a.exports ? C[a.map.id] = a.exports : a.exports = C[a.map.id] = {} : void 0
        }, module: function (a) {
            return a.module ? a.module : a.module = {id: a.map.id, uri: a.map.url, config: function () {
                return getOwn(x.config, a.map.id) || {}
            }, exports: a.exports || (a.exports = {})}
        }}, t = function (a) {
            this.events = getOwn(A, a.id) || {}, this.map = a, this.shim = getOwn(x.shim, a.id), this.depExports = [], this.depMaps = [], this.depMatched = [], this.pluginMaps = {}, this.depCount = 0
        }, t.prototype = {init: function (a, b, c, d) {
            d = d || {}, this.inited || (this.factory = b, c ? this.on("error", c) : this.events.error && (c = bind(this, function (a) {
                this.emit("error", a)
            })), this.depMaps = a && a.slice(0), this.errback = c, this.inited = !0, this.ignore = d.ignore, d.enabled || this.enabled ? this.enable() : this.check())
        }, defineDep: function (a, b) {
            this.depMatched[a] || (this.depMatched[a] = !0, this.depCount -= 1, this.depExports[a] = b)
        }, fetch: function () {
            if (!this.fetched) {
                this.fetched = !0, u.startTime = (new Date).getTime();
                var a = this.map;
                return this.shim ? void u.makeRequire(this.map, {enableBuildCallback: !0})(this.shim.deps || [], bind(this, function () {
                    return a.prefix ? this.callPlugin() : this.load()
                })) : a.prefix ? this.callPlugin() : this.load()
            }
        }, load: function () {
            var a = this.map.url;
            D[a] || (D[a] = !0, u.load(this.map.id, a))
        }, check: function () {
            if (this.enabled && !this.enabling) {
                var a, b, c = this.map.id, d = this.depExports, e = this.exports, f = this.factory;
                if (this.inited) {
                    if (this.error)this.emit("error", this.error); else if (!this.defining) {
                        if (this.defining = !0, this.depCount < 1 && !this.defined) {
                            if (isFunction(f)) {
                                if (this.events.error && this.map.isDefine || req.onError !== defaultOnError)try {
                                    e = u.execCb(c, f, d, e)
                                } catch (g) {
                                    a = g
                                } else e = u.execCb(c, f, d, e);
                                if (this.map.isDefine && void 0 === e && (b = this.module, b ? e = b.exports : this.usingExports && (e = this.exports)), a)return a.requireMap = this.map, a.requireModules = this.map.isDefine ? [this.map.id] : null, a.requireType = this.map.isDefine ? "define" : "require", j(this.error = a)
                            } else e = f;
                            this.exports = e, this.map.isDefine && !this.ignore && (C[c] = e, req.onResourceLoad && req.onResourceLoad(u, this.map, this.depMaps)), l(c), this.defined = !0
                        }
                        this.defining = !1, this.defined && !this.defineEmitted && (this.defineEmitted = !0, this.emit("defined", this.exports), this.defineEmitComplete = !0)
                    }
                } else this.fetch()
            }
        }, callPlugin: function () {
            var a = this.map, b = a.id, d = g(a.prefix);
            this.depMaps.push(d), i(d, "defined", bind(this, function (d) {
                var e, f, k, m = getOwn(E, this.map.id), n = this.map.name, o = this.map.parentMap ? this.map.parentMap.name : null, p = u.makeRequire(a.parentMap, {enableBuildCallback: !0});
                return this.map.unnormalized ? (d.normalize && (n = d.normalize(n, function (a) {
                    return c(a, o, !0)
                }) || ""), f = g(a.prefix + "!" + n, this.map.parentMap), i(f, "defined", bind(this, function (a) {
                    this.init([], function () {
                        return a
                    }, null, {enabled: !0, ignore: !0})
                })), k = getOwn(y, f.id), void(k && (this.depMaps.push(f), this.events.error && k.on("error", bind(this, function (a) {
                    this.emit("error", a)
                })), k.enable()))) : m ? (this.map.url = u.nameToUrl(m), void this.load()) : (e = bind(this, function (a) {
                    this.init([], function () {
                        return a
                    }, null, {enabled: !0})
                }), e.error = bind(this, function (a) {
                    this.inited = !0, this.error = a, a.requireModules = [b], eachProp(y, function (a) {
                        0 === a.map.id.indexOf(b + "_unnormalized") && l(a.map.id)
                    }), j(a)
                }), e.fromText = bind(this, function (c, d) {
                    var f = a.name, i = g(f), k = useInteractive;
                    d && (c = d), k && (useInteractive = !1), h(i), hasProp(x.config, b) && (x.config[f] = x.config[b]);
                    try {
                        req.exec(c)
                    } catch (l) {
                        return j(makeError("fromtexteval", "fromText eval for " + b + " failed: " + l, l, [b]))
                    }
                    k && (useInteractive = !0), this.depMaps.push(i), u.completeLoad(f), p([f], e)
                }), void d.load(a.name, p, e, x))
            })), u.enable(d, this), this.pluginMaps[d.id] = d
        }, enable: function () {
            z[this.map.id] = this, this.enabled = !0, this.enabling = !0, each(this.depMaps, bind(this, function (a, b) {
                var c, d, e;
                if ("string" == typeof a) {
                    if (a = g(a, this.map.isDefine ? this.map : this.map.parentMap, !1, !this.skipMap), this.depMaps[b] = a, e = getOwn(v, a.id))return void(this.depExports[b] = e(this));
                    this.depCount += 1, i(a, "defined", bind(this, function (a) {
                        this.defineDep(b, a), this.check()
                    })), this.errback && i(a, "error", bind(this, this.errback))
                }
                c = a.id, d = y[c], hasProp(v, c) || !d || d.enabled || u.enable(a, this)
            })), eachProp(this.pluginMaps, bind(this, function (a) {
                var b = getOwn(y, a.id);
                b && !b.enabled && u.enable(a, this)
            })), this.enabling = !1, this.check()
        }, on: function (a, b) {
            var c = this.events[a];
            c || (c = this.events[a] = []), c.push(b)
        }, emit: function (a, b) {
            each(this.events[a], function (a) {
                a(b)
            }), "error" === a && delete this.events[a]
        }}, u = {config: x, contextName: a, registry: y, defined: C, urlFetched: D, defQueue: B, Module: t, makeModuleMap: g, nextTick: req.nextTick, onError: j, configure: function (a) {
            a.baseUrl && "/" !== a.baseUrl.charAt(a.baseUrl.length - 1) && (a.baseUrl += "/");
            var b = x.shim, c = {paths: !0, bundles: !0, config: !0, map: !0};
            eachProp(a, function (a, b) {
                c[b] ? (x[b] || (x[b] = {}), mixin(x[b], a, !0, !0)) : x[b] = a
            }), a.bundles && eachProp(a.bundles, function (a, b) {
                each(a, function (a) {
                    a !== b && (E[a] = b)
                })
            }), a.shim && (eachProp(a.shim, function (a, c) {
                isArray(a) && (a = {deps: a}), !a.exports && !a.init || a.exportsFn || (a.exportsFn = u.makeShimExports(a)), b[c] = a
            }), x.shim = b), a.packages && each(a.packages, function (a) {
                var b, c;
                a = "string" == typeof a ? {name: a} : a, c = a.name, b = a.location, b && (x.paths[c] = a.location), x.pkgs[c] = a.name + "/" + (a.main || "main").replace(currDirRegExp, "").replace(jsSuffixRegExp, "")
            }), eachProp(y, function (a, b) {
                a.inited || a.map.unnormalized || (a.map = g(b))
            }), (a.deps || a.callback) && u.require(a.deps || [], a.callback)
        }, makeShimExports: function (a) {
            function b() {
                var b;
                return a.init && (b = a.init.apply(global, arguments)), b || a.exports && getGlobal(a.exports)
            }

            return b
        }, makeRequire: function (b, e) {
            function f(c, d, i) {
                var k, l, m;
                return e.enableBuildCallback && d && isFunction(d) && (d.__requireJsBuild = !0), "string" == typeof c ? isFunction(d) ? j(makeError("requireargs", "Invalid require call"), i) : b && hasProp(v, c) ? v[c](y[b.id]) : req.get ? req.get(u, c, b, f) : (l = g(c, b, !1, !0), k = l.id, hasProp(C, k) ? C[k] : j(makeError("notloaded", 'Module name "' + k + '" has not been loaded yet for context: ' + a + (b ? "" : ". Use require([])")))) : (r(), u.nextTick(function () {
                    r(), m = h(g(null, b)), m.skipMap = e.skipMap, m.init(c, d, i, {enabled: !0}), n()
                }), f)
            }

            return e = e || {}, mixin(f, {isBrowser: isBrowser, toUrl: function (a) {
                var d, e = a.lastIndexOf("."), f = a.split("/")[0], g = "." === f || ".." === f;
                return-1 !== e && (!g || e > 1) && (d = a.substring(e, a.length), a = a.substring(0, e)), u.nameToUrl(c(a, b && b.id, !0), d, !0)
            }, defined: function (a) {
                return hasProp(C, g(a, b, !1, !0).id)
            }, specified: function (a) {
                return a = g(a, b, !1, !0).id, hasProp(C, a) || hasProp(y, a)
            }}), b || (f.undef = function (a) {
                k();
                var c = g(a, b, !0), e = getOwn(y, a);
                d(a), delete C[a], delete D[c.url], delete A[a], eachReverse(B, function (b, c) {
                    b[0] === a && B.splice(c, 1)
                }), e && (e.events.defined && (A[a] = e.events), l(a))
            }), f
        }, enable: function (a) {
            var b = getOwn(y, a.id);
            b && h(a).enable()
        }, completeLoad: function (a) {
            var b, c, d, f = getOwn(x.shim, a) || {}, g = f.exports;
            for (k(); B.length;) {
                if (c = B.shift(), null === c[0]) {
                    if (c[0] = a, b)break;
                    b = !0
                } else c[0] === a && (b = !0);
                o(c)
            }
            if (d = getOwn(y, a), !b && !hasProp(C, a) && d && !d.inited) {
                if (!(!x.enforceDefine || g && getGlobal(g)))return e(a) ? void 0 : j(makeError("nodefine", "No define call for " + a, null, [a]));
                o([a, f.deps || [], f.exportsFn])
            }
            n()
        }, nameToUrl: function (a, b, c) {
            var d, e, f, g, h, i, j, k = getOwn(x.pkgs, a);
            if (k && (a = k), j = getOwn(E, a))return u.nameToUrl(j, b, c);
            if (req.jsExtRegExp.test(a))h = a + (b || ""); else {
                for (d = x.paths, e = a.split("/"), f = e.length; f > 0; f -= 1)if (g = e.slice(0, f).join("/"), i = getOwn(d, g)) {
                    isArray(i) && (i = i[0]), e.splice(0, f, i);
                    break
                }
                h = e.join("/"), h += b || (/^data\:|\?/.test(h) || c ? "" : ".js"), h = ("/" === h.charAt(0) || h.match(/^[\w\+\.\-]+:/) ? "" : x.baseUrl) + h
            }
            return x.urlArgs ? h + ((-1 === h.indexOf("?") ? "?" : "&") + x.urlArgs) : h
        }, load: function (a, b) {
            req.load(u, a, b)
        }, execCb: function (a, b, c, d) {
            return b.apply(d, c)
        }, onScriptLoad: function (a) {
            if ("load" === a.type || readyRegExp.test((a.currentTarget || a.srcElement).readyState)) {
                interactiveScript = null;
                var b = q(a);
                u.completeLoad(b.id)
            }
        }, onScriptError: function (a) {
            var b = q(a);
            return e(b.id) ? void 0 : j(makeError("scripterror", "Script error for: " + b.id, a, [b.id]))
        }}, u.require = u.makeRequire(), u
    }

    function getInteractiveScript() {
        return interactiveScript && "interactive" === interactiveScript.readyState ? interactiveScript : (eachReverse(scripts(), function (a) {
            return"interactive" === a.readyState ? interactiveScript = a : void 0
        }), interactiveScript)
    }

    var req, s, head, baseElement, dataMain, src, interactiveScript, currentlyAddingScript, mainScript, subPath, version = "2.1.11", commentRegExp = /(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm, cjsRequireRegExp = /[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g, jsSuffixRegExp = /\.js$/, currDirRegExp = /^\.\//, op = Object.prototype, ostring = op.toString, hasOwn = op.hasOwnProperty, ap = Array.prototype, apsp = ap.splice, isBrowser = !("undefined" == typeof window || "undefined" == typeof navigator || !window.document), isWebWorker = !isBrowser && "undefined" != typeof importScripts, readyRegExp = isBrowser && "PLAYSTATION 3" === navigator.platform ? /^complete$/ : /^(complete|loaded)$/, defContextName = "_", isOpera = "undefined" != typeof opera && "[object Opera]" === opera.toString(), contexts = {}, cfg = {}, globalDefQueue = [], useInteractive = !1;
    if ("undefined" == typeof define) {
        if ("undefined" != typeof requirejs) {
            if (isFunction(requirejs))return;
            cfg = requirejs, requirejs = void 0
        }
        "undefined" == typeof require || isFunction(require) || (cfg = require, require = void 0), req = requirejs = function (a, b, c, d) {
            var e, f, g = defContextName;
            return isArray(a) || "string" == typeof a || (f = a, isArray(b) ? (a = b, b = c, c = d) : a = []), f && f.context && (g = f.context), e = getOwn(contexts, g), e || (e = contexts[g] = req.s.newContext(g)), f && e.configure(f), e.require(a, b, c)
        }, req.config = function (a) {
            return req(a)
        }, req.nextTick = "undefined" != typeof setTimeout ? function (a) {
            setTimeout(a, 4)
        } : function (a) {
            a()
        }, require || (require = req), req.version = version, req.jsExtRegExp = /^\/|:|\?|\.js$/, req.isBrowser = isBrowser, s = req.s = {contexts: contexts, newContext: newContext}, req({}), each(["toUrl", "undef", "defined", "specified"], function (a) {
            req[a] = function () {
                var b = contexts[defContextName];
                return b.require[a].apply(b, arguments)
            }
        }), isBrowser && (head = s.head = document.getElementsByTagName("head")[0], baseElement = document.getElementsByTagName("base")[0], baseElement && (head = s.head = baseElement.parentNode)), req.onError = defaultOnError, req.createNode = function (a) {
            var b = a.xhtml ? document.createElementNS("http://www.w3.org/1999/xhtml", "html:script") : document.createElement("script");
            return b.type = a.scriptType || "text/javascript", b.charset = "utf-8", b.async = !0, b
        }, req.load = function (a, b, c) {
            var d, e = a && a.config || {};
            if (isBrowser)return d = req.createNode(e, b, c), d.setAttribute("data-requirecontext", a.contextName), d.setAttribute("data-requiremodule", b), !d.attachEvent || d.attachEvent.toString && d.attachEvent.toString().indexOf("[native code") < 0 || isOpera ? (d.addEventListener("load", a.onScriptLoad, !1), d.addEventListener("error", a.onScriptError, !1)) : (useInteractive = !0, d.attachEvent("onreadystatechange", a.onScriptLoad)), d.src = c, currentlyAddingScript = d, baseElement ? head.insertBefore(d, baseElement) : head.appendChild(d), currentlyAddingScript = null, d;
            if (isWebWorker)try {
                importScripts(c), a.completeLoad(b)
            } catch (f) {
                a.onError(makeError("importscripts", "importScripts failed for " + b + " at " + c, f, [b]))
            }
        }, isBrowser && !cfg.skipDataMain && eachReverse(scripts(), function (a) {
            return head || (head = a.parentNode), dataMain = a.getAttribute("data-main"), dataMain ? (mainScript = dataMain, cfg.baseUrl || (src = mainScript.split("/"), mainScript = src.pop(), subPath = src.length ? src.join("/") + "/" : "./", cfg.baseUrl = subPath), mainScript = mainScript.replace(jsSuffixRegExp, ""), req.jsExtRegExp.test(mainScript) && (mainScript = dataMain), cfg.deps = cfg.deps ? cfg.deps.concat(mainScript) : [mainScript], !0) : void 0
        }), define = function (a, b, c) {
            var d, e;
            "string" != typeof a && (c = b, b = a, a = null), isArray(b) || (c = b, b = null), !b && isFunction(c) && (b = [], c.length && (c.toString().replace(commentRegExp, "").replace(cjsRequireRegExp, function (a, c) {
                b.push(c)
            }), b = (1 === c.length ? ["require"] : ["require", "exports", "module"]).concat(b))), useInteractive && (d = currentlyAddingScript || getInteractiveScript(), d && (a || (a = d.getAttribute("data-requiremodule")), e = contexts[d.getAttribute("data-requirecontext")])), (e ? e.defQueue : globalDefQueue).push([a, b, c])
        }, define.amd = {jQuery: !0}, req.exec = function (text) {
            return eval(text)
        }, req(cfg)
    }
}(this), function (a, b, c, d) {
    "use strict";
    var e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z, A, B, C, D, E, F = [].indexOf || function (a) {
        for (var b = 0, c = this.length; c > b; b++)if (b in this && this[b] === a)return b;
        return-1
    };
    y = "notify", x = y + "js", g = y + "!blank", A = {t: "top", m: "middle", b: "bottom", l: "left", c: "center", r: "right"}, q = ["l", "c", "r"], E = ["t", "m", "b"], u = ["t", "b", "l", "r"], v = {t: "b", m: null, b: "t", l: "r", c: null, r: "l"}, w = function (a) {
        var b;
        return b = [], c.each(a.split(/\W+/), function (a, c) {
            var d;
            return d = c.toLowerCase().charAt(0), A[d] ? b.push(d) : void 0
        }), b
    }, D = {}, h = {name: "core", html: '<div class="' + x + '-wrapper">\n  <div class="' + x + '-arrow"></div>\n  <div class="' + x + '-container"></div>\n</div>', css: "." + x + "-corner {\n  position: fixed;\n  margin: 5px;\n  z-index: 1050;\n}\n\n." + x + "-corner ." + x + "-wrapper,\n." + x + "-corner ." + x + "-container {\n  position: relative;\n  display: block;\n  height: inherit;\n  width: inherit;\n  margin: 3px;\n}\n\n." + x + "-wrapper {\n  z-index: 1;\n  position: absolute;\n  display: inline-block;\n  height: 0;\n  width: 0;\n}\n\n." + x + "-container {\n  display: none;\n  z-index: 1;\n  position: absolute;\n  cursor: pointer;\n}\n\n[data-notify-text],[data-notify-html] {\n  position: relative;\n}\n\n." + x + "-arrow {\n  position: absolute;\n  z-index: 2;\n  width: 0;\n  height: 0;\n}"}, C = {"border-radius": ["-webkit-", "-moz-"]}, o = function (a) {
        return D[a]
    }, f = function (b, d) {
        var e, f, g, h;
        if (!b)throw"Missing Style name";
        if (!d)throw"Missing Style definition";
        if (!d.html)throw"Missing Style HTML";
        return(null != (h = D[b]) ? h.cssElem : void 0) && (a.console && console.warn("" + y + ": overwriting style '" + b + "'"), D[b].cssElem.remove()), d.name = b, D[b] = d, e = "", d.classes && c.each(d.classes, function (a, b) {
            return e += "." + x + "-" + d.name + "-" + a + " {\n", c.each(b, function (a, b) {
                return C[a] && c.each(C[a], function (c, d) {
                    return e += "  " + d + a + ": " + b + ";\n"
                }), e += "  " + a + ": " + b + ";\n"
            }), e += "}\n"
        }), d.css && (e += "/* styles for " + d.name + " */\n" + d.css), e && (d.cssElem = t(e), d.cssElem.attr("id", "notify-" + d.name)), g = {}, f = c(d.html), m("html", f, g), m("text", f, g), d.fields = g
    }, t = function (a) {
        var b;
        b = i("style"), b.attr("type", "text/css"), c("head").append(b);
        try {
            b.html(a)
        } catch (d) {
            b[0].styleSheet.cssText = a
        }
        return b
    }, m = function (a, b, d) {
        var e;
        return"html" !== a && (a = "text"), e = "data-notify-" + a, l(b, "[" + e + "]").each(function () {
            var b;
            return b = c(this).attr(e), b || (b = g), d[b] = a
        })
    }, l = function (a, b) {
        return a.is(b) ? a : a.find(b)
    }, z = {clickToHide: !0, autoHide: !0, autoHideDelay: 5e3, arrowShow: !0, arrowSize: 5, breakNewLines: !0, elementPosition: "bottom", globalPosition: "top right", style: "bootstrap", className: "error", showAnimation: "slideDown", showDuration: 400, hideAnimation: "slideUp", hideDuration: 200, gap: 5}, s = function (a, b) {
        var d;
        return d = function () {
        }, d.prototype = a, c.extend(!0, new d, b)
    }, j = function (a) {
        return c.extend(z, a)
    }, i = function (a) {
        return c("<" + a + "></" + a + ">")
    }, p = {}, n = function (a) {
        var b;
        return a.is("[type=radio]") && (b = a.parents("form:first").find("[type=radio]").filter(function (b, d) {
            return c(d).attr("name") === a.attr("name")
        }), a = b.first()), a
    }, r = function (a, b, c) {
        var e, f;
        if ("string" == typeof c)c = parseInt(c, 10); else if ("number" != typeof c)return;
        if (!isNaN(c))return e = A[v[b.charAt(0)]], f = b, a[e] !== d && (b = A[e.charAt(0)], c = -c), a[b] === d ? a[b] = c : a[b] += c, null
    }, B = function (a, b, c) {
        if ("l" === a || "t" === a)return 0;
        if ("c" === a || "m" === a)return c / 2 - b / 2;
        if ("r" === a || "b" === a)return c - b;
        throw"Invalid alignment"
    }, k = function (a) {
        return k.e = k.e || i("div"), k.e.text(a).html()
    }, e = function () {
        function a(a, b, d) {
            "string" == typeof d && (d = {className: d}), this.options = s(z, c.isPlainObject(d) ? d : {}), this.loadHTML(), this.wrapper = c(h.html), this.wrapper.data(x, this), this.arrow = this.wrapper.find("." + x + "-arrow"), this.container = this.wrapper.find("." + x + "-container"), this.container.append(this.userContainer), a && a.length && (this.elementType = a.attr("type"), this.originalElement = a, this.elem = n(a), this.elem.data(x, this), this.elem.before(this.wrapper)), this.container.hide(), this.run(b)
        }

        return a.prototype.loadHTML = function () {
            var a;
            return a = this.getStyle(), this.userContainer = c(a.html), this.userFields = a.fields
        }, a.prototype.show = function (a, b) {
            var c, d, e, f, g, h = this;
            if (d = function () {
                return a || h.elem || h.destroy(), b ? b() : void 0
            }, g = this.container.parent().parents(":hidden").length > 0, e = this.container.add(this.arrow), c = [], g && a)f = "show"; else if (g && !a)f = "hide"; else if (!g && a)f = this.options.showAnimation, c.push(this.options.showDuration); else {
                if (g || a)return d();
                f = this.options.hideAnimation, c.push(this.options.hideDuration)
            }
            return c.push(d), e[f].apply(e, c)
        }, a.prototype.setGlobalPosition = function () {
            var a, b, d, e, f, g, h, j;
            return j = this.getPosition(), h = j[0], g = j[1], f = A[h], a = A[g], e = h + "|" + g, b = p[e], b || (b = p[e] = i("div"), d = {}, d[f] = 0, "middle" === a ? d.top = "45%" : "center" === a ? d.left = "45%" : d[a] = 0, b.css(d).addClass("" + x + "-corner"), c("body").append(b)), b.prepend(this.wrapper)
        }, a.prototype.setElementPosition = function () {
            var a, b, d, e, f, g, h, i, j, k, l, m, n, o, p, s, t, w, x, y, z, C, D, G, H, I, J, K, L;
            for (D = this.getPosition(), y = D[0], w = D[1], x = D[2], l = this.elem.position(), i = this.elem.outerHeight(), m = this.elem.outerWidth(), j = this.elem.innerHeight(), k = this.elem.innerWidth(), G = this.wrapper.position(), f = this.container.height(), g = this.container.width(), o = A[y], s = v[y], t = A[s], h = {}, h[t] = "b" === y ? i : "r" === y ? m : 0, r(h, "top", l.top - G.top), r(h, "left", l.left - G.left), L = ["top", "left"], H = 0, J = L.length; J > H; H++)z = L[H], p = parseInt(this.elem.css("margin-" + z), 10), p && r(h, z, p);
            if (n = Math.max(0, this.options.gap - (this.options.arrowShow ? d : 0)), r(h, t, n), this.options.arrowShow) {
                for (d = this.options.arrowSize, b = c.extend({}, h), a = this.userContainer.css("border-color") || this.userContainer.css("background-color") || "white", I = 0, K = u.length; K > I; I++)z = u[I], C = A[z], z !== s && (e = C === o ? a : "transparent", b["border-" + C] = "" + d + "px solid " + e);
                r(h, A[s], d), F.call(u, w) >= 0 && r(b, A[w], 2 * d)
            } else this.arrow.hide();
            return F.call(E, y) >= 0 ? (r(h, "left", B(w, g, m)), b && r(b, "left", B(w, d, k))) : F.call(q, y) >= 0 && (r(h, "top", B(w, f, i)), b && r(b, "top", B(w, d, j))), this.container.is(":visible") && (h.display = "block"), this.container.removeAttr("style").css(h), b ? this.arrow.removeAttr("style").css(b) : void 0
        }, a.prototype.getPosition = function () {
            var a, b, c, d, e, f, g, h;
            if (b = this.options.position || (this.elem ? this.options.elementPosition : this.options.globalPosition), a = w(b), 0 === a.length && (a[0] = "b"), c = a[0], F.call(u, c) < 0)throw"Must be one of [" + u + "]";
            return(1 === a.length || (d = a[0], F.call(E, d) >= 0 && (e = a[1], F.call(q, e) < 0)) || (f = a[0], F.call(q, f) >= 0 && (g = a[1], F.call(E, g) < 0))) && (a[1] = (h = a[0], F.call(q, h) >= 0 ? "m" : "l")), 2 === a.length && (a[2] = a[1]), a
        }, a.prototype.getStyle = function (a) {
            var b;
            if (a || (a = this.options.style), a || (a = "default"), b = D[a], !b)throw"Missing style: " + a;
            return b
        }, a.prototype.updateClasses = function () {
            var a, b;
            return a = ["base"], c.isArray(this.options.className) ? a = a.concat(this.options.className) : this.options.className && a.push(this.options.className), b = this.getStyle(), a = c.map(a,function (a) {
                return"" + x + "-" + b.name + "-" + a
            }).join(" "), this.userContainer.attr("class", a)
        }, a.prototype.run = function (a, b) {
            var d, e, f, h, i, j = this;
            if (c.isPlainObject(b) ? c.extend(this.options, b) : "string" === c.type(b) && (this.options.color = b), this.container && !a)return void this.show(!1);
            if (this.container || a) {
                e = {}, c.isPlainObject(a) ? e = a : e[g] = a;
                for (f in e)d = e[f], h = this.userFields[f], h && ("text" === h && (d = k(d), this.options.breakNewLines && (d = d.replace(/\n/g, "<br/>"))), i = f === g ? "" : "=" + f, l(this.userContainer, "[data-notify-" + h + i + "]").html(d));
                return this.updateClasses(), this.elem ? this.setElementPosition() : this.setGlobalPosition(), this.show(!0), this.options.autoHide ? (clearTimeout(this.autohideTimer), this.autohideTimer = setTimeout(function () {
                    return j.show(!1)
                }, this.options.autoHideDelay)) : void 0
            }
        }, a.prototype.destroy = function () {
            return this.wrapper.remove()
        }, a
    }(), c[y] = function (a, b, d) {
        return a && a.nodeName || a.jquery ? c(a)[y](b, d) : (d = b, b = a, new e(null, b, d)), a
    }, c.fn[y] = function (a, b) {
        return c(this).each(function () {
            var d;
            return d = n(c(this)).data(x), d ? d.run(a, b) : new e(c(this), a, b)
        }), this
    }, c.extend(c[y], {defaults: j, addStyle: f, pluginOptions: z, getStyle: o, insertCSS: t}), c(function () {
        return t(h.css).attr("id", "core-notify"), c(b).on("click notify-hide", "." + x + "-wrapper", function (a) {
            var b;
            return b = c(this).data(x), b && (b.options.clickToHide || "notify-hide" === a.type) ? b.show(!1) : void 0
        })
    })
}(window, document, jQuery), $.notify.addStyle("bootstrap", {html: "<div>\n<span data-notify-text></span>\n</div>", classes: {base: {"font-weight": "bold", padding: "8px 15px 8px 14px", "text-shadow": "0 1px 0 rgba(255, 255, 255, 0.5)", "background-color": "#fcf8e3", border: "1px solid #fbeed5", "border-radius": "4px", "white-space": "nowrap", "padding-left": "25px", "background-repeat": "no-repeat", "background-position": "3px 7px"}, error: {color: "#B94A48", "background-color": "#F2DEDE", "border-color": "#EED3D7", "background-image": "url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAtRJREFUeNqkVc1u00AQHq+dOD+0poIQfkIjalW0SEGqRMuRnHos3DjwAH0ArlyQeANOOSMeAA5VjyBxKBQhgSpVUKKQNGloFdw4cWw2jtfMOna6JOUArDTazXi/b3dm55socPqQhFka++aHBsI8GsopRJERNFlY88FCEk9Yiwf8RhgRyaHFQpPHCDmZG5oX2ui2yilkcTT1AcDsbYC1NMAyOi7zTX2Agx7A9luAl88BauiiQ/cJaZQfIpAlngDcvZZMrl8vFPK5+XktrWlx3/ehZ5r9+t6e+WVnp1pxnNIjgBe4/6dAysQc8dsmHwPcW9C0h3fW1hans1ltwJhy0GxK7XZbUlMp5Ww2eyan6+ft/f2FAqXGK4CvQk5HueFz7D6GOZtIrK+srupdx1GRBBqNBtzc2AiMr7nPplRdKhb1q6q6zjFhrklEFOUutoQ50xcX86ZlqaZpQrfbBdu2R6/G19zX6XSgh6RX5ubyHCM8nqSID6ICrGiZjGYYxojEsiw4PDwMSL5VKsC8Yf4VRYFzMzMaxwjlJSlCyAQ9l0CW44PBADzXhe7xMdi9HtTrdYjFYkDQL0cn4Xdq2/EAE+InCnvADTf2eah4Sx9vExQjkqXT6aAERICMewd/UAp/IeYANM2joxt+q5VI+ieq2i0Wg3l6DNzHwTERPgo1ko7XBXj3vdlsT2F+UuhIhYkp7u7CarkcrFOCtR3H5JiwbAIeImjT/YQKKBtGjRFCU5IUgFRe7fF4cCNVIPMYo3VKqxwjyNAXNepuopyqnld602qVsfRpEkkz+GFL1wPj6ySXBpJtWVa5xlhpcyhBNwpZHmtX8AGgfIExo0ZpzkWVTBGiXCSEaHh62/PoR0p/vHaczxXGnj4bSo+G78lELU80h1uogBwWLf5YlsPmgDEd4M236xjm+8nm4IuE/9u+/PH2JXZfbwz4zw1WbO+SQPpXfwG/BBgAhCNZiSb/pOQAAAAASUVORK5CYII=)"}, success: {color: "#468847", "background-color": "#DFF0D8", "border-color": "#D6E9C6", "background-image": "url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAutJREFUeNq0lctPE0Ecx38zu/RFS1EryqtgJFA08YCiMZIAQQ4eRG8eDGdPJiYeTIwHTfwPiAcvXIwXLwoXPaDxkWgQ6islKlJLSQWLUraPLTv7Gme32zoF9KSTfLO7v53vZ3d/M7/fIth+IO6INt2jjoA7bjHCJoAlzCRw59YwHYjBnfMPqAKWQYKjGkfCJqAF0xwZjipQtA3MxeSG87VhOOYegVrUCy7UZM9S6TLIdAamySTclZdYhFhRHloGYg7mgZv1Zzztvgud7V1tbQ2twYA34LJmF4p5dXF1KTufnE+SxeJtuCZNsLDCQU0+RyKTF27Unw101l8e6hns3u0PBalORVVVkcaEKBJDgV3+cGM4tKKmI+ohlIGnygKX00rSBfszz/n2uXv81wd6+rt1orsZCHRdr1Imk2F2Kob3hutSxW8thsd8AXNaln9D7CTfA6O+0UgkMuwVvEFFUbbAcrkcTA8+AtOk8E6KiQiDmMFSDqZItAzEVQviRkdDdaFgPp8HSZKAEAL5Qh7Sq2lIJBJwv2scUqkUnKoZgNhcDKhKg5aH+1IkcouCAdFGAQsuWZYhOjwFHQ96oagWgRoUov1T9kRBEODAwxM2QtEUl+Wp+Ln9VRo6BcMw4ErHRYjH4/B26AlQoQQTRdHWwcd9AH57+UAXddvDD37DmrBBV34WfqiXPl61g+vr6xA9zsGeM9gOdsNXkgpEtTwVvwOklXLKm6+/p5ezwk4B+j6droBs2CsGa/gNs6RIxazl4Tc25mpTgw/apPR1LYlNRFAzgsOxkyXYLIM1V8NMwyAkJSctD1eGVKiq5wWjSPdjmeTkiKvVW4f2YPHWl3GAVq6ymcyCTgovM3FzyRiDe2TaKcEKsLpJvNHjZgPNqEtyi6mZIm4SRFyLMUsONSSdkPeFtY1n0mczoY3BHTLhwPRy9/lzcziCw9ACI+yql0VLzcGAZbYSM5CCSZg1/9oc/nn7+i8N9p/8An4JMADxhH+xHfuiKwAAAABJRU5ErkJggg==)"}, info: {color: "#3A87AD", "background-color": "#D9EDF7", "border-color": "#BCE8F1", "background-image": "url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3QYFAhkSsdes/QAAA8dJREFUOMvVlGtMW2UYx//POaWHXg6lLaW0ypAtw1UCgbniNOLcVOLmAjHZolOYlxmTGXVZdAnRfXQm+7SoU4mXaOaiZsEpC9FkiQs6Z6bdCnNYruM6KNBw6YWewzl9z+sHImEWv+vz7XmT95f/+3/+7wP814v+efDOV3/SoX3lHAA+6ODeUFfMfjOWMADgdk+eEKz0pF7aQdMAcOKLLjrcVMVX3xdWN29/GhYP7SvnP0cWfS8caSkfHZsPE9Fgnt02JNutQ0QYHB2dDz9/pKX8QjjuO9xUxd/66HdxTeCHZ3rojQObGQBcuNjfplkD3b19Y/6MrimSaKgSMmpGU5WevmE/swa6Oy73tQHA0Rdr2Mmv/6A1n9w9suQ7097Z9lM4FlTgTDrzZTu4StXVfpiI48rVcUDM5cmEksrFnHxfpTtU/3BFQzCQF/2bYVoNbH7zmItbSoMj40JSzmMyX5qDvriA7QdrIIpA+3cdsMpu0nXI8cV0MtKXCPZev+gCEM1S2NHPvWfP/hL+7FSr3+0p5RBEyhEN5JCKYr8XnASMT0xBNyzQGQeI8fjsGD39RMPk7se2bd5ZtTyoFYXftF6y37gx7NeUtJJOTFlAHDZLDuILU3j3+H5oOrD3yWbIztugaAzgnBKJuBLpGfQrS8wO4FZgV+c1IxaLgWVU0tMLEETCos4xMzEIv9cJXQcyagIwigDGwJgOAtHAwAhisQUjy0ORGERiELgG4iakkzo4MYAxcM5hAMi1WWG1yYCJIcMUaBkVRLdGeSU2995TLWzcUAzONJ7J6FBVBYIggMzmFbvdBV44Corg8vjhzC+EJEl8U1kJtgYrhCzgc/vvTwXKSib1paRFVRVORDAJAsw5FuTaJEhWM2SHB3mOAlhkNxwuLzeJsGwqWzf5TFNdKgtY5qHp6ZFf67Y/sAVadCaVY5YACDDb3Oi4NIjLnWMw2QthCBIsVhsUTU9tvXsjeq9+X1d75/KEs4LNOfcdf/+HthMnvwxOD0wmHaXr7ZItn2wuH2SnBzbZAbPJwpPx+VQuzcm7dgRCB57a1uBzUDRL4bfnI0RE0eaXd9W89mpjqHZnUI5Hh2l2dkZZUhOqpi2qSmpOmZ64Tuu9qlz/SEXo6MEHa3wOip46F1n7633eekV8ds8Wxjn37Wl63VVa+ej5oeEZ/82ZBETJjpJ1Rbij2D3Z/1trXUvLsblCK0XfOx0SX2kMsn9dX+d+7Kf6h8o4AIykuffjT8L20LU+w4AZd5VvEPY+XpWqLV327HR7DzXuDnD8r+ovkBehJ8i+y8YAAAAASUVORK5CYII=)"}, warn: {color: "#C09853", "background-color": "#FCF8E3", "border-color": "#FBEED5", "background-image": "url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAABJlBMVEXr6eb/2oD/wi7/xjr/0mP/ykf/tQD/vBj/3o7/uQ//vyL/twebhgD/4pzX1K3z8e349vK6tHCilCWbiQymn0jGworr6dXQza3HxcKkn1vWvV/5uRfk4dXZ1bD18+/52YebiAmyr5S9mhCzrWq5t6ufjRH54aLs0oS+qD751XqPhAybhwXsujG3sm+Zk0PTwG6Shg+PhhObhwOPgQL4zV2nlyrf27uLfgCPhRHu7OmLgAafkyiWkD3l49ibiAfTs0C+lgCniwD4sgDJxqOilzDWowWFfAH08uebig6qpFHBvH/aw26FfQTQzsvy8OyEfz20r3jAvaKbhgG9q0nc2LbZxXanoUu/u5WSggCtp1anpJKdmFz/zlX/1nGJiYmuq5Dx7+sAAADoPUZSAAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfdBgUBGhh4aah5AAAAlklEQVQY02NgoBIIE8EUcwn1FkIXM1Tj5dDUQhPU502Mi7XXQxGz5uVIjGOJUUUW81HnYEyMi2HVcUOICQZzMMYmxrEyMylJwgUt5BljWRLjmJm4pI1hYp5SQLGYxDgmLnZOVxuooClIDKgXKMbN5ggV1ACLJcaBxNgcoiGCBiZwdWxOETBDrTyEFey0jYJ4eHjMGWgEAIpRFRCUt08qAAAAAElFTkSuQmCC)"}}});
var saveAs = saveAs || navigator.msSaveBlob && navigator.msSaveBlob.bind(navigator) || function (a) {
    "use strict";
    var b = a.document, c = function () {
        return a.URL || a.webkitURL || a
    }, d = a.URL || a.webkitURL || a, e = b.createElementNS("http://www.w3.org/1999/xhtml", "a"), f = "download"in e, g = function (c) {
        var d = b.createEvent("MouseEvents");
        d.initMouseEvent("click", !0, !1, a, 0, 0, 0, 0, 0, !1, !1, !1, !1, 0, null), c.dispatchEvent(d)
    }, h = a.webkitRequestFileSystem, i = a.requestFileSystem || h || a.mozRequestFileSystem, j = function (b) {
        (a.setImmediate || a.setTimeout)(function () {
            throw b
        }, 0)
    }, k = "application/octet-stream", l = 0, m = [], n = function () {
        for (var a = m.length; a--;) {
            var b = m[a];
            "string" == typeof b ? d.revokeObjectURL(b) : b.remove()
        }
        m.length = 0
    }, o = function (a, b, c) {
        b = [].concat(b);
        for (var d = b.length; d--;) {
            var e = a["on" + b[d]];
            if ("function" == typeof e)try {
                e.call(a, c || a)
            } catch (f) {
                j(f)
            }
        }
    }, p = function (b, d) {
        var j, n, p, q = this, r = b.type, s = !1, t = function () {
            var a = c().createObjectURL(b);
            return m.push(a), a
        }, u = function () {
            o(q, "writestart progress write writeend".split(" "))
        }, v = function () {
            (s || !j) && (j = t(b)), n && (n.location.href = j), q.readyState = q.DONE, u()
        }, w = function (a) {
            return function () {
                return q.readyState !== q.DONE ? a.apply(this, arguments) : void 0
            }
        }, x = {create: !0, exclusive: !1};
        return q.readyState = q.INIT, d || (d = "download"), f ? (j = t(b), e.href = j, e.download = d, g(e), q.readyState = q.DONE, void u()) : (a.chrome && r && r !== k && (p = b.slice || b.webkitSlice, b = p.call(b, 0, b.size, k), s = !0), h && "download" !== d && (d += ".download"), n = r === k || h ? a : a.open(), i ? (l += b.size, void i(a.TEMPORARY, l, w(function (a) {
            a.root.getDirectory("saved", x, w(function (a) {
                var c = function () {
                    a.getFile(d, x, w(function (a) {
                        a.createWriter(w(function (c) {
                            c.onwriteend = function (b) {
                                n.location.href = a.toURL(), m.push(a), q.readyState = q.DONE, o(q, "writeend", b)
                            }, c.onerror = function () {
                                var a = c.error;
                                a.code !== a.ABORT_ERR && v()
                            }, "writestart progress write abort".split(" ").forEach(function (a) {
                                c["on" + a] = q["on" + a]
                            }), c.write(b), q.abort = function () {
                                c.abort(), q.readyState = q.DONE
                            }, q.readyState = q.WRITING
                        }), v)
                    }), v)
                };
                a.getFile(d, {create: !1}, w(function (a) {
                    a.remove(), c()
                }), w(function (a) {
                    a.code === a.NOT_FOUND_ERR ? c() : v()
                }))
            }), v)
        }), v)) : void v())
    }, q = p.prototype, r = function (a, b) {
        return new p(a, b)
    };
    return q.abort = function () {
        var a = this;
        a.readyState = a.DONE, o(a, "abort")
    }, q.readyState = q.INIT = 0, q.WRITING = 1, q.DONE = 2, q.error = q.onwritestart = q.onprogress = q.onwrite = q.onabort = q.onerror = q.onwriteend = null, a.addEventListener("unload", n, !1), r
}(self);
L.DeferredLayer = L.LayerGroup.extend({includes: L.Mixin.Events, options: {js: [], init: null, onload: null}, _script_cache: {}, initialize: function (a) {
    L.Util.setOptions(this, a), L.LayerGroup.prototype.initialize.apply(this), this._loaded = !1
}, getURL: function () {
}, onAdd: function (a) {
    var b = this;
    if (L.LayerGroup.prototype.onAdd.apply(this, [a]), !this._loaded) {
        var c = function () {
            this._loaded = !0;
            var a = this.options.init();
            a && (a.on("load", function (a) {
                b.fire("load", a)
            }), this.addLayer(a))
        };
        this._loadScripts(this.options.js.reverse(), L.Util.bind(c, this))
    }
}, _loadScripts: function (a, b, c) {
    function d() {
        f._loadScripts(a, b, c)
    }

    if (!a || 0 == a.length)return b(c);
    var e, f = this, g = a.pop();
    if (e = this._script_cache[g], void 0 === e) {
        e = {url: g, wait: []};
        var h = document.createElement("script");
        h.src = g, h.type = "text/javascript", h.onload = function () {
            e.e.readyState = "completed";
            var a = 0;
            for (a = 0; a < e.wait.length; a++)e.wait[a]()
        }, e.e = h, document.getElementsByTagName("head")[0].appendChild(h)
    }
    e.wait.push(d), "completed" == e.e.readyState && d(), this._script_cache[g] = e
}});
var Gis = {};
window.Gis = Gis, window.FILTER_ROTATABLE_IMAGES = window.hasOwnProperty("FILTER_ROTATABLE_IMAGES") ? window.FILTER_ROTATABLE_IMAGES : !0, Gis.version = "object" == typeof window ? window.buildVersion : this.buildVersion, Gis.buildDate = this.buildDate ? this.buildDate : "", Gis.moduleKey = "TacticMapClient", Gis.moduleName = {ru: "  "}, Gis.Config = {deltaPixcel: 2, needUserNotify: !0, overlayClass: "gis-overlays", heatMapClass: "gis-heat-map", popupClass: "gis-popup", captionClass: "gis-caption", textLabelClass: "gis-label", imageLabelClass: "gis-image-label", gisSelectedClass: "gis-selected", defaultProjection: "EPSG3857", relativePath: "", DefaultHatchColor: "black", maxInCache: 15, DefaultBearingBehavior: {latestBearingCount: 1}, style: {DefaultTempLine: {color: "gray", border: "white", thickness: 3, dash: "dot"}, DefaultCourseStyle: null, DefaultLine: {color: "#0033ff", thickness: 1, dash: "solid", border: void 0}, DefaultTrackStyle: null, DefaultFill: {color: "#0033ff", hatch: void 0, hatchColor: void 0}, DefaultTrackBehavior: {traceLengthSeconds: 0, traceLengthMeters: 1e4}, DefaultBearingBehavior: {latestBearingCount: 1}, DefaultTextLabel: {latitude: void 0, longitude: void 0, selectable: void 0, draggable: void 0, foreColor: "#FFFFFF", backColor: "#AB1D4A", position: "centerright", className: void 0, drawPoint: !0}}, REST: {port: void 0}, connection: {host: "localhost", port: "9797", portSecond: "8080", reconnectDelay: 5e3}, heatmap: {opacity: .6, color: [
    {percent: 0, color: "rgb(13,255,3)"},
    {percent: 1, color: "rgb(170,19,19)"}
]}, tiles: {bingKey: "AlJxQ0XPAmp2briEr8BrKXferQDjH7GXYd-yT4M-HT_37eSREOfCF_zAnk6gii7V", otherAsLocal: !0, workWithoutCacheConfig: !0, forceCacheExtension: null, loadDataOtherOrigin: !0, cacheConfigFile: "tmc_map_config.js"}}, Gis.Config.image = function (a) {
    var b = Gis.Config.image, c = {path: b && b.path || Gis.Config.relativePath + "images/", ErrorTile: b && b.ErrorTile || Gis.Config.relativePath + "images/no_image.gif", rotationIcon: b && b.ErrorTile || Gis.Config.relativePath + "images/rotate.gif", extensions: b && b.extensions || ".png", serverOverlayExtension: b && b.serverOverlayExtension || "", defaultHost: b && b.defaultHost || "gis", defaultProtocol: b && b.defaultProtocol || "http", defaultPort: b && b.defaultPort || "80"};
    return c[a]
}, Gis.config = function (a, b) {
    var c, d, e, f;
    if (b = Gis.Util.isDefine(b) ? b : null, !a)return b;
    if (f = a.split("."), !f)return b;
    for (e = Gis.Config, c = 0, d = f.length; d > c; c += 1)if (e = e[f[c]], !Gis.Util.isDefine(e))return b;
    return e
}, Gis.setConfig = function (a, b) {
    var c, d, e, f, g;
    if (!a)return null;
    if (f = a.split("."), !f)return null;
    for (e = Gis.Config, c = 0, d = f.length - 1; d > c; c += 1)g = e[f[c]], Gis.Util.isDefine(g) || (g = {}, e[f[c]] = g), e = g;
    e[f[c]] = b
}, window.GIS_RGBA_DISABLE = !1, window.GIS_GENERATE_GUID = !1, function () {
    "use strict";
    Array.prototype.indexOf || (Array.prototype.indexOf = function (a) {
        if (null == this)throw new TypeError;
        var b, c, d = Object(this), e = d.length >>> 0;
        if (0 === e)return-1;
        if (b = 0, arguments.length > 1 && (b = Number(arguments[1]), b != b ? b = 0 : 0 != b && 1 / 0 != b && b != -1 / 0 && (b = (b > 0 || -1) * Math.floor(Math.abs(b)))), b >= e)return-1;
        for (c = b >= 0 ? b : Math.max(e - Math.abs(b), 0); e > c; c++)if (c in d && d[c] === a)return c;
        return-1
    })
}(), function () {
    "use strict";
    window.BrowserDetect = {init: function () {
        this.browser = this.searchString(this.dataBrowser) || "An unknown browser", this.version = this.searchVersion(navigator.userAgent) || this.searchVersion(navigator.appVersion) || "an unknown version", this.OS = this.searchString(this.dataOS) || "an unknown OS"
    }, isWebKit: function () {
        var a = this.browser.toLowerCase();
        return"chrome" === a || "safary" === a || "webkit" === a
    }, searchString: function (a) {
        for (var b = 0; b < a.length; b++) {
            var c = a[b].string, d = a[b].prop;
            if (this.versionSearchString = a[b].versionSearch || a[b].identity, c) {
                if (-1 !== c.indexOf(a[b].subString))return a[b].identity
            } else if (d)return a[b].identity
        }
    }, searchVersion: function (a) {
        var b = a.indexOf(this.versionSearchString);
        if (-1 !== b)return parseFloat(a.substring(b + this.versionSearchString.length + 1))
    }, dataBrowser: [
        {string: navigator.userAgent, subString: "Chrome", identity: "Chrome"},
        {string: navigator.userAgent, subString: "OmniWeb", versionSearch: "OmniWeb/", identity: "OmniWeb"},
        {string: navigator.userAgent, subString: "AppleWebKit", identity: "WebKit"},
        {string: navigator.vendor, subString: "Apple", identity: "Safari", versionSearch: "Version"},
        {prop: window.opera, identity: "Opera", versionSearch: "Version"},
        {string: navigator.vendor, subString: "iCab", identity: "iCab"},
        {string: navigator.vendor, subString: "KDE", identity: "Konqueror"},
        {string: navigator.userAgent, subString: "Firefox", identity: "Firefox"},
        {string: navigator.vendor, subString: "Camino", identity: "Camino"},
        {string: navigator.userAgent, subString: "Netscape", identity: "Netscape"},
        {string: navigator.userAgent, subString: "MSIE", identity: "Explorer", versionSearch: "MSIE"},
        {string: navigator.userAgent, subString: "Gecko", identity: "Mozilla", versionSearch: "rv"},
        {string: navigator.userAgent, subString: "Mozilla", identity: "Netscape", versionSearch: "Mozilla"}
    ], dataOS: [
        {string: navigator.platform, subString: "Win", identity: "Windows"},
        {string: navigator.platform, subString: "Mac", identity: "Mac"},
        {string: navigator.userAgent, subString: "iPhone", identity: "iPhone/iPod"},
        {string: navigator.platform, subString: "Linux", identity: "Linux"}
    ]}, BrowserDetect.init()
}(Gis), function (a) {
    "use strict";
    a.Canvas = {lineByPath: function (a, b) {
        var c, d = b.split(" ");
        return d.forEach(function (b) {
            c = b.split(","), a.lineTo(c[0], c[1])
        }), a
    }, roundRect: function (a, b, c, d, e, f, g, h) {
        h = h || !0, f = f || 5, a.fillStyle = g, a.beginPath(), a.moveTo(b + f, c), a.lineTo(b + d - f, c), a.quadraticCurveTo(b + d, c, b + d, c + f), a.lineTo(b + d, c + e - f), a.quadraticCurveTo(b + d, c + e, b + d - f, c + e), a.lineTo(b + f, c + e), a.quadraticCurveTo(b, c + e, b, c + e - f), a.lineTo(b, c + f), a.quadraticCurveTo(b, c, b + f, c), a.closePath(), g && (a.fillStyle = g, a.fill()), h && (a.strokeStyle = h, a.stroke())
    }}
}(Gis), function (a) {
    "use strict";
    var b = {};
    Gis.Concurrency = {isWebWorkers: function () {
        return Modernizr && Modernizr.webworkers || a.Worker
    }, getWorker: function (a) {
        return b[a]
    }, registerWorker: function (a, c) {
        b[a] = c
    }}
}(this), function (a) {
    "use strict";
    var b = "_gis_";
    a.DomUtil = {getStyle: function (a, b) {
        var c;
        return c = window.getComputedStyle ? window.getComputedStyle(a) : a.currentStyle, c[b] || ""
    }, prepend: function (a, b) {
        a.firstChild ? a.insertBefore(b, a.firstChild) : a.appendChild(b)
    }, isCssTransform: function () {
        return Modernizr && (Modernizr.csstransforms3d || Modernizr.csstransforms)
    }, isCssTransform3d: function () {
        return Modernizr && Modernizr.csstransforms3d
    }, prefixes: function (a) {
        return Modernizr && Modernizr.prefixed(a) || a
    }, getPosition: function (a) {
        return a ? {left: a[b + "left"], top: a[b + "top"]} : void 0
    }, attachValue: function (a, c, d) {
        return a && (a[b + c] = d), this
    }}
}(Gis), function () {
    "use strict";
    var a = "_gis_preferences_";
    Gis.Preferences = {setPreferenceData: function (a, b) {
        this.setPreference(a, JSON.stringify(b))
    }, getPreferenceData: function (a) {
        var b = this.getPreference(a);
        if (b && b + "" != void 0 + "" && b + "" != "null")try {
            b = JSON.parse(b)
        } catch (c) {
            return void Gis.Logger.log("   ,    .", b)
        }
        return b
    }, setPreference: function (b, c) {
        Gis.myLocalStorage.setItem(a + b, c)
    }, getPreference: function (b) {
        return Gis.myLocalStorage.getItem(a + b)
    }}
}(Gis), function (a) {
    "use strict";
    a.LineUtil = {simplify: function (a, b) {
        if (!b || !a.length)return a.slice();
        var c = b * b;
        return a = this._reducePoints(a, c), a = this._simplifyDP(a, c)
    }, _reducePoints: function (b, c) {
        var d, e, f, g = [b[0]];
        for (d = 1, e = 0, f = b.length; f > d; d += 1)a.Projection.distanceTo(b[d], b[e]) > c && (g.push(b[d]), e = d);
        return f - 1 > e && g.push(b[f - 1]), g
    }, _simplifyDP: function (a, b) {
        var c, d, e = a.length, f = typeof Int32Array != void 0 + "" ? Int32Array : Array, g = new f(e);
        for (g[0] = g[e - 1] = 1, this._simplifyDPStep(a, g, b, 0, e - 1), d = [], c = 0; e > c; c += 1)g[c] && d.push(a[c]);
        return d
    }, _simplifyDPStep: function (a, b, c, d, e) {
        var f, g, h, i = 0;
        for (g = d + 1; e - 1 >= g; g += 1)h = this._sqClosestPointOnSegment(a[g], a[d], a[e], !0), h > i && (f = g, i = h);
        i > c && (b[f] = 1, this._simplifyDPStep(a, b, c, d, f), this._simplifyDPStep(a, b, c, f, e))
    }, _sqDist: function (a, b) {
        var c = b.lng - a.lng, d = b.lat - a.lat;
        return c * c + d * d
    }, _sqClosestPointOnSegment: function (b, c, d, e) {
        var f, g = c.lng, h = c.lat, i = d.lng - g, j = d.lat - h, k = i * i + j * j;
        return k > 0 && (f = ((b.lng - g) * i + (b.lat - h) * j) / k, f > 1 ? (g = d.lng, h = d.lat) : f > 0 && (g += i * f, h += j * f)), i = b.lng - g, j = b.lat - h, e ? i * i + j * j : new a.latLng(h, g)
    }}
}(Gis), function () {
    "use strict";
    !window.localStorage || window.GIS_PREFER_COOKIE ? Object.defineProperty(Gis, "myLocalStorage", new function () {
        var a = [], b = {};
        Object.defineProperty(b, "getItem", {value: function (a) {
            return a ? this[a] : null
        }, writable: !1, configurable: !1, enumerable: !1}), Object.defineProperty(b, "key", {value: function (b) {
            return a[b]
        }, writable: !1, configurable: !1, enumerable: !1}), Object.defineProperty(b, "setItem", {value: function (a, b) {
            a && (document.cookie = escape(a) + "=" + escape(b) + "; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/")
        }, writable: !1, configurable: !1, enumerable: !1}), Object.defineProperty(b, "length", {get: function () {
            return a.length
        }, configurable: !1, enumerable: !1}), Object.defineProperty(b, "removeItem", {value: function (a) {
            a && (document.cookie = escape(a) + "=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")
        }, writable: !1, configurable: !1, enumerable: !1}), this.get = function () {
            var c;
            for (var d in b)c = a.indexOf(d), -1 === c ? b.setItem(d, b[d]) : a.splice(c, 1), delete b[d];
            for (a; a.length > 0; a.splice(0, 1))b.removeItem(a[0]);
            for (var e, f, g = 0, h = document.cookie.split(/\s*;\s*/); g < h.length; g++)e = h[g].split(/\s*=\s*/), e.length > 1 && (b[f = unescape(e[0])] = unescape(e[1]), a.push(f));
            return b
        }, this.configurable = !1, this.enumerable = !0
    }) : Gis.myLocalStorage = window.localStorage
}(), Gis.Logger = function () {
    "use strict";
    return{logLevel: 1, logerror: function (a) {
        "object" == typeof a && console.table && console.table(a)
    }, log: function (a, b, c) {
        var d;
        this.logLevel > 0 && (d = (new Date).getTime() / 1e3, console.log("[" + d + "]: " + a), this.logerror(a), this.logLevel > 1 && b && (console.log("	" + b), this.logerror(b)), this.logLevel > 2 && c && (console.error("		" + c), this.logerror(c)))
    }}
}(), function (a) {
    "use strict";
    a.NetworkUtil = {}
}(Gis), function (a) {
    "use strict";
    a.notify = function (b, c) {
        a.Config.needUserNotify && $ && $.notify && $.notify(b, c)
    }
}(Gis), function (a) {
    "use strict";
    a.Projection = {R: 6378137, L: 40075e3, MERIDIAN_LENGTH: 20003930, distanceTo: function (a, b) {
        var c, d, e = Math.PI / 180, f = (b[0] - a[0]) * e, g = (b[1] - a[1]) * e, h = a[0] * e, i = b[0] * e, j = Math.sin(f / 2), k = Math.sin(g / 2);
        return c = j * j + k * k * Math.cos(h) * Math.cos(i), d = 2 * this.R * Math.atan2(Math.sqrt(c), Math.sqrt(1 - c))
    }, nextPointByLen: function (b, c, d) {
        var e, f, g, h, i, j;
        return c = a.latLng(c), g = a.Util.gradToRad(c.lng), e = a.Util.gradToRad(c.lat), i = a.Util.gradToRad(d), f = Math.asin(Math.sin(e) * Math.cos(b / a.Projection.R) + Math.cos(e) * Math.sin(b / a.Projection.R) * Math.cos(i)), h = g + Math.atan2(Math.sin(i) * Math.sin(b / a.Projection.R) * Math.cos(e), Math.cos(b / a.Projection.R) - Math.sin(e) * Math.sin(f)), j = a.Util.radToGrad(h), [a.Util.radToGrad(f), j]
    }, getNextBearingPointSimplifiedLongitude: function (a, b) {
        return b
    }, calculateNextBearingPoint: function (a, b) {
        var c;
        return a = Gis.latLng(a), b = Gis.latLng(b), c = this.calculateAsimuth(a, b), Gis.latLng(this.nextPointByLen(a.distanceTo(b), a, c))
    }, bearingByPoints: function (a, b, c) {
        var d, e, f, g, h, i = [];
        for (c = c || 8e4, a = Gis.latLng(a), b = Gis.latLng(b), h = Gis.Projection.getNextBearingPointSimplifiedLongitude(a, b), b.lng = h.lng, d = this.calculateAsimuth(a, b), g = a.distanceTo(b), e = 0; Math.abs(e) <= g; e += c)f = this.nextPointByLen(e, a, d), i.push(f);
        return e !== g && (f = this.nextPointByLen(g, a, d), i.push(f)), i
    }, absLongitude: function (a) {
        return a >= 0 ? a : 360 + a % 360
    }, calculateAsimuth: function (b, c) {
        var d, e, f = a.Util.gradToRad(b.lng) - a.Util.gradToRad(c.lng);
        return d = a.Util.gradToRad(b.lat), e = a.Util.gradToRad(c.lat), -a.Util.radToGrad(Math.atan2(Math.sin(f) * Math.cos(e), Math.cos(d) * Math.sin(e) - Math.sin(d) * Math.cos(e) * Math.cos(f))) % 360
    }, calculateLoxodromeAngle: function (b, c) {
        var d, e, f, g, h;
        return d = a.Util.gradToRad(b.lat), e = a.Util.gradToRad(c.lat), g = a.Util.gradToRad(b.lng), f = a.Util.gradToRad(c.lng), h = a.Util.radToGrad(Math.atan(Math.cos((d + e) / 2) * (f - g) / (e - d))) % 360, 0 > h && (h = 360 + h), d > e && g > f ? h = 180 + h : d > e && f > g && (h -= 180), h
    }}
}(Gis), RGBColor.prototype.parseColor = function (a) {
    this.ok = !1, "#" == a.charAt(0) && (a = a.substr(1, 6)), a = a.replace(/ /g, ""), a = a.toLowerCase();
    var b = {aliceblue: "f0f8ff", antiquewhite: "faebd7", aqua: "00ffff", aquamarine: "7fffd4", azure: "f0ffff", beige: "f5f5dc", bisque: "ffe4c4", black: "000000", blanchedalmond: "ffebcd", blue: "0000ff", blueviolet: "8a2be2", brown: "a52a2a", burlywood: "deb887", cadetblue: "5f9ea0", chartreuse: "7fff00", chocolate: "d2691e", coral: "ff7f50", cornflowerblue: "6495ed", cornsilk: "fff8dc", crimson: "dc143c", cyan: "00ffff", darkblue: "00008b", darkcyan: "008b8b", darkgoldenrod: "b8860b", darkgray: "a9a9a9", darkgreen: "006400", darkkhaki: "bdb76b", darkmagenta: "8b008b", darkolivegreen: "556b2f", darkorange: "ff8c00", darkorchid: "9932cc", darkred: "8b0000", darksalmon: "e9967a", darkseagreen: "8fbc8f", darkslateblue: "483d8b", darkslategray: "2f4f4f", darkturquoise: "00ced1", darkviolet: "9400d3", deeppink: "ff1493", deepskyblue: "00bfff", dimgray: "696969", dodgerblue: "1e90ff", feldspar: "d19275", firebrick: "b22222", floralwhite: "fffaf0", forestgreen: "228b22", fuchsia: "ff00ff", gainsboro: "dcdcdc", ghostwhite: "f8f8ff", gold: "ffd700", goldenrod: "daa520", gray: "808080", green: "008000", greenyellow: "adff2f", honeydew: "f0fff0", hotpink: "ff69b4", indianred: "cd5c5c", indigo: "4b0082", ivory: "fffff0", khaki: "f0e68c", lavender: "e6e6fa", lavenderblush: "fff0f5", lawngreen: "7cfc00", lemonchiffon: "fffacd", lightblue: "add8e6", lightcoral: "f08080", lightcyan: "e0ffff", lightgoldenrodyellow: "fafad2", lightgrey: "d3d3d3", lightgreen: "90ee90", lightpink: "ffb6c1", lightsalmon: "ffa07a", lightseagreen: "20b2aa", lightskyblue: "87cefa", lightslateblue: "8470ff", lightslategray: "778899", lightsteelblue: "b0c4de", lightyellow: "ffffe0", lime: "00ff00", limegreen: "32cd32", linen: "faf0e6", magenta: "ff00ff", maroon: "800000", mediumaquamarine: "66cdaa", mediumblue: "0000cd", mediumorchid: "ba55d3", mediumpurple: "9370d8", mediumseagreen: "3cb371", mediumslateblue: "7b68ee", mediumspringgreen: "00fa9a", mediumturquoise: "48d1cc", mediumvioletred: "c71585", midnightblue: "191970", mintcream: "f5fffa", mistyrose: "ffe4e1", moccasin: "ffe4b5", navajowhite: "ffdead", navy: "000080", oldlace: "fdf5e6", olive: "808000", olivedrab: "6b8e23", orange: "ffa500", orangered: "ff4500", orchid: "da70d6", palegoldenrod: "eee8aa", palegreen: "98fb98", paleturquoise: "afeeee", palevioletred: "d87093", papayawhip: "ffefd5", peachpuff: "ffdab9", peru: "cd853f", pink: "ffc0cb", plum: "dda0dd", powderblue: "b0e0e6", purple: "800080", red: "ff0000", rosybrown: "bc8f8f", royalblue: "4169e1", saddlebrown: "8b4513", salmon: "fa8072", sandybrown: "f4a460", seagreen: "2e8b57", seashell: "fff5ee", sienna: "a0522d", silver: "c0c0c0", skyblue: "87ceeb", slateblue: "6a5acd", slategray: "708090", snow: "fffafa", springgreen: "00ff7f", steelblue: "4682b4", tan: "d2b48c", teal: "008080", thistle: "d8bfd8", tomato: "ff6347", turquoise: "40e0d0", violet: "ee82ee", violetred: "d02090", wheat: "f5deb3", white: "ffffff", whitesmoke: "f5f5f5", yellow: "ffff00", yellowgreen: "9acd32"};
    for (var c in b)a == c && (a = b[c]);
    for (var d = [
        {re: /^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/, example: ["rgb(123, 234, 45)", "rgb(255,234,245)"], process: function (a) {
            return[parseInt(a[1]), parseInt(a[2]), parseInt(a[3])]
        }},
        {re: /^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}\.*\d*)\)$/, example: ["rgba(123, 234, 45, 0.5)", "rgba(255,234,245, 1)"], process: function (a) {
            return[parseInt(a[1]), parseInt(a[2]), parseInt(a[3]), parseFloat(a[4])]
        }},
        {re: /^(\w{2})(\w{2})(\w{2})$/, example: ["#00ff00", "336699"], process: function (a) {
            return[parseInt(a[1], 16), parseInt(a[2], 16), parseInt(a[3], 16)]
        }},
        {re: /^(\w{1})(\w{1})(\w{1})$/, example: ["#fb0", "f0f"], process: function (a) {
            return[parseInt(a[1] + a[1], 16), parseInt(a[2] + a[2], 16), parseInt(a[3] + a[3], 16)]
        }}
    ], e = 0; e < d.length; e++) {
        var f = d[e].re, g = d[e].process, h = f.exec(a);
        h && (channels = g(h), this.r = channels[0], this.g = channels[1], this.b = channels[2], this.a = channels.length > 3 ? channels[3] : 1, this.ok = !0)
    }
    this.r = this.r < 0 || isNaN(this.r) ? 0 : this.r > 255 ? 255 : this.r, this.g = this.g < 0 || isNaN(this.g) ? 0 : this.g > 255 ? 255 : this.g, this.b = this.b < 0 || isNaN(this.b) ? 0 : this.b > 255 ? 255 : this.b, this.a = this.a < 0 || isNaN(this.a) ? 0 : this.a > 1 ? 1 : this.a, this.toRGB = function () {
        return"rgb(" + this.r + ", " + this.g + ", " + this.b + ")"
    }, this.toRGBA = function () {
        return"rgba(" + this.r + ", " + this.g + ", " + this.b + ", " + this.a + ")"
    }, this.toHex = function () {
        var a = this.r.toString(16), b = this.g.toString(16), c = this.b.toString(16);
        return 1 == a.length && (a = "0" + a), 1 == b.length && (b = "0" + b), 1 == c.length && (c = "0" + c), "#" + a + b + c
    }, this.getHelpXML = function () {
        for (var a = new Array, c = 0; c < d.length; c++)for (var e = d[c].example, f = 0; f < e.length; f++)a[a.length] = e[f];
        for (var g in b)a[a.length] = g;
        var h = document.createElement("ul");
        h.setAttribute("id", "rgbcolor-examples");
        for (var c = 0; c < a.length; c++)try {
            var i = document.createElement("li"), j = new RGBColor(a[c]), k = document.createElement("div");
            k.style.cssText = "margin: 3px; border: 1px solid black; background:" + j.toHex() + "; color:" + j.toHex(), k.appendChild(document.createTextNode("test"));
            var l = document.createTextNode(" " + a[c] + " -> " + j.toRGB() + " -> " + j.toRGBA() + " -> " + j.toHex());
            i.appendChild(k), i.appendChild(l), h.appendChild(i)
        } catch (m) {
        }
        return h
    }
}, function (a) {
    "use strict";
    function b() {
        return(65536 * (1 + Math.random()) | 0).toString(16).substring(1)
    }

    Gis.SK_AUTOZONE = null;
    var c = a.requestAnimationFrame || a.webkitRequestAnimationFrame || a.mozRequestAnimationFrame, d = !location.href.indexOf("file:/");
    Gis.requestAnimationFrame = function (b) {
        return c || function (c) {
            a.setTimeout(c, b)
        }
    }, Array.prototype.compare = Array.prototype.compare || function (a) {
        if (this.length != a.length)return!1;
        for (var b = 0; b < a.length; b++) {
            if (this[b].compare && !this[b].compare(a[b]))return!1;
            if (this[b] !== a[b])return!1
        }
        return!0
    }, Gis.Util = {rotate: function (a, b) {
        var c = -b * Math.PI / 180;
        return L.point(a.x * Math.cos(c) - a.y * Math.sin(c), a.x * Math.sin(c) + a.y * Math.cos(c))
    }, isInFixedZoneBounds: function (a) {
        var b, c;
        return Gis.Util.isNumeric(Gis.SK_AUTOZONE) ? (b = 6 * Gis.SK_AUTOZONE + 1, c = b - 8, a >= c && c + 1 >= a || b > a && a >= b - 1) : !1
    }, getZoneFromLongitude: function (a) {
        var b = this.isInFixedZoneBounds(a), c = Math.floor(Gis.Projection.absLongitude(a) % 360 / 6 + 1);
        return b && Gis.Util.isNumeric(Gis.SK_AUTOZONE) ? Gis.SK_AUTOZONE : c
    }, extend: function (a) {
        var b, c, d, e, f = Array.prototype.slice.call(arguments, 1);
        for (c = 0, d = f.length; d > c; c += 1) {
            e = f[c] || {};
            for (b in e)e.hasOwnProperty(b) && (a[b] = e[b])
        }
        return a
    }, fill: function (a) {
        var b, c, d, e, f = Array.prototype.slice.call(arguments, 1);
        for (c = 0, d = f.length; d > c; c += 1) {
            e = f[c] || {};
            for (b in e)e.hasOwnProperty(b) && a.hasOwnProperty(b) && (a[b] = e[b])
        }
        return a
    }, inherit: function (a) {
        function b() {
        }

        if (null === a)throw new TypeError;
        if (Object.create)return Object.create(a);
        var c = typeof a;
        if ("object" !== c && "function" !== c)throw new TypeError;
        return b.prototype = a, new b
    }, defineSubclass: function (a, b, c) {
        var d = function () {
            this.initialize && this.initialize.apply(this, arguments)
        };
        return c && (d = Gis.Util.extend(d, c)), d.include = function (a) {
            var b, c;
            a.options && (Gis.Util.extend(d.prototype.options, a.options), delete a.options), a.initialize && (b = d.prototype.initialize, c = a.initialize, d.prototype.initialize = function () {
                var a = this, d = arguments;
                c.call(this, function () {
                    b.apply(a, d)
                })
            }, delete a.initialize), Gis.Util.extend(d.prototype, a)
        }, d.prototype = Gis.Util.inherit(a.prototype), d.prototype.constructor = d, d.prototype._super = a.prototype, b.includes && (Gis.Util.extend.apply(null, [b].concat(b.includes)), delete b.includes), b.options && (b.options = Gis.Util.extend({}, d.prototype.options, b.options)), b && Gis.Util.extend(d.prototype, b), d
    }, splitWords: function (a) {
        return a.replace(/^\s+|\s+$/g, "").split(/\s+/)
    }, formatNum: function (a, b) {
        var c = Math.pow(10, b || 5);
        return Math.round(a * c) / c
    }, gradToRad: function (a) {
        return a * (Math.PI / 180)
    }, radToGrad: function (a) {
        return a * (180 / Math.PI)
    }, generateGUID: function () {
        return b() + b() + "-" + b() + "-" + b() + "-" + b() + "-" + b() + b() + b()
    }, checkGUID: function (a) {
        var b, c = /^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;
        return b = a && a.match && a.match(c), b && 1 === b.length
    }, compareArrays: function (a, b) {
        if (!this.isDefine(a) || !this.isDefine(b))return!1;
        var c, d = a.length;
        if (d !== b.length)return!1;
        for (c = 0; d > c; c += 1)if (a[c]instanceof Array && b[c]instanceof Array) {
            if (!a[c].compare(b[c]))return!1
        } else if (a[c] !== b[c])return!1;
        return!0
    }, lastTrim: function (a, b) {
        return b = Gis.Util.isDefine(b) ? b : " ", a[a.length - 1] === b && (a = a.substr(0, a.length - 1)), a
    }, isNumeric: function (a) {
        return!isNaN(parseFloat(a)) && isFinite(a)
    }, isFunction: function (a) {
        return"function" == typeof a
    }, isArray: function (a) {
        return a && Object.prototype.toString.call(a).toLowerCase().indexOf("array") > -1
    }, greateHtmlList: function (a) {
        var b, c;
        return this.isArray(a) && a.length && (b = document.createElement("div"), b.classList.add("gis-custom-action-list-container"), c = '<ul class="gis-custom-action-list">' + a.reduce(function (a, b) {
            return a + '<li data-action="' + b + '"><span>' + b + "</span></li>"
        }, "") + "</ul>", b.innerHTML = c), b
    }, toFixed: function (a, b) {
        return a.toFixed ? a.toFixed(b) : parseFloat(a).toFixed(b)
    }, isDefine: function (a) {
        return void 0 != a && null != a
    }, isAwesomium: function () {
        return navigator.userAgent.toLowerCase().indexOf("awesomium") > -1
    }, isCellNet: function () {
        return this.isDefine(a.cellnet)
    }, isString: function (a) {
        return this.isDefine(a) && "string" === (typeof a).toLowerCase()
    }, fillMapFromObject: function (a, b) {
        function c(a, b) {
            try {
                var c = a.getLayer(b.id);
                b.tags && b.tags.creator && (b.tags.creator = a.getSetting("creator")), b.id = Gis.Util.generateGUID(), c && c.getType() === b.tacticObjectType ? (c.setData(b, void 0, !0), Gis.Logger.log("Object updated " + c.getId(), c)) : Gis.ObjectFactory.createObject(b).addTo(a)
            } catch (d) {
                Gis.Logger.log("    " + d.message, b, d.stack)
            }
        }

        var d, e;
        for (d = 0, e = b.length; e > d; d += 1)c(a, b[d])
    }, isFileProtocol: function () {
        return d
    }}, Gis.Util.loadKinetic = function (a, b) {
        require([Gis.config("relativePath") + "scripts/kinetic.min"], function (b) {
            a && a(b)
        }, function () {
            b && b()
        })
    }, Gis.extend = Gis.Util.extend
}(this);
var key = "_gis_events";
Gis.Core = {}, Gis.Core.Events = {availableDomEvents: "drag contextmenu dragstart dragend click dblclick keydown keypress keyup", eventsKey: key, addEventListener: function (a, b, c) {
    var d, e, f, g = this[key] = this[key] || {};
    if ("object" == typeof a) {
        for (d in a)a.hasOwnProperty(d) && this.addEventListener(d, a[d], b);
        return this
    }
    for (a = Gis.Util.splitWords(a), e = 0, f = a.length; f > e; e += 1)g[a[e]] = g[a[e]] || [], g[a[e]].push({action: b, context: c || this});
    return this
}, hasEventListeners: function (a) {
    return this[key] && this[key][a] && this[key][a].length > 0
}, removeEventListener: function (a, b, c) {
    var d, e, f, g, h, i = this[key];
    if ("object" == typeof a) {
        for (d in a)a.hasOwnProperty(d) && this.removeEventListener(d, a[d], b);
        return this
    }
    for (a = Gis.Util.splitWords(a), e = 0, f = a.length; f > e; e += 1)if (this.hasEventListeners(a[e]))for (g = i[a[e]], h = g.length - 1; h >= 0; h -= 1)b && g[h].action !== b || c && g[h].context !== c || g.splice(h, 1);
    return this
}, fireEvent: function (a, b) {
    if (!this.hasEventListeners(a))return this;
    var c, d, e, f = Gis.Util.extend({type: a, target: this}, b);
    for (c = this[key][a].slice(), d = 0, e = c.length; e > d; d += 1)c[d].action.call(c[d].context || this, f);
    return this
}}, Gis.Core.Events.on = Gis.Core.Events.addEventListener, Gis.Core.Events.off = Gis.Core.Events.removeEventListener, Gis.Core.Events.fire = Gis.Core.Events.fireEvent, Gis.Class = Gis.Util.defineSubclass(function () {
}, {}, {extend: function (a) {
    return Gis.Util.defineSubclass(this, a || {}, this.prototype.constructor)
}}), Gis.extendError = function () {
    throw new Error("need override error")
}, Gis.BaseClass = Gis.Class.extend({includes: Gis.Core.Events, optionsFire: [], fixed: [], options: {}, _fillDataFromObject: function (a) {
    var b, c = this.options, d = !1, e = [];
    a.tags && (d = this.fillTags(a.tags), d && e.push("tags"), delete a.tags), a = this._clearFixed(a);
    for (b in a)a.hasOwnProperty(b) && c.hasOwnProperty(b) && (d = !1, d = this._fillDataFromString(b, a[b]), d && (e = e.concat(d)));
    return e.length && e
}, equals: function (a) {
    var b, c = a && a.getParams && a.getParams(), d = !0;
    if (a === this)return!0;
    if (c) {
        for (b in this.options)if (this.options.hasOwnProperty(b) && (d = d && (c[b] && c[b].equals && c[b].equals(this.options[b]) || this.options[b] === c[b]), !d))return!1;
        return d
    }
    return!1
}, _fillDataFromString: function (a, b) {
    var c, d = this.options, e = [];
    return"tags" === a ? (c = this.fillTags(b), c && e.push("tags"), e.length && e) : (b && "object" == typeof b ? d[a] && d[a].setData ? c = d[a].setData(b.options || b) : Gis.Util.isArray(b) ? Gis.Util.compareArrays(d[a], b) || (d[a] = b, c = !0) : d[a] && b === d[a] || (d[a] = b, c = !0) : d[a] !== b && (d[a] = b, c = !0), c && e.push(a), e.length && e)
}, setData: function (a, b, c) {
    var d, e = [];
    return"object" == typeof a ? e = this._fillDataFromObject(a) : "string" == typeof a && (e = this._fillDataFromString(a, b)), e && e.length && (d = this._getRowsChanged(e), this.fire("change", {target: this, notFireToServer: c || !d, rows: d, realRows: "object" == typeof e ? Object.keys(e) : e})), e
}, _fillOption: function (a, b, c, d) {
    return"object" == typeof a && a[c] && (a[c] = d(a[c])), a === c && (b = d(b)), b
}, _getRowsChanged: function (a) {
    var b, c = this;
    return"object" == typeof a ? (b = (Gis.Util.isArray(a) ? a : Object.keys(a)).filter(function (a) {
        return c.optionsFire.indexOf(a) >= 0
    }), b.length && b) : this.optionsFire.indexOf(a) >= 0 ? [a] : null
}, _isFixed: function (a) {
    return this.fixed && this.fixed.indexOf(a) >= 0
}, _clearFixed: function (a) {
    var b, c = {};
    if ("object" == typeof a)for (b in a)a.hasOwnProperty(b) && !this._isFixed(b) && (c[b] = a[b]);
    return c
}, getParams: function (a) {
    return a = a || this, a && Gis.Util.extend({}, a.options)
}, _checkRequired: function (a) {
    var b, c, d;
    if (this.required) {
        if (!a)throw new TypeError("   ");
        for (b = 0, c = this.required.length; c > b; b += 1)if (d = this.required[b], !a.hasOwnProperty(d) || void 0 == a[d])throw new TypeError(" '" + d + "' ")
    }
}, _initTags: function (a) {
    function b(a) {
        return c.hasOwnProperty(a) && d.indexOf(a) > -1
    }

    if (!this.setTag) {
        var c = a && a.tags || {}, d = ["creator"];
        this.setTag = function (a, d) {
            var e = c[a];
            return c[a] && b(a) || c[a] == d ? !1 : (c[a] = d, this.fire("tagchanged", {key: a, oldVal: e, newVal: d, target: this}), !0)
        }, this.fillTags = function (a) {
            var b, c = !1;
            for (b in a)a.hasOwnProperty(b) && (c = c || this.setTag(b, a[b]));
            return c
        }, this.getTag = function (a) {
            var b = c[a];
            return Gis.Util.isArray(b) ? b.slice() : b
        }, this.getTags = function () {
            return Gis.Util.extend({}, c)
        }, a && a.tags && delete a.tags
    }
}, initialize: function (a) {
    if (this._initTags(a), a && a.hasOwnProperty("tags") && delete a.tags, a = a || {}, a.id) {
        if (!Gis.Util.checkGUID(a.id))throw Gis.Logger.log(JSON.stringify(a.id) + " is incorrect GUID", this.options.tacticObjectType && this.options.tacticObjectType.toUpperCase()), new TypeError(" GUID - " + a.id)
    } else window.GIS_GENERATE_GUID && this.options.hasOwnProperty("id") && (a.id = Gis.Util.generateGUID());
    this._checkRequired(a), a && (this.options = Gis.Util.fill(Gis.Util.extend({}, this.options), a))
}, objectData: function () {
    var a, b = {};
    for (a in this.options)this.options.hasOwnProperty(a) && void 0 !== this.options[a] && null !== this.options[a] && (b[a] = this.options[a] && this.options[a].options ? this.options[a].options : this.options[a]);
    return b
}, getOption: function (a) {
    return this.getStyle() && this.getStyle().getStyleProperty(a) || this.options[a]
}, isOfficialParam: function (a) {
    return this.optionsFire.indexOf(a) > -1
}, getOptionsWithStyle: function () {
    var a = this.getStyle();
    return Gis.Util.extend({}, this.options, a && a.getStyleValues())
}, objectOfficialData: function () {
    var a, b = {};
    for (a in this.options)this.options.hasOwnProperty(a) && this.isOfficialParam(a) && void 0 !== this.options[a] && null != this.options[a] && (b[a] = this.options[a] && this.options[a].objectOfficialData ? this.options[a].objectOfficialData() : this.options[a]);
    var c = this.getTags();
    return c && Object.keys(c).length && (b.tags = c), b
}, getStyle: function () {
    var a = this.getTag("style");
    return this._map && a && this._map.getStyle(a)
}, toString: function () {
    var a = this.objectData();
    return JSON.stringify(a)
}, toJSON: function () {
    return this.objectOfficialData()
}}), function (a) {
    "use strict";
    function b(a) {
        return a ? (e[a] || (e[a] = []), e[a]) : void 0
    }

    function c(a) {
        var c, d = b(a.tacticObjectType);
        return d && d.length ? (c = d.shift(), c.initialize(a), c) : void 0
    }

    var d, e = {}, f = 1e3;
    a.ObjectFactory = {list: {}, createObject: function (a) {
        if (a && a.tacticObjectType)return a.tacticObjectType = a.tacticObjectType.toLocaleLowerCase(), c(a) || new this.list[a.tacticObjectType](a);
        throw new Error("Cannot create object")
    }, cache: function (a) {
        var c = b(a.getType());
        c && c.length < f && c.push(a)
    }};
    for (d in a.Objects)a.Objects.hasOwnProperty(d) && (a.ObjectFactory.list[a.Objects[d].getType()] = a.Objects[d])
}(Gis), Gis.Settings = Gis.BaseClass.extend({_maps: null, options: {creator: null, tacticMapServer: null}, initialize: function (a) {
    this._maps = {}, a = a || {}, a.creator = a.creator || Gis.Util.generateGUID();
    var b = this._maps;
    a.maps && (a.maps.forEach(function (a) {
        switch (typeof a) {
            case"string":
                b[a] = a;
                break;
            case"object":
                b[a.getURL()] = a
        }
    }), delete a.maps), this.options = Gis.Util.extend({}, a)
}, getSetting: function (a) {
    return this.options[a]
}, _sameCrsCode: function (a, b) {
    return(a && a.getCrs() && a.getCrs().getCode()) === b
}, getMaps: function () {
    var a, b, c = {};
    for (a in this._maps)this._maps.hasOwnProperty(a) && (b = this._maps[a], c[a] = b);
    return c
}, getMap: function (a) {
    var b, c = "undefined" != typeof a && ("string" == typeof a ? a : a.getKey && a.getKey()) || a;
    return c = void 0 != c ? c + "" : c, c = c && c.split("|"), b = c && Gis.Util.isNumeric(c[0]) && !this._maps[c[0]] ? this._maps[Object.keys(this._maps)[a]] : c && this._maps[c[0]], c && c[1] && b && "tilemapservice" === b.getType() && (b = b.getTileServer(c[1])), b
}, filterByCrs: function (a, b) {
    return!a || a.getKey() !== b.getKey() && this._sameCrsCode(b, a.getCrs().getCode())
}, getMapList: function (a) {
    var b, c, d, e = this.getMaps(), f = [], g = this, h = function (b) {
        var c = d.getURL() + "|" + (b.key || b.title);
        g.filterByCrs(a, g.getMap(c)) && f.push({key: c, title: b.title})
    };
    for (c in e)e.hasOwnProperty(c) && (d = e[c], d.getAvailableMaps && (b = d.getAvailableMaps()) ? b.forEach(h) : this.filterByCrs(a, d) && f.push({key: Gis.Util.isString(d) ? d : d.getKey(), title: Gis.Util.isString(d) ? d : d.getTitle()}));
    return f
}, addToMaps: function (a) {
    var b = a && ("string" == typeof a ? a : a.getKey && a.getKey());
    this.setMap(b, a)
}, _tmsLoaded: function () {
    this.fire(Gis.Map.MAP_LIST_CHANGED.TYPE)
}, _tmsDataChanged: function (a) {
    this.fire(Gis.Map.TIME_MAP_DATA_CHANGED.TYPE, a)
}, setMap: function (a, b) {
    this._maps[a] && this._maps[a].load && (this._maps[a].off("load tilemapdataloaded mapremoved", this._tmsLoaded, this), this._maps[a].off(Gis.Map.TIME_MAP_DATA_CHANGED.TYPE, this._tmsDataChanged, this)), this._maps[a] = b, this._maps[a].load && (this._maps[a].on("load tilemapdataloaded mapremoved", this._tmsLoaded, this), this._maps[a].on(Gis.Map.TIME_MAP_DATA_CHANGED.TYPE, this._tmsDataChanged, this)), this.fire("maplistchanged")
}, getServer: function () {
    return this.options.tacticMapServer && this.options.tacticMapServer.slice() || Gis.Config.connection.host && Gis.Config.connection.port && [Gis.Config.connection.host, Gis.Config.connection.port, Gis.Config.connection.portSecond]
}}), Gis.Settings.MapData = function (a, b) {
    this.key = a, this.title = b
}, Gis.settings = function (a) {
    return a && a.getServer ? a : new Gis.Settings(a)
}, Gis.Commands = Gis.Commands || {}, Gis.Commands.Command = Gis.BaseClass.extend({required: ["gis", "connection"], options: {type: null, fromServer: !1, gis: void 0, connection: void 0}, initialize: function (a) {
    Gis.BaseClass.prototype.initialize.call(this, a), this.options.connection = this.options.connection || this.options.gis.getConnection()
}, execute: function () {
    Gis.extendError()
}}), Gis.Additional = Gis.Additional || {}, Gis.Additional.BearingBehavior = Gis.BaseClass.extend({options: {latestBearingCount: 1, bearingShowTimeSeconds: void 0}, getLatestBearingCount: function () {
    return this.options.latestBearingCount || Gis.Config.style.DefaultBearingBehavior.bearingShowTimeSeconds
}, isBearingVisible: function (a, b) {
    var c;
    return c = !Gis.Util.isNumeric(b) || b <= this.getLatestBearingCount(), this.isBearingVisibleInTime(a) && c || b <= Gis.Additional.BearingBehavior.ALWAYS_SHOW_COUNT
}, isBearingVisibleInTime: function (a) {
    var b;
    return this.gerBearingShowTimeSeconds() ? (b = Date.now() / 1e3, b - a.getTimeStamp() < this.gerBearingShowTimeSeconds()) : !0
}, getVisiblePoints: function (a) {
    var b, c, d = [];
    for (b = 0, c = a.length; c > b; b += 1)this.isBearingVisible(a[b], c - b) && d.push(a[b]);
    return d
}, gerBearingShowTimeSeconds: function () {
    return Gis.Util.isNumeric(this.options.bearingShowTimeSeconds) ? this.options.bearingShowTimeSeconds : Gis.Config.style.DefaultBearingBehavior.bearingShowTimeSeconds
}}), Gis.BearingBehavior = Gis.Additional.BearingBehavior, Gis.bearingBehavior = function (a) {
    return a && a.setData ? a : new Gis.Additional.BearingBehavior(a)
}, Gis.Additional.BearingBehavior.ALWAYS_SHOW_COUNT = 1, Gis.Config.SourceBearingBehavior = Gis.bearingBehavior({latestBearingCount: 2}), Gis.Color = Gis.BaseClass.extend({}), Gis.Color.BLACK = "#000000", Gis.Color.YELLOW = "#fff38e", Gis.Color.DEFAULT = "#0033ff", Gis.Color.STROKE_DEFAULT = "#0033ff", function () {
    "use strict";
    var a;
    Gis.Thread = Gis.BaseClass.extend({initialize: function (b) {
        var c = this;
        a = b, Gis.BaseClass.prototype.initialize.apply(this, Array.prototype.slice.call(arguments, 1)), a.onmessage = function (a) {
            c.publishResponse(a.data)
        }
    }, publishResponse: function (a) {
        this.fire("response", a)
    }, sendMessage: function (b) {
        a.postMessage(b)
    }}), Gis.thread = function (a, b) {
        return a.publishResponse ? a : new Gis.Thread(a, b)
    }
}(this), Gis.Additional.Dash = {solid: "", dash: "10, 10", dot: "1, 10", dashDot: "10, 10, 1, 10", dashDotDot: "10, 10, 1, 10, 1"}, Gis.Dash = {solid: "solid", dash: "dash", dot: "dot", dashDot: "dashDot", dashDotDot: "dashDotDot"}, Gis.Additional.FillStyle = Gis.BaseClass.extend({options: {color: void 0, hatch: void 0, hatchColor: void 0}, optionsFire: ["color", "hatch", "hatchColor"], getColor: function () {
    return this.options.color || Gis.Config.style.DefaultFill.color
}, getHatch: function () {
    return this.options.hatch || Gis.Config.style.DefaultFill.hatch
}, getHatchColor: function () {
    return this.options.hatchColor || Gis.Config.style.DefaultFill.hatchColor
}}), Gis.FillStyle = Gis.Additional.FillStyle, Gis.fillStyle = function (a) {
    return a && a.getHatch ? a : new Gis.FillStyle(a)
}, Gis.Hatch = {HatchStyleHorizontal: 0, HatchStyleVertical: 1, HatchStyleForwardDiagonal: 2, HatchStyleBackwardDiagonal: 3, HatchStyleCross: 4, HatchStyleDiagonalCross: 5, HatchStyle05Percent: 6, HatchStyle10Percent: 7, HatchStyle20Percent: 8, HatchStyle25Percent: 9, HatchStyle30Percent: 10, HatchStyle40Percent: 11, HatchStyle50Percent: 12, HatchStyle60Percent: 13, HatchStyle70Percent: 14, HatchStyle75Percent: 15, HatchStyle80Percent: 16, HatchStyle90Percent: 17, HatchStyleLightDownwardDiagonal: 18, HatchStyleLightUpwardDiagonal: 19, HatchStyleDarkDownwardDiagonal: 20, HatchStyleDarkUpwardDiagonal: 21, HatchStyleWideDownwardDiagonal: 22, HatchStyleWideUpwardDiagonal: 23, HatchStyleLightVertical: 24, HatchStyleLightHorizontal: 25, HatchStyleNarrowVertical: 26, HatchStyleNarrowHorizontal: 27, HatchStyleDarkVertical: 28, HatchStyleDarkHorizontal: 29, HatchStyleDashedDownwardDiagonal: 30, HatchStyleDashedUpwardDiagonal: 31, HatchStyleDashedHorizontal: 32, HatchStyleDashedVertical: 33, HatchStyleSmallConfetti: 34, HatchStyleLargeConfetti: 35, HatchStyleZigZag: 36, HatchStyleWave: 37, HatchStyleDiagonalBrick: 38, HatchStyleHorizontalBrick: 39, HatchStyleDivot: 42, HatchStyleDottedGrid: 43, HatchStyleDottedDiamond: 44, HatchStyleTrellis: 46, HatchStyleSphere: 47, HatchStyleSmallGrid: 48, HatchStyleSmallCheckerBoard: 49, HatchStyleLargeCheckerBoard: 50, HatchStyleOutlinedDiamond: 51, HatchStyleSolidDiamond: 52}, Gis.getAvailableHathes = function () {
    return Object.keys(Gis.Hatch)
}, Gis.Hatch.HatchStyleLargeGrid = Gis.Hatch.HatchStyleCross, Gis.Additional.Icon = Gis.BaseClass.extend({required: ["type"], options: {width: 15, type: void 0, color: void 0, rotatable: void 0, image: void 0}, optionsFire: ["type", "color", "image"], initialize: function (a) {
    a && a.type && (a.type = a.type.toLowerCase()), a.image && this._fillOption(a, null, "image", Gis.image), !a.width && a.type && Gis.Additional.Icon[a.type] && Gis.Additional.Icon[a.type].width && (a.width = Gis.Additional.Icon[a.type].width), Gis.BaseClass.prototype.initialize.call(this, a), this.options.image && !this.options.image.createImageUri && (this.options.image = Gis.image(this.options.image))
}, setData: function (a, b, c) {
    return b && "type" === a ? b = b.toLowerCase() : a && a.type && (a.type = a.type.toLowerCase()), ("image" === a || a.image) && (b = this._fillOption(a, b, "image", Gis.image)), Gis.BaseClass.prototype.setData.call(this, a, b, c)
}, isRotatable: function () {
    return this.options.rotatable || this.options.rotatable !== !1 && (!window.FILTER_ROTATABLE_IMAGES || Gis.Additional.Icon.rotation[this.options.type])
}, getType: function () {
    return this.options.type
}, getColor: function () {
    return this.getOption("color")
}, getImage: function () {
    return this.getOption("image") && Gis.image(this.getOption("image"))
}, clone: function () {
    return Gis.icon(this.options)
}, getImageUrl: function () {
    var a = Gis.Config.image, b = Gis.Util.isFunction(a);
    if (this._isPredefinedType())return Gis.Additional.Icon[this.options.type] ? (this._canvas = Gis.Additional.Icon[this.options.type](this.getOption("color") || "black", this.getOption("width") || 15, this._canvas), this._canvas) : (b && a("path") || a.path) + this.getType() + "_" + this.getColor() + (b && a("extensions") || a.extensions);
    if (!this.getImage() || !this.getImage().createImageUri)throw Gis.Logger.log("Could't create image", JSON.stringify(this.options)), new Error("Error create image " + JSON.stringify(this.options));
    return this.getImage().createImageUri()
}, _isPredefinedType: function () {
    return void 0 !== Gis.Additional.Icon[this.options.type]
}, isPredefinedType: function () {
    return this._isPredefinedType() && Gis.Additional.Icon[this.options.type]
}}), Gis.Additional.Icon.TYPE = {CAR: "car", CIRCLE: "circle", ARROW: "arrow", DANGER: "danger", DIAMOND: "diamond", HELICOPTER: "helicopter", M: "m", PLANE: "plane", ROUTER: "router", SENSOR: "sensor", SIMPLE: "simple", STATIC: "static", STORM: "storm", TARGET: "target", TRIANGLE: "triangle"}, Gis.Additional.Icon.rotation = {arrow: !0, car: !0, plane: !0, helicopter: !0, "static": !1, custom: !1}, Gis.Additional.Icon.fixPositionCanvas = function (a, b, c) {
    var d, e;
    a && a !== b && (d = a / b, c.style[Modernizr.prefixed("transform")] = "scale(" + d + ")", e = (a - b) / 2 + "px", c.style.marginLeft = e, c.style.marginTop = e)
}, Gis.Icon = Gis.Additional.Icon, Gis.icon = function (a) {
    return a && a.getImage ? a : new Gis.Icon(a)
}, Gis.Additional.Image = Gis.BaseClass.extend({options: {hash: void 0, projection: null, fullPath: void 0}, optionsFire: ["hash", "fullPath"], initialize: function (a) {
    var b = Gis.Config.image, c = Gis.Util.isFunction(b);
    Gis.BaseClass.prototype.initialize.call(this, a), this._host = c && b("defaultHost") || b.defaultHost, this._port = c && b("defaultPort") || b.defaultPort, this._protocol = c && b("defaultProtocol") || b.defaultProtocol, this._extension = c && b("serverOverlayExtension") || b.serverOverlayExtension || "", this._processData()
}, setData: function (a, b, c) {
    var d = Gis.BaseClass.prototype.setData.call(this, a, b, c);
    return d && this._processData(), d
}, setProjection: function (a) {
    this.options.projection = a, this._processData()
}, setHost: function (a) {
    this._host = a
}, _isBlobData: function () {
    return this.options.hash && "data:image/" === this.options.hash.substr(0, 11)
}, _processBlobData: function () {
    this._uri = this.options.hash
}, _processUriData: function () {
    var a = this.options.hash && this.options.hash + this._extension;
    this._uri = this.options.fullPath ? this.options.fullPath + (a ? "/" + a : "") : this._protocol + "://" + this._host + ":" + this._port + "/image/" + a
}, _processData: function () {
    return this._isBlobData() ? this._processBlobData() : this._processUriData()
}, createImageUri: function () {
    return this._processData(), this._uri
}}), Gis.Image = Gis.Additional.Image, Gis.image = function (a) {
    return a && a.createImageUri ? a : new Gis.Additional.Image(a)
}, Gis.Additional.LineStyle = Gis.BaseClass.extend({_smoothFactor: 1, options: {color: Gis.Config.style.DefaultLine.color, thickness: Gis.Config.style.DefaultLine.thickness, dash: Gis.Config.style.DefaultLine.dash, border: Gis.Config.style.DefaultLine.border}, optionsFire: ["thickness", "dash", "border", "color"], getSmoothFactor: function () {
    return this._smoothFactor
}, initialize: function (a) {
    a = Gis.Util.extend({}, a), Gis.BaseClass.prototype.initialize.call(this, a)
}, setData: function (a, b, c) {
    return"object" == typeof a ? a = Gis.Util.extend({}, a) : "string" == typeof a && void 0 !== b && !this._isFixed(a), Gis.BaseClass.prototype.setData.call(this, a, b, c)
}, getColor: function () {
    return this.options.color || Gis.Config.style.DefaultLine.color
}, getThickness: function () {
    return this.options.thickness || Gis.Config.style.DefaultLine.thickness
}, getDash: function () {
    var a, b, c, d = Gis.Additional.Dash[this.options.dash || Gis.Config.style.DefaultLine.dash], e = 0;
    if (d) {
        for (a = [], c = this.getThickness() + (this.getBorder() ? 1 : 0), d = d.split(","), b = d.length, e = 0; b > e; e += 1)a[e] = parseInt(d[e], 10) + e % 2 * c;
        a = a.join(", ")
    }
    return a
}, getBorder: function () {
    return this.options.border || Gis.Config.style.DefaultLine.border
}}), Gis.LineStyle = Gis.Additional.LineStyle, Gis.lineStyle = function (a) {
    return a && a.getDash ? a : new Gis.LineStyle(a)
}, Gis.Additional.Point = Gis.BaseClass.extend({initialize: function (a, b) {
    Gis.Util.isArray(a) ? (this.x = a[0], this.y = a[1]) : Gis.Util.isNumeric(a) ? (this.x = a, this.y = b) : "object" == typeof a && a.hasOwnProperty("x") && a.hasOwnProperty("y") && (this.x = a.x, this.y = a.y)
}, clone: function () {
    return new Gis.Point(this.x, this.y)
}, add: function (a) {
    return this.clone()._add(Gis.point(a))
}, _add: function (a) {
    return this.x += a.x, this.y += a.y, this
}, subtract: function (a) {
    return this.clone()._subtract(Gis.point(a))
}, _subtract: function (a) {
    return this.x -= a.x, this.y -= a.y, this
}, divideBy: function (a) {
    return this.clone()._divideBy(a)
}, _divideBy: function (a) {
    return this.x /= a, this.y /= a, this
}, multiplyBy: function (a) {
    return this.clone()._multiplyBy(a)
}, _multiplyBy: function (a) {
    return this.x *= a, this.y *= a, this
}, round: function () {
    return this.clone()._round()
}, _round: function () {
    return this.x = Math.round(this.x), this.y = Math.round(this.y), this
}, floor: function () {
    return this.clone()._floor()
}, _floor: function () {
    return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this
}, distanceTo: function (a) {
    a = Gis.point(a);
    var b = a.x - this.x, c = a.y - this.y;
    return Math.sqrt(b * b + c * c)
}}), Gis.Point = Gis.Additional.Point, Gis.point = function (a, b) {
    return new Gis.Point(a, b)
}, Gis.Additional.Style = Gis.BaseClass.extend({options: {styleID: void 0, styleName: void 0, styleObjectTypes: void 0}, containsObjectType: function (a) {
    return this.options.styleObjectTypes.indexOf(a) > -1
}, getStyleProperty: function (a) {
    return"styleID" !== a && "styleName" !== a && "styleObjectTypes" !== a && this._styleData[a] || null
}, getStyleValues: function () {
    return this._styleData
}, initialize: function (a) {
    var b = Gis.BaseClass.prototype.initialize.call(this, a);
    return delete a.styleID, delete a.styleName, delete a.styleObjectTypes, this._styleData = a, b
}, getStyleId: function () {
    return this.options.styleID
}, getStyleName: function () {
    return this.options.styleName
}}), Gis.Style = Gis.Additional.Style, Gis.style = function (a) {
    return a && a.getStyleId ? a : new Gis.Style(a)
}, Gis.StyleContainerBehavior = {initStyleContainer: function () {
    var a = this;
    this.getStyle && !function () {
        var b = {};
        a.getStyle = function (a) {
            return b[a]
        }, a.getStylesByObjectType = function (a) {
            var c, d = [];
            for (c in b)b.hasOwnProperty(c) && b[c].containsObjectType(a) && d.push(c);
            return d
        }, a.putStyle = function (a) {
            var c, d, e = this;
            if (Gis.Util.isArray(a))a.forEach(function (a) {
                try {
                    e.putStyle(a)
                } catch (b) {
                    Gis.Logger.log("   ", JSON.stringify(a), b.stack)
                }
            }); else if (a) {
                if (d = a.styleID || a.getStyleId && a.getStyleId(), c = b[d])c.setData(this.getParams(a) || a); else try {
                    b[d] = Gis.style(a)
                } catch (f) {
                    Gis.Logger.log("    ", a, f.stack)
                }
                e.fire("stylechanged", {style: b[d].getStyleId()})
            }
            return this
        }
    }()
}}, Gis.Additional.TrackBehavior = Gis.BaseClass.extend({options: {traceLengthSeconds: null, traceLengthMeters: null}, getTraceLengthSeconds: function () {
    return parseFloat(Gis.Util.isNumeric(this.options.traceLengthSeconds) ? this.options.traceLengthSeconds : Gis.Config.style.DefaultTrackBehavior.traceLengthSeconds)
}, getTraceLengthMeters: function () {
    return parseFloat(Gis.Util.isNumeric(this.options.traceLengthMeters) ? this.options.traceLengthMeters : Gis.Config.style.DefaultTrackBehavior.traceLengthMeters)
}, findMiddleInTime: function (a, b, c) {
    var d = a.getTimeStamp(), e = b.getTimeStamp(), f = c - d, g = e - c, h = a.getLatLng(), i = b.getLatLng(), j = f + g, k = j && f > 0 ? (g * h[0] + f * i[0]) / (f + g) : i[0], l = j && f > 0 ? (g * h[1] + f * i[1]) / (f + g) : i[1];
    return Gis.position({latitude: k, longitude: l, parentId: a.getParentId(), timeStamp: c})
}, needCrop: function () {
    return this.getTraceLengthSeconds() > 0 || this.getTraceLengthMeters() > 0
}, getVisiblePoints: function (a, b) {
    var c = this.positionInTime(a, b), d = this.positionByLen(a);
    return c.length > d.length ? d : c
}, showFirstPoint: function (a) {
    var b, c;
    if (this._showFirst)for (b = 0, c = a.length; c > b; b += 1)this._showFirst === a[b].getId() && a[b].setLastShowedTime(a[b].calculateNextStamp());
    return b
}, positionInTime: function (a, b) {
    var c, d, e, f, g, h = 0, i = a.length - 1, j = a;
    if (f = Date.now() / 1e3, d = b || f - this.getTraceLengthSeconds(), this.showFirstPoint(a), this.getTraceLengthSeconds()) {
        for (h; i > h; h += 1)if (c = h + 1, e = a[c], g = a[h].getLastShowedTime(a[h - 1], e), a[h].getLastShowedTime(a[h - 1], e) < d && (j = [], e.getLastShowedTime(a[h], a[h + 2]) > d)) {
            j = a.slice(c), j.unshift(this.findMiddleInTime(a[h], e, d));
            break
        }
        this._showFirst = !1, j = j.length ? j : a.slice(i), 1 === j.length && (j[0].setLastShowedTime(j[0].calculateNextStamp()), this._showFirst = j[0].getId())
    }
    return j
}, positionByLen: function (a) {
    var b = a.length - 1, c = 0, d = this.getTraceLengthMeters();
    if (d && b > 0)for (b; b > 0; b -= 1)if (c += a[b].distanceTo(a[b - 1]), c > d)return a.slice(b);
    return a
}}), Gis.TrackBehavior = Gis.Additional.TrackBehavior, Gis.trackBehavior = function (a) {
    return a && a.positionByLen ? a : new Gis.TrackBehavior(a)
}, Gis.Config.SourceTrackBehavior = Gis.trackBehavior({}), Gis.Config.PostTrackBehavior = Gis.trackBehavior({}), Gis.Objects = Gis.Objects || {}, Gis.Objects.Base = Gis.BaseClass.extend({_isControllableByServer: 1, _isControllable: !0, _isCountable: !0, _isMetaData: !1, _isCached: !1, _isCachedGis: !1, options: {tacticObjectType: "base", parentId: void 0, forcePaint: void 0, customActions: void 0, name: void 0, caption: void 0, tooltip: void 0}, isMetaData: function () {
    return this._isMetaData
}, redraw: function () {
    this.fire(Gis.Objects.Base.NEED_REDRAW_EVENT.TYPE, new Gis.Objects.Base.NEED_REDRAW_EVENT(this))
}, clearMeta: function () {
    Gis.extendError()
}, hideMeta: function () {
    Gis.extendError()
}, preAdd: function () {
    return!0
}, getTypeName: function (a) {
    return a = a || this.getType(), Gis.Objects.Base.TYPE_NAMES[a] || a
}, getName: function () {
    return this.options.name
}, getParentId: function () {
    return this.options.parentId
}, initialize: function (a) {
    this._originalType = this.options.tacticObjectType, a && a.hasOwnProperty("tacticObjectType") && (a.tacticObjectType = a.tacticObjectType.toLocaleLowerCase()), Gis.BaseClass.prototype.initialize.call(this, a)
}, getCustomActions: function () {
    return this.options.customActions && this.options.customActions.slice()
}, hasCustomAction: function (a) {
    return this.options.customActions && this.options.customActions.indexOf(a) > -1
}, fireCustomAction: function (a) {
    return this.hasCustomAction(a) && this.fire("customaction", {target: this, action: a}), this
}, _getFormatedRow: function (a, b) {
    return b && a ? '<p><span class="desc-title">' + a + ": </span><span>" + b + "</span></p>" : ""
}, getFormatedDescription: function () {
    if (this.options.tooltip)return this.options.tooltip;
    var a = "";
    return a += this._getFormatedRow(" ", this.options.name)
}, detachFromMap: function () {
    return this._attachedToMap = !1, delete this._mapRender, delete this._lowLevelObject, this
}, isThisEventable: function () {
    var a = this.options.parentId && this._map.getLayer(this.options.parentId);
    return!!(this._map.isFilterable(this.options.tacticObjectType) || a && this._map.isFilterable(a.getType()))
}, _clearData: function () {
    Gis.extend(this.options, {parentId: void 0, name: void 0, caption: void 0, tooltip: void 0})
}, pushToCache: function () {
    this._clearData(), Gis.ObjectFactory.cache(this)
}, fireEventsFromLowLevel: function (a) {
    return this.isThisEventable() && this.fire(a.type, a), this
}, addTo: function (a) {
    return a.addLayer(this), this
}, attachToMap: function (a) {
    return this._map = a, this._attachedToMap = !0, this
}, getAdditionalActionsList: function () {
    return Gis.Util.greateHtmlList(this.getCustomActions())
}, _actionChangedOnMenuShown: function () {
    this._additionalActionsList && (this._additionalActionsList.innerHTML = this.getAdditionalActionsList().innerHTML, this.setMenuStyle())
}, _deInitMenuEvents: function (a) {
    Modernizr.touch ? (document.body.removeEventListener("touch", this._onContextMenuClose), a.removeEventListener("touch", this._onContextMenuSelect)) : (document.body.removeEventListener("click", this._onContextMenuClose), a.removeEventListener("click", this._onContextMenuSelect)), document.body.removeEventListener("contextmenu", this._onContextMenuClose), this.off("change", this._actionChangedOnMenuShown, this), (this._map && this._map.getMapContainer() || a.parentNode).removeEventListener("contextmenu", this._onContextMenuClose)
}, closeContextMenu: function () {
    this._additionalActionsList && (this._deInitMenuEvents(this._additionalActionsList), this._additionalActionsList.parentNode.removeChild(this._additionalActionsList), this._additionalActionsList = null)
}, _initMenuEvent: function (a) {
    var b = this;
    this._onContextMenuClose = this._onContextMenuClose || function () {
        b.closeContextMenu()
    }, this._onContextMenuSelect = this._onContextMenuSelect || function (a) {
        var c = a.target || a.srcElement;
        b.closeContextMenu(), b.fireCustomAction(c.parentNode.attributes["data-action"].value), a.preventDefault(), a.stopPropagation()
    }, Modernizr.touch ? (document.body.addEventListener("touch", this._onContextMenuClose), a.addEventListener("touch", this._onContextMenuSelect)) : (document.body.addEventListener("click", this._onContextMenuClose), a.addEventListener("click", this._onContextMenuSelect)), this.on("change", this._actionChangedOnMenuShown, this), document.body.addEventListener("contextmenu", this._onContextMenuClose), (this._map && this._map.getMapContainer() || a.parentNode).addEventListener("contextmenu", this._onContextMenuClose)
}, setMenuStyle: function (a, b) {
    var c, d, e = Gis.DomUtil, f = document.width, g = document.height, h = (!a || !b) && e.getPosition(this._additionalActionsList);
    this._additionalActionsList && (a = a || h.left, b = b || h.top, c = this._additionalActionsList.clientHeight, d = this._additionalActionsList.clientWidth, c > g && (c = g, this._additionalActionsList.style.height = g + "px"), d > f && (d = f, this._additionalActionsList.style.width = f + "px"), a + d > f && (a = f - d), b + c > g && (b = g - c), e.isCssTransform() ? this._additionalActionsList.style[e.prefixes("transform")] = e.isCssTransform3d() ? "translate3d(" + a + "px, " + b + "px, 0)" : "translate(" + a + "px, " + b + "px)" : (this._additionalActionsList.style.top = b + "px", this._additionalActionsList.style.left = a + "px"))
}, onContextMenu: function (a) {
    var b = a.originalEvent;
    this.closeContextMenu(), this._additionalActionsList = this.getAdditionalActionsList(), this._additionalActionsList && (this._initMenuEvent(this._additionalActionsList), this._map.getMapContainer().appendChild(this._additionalActionsList), this.setMenuStyle(b.clientX, b.clientY), Gis.DomUtil.attachValue(this._additionalActionsList, "left", b.clientX), Gis.DomUtil.attachValue(this._additionalActionsList, "top", b.clientY), b.preventDefault(), b.stopPropagation())
}, onAdd: function (a) {
    return this.attachToMap(a), this.setTag(Gis.Objects.Base.CREATOR_TAG_NAME, a.getSetting("creator")), this.on("remove", this.onDelete, this), this.on("contextmenu", this.onContextMenu, this), this.fire("added", {target: this}), this
}, getLayers: function () {
    return this.getTag("layers")
}, onDelete: function (a) {
    return this._map, this.closeContextMenu(), this.off("remove", this.onDelete, this), this.off("contextmenu", this.onContextMenu, this), this.detachFromMap(a.from), this.fire("deleted", {target: this}), this
}, isEditableByUser: function () {
    var a = this._map || Gis.Map.CURRENT_MAP;
    return this.getTag(Gis.Objects.Base.CREATOR_TAG_NAME) === a.getSetting("creator")
}, reinit: function () {
    this._lowLevelObject = !1
}, isAttached: function () {
    return!!this._attachedToMap
}, preDraw: function () {
    return this.isAttached()
}, getId: function () {
    return this.options.id
}, _update: function () {
    this.fire("change", {target: this})
}, draw: function (a) {
    this._pushedToRender = !1, this._mapRender = a
}, isCached: function () {
    return this._isCached
}, isCachedGis: function () {
    return this._isCachedGis
}, getType: function () {
    return this.options.tacticObjectType
}, getOriginalType: function () {
    return this._originalType
}, getLowLevelObject: function () {
    return this._lowLevelObject
}, setLowLevelObject: function (a) {
    this._lowLevelObject = a
}, getLatLng: function () {
    Gis.extendError()
}, isControllable: function () {
    return this._isControllable
}, isCountable: function () {
    return this._isCountable
}, setCountable: function (a) {
    return this._isCountable = a, this
}, isControllableByServer: function () {
    return this._isControllableByServer
}, setControllableByServer: function (a) {
    return this.isAttached() || (this._isControllableByServer = a), this
}, getLatLngBounds: function () {
    return Gis.latLngBounds(this.getLatLng(), this.getLatLng())
}, getCenter: function () {
    return this.getLatLng()
}, isSelectable: function () {
    return!1
}, getCurrentLatLngBounds: function () {
    return this.getLatLngBounds()
}, selfDraw: function () {
    return this._selfDraw
}, disableDraw: function (a) {
    this._selfDraw && (this._selfDraw[a] = !1)
}, enableDraw: function (a) {
    this._selfDraw && (this._selfDraw[a] = !0)
}}), Gis.Objects.Base.CREATOR_TAG_NAME = "creator", Gis.Objects.Base.NEED_REDRAW_EVENT = function (a) {
    this.target = a, this.type = Gis.Objects.Base.NEED_REDRAW_EVENT.TYPE
}, Gis.Objects.Base.NEED_REDRAW_EVENT.TYPE = "needredraw", Gis.Objects.Base.LOCAL_CHANGE_EVENT = function (a) {
    this.target = a, this.type = Gis.Objects.Base.LOCAL_CHANGE_EVENT.TYPE
}, Gis.Objects.Base.LOCAL_CHANGE_EVENT.TYPE = "localchange", Gis.FULL_LOCAL = !1, Gis.NETWORK_LOCAL = -1, Gis.Objects.Base.TYPE_NAMES = {overlay: "", source: "", post: "", ellipse: "", path: "", polygon: "", sector: "", image: "", text: ""}, Gis.Objects.Selectable = Gis.Objects.Base.extend({_selectedAdditional: void 0, options: {selectable: void 0}, isSelected: function () {
    return this._selected
}, initialize: function (a) {
    Gis.Objects.Base.prototype.initialize.call(this, a), this._selectedLine = Gis.lineStyle({color: "red", border: "rgb(75, 84, 255)"})
}, setSelectedStyle: function (a) {
    this._selectedLine = a && Gis.lineStyle(a)
}, setSelected: function (a) {
    var b;
    this._selected = a, a ? this.fire("selected", {additional: this._selectedAdditional}) : (b = this._selectedAdditional, this._selectedAdditional = void 0, this.fire("unselected", {additional: b}))
}, getLineStyle: function () {
    var a = Gis.lineStyle(this.getOption("line"));
    return this._selected && this._selectedLine ? Gis.lineStyle(Gis.Util.extend({}, {color: a.getColor(), border: this._selectedLine.getBorder(), thickness: a.getThickness()})) : a
}, _onClick: function (a) {
    this.isSelectable() && (this._dragged || this.fire("select", Gis.Util.extend(a, {target: this, addToSelection: a.originalEvent.ctrlKey}))), this._dragged = !1
}, onAdd: function (a) {
    Gis.Objects.Base.prototype.onAdd.call(this, a), this.on("click", this._onClick, this)
}, onDelete: function () {
    Gis.Objects.Base.prototype.onDelete.apply(this, arguments), this.off("click", this._onClick, this)
}, isSelectable: function () {
    return this.options.selectable
}}), Gis.CourseIconBehavior = {_markersAsimuth: void 0, _markersAsimuthDisable: void 0, _course: !1, _coursePosition: "end", setCourseEnable: function (a) {
    return this._course = a, this.fire(Gis.Objects.Base.NEED_REDRAW_EVENT.TYPE), this
}, setCoursePointPosition: function (a) {
    return this._coursePosition = a, this.fire(Gis.Objects.Base.NEED_REDRAW_EVENT.TYPE), this
}, isCoursePositionVisible: function (a) {
    return!this._markersAsimuthDisable || this._markersAsimuthDisable.indexOf(a) < 0
}, setCoursePointDisable: function (a) {
    var b = !1, c = this;
    return this._markersAsimuthDisable = this._markersAsimuthDisable || [], Gis.Util.isArray(a) ? a.forEach(function (a) {
        Gis.Util.isNumeric(a) && c.isCoursePositionVisible(a) && (c._markersAsimuthDisable.push(a), b = !0)
    }) : Gis.Util.isNumeric(a) && this.isCoursePositionVisible(a) && (this._markersAsimuthDisable.push(a), b = !0), b && this.fire(Gis.Objects.Base.NEED_REDRAW_EVENT.TYPE), this
}, _getCoursePosition: function () {
    var a = ["start", "end"];
    return a.indexOf(this._coursePosition) > -1 ? this._coursePosition : a.indexOf(this._coursePosition) > -1 && this._coursePosition || a[0]
}, setCoursePointEnable: function (a) {
    var b = !1, c = this;
    return this._markersAsimuthDisable = this._markersAsimuthDisable || [], Gis.Util.isArray(a) ? a.forEach(function (a) {
        Gis.Util.isNumeric(a) && c._markersAsimuthDisable.splice(c._markersAsimuthDisable.indexOf(a), 1).length && (b = !0)
    }) : Gis.Util.isNumeric(a) && c._markersAsimuthDisable.splice(c._markersAsimuthDisable.indexOf(a), 1).length && (b = !0), b && this.fire(Gis.Objects.Base.NEED_REDRAW_EVENT.TYPE), this
}, setCourseIcon: function (a) {
    return this._pathAngleIcon = Gis.icon(a), this._pathAngleIcon.setData({rotatable: !0}), this.fire("change", {target: this}, !0), this
}, _drawCourseIcon: function (a, b, c) {
    var d, e, f, g, h, i, j = this.isCoursePositionVisible(a);
    switch (this._getCoursePosition()) {
        case"end":
            h = c[a - 1], j = j && (this.getOption("isCycle") || a > 0), j && (e = Gis.latLng(h ? c[a - 1] : c[c.length - 1]), f = Gis.latLng(b));
            break;
        default:
            g = c[a + 1], e = Gis.latLng(g ? b : this.getOption("isCycle") ? b : c[a - 1]), f = Gis.latLng(g || this.getOption("isCycle") && c[0] || b)
    }
    d = this._markersAsimuth[a], j ? (this._pathAngleIcon || (this._pathAngleIcon = Gis.icon({type: "custom", rotatable: !0, image: {fullPath: Gis.Config.relativePath + "images", hash: "path_triangle.png"}})), (!this._cloned || this._pathAngleIcon && !this._pathAngleIcon.equals(this._cloned)) && (i = !0, this._cloned = this._pathAngleIcon.clone()), d ? (d.setData(Gis.Util.extend({latitude: b[0], longitude: b[1], angle: Gis.Projection.calculateLoxodromeAngle(e, f)}, i ? {icon: this._cloned} : {})), this._map.hasLayer(d) || d.addTo(this._map)) : (d = Gis.imageLabel({id: Gis.Util.generateGUID(), latitude: b[0], longitude: b[1], angle: Gis.Projection.calculateLoxodromeAngle(e, f), className: "gis-path-azimuth", icon: this._cloned}), d.idx = a, d.setCountable(!1), d.setControllableByServer(!1), d.addTo(this._map), this._markersAsimuth[a] = d)) : d && this._map.removeLayer(d)
}}, Gis.Objects.Polyline = Gis.Objects.Selectable.extend({includes: Gis.CourseIconBehavior, _isCached: !0, _markerEvents: "change drag dragstart dragend click", _markers: void 0, events: Gis.Core.Events.availableDomEvents, fixed: "id tacticObjectType", required: ["id", "points"], _iconDraggable: !0, _iconSelectable: !0, _cycled: !1, options: {points: void 0, line: void 0, icon: null, draggable: void 0, selectable: void 0, className: void 0, step: void 0}, isDraggable: function () {
    return this.getOption("draggable")
}, _initEventFunctions: function () {
    var a = this;
    this._markerEvent = this._markerEvent || function (b) {
        "dragend" === b.type || "dragstart" === b.type || "drag" === b.type ? a.fire("marker_drag", Gis.Util.extend(b, {markerKey: this.getIndex(), target: a})) : ("click" === b.type && (a._selectedAdditional = {markerKey: this.getIndex()}), "change" !== b.type && a.fire(b.type, Gis.Util.extend(b, {markerKey: this.getIndex(), target: a})))
    }
}, initialize: function (a) {
    this._fillOption(a, null, "icon", Gis.icon), a.line = Gis.lineStyle(a.line || {color: "#0033ff"}), a.id = a.id || Gis.Util.generateGUID();
    var b = a.points && this._updatePoints(a);
    b && (a.points = b), Gis.Objects.Selectable.prototype.initialize.call(this, a), this._initEventFunctions(), this._markers = [], this._markersAsimuth = []
}, setData: function (a, b, c) {
    var d, e, f, g = this.options.points;
    if (a && a.points || "points" === a)if (f = a.points || b, f.length !== g.length || f !== g && f.reduce(function (a, b, c) {
        return a + (g[c].equals(Gis.pathPoint(b)) ? "" : "1")
    }, ""))d = this._updatePoints(Gis.extend({}, Gis.Util.extend({}, this.options, this.getStyle()), {points: f})), d && (b ? b = d : a.points = d); else {
        if ("points" === a)return!1;
        delete a.points
    }
    return b = this._fillOption(a, b, "icon", Gis.icon), b = this._fillOption(a, b, "line", Gis.lineStyle), e = Gis.Objects.Selectable.prototype.setData.call(this, a, b, c)
}, appendPoint: function (a) {
    return this.options.points.push(a), this.fire("change", {target: this, rows: ["points"]}), this
}, _zoomFunc: function () {
    var a = this;
    this.getOptionsWithStyle().orthodrome && (this._timeout && clearTimeout(this._timeout), this._timeout = setTimeout(function () {
        a._timeout = void 0, Gis.requestAnimationFrame(100)(function () {
            a.fire(Gis.Objects.Base.NEED_REDRAW_EVENT.TYPE, {target: a})
        })
    }, 1e3))
}, onAdd: function (a) {
    Gis.Objects.Selectable.prototype.onAdd.call(this, a), this.on("drag", this._onDrag, this), this.on("hided", this._onHided, this), this.on("dragend", this._onDragEnd, this), this.on("marker_drag", this._markerDrag, this), a.on("zoomend", this._zoomFunc, this)
}, onDelete: function (a) {
    this._removeMarkers(), this._map.off("zoomend", this._zoomFunc, this), Gis.Objects.Selectable.prototype.onDelete.call(this, a), this.off("drag", this._onDrag, this), this.off("hided", this._onHided, this), this.off("dragend", this._onDragEnd, this), this.off("marker_drag", this._markerDrag, this)
}, setControllableByServer: function (a) {
    return this.options.points.forEach(function (b) {
        b.setControllableByServer(a)
    }), Gis.Objects.Selectable.prototype.setControllableByServer.call(this, a)
}, _toggleMarkerVisibility: function (a) {
    var b, c = "", d = this.getMarkersArray();
    for (b in d)d.hasOwnProperty(b) && (c += " " + b);
    a ? this._map.showLayersByID(c) : this._map.hideLayersByID(c)
}, _dragCalculate: function (a, b) {
    var c = [parseFloat(a.latLng.latitude) - parseFloat(this.getLatitudes()[0]), parseFloat(a.latLng.longitude) - parseFloat(this.getLongitudes()[0])];
    this._dragged = !0, this._increaseLanLng(c, !b), this.fire("change", {target: this, rows: ["points"], notFireToServer: !b})
}, _getModifiedRow: function (a, b, c) {
    c = c || this.options;
    var d, e, f, g, h = {selectable: c.selectable, parentId: c.id, className: Gis.Config.imageLabelClass + " " + (c.className || ""), draggable: c.draggable}, i = this.options.points;
    if (d = Gis.pathPoint(a), d.setData(h), d.setIndex(b), i)for (f = 0, g = i.length; g > f; f += 1)if (i[f].getId() === d.getId()) {
        e = i[f], e.setData(d.getParams()), e.setIndex(d.getIndex());
        break
    }
    return e || d.setControllableByServer(this.isControllableByServer())
}, _increase: function (a, b) {
    var c, d;
    for (c = 0, d = a.length; d > c; c += 1)a[c] = parseFloat(a[c]) + b
}, _updatePoints: function (a) {
    var b = this.options.points, c = a.points, d = [], e = this;
    return c && c.forEach(function (b, c) {
        d.push(e._getModifiedRow(b, c, a))
    }), b && this.removeMarkersExclude(d), d
}, getMarkerPosiotion: function (a, b) {
    var c, d;
    for (b = Gis.pathPoint(b), c = 0, d = a.length; d > c; c += 1) {
        var e = Gis.pathPoint(a[c]);
        if (e.getId() === b.getId() || b.equals(e))return c
    }
    return a.indexOf(b)
}, removeMarkersExclude: function (a) {
    var b, c, d, e = this.getMarkersArray(), f = this._markersAsimuth;
    for (b = 0, c = e.length; c > b; b += 1)d = e[b], -1 === this.getMarkerPosiotion(a, d) && (d.off(this._markerEvents, this._markerEvent, d), this._map.removeLayer(d));
    for (b = a.length, c = f.length; c > b; b += 1)this._map.removeLayer(f[b])
}, _increaseLanLng: function (a, b) {
    var c, d;
    this.options.points.forEach(function (e) {
        c = e.getParams(), d = e.setData({latitude: c.latitude + a[0], longitude: c.longitude + a[1]}, null, b), d || b || e.fire("change", {target: e, notFireToServer: b, rows: ["latitude", "longitude"]})
    })
}, isOrthodrome: function () {
    return this.options.orthodrome
}, _getPointCoordinates: function (a) {
    var b;
    switch (a) {
        case Gis.Objects.Path.CoordinateTypeFull:
            b = function (a) {
                return a.getLatLng()
            };
            break;
        case Gis.Objects.Path.CoordinateTypeLatitudes:
            b = function (a) {
                return a.getLatLng()[0]
            };
            break;
        case Gis.Objects.Path.CoordinateTypeLongitudes:
            b = function (a) {
                return a.getLatLng()[1]
            }
    }
    return this.options.points.map(b)
}, _onDrag: function (a) {
    this._dragCalculate(a, !1)
}, _onDragEnd: function (a) {
    this._dragCalculate(a, !0)
}, _getLatLngArray: function (a, b, c, d) {
    var e, f, g, h, i = [], j = a || this.getLatitudes(), k = b || this.getLongitudes(), l = Math.max(j.length, k.length);
    for (c && (h = d || this.getOption("step") && this.getOption("step")() || this._map.getOption("provider").getCurveStepKilometr()), e = 0; l > e; e += 1)c ? void 0 !== j[e + 1] && (g = i[i.length - 1], f = Gis.Projection.bearingByPoints(Gis.latLng([g && g[0] || parseFloat(j[e]), g && g[1] || parseFloat(k[e])]), Gis.latLng([parseFloat(j[e + 1]), parseFloat(k[e + 1])]), h), this._latLngDraw = this._latLngDraw || [f[0]], this._latLngDraw.push([parseFloat(j[e + 1]), parseFloat(k[e + 1])]), i = i.concat(f)) : i.push([parseFloat(j[e]), parseFloat(k[e])]);
    return i
}, getLatLngs: function (a, b, c) {
    return this._getLatLngArray(a, b, c)
}, getLatLngArray: function () {
    var a, b = this._getLatLngArray(this.getLatitudes(), this.getLongitudes(), !1);
    if (b) {
        a = [];
        for (var c = 0, d = b.length; d > c; c += 1)a.push(Gis.latLng(b[c][0], b[c][1]))
    }
    return a
}, _getMarkerName: function (a) {
    return"marker" + a[0] + "_" + a[1]
}, getLowLevelMarker: function (a) {
    return this._lowLevelObject && this._lowLevelObject[this._getMarkerName(a)]
}, _hideNewPath: function () {
    this._mapRender.removeLayer(this._lowLevelObject.templine), this._lowLevelObject.templine = void 0
}, _drawNewPath: function (a) {
    var b, c = this.getLongitudes(), d = this.getLatitudes(), e = a - 1 >= 0 ? a - 1 : 0, f = Math.min(d.length, c.length) - 1;
    b = this._getLatLngArray(d.slice(e, a + 2), c.slice(e, a + 2)), this._cycled && 0 === a ? b.unshift([d[f], c[f]]) : this._cycled && a === f && b.push([d[0], c[0]]), this._lowLevelObject.templine = this._mapRender.drawPolyline(Gis.Util.extend({}, {latlng: b, drawIcon: !1, line: Gis.lineStyle(Gis.Config.style.DefaultTempLine)}), this._lowLevelObject && this._lowLevelObject.templine)
}, setIconDraggable: function (a) {
    this._iconDraggable = a
}, setIconSelectable: function (a) {
    this._iconSelectable = a
}, hasMarker: function (a) {
    return this.getMarkersArray().hasOwnProperty(a)
}, clearMarkers: function () {
    return this.options.points = [], this
}, removeSelectedMarkers: function (a, b) {
    if (a) {
        var c, d, e;
        for (c = 0, d = Math.max(a.length || b.length); d > c; c += 1)e = a[c], e && (e.off(this._markerEvents, this._markerEvent, e), this._map.removeLayer(e)), b[c] && this._map.removeLayer(b[c])
    }
}, _removeMarkers: function (a) {
    a = a || 0;
    var b = this.getMarkersArray();
    b && this.removeSelectedMarkers(b.splice(a), this._markersAsimuth.splice(a))
}, getMarkersArray: function () {
    return this.options.points
}, getMarkersArraySafe: function () {
    return this.options.points.slice()
}, pushMarker: function (a) {
    this._markers[a.getIndex()] = a
}, _drawPointMarker: function (a, b) {
    var c, d, e, f, g, h = this._firstIcon !== this.getOption("icon");
    e = this.getMarkersArray()[a], g = this.getOptionsWithStyle(), e ? (c = e.isSelected(), f = {latitude: b[0], longitude: b[1], draggable: g.draggable && this._iconDraggable && this.isThisEventable(), className: Gis.Config.imageLabelClass + " " + (g.className || ""), selectable: g.selectable && this._iconSelectable && this.isThisEventable()}, e.setSelected(this._selected && this._selectedAdditional && this._selectedAdditional.markerKey === a), d = e.setData(f), this._map.hasLayer(e) ? d || c === e.isSelected() || e.fire("change") : (e.addTo(this._map), e.on(this._markerEvents, this._markerEvent, e))) : (this._firstIcon = g.icon, e = Gis.pathPoint({tacticObjectType: this.getType(), parentId: this.getId(), latitude: b[0], longitude: b[1], draggable: g.draggable && this._iconDraggable && this.isThisEventable(), className: Gis.Config.imageLabelClass + " " + (g.className || ""), selectable: g.selectable && this._iconSelectable && this.isThisEventable()}), e.setSelected(this._selected && this._selectedAdditional && this._selectedAdditional.markerKey === a), e.setIndex(a), e.setControllableByServer(!1), e.addTo(this._map), e.on(this._markerEvents, this._markerEvent, e), this.pushMarker(e)), h && (this._firstIcon = g.icon)
}, drawAllMarkers: function (a, b) {
    var c, d, e = this;
    if (a && a.length) {
        for (c = a.length, this._lowLevelObject = this._lowLevelObject || {inset: !0}, Gis.Objects.Selectable.prototype.draw.call(this, b), this._lastLng && this._lastLng.length > c && this._removeMarkers(c), d = 0; c > d; d += 1)e._drawPointMarker(d, a[d]), e._course && e._drawCourseIcon(d, a[d], a);
        this._lastLng = a
    }
}, hideAllMarkers: function () {
    var a, b = this.getMarkersArraySafe().splice(0), c = b && b.length;
    if (c)for (a = 0; c > a; a += 1)b[a].hideFromMap()
}, _onHided: function () {
    this.hideAllMarkers()
}, draw: function (a) {
    a && this.preDraw() && this.drawAllMarkers(this._latLngDraw || this._getLatLngArray(), a)
}, setSelectedPoint: function (a, b) {
    this._selectedAdditional = this._selectedAdditional || {}, this._selectedAdditional.markerKey = a, b && this.fire(Gis.Objects.Base.NEED_REDRAW_EVENT.TYPE)
}, _markerDrag: function (a) {
    "dragend" === a.type || this.getOption("orthodrome") && "drag" === a.type ? (this._hideNewPath(a.markerKey), this.fire("change", {target: this, rows: ["points"]})) : this._drawNewPath(a.markerKey)
}, getLatLng: function () {
    return[this.getLatitudes()[0], this.getLongitudes()[0]]
}, getCenter: function () {
    try {
        var a = this.getCurrentLatLngBounds();
        return[(a.getSouthWest().lat + a.getNorthWest().lat) / 2, (a.getSouthWest().lng + a.getSouthEast().lng) / 2]
    } catch (b) {
        return void 0
    }
}, getPoints: function () {
    return this.getOption("points")
}, getLatitudes: function () {
    return this._getPointCoordinates(Gis.Objects.Path.CoordinateTypeLatitudes)
}, getLongitudes: function () {
    return this._getPointCoordinates(Gis.Objects.Path.CoordinateTypeLongitudes)
}, getLatLngBounds: function () {
    var a, b, c = this.getLatitudes(), d = this.getLongitudes(), e = 0, f = 0, g = c[0], h = d[0];
    for (b = Math.min(c.length, d.length), a = 0; b > a; a += 1)e = Math.max(e, c[a]), f = Math.max(f, d[a]), g = Math.min(g, c[a]), h = Math.min(h, d[a]);
    return Gis.latLngBounds(Gis.latLng(e, h), Gis.latLng(g, f))
}}), Gis.Objects.PathData = Gis.BaseClass.extend({tolerance: .1, initialize: function () {
    this._points = this._points || [], Gis.BaseClass.prototype.initialize.apply(this, arguments)
}, add: function (a) {
    var b = a.getTimeStamp();
    this._points.length ? this._points[this._points.length - 1].getTimeStamp() <= b ? this._points.push(a) : this._points[0].getTimeStamp() > b ? this._points.unshift(a) : this._points.splice(this.searchPositionToInsert(a), 0, a) : this._points.push(a)
}, size: function () {
    return this._points.length
}, removePointByIndex: function (a) {
    this._points.splice(a, 1)
}, getPoint: function (a) {
    return this._points[a]
}, findIndex: function (a) {
    return this._points.indexOf(a)
}, remove: function (a) {
    if (Array.isArray(a)) {
        var b = this._points.indexOf(a[0]);
        b > -1 && this._points.splice(b, a.length)
    } else this.removePointByIndex(Gis.Util.isNumeric(a) ? a : this.findIndex(a))
}, searchPositionToInsert: function (a) {
    var b, c, d, e, f, g, h = this._points;
    if (void 0 === a)return null;
    if (!h.length)return 0;
    if (f = h[h.length - 1], g = a.getTimeStamp(), g >= f.getTimeStamp())return a._insertPosition = h.length, h.length;
    if (f = h[0], g < f.getTimeStamp())return a._insertPosition = 0, 0;
    for (b = 0, c = h.length - 1; c >= b;)if (d = parseInt((b + c) / 2, 10), e = h[d].getTimeStamp() - g, 0 > e || 0 === e) {
        if (f = h[d + 1], e = f.getTimeStamp() - g, e > 0)return a._insertPosition = d + 1, d + 1;
        b = d + 1
    } else c = d - 1;
    return-1
}, getData: function () {
    return this._points.slice()
}, each: function (a, b) {
    var c, d = this._points.slice();
    for (c in d)d.hasOwnProperty(c) && a.call(b || d[c], d[c])
}, getSorted: function (a) {
    var b, c, d, e = [];
    for (b = a ? this.getSortedPoints(a) : this._points, c = 0, d = b.length; d > c; c += 1)e[c] = b[c].getLatLng().slice();
    return e
}, getSortedPoints: function (a) {
    var b, c = this._points.slice(), d = 0;
    if (a)if (this._points = a.getVisiblePoints(this._points), this._points.length) {
        if (this._points[0] !== c[0])for (b = Math.max(this._points.length - 1, 0), d = 0, b = c.length - b; b > d; d += 1)-1 === this._points.indexOf(c[d]) && c[d].onClosePoint()
    } else for (d = 0, b = c.length; b > d; d += 1)c[d].onClosePoint();
    return this._points
}}), Gis.Additional.Icon.arrow = function (a, b, c, d) {
    "use strict";
    var e, f = 21;
    c = c || document.createElement("canvas"), c.width = b, c.height = b, Gis.Additional.Icon.fixPositionCanvas(f, f, c);
    var g = b / f;
    return e = c.getContext("2d"), d = d || "#ffffff", e.save(), e.beginPath(), e.moveTo(0, 0), e.lineTo(21 * g, 0), e.lineTo(21 * g, 21 * g), e.lineTo(0, 21 * g), e.closePath(), e.clip(), e.strokeStyle = a, e.lineCap = "butt", e.lineJoin = "miter", e.miterLimit = 4, e.save(), e.save(), e.restore(), e.save(), e.fillStyle = d, e.translate(9.924735069274902 * g, 10.48912525177002 * g), e.rotate(-3.141592653589793), e.translate(-9.924735069274902 * g, -10.48912525177002 * g), e.beginPath(), e.moveTo(16.614143 * g, 6.746563 * g), e.bezierCurveTo(16.613746 * g, 3.052125 * g, 13.619785999999998 * g, .057319999999999816 * g, 9.925756999999997 * g, .057319999999999816 * g), e.bezierCurveTo(6.230539999999998 * g, .057319999999999816 * g, 3.235325999999997 * g, 3.0521249999999998 * g, 3.235325999999997 * g, 6.746563 * g), e.bezierCurveTo(3.235325999999997 * g, 9.93516 * g, 8.218344999999996 * g, 18.453873 * g, 9.583697999999998 * g, 20.726955 * g), e.bezierCurveTo(9.655535999999998 * g, 20.847431 * g, 9.785340999999999 * g, 20.92093 * g, 9.925358999999998 * g, 20.92093 * g), e.bezierCurveTo(10.065364999999998 * g, 20.92093 * g, 10.195645999999998 * g, 20.84743 * g, 10.267033999999999 * g, 20.727348999999997 * g), e.bezierCurveTo(11.631991999999999 * g, 18.454662999999996 * g, 16.614142 * g, 9.935157999999996 * g, 16.614142 * g, 6.746561999999997 * g), e.closePath(), e.fill(), e.stroke(), e.restore(), e.save(), e.fillStyle = a, e.translate(9.897698402404785 * g, 12.236992835998535 * g), e.rotate(-3.141592653589793), e.translate(-9.897698402404785 * g, -12.236992835998535 * g), e.beginPath(), e.moveTo(13.93781 * g, 9.976645 * g), e.bezierCurveTo(13.937570000000001 * g, 7.7453579999999995 * g, 12.129343 * g, 5.936617999999999 * g, 9.898328000000001 * g, 5.936617999999999 * g), e.bezierCurveTo(7.666566000000001 * g, 5.936617999999999 * g, 5.857588000000001 * g, 7.7453579999999995 * g, 5.857588000000001 * g, 9.976645 * g), e.bezierCurveTo(5.857588000000001 * g, 11.902421 * g, 8.867123000000001 * g, 17.047369 * g, 9.691742000000001 * g, 18.420218 * g), e.bezierCurveTo(9.735127000000002 * g, 18.49298 * g, 9.813526000000001 * g, 18.537368999999998 * g, 9.898091 * g, 18.537368999999998 * g), e.bezierCurveTo(9.982646 * g, 18.537368999999998 * g, 10.061309000000001 * g, 18.492979 * g, 10.104423 * g, 18.420451999999997 * g), e.bezierCurveTo(10.9288 * g, 17.047849999999997 * g, 13.937809000000001 * g, 11.902420999999997 * g, 13.937809000000001 * g, 9.976643999999997 * g), e.closePath(), e.fill(), e.stroke(), e.restore(), e.restore(), e.restore(), c
}, Gis.Additional.Icon.arrow.width = 21, Gis.Additional.Icon.car = function (a, b, c, d) {
    "use strict";
    var e;
    return c = c || document.createElement("canvas"), c.width = 21, c.height = 21, Gis.Additional.Icon.fixPositionCanvas(b, 21, c), e = c.getContext("2d"), e.save(), e.translate(0, 0), e.beginPath(), e.moveTo(0, 0), e.lineTo(21, 0), e.lineTo(21, 21), e.lineTo(0, 21), e.closePath(), e.clip(), e.translate(0, 0), e.translate(0, 0), e.scale(1, 1), e.translate(0, 0), e.strokeStyle = "rgba(0, 0, 0, 0)", e.lineCap = "butt", e.lineJoin = "miter", e.miterLimit = 4, e.save(), e.save(), e.fillStyle = a, e.beginPath(), e.moveTo(6.84, 20.5), e.bezierCurveTo(5.55, 20.5, 4.5, 19.45, 4.5, 18.16), e.lineTo(4.5, 9.839), e.bezierCurveTo(4.5, 9.463, 4.516, 9, 4.544, 8.5), e.lineTo(3.5, 8.5), e.lineTo(3.5, 6.5), e.lineTo(4.714, 6.5), e.bezierCurveTo(4.731000000000001, 6.361, 4.747000000000001, 6.23, 4.765000000000001, 6.108), e.lineTo(5.245000000000001, 2.7499999999999996), e.bezierCurveTo(5.422, 1.509, 6.586, .5, 7.84, .5), e.lineTo(13.16, .5), e.bezierCurveTo(14.414, .5, 15.578, 1.51, 15.755, 2.751), e.lineTo(16.235, 6.106999999999999), e.bezierCurveTo(16.253, 6.228999999999999, 16.269, 6.360999999999999, 16.285999999999998, 6.499999999999999), e.lineTo(17.5, 6.499999999999999), e.lineTo(17.5, 8.5), e.lineTo(16.456, 8.5), e.bezierCurveTo(16.484, 9, 16.5, 9.463, 16.5, 9.839), e.lineTo(16.5, 18.16), e.bezierCurveTo(16.5, 19.45, 15.45, 20.5, 14.16, 20.5), e.lineTo(6.84, 20.5), e.closePath(), e.fill(), e.stroke(), e.restore(), e.save(), d = d || "#ffffff", e.fillStyle = d, e.beginPath(), e.moveTo(13.16, 1), e.bezierCurveTo(14.172, 1, 15.117, 1.819, 15.26, 2.8209999999999997), e.lineTo(15.74, 6.178), e.bezierCurveTo(15.774, 6.419, 15.808, 6.7, 15.838, 7), e.lineTo(17, 7), e.lineTo(17, 8), e.lineTo(15.923, 8), e.bezierCurveTo(15.971, 8.665, 16, 9.332, 16, 9.839), e.lineTo(16, 18.16), e.bezierCurveTo(16, 19.172, 15.172, 20, 14.16, 20), e.lineTo(6.84, 20), e.bezierCurveTo(5.828, 20, 5, 19.171, 5, 18.16), e.lineTo(5, 9.839), e.bezierCurveTo(5, 9.332, 5.029, 8.665, 5.077, 8), e.lineTo(4, 8), e.lineTo(4, 7), e.lineTo(5.162, 7), e.bezierCurveTo(5.192, 6.7, 5.226, 6.419, 5.26, 6.178), e.lineTo(5.74, 2.8209999999999997), e.bezierCurveTo(5.883, 1.819, 6.828, 1, 7.84, 1), e.lineTo(13.16, 1), e.moveTo(13.16, 0), e.lineTo(7.84, 0), e.bezierCurveTo(6.321, 0, 4.964, 1.177, 4.75, 2.68), e.lineTo(4.275, 6), e.lineTo(4, 6), e.lineTo(3, 6), e.lineTo(3, 7), e.lineTo(3, 8), e.lineTo(3, 9), e.lineTo(4, 9), e.lineTo(4.019, 9), e.bezierCurveTo(4.007, 9.307, 4, 9.591, 4, 9.839), e.lineTo(4, 18.16), e.bezierCurveTo(4, 19.726, 5.273, 21, 6.84, 21), e.lineTo(14.16, 21), e.bezierCurveTo(15.726, 21, 17, 19.726, 17, 18.16), e.lineTo(17, 9.839), e.bezierCurveTo(17, 9.591, 16.993, 9.307, 16.981, 9), e.lineTo(17, 9), e.lineTo(18, 9), e.lineTo(18, 8), e.lineTo(18, 7), e.lineTo(18, 6), e.lineTo(17, 6), e.lineTo(16.725, 6), e.lineTo(16.25, 2.68), e.bezierCurveTo(16.036, 1.177, 14.679, 0, 13.16, 0), e.lineTo(13.16, 0), e.closePath(), e.fill(), e.stroke(), e.restore(), e.restore(), e.save(), e.fillStyle = d, e.beginPath(), e.moveTo(10.503, 8.607), e.bezierCurveTo(8.97, 8.607, 8.435, 8.658, 7.006, 9), e.bezierCurveTo(6.55, 8.123, 6.444, 7.531, 6.049, 6.584), e.bezierCurveTo(7.479, 6.242, 8.97, 6.061999999999999, 10.503, 6.061999999999999), e.bezierCurveTo(12.036, 6.061999999999999, 13.527000000000001, 6.242999999999999, 14.957, 6.584), e.bezierCurveTo(14.562, 7.531, 14.456, 8.123, 14, 9), e.bezierCurveTo(12.571, 8.658, 12.036, 8.607, 10.503, 8.607), e.closePath(), e.fill(), e.stroke(), e.restore(), e.save(), e.fillStyle = d, e.beginPath(), e.moveTo(10.503, 16.696), e.bezierCurveTo(11.691, 16.696, 12.107, 16.656000000000002, 13.215, 16.392000000000003), e.bezierCurveTo(13.568999999999999, 17.072000000000003, 13.651, 17.531000000000002, 13.957, 18.265000000000004), e.bezierCurveTo(12.849, 18.530000000000005, 11.691, 18.670000000000005, 10.503, 18.670000000000005), e.bezierCurveTo(9.314, 18.670000000000005, 8.157, 18.530000000000005, 7.0489999999999995, 18.265000000000004), e.bezierCurveTo(7.356, 17.531000000000006, 7.438, 17.072000000000003, 7.7909999999999995, 16.392000000000003), e.bezierCurveTo(8.898, 16.656, 9.313, 16.696, 10.503, 16.696), e.closePath(), e.fill(), e.stroke(), e.restore(), e.save(), e.fillStyle = d, e.beginPath(), e.moveTo(15, 8), e.lineTo(14.031, 11), e.lineTo(14.031, 14.813), e.lineTo(15, 16), e.lineTo(15, 8), e.closePath(), e.fill(), e.stroke(), e.restore(), e.save(), e.fillStyle = d, e.beginPath(), e.moveTo(6.031, 7.999), e.lineTo(7, 11), e.lineTo(7, 14.812), e.lineTo(6.031, 15.999), e.lineTo(6.031, 7.999), e.closePath(), e.fill(), e.stroke(), e.restore(), e.restore(), c
}, Gis.Additional.Icon.circle = function (a, b, c) {
    var d;
    return c = c || document.createElement("canvas"), c.width = b, c.height = b, d = c.getContext("2d"), d.fillStyle = a, d.lineWidth = b / 6, d.arc(b / 2, b / 2, 2 * b / 6, 0, 2 * Math.PI), d.fill(), d.strokeStyle = "#FFFFFF", d.stroke(), c
}, function (a) {
    "use strict";
    a.Additional.Icon.danger = function (a, b, c) {
        var d;
        return c = c || document.createElement("canvas"), c.width = 18, c.height = 18, Gis.Additional.Icon.fixPositionCanvas(b, 18, c), d = c.getContext("2d"), d.save(), d.translate(0, 0), d.beginPath(), d.moveTo(0, 0), d.lineTo(18, 0), d.lineTo(18, 18), d.lineTo(0, 18), d.closePath(), d.clip(), d.translate(0, 0), d.translate(0, 0), d.scale(1, 1), d.translate(0, 0), d.strokeStyle = "rgba(0, 0, 0, 0)", d.lineCap = "butt", d.lineJoin = "miter", d.miterLimit = 4, d.save(), d.fillStyle = a, d.beginPath(), d.moveTo(9.019, -.031), d.lineTo(7.794, 2.412), d.lineTo(10.242999999999999, 2.412), d.lineTo(9.019, -.031), d.closePath(), d.moveTo(18, 17.908), d.lineTo(10.489, 2.905), d.lineTo(10.489, 12.742999999999999), d.lineTo(7.502, 12.742999999999999), d.lineTo(7.502, 2.998), d.lineTo(.035, 17.908), d.lineTo(7.502, 17.908), d.lineTo(7.502, 14.464000000000002), d.lineTo(10.489, 14.464000000000002), d.lineTo(10.489, 17.908), d.lineTo(18, 17.908), d.closePath(), d.fill(), d.stroke(), d.restore(), d.restore(), c
    }
}(Gis), function (a) {
    "use strict";
    a.Additional.Icon.diamod = function (a, b, c) {
        var d, e = b / 8;
        return c = c || document.createElement("canvas"), c.width = b, c.height = b, d = c.getContext("2d"), d.fillStyle = a, d.beginPath(), d.moveTo(e / 2, b / 2), Gis.Canvas.lineByPath(d, b / 2 + "," + e + " " + (b - e) + "," + b / 2 + " " + b / 2 + "," + (b - e)), d.fill(), d.closePath(), d.lineWidth = e, d.strokeStyle = "white", d.stroke(), c
    }
}(Gis), function (a) {
    "use strict";
    a.Additional.Icon.diamond = function (a, b, c) {
        var d, e = b / 8;
        return c = c || document.createElement("canvas"), c.width = b, c.height = b, d = c.getContext("2d"), d.fillStyle = a, d.beginPath(), d.moveTo(e / 2, b / 2), Gis.Canvas.lineByPath(d, b / 2 + "," + e + " " + (b - e) + "," + b / 2 + " " + b / 2 + "," + (b - e)), d.fill(), d.closePath(), d.lineWidth = e, d.strokeStyle = "white", d.stroke(), c
    }
}(Gis), Gis.Additional.Icon.helicopter = function (a, b, c, d) {
    "use strict";
    var e;
    return c = c || document.createElement("canvas"), c.width = 21, c.height = 21, Gis.Additional.Icon.fixPositionCanvas(b, 21, c), e = c.getContext("2d"), e.save(), e.translate(0, 0), e.beginPath(), e.moveTo(0, 0), e.lineTo(21, 0), e.lineTo(21, 21), e.lineTo(0, 21), e.closePath(), e.clip(), e.translate(0, 0), e.translate(0, 0), e.scale(1, 1), e.translate(0, 0), e.strokeStyle = "rgba(0,0,0,0)", e.lineCap = "butt", e.lineJoin = "miter", e.miterLimit = 4, e.save(), e.save(), e.fillStyle = a, e.beginPath(), e.moveTo(9.5, 20.5), e.lineTo(9.5, 19.5), e.lineTo(8.5, 19.5), e.lineTo(8.5, 18.5), e.bezierCurveTo(8.5, 18.26, 8.574, 17.82, 9.073, 17.571), e.lineTo(9.265, 17.938000000000002), e.lineTo(9.25, 17.5), e.lineTo(7.5, 17.5), e.lineTo(7.5, 16.5), e.bezierCurveTo(7.5, 16.17, 7.668, 15.734, 8.471, 15.533), e.lineTo(8.518, 15.681999999999999), e.lineTo(8.5, 15.5), e.lineTo(9.5, 15.5), e.lineTo(9.5, 14.134), e.bezierCurveTo(9.099, 13.829, 8.739, 13.335, 8.437, 12.676), e.lineTo(3.467999999999999, 17.645), e.lineTo(1.8219999999999992, 15.998999999999999), e.lineTo(7.704999999999999, 10.114999999999998), e.bezierCurveTo(7.575, 9.315, 7.506, 8.477, 7.5, 7.619), e.lineTo(1.822, 1.94), e.lineTo(3.4690000000000003, .29400000000000004), e.lineTo(7.757000000000001, 4.582000000000001), e.bezierCurveTo(8.221, 2.071, 9.255, .5, 10.5, .5), e.bezierCurveTo(11.743, .5, 12.777000000000001, 2.0700000000000003, 13.242, 4.579), e.lineTo(17.528, .29300000000000015), e.lineTo(19.174, 1.939), e.lineTo(13.497, 7.615), e.bezierCurveTo(13.489, 8.516, 13.421, 9.338000000000001, 13.293, 10.119), e.lineTo(19.174, 16), e.lineTo(17.528, 17.646), e.lineTo(12.561999999999998, 12.68), e.bezierCurveTo(12.260999999999997, 13.337, 11.901999999999997, 13.829, 11.499999999999998, 14.134), e.lineTo(11.499999999999998, 15.5), e.lineTo(12.499999999999998, 15.5), e.lineTo(12.499999999999998, 15.558), e.lineTo(12.508999999999999, 15.529), e.bezierCurveTo(13.331, 15.734, 13.5, 16.17, 13.5, 16.5), e.lineTo(13.5, 17.438), e.lineTo(13, 17.5), e.lineTo(11.5, 17.5), e.lineTo(11.5, 17.558), e.lineTo(11.509, 17.529), e.bezierCurveTo(12.331, 17.734, 12.5, 18.17, 12.5, 18.5), e.lineTo(12.5, 19.438), e.lineTo(12, 19.5), e.lineTo(11.5, 19.5), e.lineTo(11.5, 20.5), e.lineTo(9.5, 20.5), e.closePath(), e.fill(), e.stroke(), e.restore(), e.save(), d = d || "#ffffff", e.fillStyle = d, e.beginPath(), e.moveTo(17.528, 1), e.lineTo(18.465999999999998, 1.939), e.lineTo(12.996999999999996, 7.407), e.bezierCurveTo(12.998, 7.438, 13, 7.469, 13, 7.5), e.bezierCurveTo(13, 8.5, 12.91, 9.443, 12.756, 10.29), e.lineTo(18.467, 16), e.lineTo(17.528, 16.938), e.lineTo(12.376999999999999, 11.786999999999999), e.bezierCurveTo(12.024, 12.829999999999998, 11.544999999999998, 13.573999999999998, 11.001, 13.863), e.lineTo(11.001, 16), e.bezierCurveTo(11.001, 16, 12.186, 16, 12.501, 16), e.bezierCurveTo(12, 16, 13, 16, 13, 16.5), e.bezierCurveTo(13, 17, 13, 17, 13, 17), e.lineTo(11, 17), e.lineTo(11, 18), e.bezierCurveTo(11.212, 18, 11.399000000000001, 18, 11.5, 18), e.bezierCurveTo(11, 18, 12, 18, 12, 18.5), e.bezierCurveTo(12, 19, 12, 19, 12, 19), e.lineTo(11, 19), e.lineTo(11, 20), e.lineTo(10, 20), e.lineTo(10, 19), e.lineTo(9, 19), e.bezierCurveTo(9, 19, 9, 19, 9, 18.5), e.bezierCurveTo(9, 18, 9.5, 18, 9.25, 18), e.bezierCurveTo(9.4, 18, 10, 18, 10, 18), e.lineTo(10, 17), e.lineTo(8, 17), e.bezierCurveTo(8, 17, 8, 17, 8, 16.5), e.bezierCurveTo(8, 16, 9, 16, 8.5, 16), e.bezierCurveTo(8.815, 16, 10, 16, 10, 16), e.lineTo(10, 13.863), e.bezierCurveTo(9.456, 13.574, 8.977, 12.828999999999999, 8.623, 11.783), e.lineTo(3.4689999999999994, 16.936999999999998), e.lineTo(2.53, 15.998), e.lineTo(8.243, 10.285), e.bezierCurveTo(8.089, 9.439, 8, 8.498, 8, 7.5), e.bezierCurveTo(8, 7.471, 8.002, 7.442, 8.002, 7.413), e.lineTo(2.529, 1.94), e.lineTo(3.468, 1.002), e.lineTo(8.105, 5.638), e.bezierCurveTo(8.413, 2.956, 9.368, 1, 10.5, 1), e.bezierCurveTo(11.631, 1, 12.586, 2.9539999999999997, 12.895, 5.634), e.lineTo(17.528, 1), e.moveTo(17.528, -.415), e.lineTo(16.820999999999998, .293), e.lineTo(13.532999999999998, 3.581), e.bezierCurveTo(12.942, 1.331, 11.847, 0, 10.5, 0), e.bezierCurveTo(9.152, 0, 8.056, 1.332, 7.466, 3.584), e.lineTo(4.176, .29400000000000004), e.lineTo(3.469, -.412), e.lineTo(2.762, .294), e.lineTo(1.823, 1.233), e.lineTo(1.115, 1.94), e.lineTo(1.823, 2.6479999999999997), e.lineTo(7.004, 7.829), e.bezierCurveTo(7.0169999999999995, 8.552, 7.074, 9.259, 7.1739999999999995, 9.940999999999999), e.lineTo(1.8239999999999998, 15.291999999999998), e.lineTo(1.117, 15.998999999999999), e.lineTo(1.823, 16.706), e.lineTo(2.761, 17.645), e.lineTo(3.468, 18.352999999999998), e.lineTo(4.176, 17.645), e.lineTo(8.311, 13.51), e.bezierCurveTo(8.52, 13.855, 8.75, 14.142, 9, 14.369), e.lineTo(9, 15), e.lineTo(8.5, 15), e.lineTo(8.5, 15.519), e.lineTo(8.364, 15.045), e.bezierCurveTo(7.131, 15.353, 7, 16.165, 7, 16.5), e.lineTo(7, 16.938), e.lineTo(7, 16.993), e.lineTo(7, 17.993), e.lineTo(8, 18), e.lineTo(8.077, 18), e.bezierCurveTo(8.026, 18.156, 8, 18.323, 8, 18.5), e.lineTo(8, 18.938), e.lineTo(8, 18.993), e.lineTo(8, 19.993), e.lineTo(9, 20), e.lineTo(9, 21), e.lineTo(10, 21), e.lineTo(11, 21), e.lineTo(12, 21), e.lineTo(12, 20), e.lineTo(13, 20), e.lineTo(13, 18.999), e.lineTo(13, 18.936999999999998), e.lineTo(13, 18.5), e.bezierCurveTo(13, 18.38, 12.983, 18.198, 12.905, 18), e.lineTo(13, 18), e.lineTo(14, 18), e.lineTo(14, 16.999), e.lineTo(14, 16.936999999999998), e.lineTo(14, 16.5), e.bezierCurveTo(14, 16.165, 13.868, 15.353, 12.65, 15.049), e.lineTo(12.5, 15.596), e.lineTo(12.5, 15), e.lineTo(12, 15), e.lineTo(12, 14.369), e.bezierCurveTo(12.25, 14.142, 12.479, 13.857, 12.688, 13.514), e.lineTo(16.82, 17.646), e.lineTo(17.527, 18.353), e.lineTo(18.234, 17.646), e.lineTo(19.173000000000002, 16.708000000000002), e.lineTo(19.882, 16), e.lineTo(19.174000000000003, 15.293), e.lineTo(13.826000000000004, 9.945), e.bezierCurveTo(13.927000000000005, 9.257, 13.984000000000004, 8.547, 13.997000000000003, 7.822), e.lineTo(19.174000000000003, 2.646), e.lineTo(19.881000000000004, 1.939), e.lineTo(19.174000000000003, 1.2320000000000002), e.lineTo(18.236000000000004, .29300000000000026), e.lineTo(17.528, -.415), e.lineTo(17.528, -.415), e.closePath(), e.fill(), e.stroke(), e.restore(), e.restore(), e.restore(), c
}, function (a) {
    "use strict";
    a.Additional.Icon.m = function (a, b, c, d) {
        var e;
        return c = c || document.createElement("canvas"), c.width = b, c.height = b, e = c.getContext("2d"), Gis.Canvas.roundRect(e, 0, 0, b, b, 4, a, "#FFFFFF"), e.stroke(), e.fillStyle = d || "#FFFFFF", e.font = "bold 9pt Arial", e.textBaseline = "bottom", e.textAlign = "center", e.fillText("M", b / 2, b - (b - 13.5) / 2), c
    }
}(Gis), function (a) {
    "use strict";
    a.Additional.Icon.plane = function (a, b, c, d) {
        var e;
        return c = c || document.createElement("canvas"), c.width = 21, c.height = 21, Gis.Additional.Icon.fixPositionCanvas(b, 21, c), e = c.getContext("2d"), e.save(), e.translate(0, 0), e.beginPath(), e.moveTo(0, 0), e.lineTo(21, 0), e.lineTo(21, 21), e.lineTo(0, 21), e.closePath(), e.clip(), e.translate(0, 0), e.translate(0, 0), e.scale(1, 1), e.translate(0, 0), e.strokeStyle = "rgba(0, 0, 0, 0)", e.lineCap = "butt", e.lineJoin = "miter", e.miterLimit = 4, e.save(), e.save(), e.fillStyle = a, e.beginPath(), e.moveTo(10, 18.5), e.bezierCurveTo(9.173, 18.5, 8.5, 17.826999999999998, 8.5, 17), e.lineTo(8.5, 14), e.bezierCurveTo(8.5, 13.724, 8.275, 13.5, 8, 13.5), e.lineTo(2, 13.5), e.bezierCurveTo(1.173, 13.5, .5, 12.827, .5, 12), e.bezierCurveTo(.5, 11.245, 1.054, 10.446, 1.761, 10.181000000000001), e.lineTo(7.888, 7.883000000000001), e.bezierCurveTo(8.208, 7.762, 8.5, 7.341, 8.5, 7), e.lineTo(8.5, 4), e.bezierCurveTo(8.5, 2.423, 9.292, 2.009, 9.382, 1.967), e.bezierCurveTo(9.689, 1.8250000000000002, 10.084999999999999, 1.747, 10.5, 1.747), e.bezierCurveTo(10.915000000000001, 1.747, 11.312, 1.8250000000000002, 11.617, 1.967), e.bezierCurveTo(11.708, 2.009, 12.5, 2.422, 12.5, 4), e.lineTo(12.5, 7), e.bezierCurveTo(12.5, 7.342, 12.792, 7.763, 13.112, 7.883), e.lineTo(19.239, 10.181000000000001), e.bezierCurveTo(19.946, 10.445, 20.5, 11.244, 20.5, 12), e.bezierCurveTo(20.5, 12.827, 19.826999999999998, 13.5, 19, 13.5), e.lineTo(13, 13.5), e.bezierCurveTo(12.725, 13.5, 12.5, 13.724, 12.5, 14), e.lineTo(12.5, 17), e.bezierCurveTo(12.5, 17.826999999999998, 11.827, 18.5, 11, 18.5), e.lineTo(10, 18.5), e.closePath(), e.fill(), e.stroke(), e.restore(), e.save(), e.fillStyle = d || "#ffffff", e.beginPath(), e.moveTo(10.5, 2.247), e.bezierCurveTo(10.829, 2.247, 11.158, 2.3049999999999997, 11.407, 2.42), e.bezierCurveTo(11.407, 2.42, 12, 2.696, 12, 4), e.lineTo(12, 7), e.bezierCurveTo(12, 7.55, 12.422, 8.158, 12.937, 8.350999999999999), e.lineTo(19.064, 10.649), e.bezierCurveTo(19.578, 10.841, 20, 11.45, 20, 12), e.bezierCurveTo(20, 12.55, 19.55, 13, 19, 13), e.lineTo(13, 13), e.bezierCurveTo(12.45, 13, 12, 13.45, 12, 14), e.lineTo(12, 17), e.bezierCurveTo(12, 17.55, 11.55, 18, 11, 18), e.lineTo(10, 18), e.bezierCurveTo(9.45, 18, 9, 17.55, 9, 17), e.lineTo(9, 14), e.bezierCurveTo(9, 13.45, 8.55, 13, 8, 13), e.lineTo(2, 13), e.bezierCurveTo(1.45, 13, 1, 12.55, 1, 12), e.bezierCurveTo(1, 11.45, 1.422, 10.842, 1.937, 10.649000000000001), e.lineTo(8.064, 8.351), e.bezierCurveTo(8.578, 8.158, 9, 7.549, 9, 7), e.lineTo(9, 4), e.bezierCurveTo(9, 2.696, 9.593, 2.42, 9.593, 2.42), e.bezierCurveTo(9.842, 2.305, 10.171, 2.247, 10.5, 2.247), e.moveTo(10.5, 1.247), e.bezierCurveTo(10.156, 1.247, 9.646, 1.2930000000000001, 9.172, 1.5130000000000001), e.bezierCurveTo(8.976, 1.604, 8, 2.151, 8, 4), e.lineTo(8, 7), e.bezierCurveTo(8, 7.132, 7.836, 7.368, 7.713, 7.415), e.lineTo(1.585, 9.712), e.bezierCurveTo(.682, 10.051, 0, 11.034, 0, 12), e.bezierCurveTo(0, 13.103, .897, 14, 2, 14), e.lineTo(8, 14), e.lineTo(8, 17), e.bezierCurveTo(8, 18.103, 8.897, 19, 10, 19), e.lineTo(11, 19), e.bezierCurveTo(12.103, 19, 13, 18.103, 13, 17), e.lineTo(13, 14), e.lineTo(19, 14), e.bezierCurveTo(20.103, 14, 21, 13.103, 21, 12), e.bezierCurveTo(21, 11.035, 20.318, 10.051, 19.414, 9.712), e.lineTo(13.288, 7.414), e.bezierCurveTo(13.164, 7.368, 13, 7.131, 13, 7), e.lineTo(13, 4), e.bezierCurveTo(13, 2.152, 12.024000000000001, 1.605, 11.828, 1.5139999999999998), e.bezierCurveTo(11.354, 1.293, 10.844, 1.247, 10.5, 1.247), e.lineTo(10.5, 1.247), e.closePath(), e.fill(), e.stroke(), e.restore(), e.restore(), e.restore(), c
    }
}(Gis), Gis.Additional.Icon.router = function (a, b, c) {
    "use strict";
    var d, e;
    return c = c || document.createElement("canvas"), c.width = 21, c.height = 21, Gis.Additional.Icon.fixPositionCanvas(b, 21, c), d = c.getContext("2d"), d.save(), d.translate(0, 0), d.beginPath(), d.moveTo(0, 0), d.lineTo(21, 0), d.lineTo(21, 21), d.lineTo(0, 21), d.closePath(), d.clip(), d.translate(0, 0), d.translate(0, 0), d.scale(1, 1), d.translate(0, 0), d.strokeStyle = "rgba(0, 0, 0, 0)", d.lineCap = "butt", d.lineJoin = "miter", d.miterLimit = 4, d.save(), d.fillStyle = "#ffffff", d.beginPath(), d.moveTo(5, 5), d.lineTo(16, 5), d.quadraticCurveTo(16, 5, 16, 5), d.lineTo(16, 16), d.quadraticCurveTo(16, 16, 16, 16), d.lineTo(5, 16), d.quadraticCurveTo(5, 16, 5, 16), d.lineTo(5, 5), d.quadraticCurveTo(5, 5, 5, 5), d.closePath(), d.fill(), d.stroke(), d.restore(), d.save(), d.save(), d.save(), d.restore(), d.save(), d.restore(), d.restore(), d.save(), e = d.createLinearGradient(8.8887, 4.0547, 12.4372, 18.2501), e.addColorStop(0, a), e.addColorStop(.7333, a), d.fillStyle = e, d.beginPath(), d.moveTo(6, 17.375), d.bezierCurveTo(4.6899999999999995, 17.375, 3.625, 16.31, 3.625, 15), d.lineTo(3.625, 6), d.bezierCurveTo(3.625, 4.69, 4.69, 3.625, 6, 3.625), d.lineTo(15, 3.625), d.bezierCurveTo(16.31, 3.625, 17.375, 4.6899999999999995, 17.375, 6), d.lineTo(17.375, 15), d.bezierCurveTo(17.375, 16.31, 16.31, 17.375, 15, 17.375), d.lineTo(6, 17.375), d.closePath(), d.moveTo(14.856, 15.683), d.lineTo(15.683, 14.856), d.lineTo(13.440999999999999, 13.028), d.lineTo(15.094, 11.375), d.lineTo(11.373999999999999, 11.375), d.lineTo(11.373999999999999, 15.095), d.lineTo(13.027, 13.442), d.lineTo(14.856, 15.683), d.closePath(), d.moveTo(9.095, 15.625), d.lineTo(7.442, 13.972), d.lineTo(9.684000000000001, 12.144), d.lineTo(8.857000000000001, 11.316), d.lineTo(7.029000000000001, 13.559000000000001), d.lineTo(5.376000000000001, 11.906), d.lineTo(5.376000000000001, 15.626000000000001), d.lineTo(9.095, 15.626000000000001), d.closePath(), d.moveTo(12.144, 9.684), d.lineTo(13.972, 7.440999999999999), d.lineTo(15.625, 9.094), d.lineTo(15.625, 5.373999999999999), d.lineTo(11.905, 5.373999999999999), d.lineTo(13.558, 7.026999999999999), d.lineTo(11.315999999999999, 8.854999999999999), d.lineTo(12.144, 9.684), d.closePath(), d.moveTo(9.625, 9.625), d.lineTo(9.625, 5.904999999999999), d.lineTo(7.972, 7.558), d.lineTo(6.144, 5.316), d.lineTo(5.316, 6.143), d.lineTo(7.558, 7.971), d.lineTo(5.905, 9.625), d.lineTo(9.625, 9.625), d.closePath(), d.fill(), d.stroke(), d.restore(), d.save(), d.fillStyle = "#ffffff", d.beginPath(), d.moveTo(15, 4), d.bezierCurveTo(16.1, 4, 17, 4.9, 17, 6), d.lineTo(17, 15), d.bezierCurveTo(17, 16.1, 16.1, 17, 15, 17), d.lineTo(6, 17), d.bezierCurveTo(4.9, 17, 4, 16.1, 4, 15), d.lineTo(4, 6), d.bezierCurveTo(4, 4.9, 4.9, 4, 6, 4), d.lineTo(15, 4), d.moveTo(5, 10), d.lineTo(10, 10), d.lineTo(10, 5), d.lineTo(8, 7), d.lineTo(6.172, 4.757), d.lineTo(4.758, 6.171), d.lineTo(7, 8), d.lineTo(5, 10), d.moveTo(12.172, 10.242), d.lineTo(14, 8), d.lineTo(16, 10), d.lineTo(16, 5), d.lineTo(11, 5), d.lineTo(13, 7), d.lineTo(10.758, 8.828), d.lineTo(12.172, 10.242), d.moveTo(7, 13), d.lineTo(5, 11), d.lineTo(5, 16), d.lineTo(10, 16), d.lineTo(8, 14), d.lineTo(10.242, 12.172), d.lineTo(8.828000000000001, 10.757000000000001), d.lineTo(7, 13), d.moveTo(11, 16), d.lineTo(13, 14), d.lineTo(14.828, 16.242), d.lineTo(16.242, 14.828000000000001), d.lineTo(14, 13), d.lineTo(16, 11), d.lineTo(11, 11), d.lineTo(11, 16), d.moveTo(15, 3.25), d.lineTo(6, 3.25), d.bezierCurveTo(4.483, 3.25, 3.25, 4.483, 3.25, 6), d.lineTo(3.25, 15), d.bezierCurveTo(3.25, 16.517, 4.4830000000000005, 17.75, 6, 17.75), d.lineTo(15, 17.75), d.bezierCurveTo(16.517, 17.75, 17.75, 16.517, 17.75, 15), d.lineTo(17.75, 6), d.bezierCurveTo(17.75, 4.483, 16.517, 3.25, 15, 3.25), d.lineTo(15, 3.25), d.closePath(), d.moveTo(12.811, 5.75), d.lineTo(15.25, 5.75), d.lineTo(15.25, 8.189), d.lineTo(14.53, 7.469), d.lineTo(13.943, 6.882000000000001), d.lineTo(13.53, 6.469), d.lineTo(12.811, 5.75), d.lineTo(12.811, 5.75), d.closePath(), d.moveTo(5.875, 6.115), d.lineTo(6.115, 5.875), d.lineTo(7.175000000000001, 7.175), d.lineTo(5.875, 6.115), d.lineTo(5.875, 6.115), d.closePath(), d.moveTo(8.117, 7.943), d.lineTo(8.53, 7.53), d.lineTo(9.25, 6.8100000000000005), d.lineTo(9.25, 9.25), d.lineTo(6.811, 9.25), d.lineTo(7.531, 8.53), d.lineTo(8.117, 7.943), d.lineTo(8.117, 7.943), d.closePath(), d.moveTo(11.875, 8.884), d.lineTo(13.175, 7.824), d.lineTo(12.115, 9.124), d.lineTo(11.875, 8.884), d.lineTo(11.875, 8.884), d.closePath(), d.moveTo(11.75, 11.75), d.lineTo(14.189, 11.75), d.lineTo(13.469, 12.47), d.lineTo(13.056, 12.883000000000001), d.lineTo(12.469, 13.47), d.lineTo(11.748999999999999, 14.190000000000001), d.lineTo(11.748999999999999, 11.75), d.lineTo(11.75, 11.75), d.closePath(), d.moveTo(7.825, 13.174), d.lineTo(8.885, 11.873999999999999), d.lineTo(9.125, 12.113999999999999), d.lineTo(7.825, 13.174), d.lineTo(7.825, 13.174), d.closePath(), d.moveTo(5.75, 15.25), d.lineTo(5.75, 12.81), d.lineTo(6.47, 13.530000000000001), d.lineTo(6.883, 13.943000000000001), d.lineTo(7.47, 14.53), d.lineTo(8.19, 15.25), d.lineTo(5.75, 15.25), d.lineTo(5.75, 15.25), d.closePath(), d.moveTo(14.885, 15.125), d.lineTo(13.825, 13.825), d.lineTo(15.125, 14.885), d.lineTo(14.885, 15.125), d.lineTo(14.885, 15.125), d.closePath(), d.fill(), d.stroke(), d.restore(), d.restore(), d.restore(), c
}, Gis.Additional.Icon.sensor = function (a, b, c) {
    "use strict";
    var d, e;
    return c = c || document.createElement("canvas"), c.width = 21, c.height = 21, Gis.Additional.Icon.fixPositionCanvas(b, 21, c), d = c.getContext("2d"), d.save(), d.translate(0, 0), d.beginPath(), d.moveTo(0, 0), d.lineTo(21, 0), d.lineTo(21, 21), d.lineTo(0, 21), d.closePath(), d.clip(), d.translate(0, 0), d.translate(0, 0), d.scale(1, 1), d.translate(0, 0), d.strokeStyle = "rgba(0, 0, 0, 0)", d.lineCap = "butt", d.lineJoin = "miter", d.miterLimit = 4, d.save(), d.save(), d.save(), d.restore(), d.save(), d.restore(), d.restore(), d.save(), e = d.createLinearGradient(8.8262, 3.3052, 12.9653, 19.8635), e.addColorStop(0, a), e.addColorStop(.7333, a), d.fillStyle = e, d.beginPath(), d.moveTo(7, 19.375), d.bezierCurveTo(6.242, 19.375, 5.625, 18.758, 5.625, 18), d.lineTo(5.625, 10), d.bezierCurveTo(5.625, 9.242, 6.242, 8.625, 7, 8.625), d.lineTo(14, 8.625), d.bezierCurveTo(14.758, 8.625, 15.375, 9.242, 15.375, 10), d.lineTo(15.375, 18), d.bezierCurveTo(15.375, 18.758, 14.758, 19.375, 14, 19.375), d.lineTo(7, 19.375), d.closePath(), d.moveTo(12.625, 8.375), d.lineTo(12.625, 2), d.bezierCurveTo(12.625, 1.242, 13.242, .625, 14, .625), d.bezierCurveTo(14.758, .625, 15.375, 1.242, 15.375, 2), d.lineTo(15.375, 8.375), d.lineTo(12.625, 8.375), d.closePath(), d.fill(), d.stroke(), d.restore(), d.save(), d.fillStyle = "#ffffff", d.beginPath(), d.moveTo(14, 1), d.bezierCurveTo(14.55, 1, 15, 1.45, 15, 2), d.lineTo(15, 8), d.lineTo(13, 8), d.lineTo(13, 2), d.bezierCurveTo(13, 1.45, 13.45, 1, 14, 1), d.moveTo(14, 9), d.bezierCurveTo(14.55, 9, 15, 9.45, 15, 10), d.lineTo(15, 18), d.bezierCurveTo(15, 18.55, 14.55, 19, 14, 19), d.lineTo(7, 19), d.bezierCurveTo(6.45, 19, 6, 18.55, 6, 18), d.lineTo(6, 10), d.bezierCurveTo(6, 9.45, 6.45, 9, 7, 9), d.lineTo(14, 9), d.moveTo(14, .25), d.bezierCurveTo(13.035, .25, 12.25, 1.0350000000000001, 12.25, 2), d.lineTo(12.25, 8), d.lineTo(12.25, 8.25), d.lineTo(7, 8.25), d.bezierCurveTo(6.035, 8.25, 5.25, 9.035, 5.25, 10), d.lineTo(5.25, 18), d.bezierCurveTo(5.25, 18.965, 6.035, 19.75, 7, 19.75), d.lineTo(14, 19.75), d.bezierCurveTo(14.965, 19.75, 15.75, 18.965, 15.75, 18), d.lineTo(15.75, 10), d.bezierCurveTo(15.75, 9.511, 15.548, 9.068, 15.224, 8.75), d.lineTo(15.75, 8.75), d.lineTo(15.75, 8), d.lineTo(15.75, 2), d.bezierCurveTo(15.75, 1.035, 14.965, .25, 14, .25), d.lineTo(14, .25), d.closePath(), d.fill(), d.stroke(), d.restore(), d.restore(), d.restore(), c
}, function (a) {
    "use strict";
    a.Additional.Icon.simple = function (a, b, c) {
        var d;
        return c = c || document.createElement("canvas"), c.width = b, c.height = b, d = c.getContext("2d"), d.fillStyle = a, d.lineWidth = b / 6, d.beginPath(), d.moveTo(8, 0), Gis.Canvas.lineByPath(d, "2,0 0,0 0,2 0,8 2,8 2,1.914 8,1.914"), d.fill(), d.closePath(), d.beginPath(), d.moveTo(12, 4), Gis.Canvas.lineByPath(d, "6,4 4,4 4,6 4,12 6,12 6,5.914 12,5.914"), d.fill(), d.closePath(), d.rect(8, 8, 4, 4), d.fill(), c
    }
}(Gis), function (a) {
    "use strict";
    a.Additional.Icon["static"] = function (a, b, c) {
        var d, e;
        return c = c || document.createElement("canvas"), c.width = 21, c.height = 21, Gis.Additional.Icon.fixPositionCanvas(b, 21, c), d = c.getContext("2d"), d.save(), d.translate(0, 0), d.beginPath(), d.moveTo(0, 0), d.lineTo(21, 0), d.lineTo(21, 21), d.lineTo(0, 21), d.closePath(), d.clip(), d.translate(0, 0), d.translate(0, 0), d.scale(1, 1), d.translate(0, 0), d.strokeStyle = "rgba(0, 0, 0, 0)", d.lineCap = "butt", d.lineJoin = "miter", d.miterLimit = 4, d.save(), d.save(), d.save(), d.restore(), d.save(), d.restore(), d.restore(), d.save(), e = d.createLinearGradient(9.9453, 3.98, 13.6538, 18.8152), e.addColorStop(0, a), e.addColorStop(.7333, a), d.fillStyle = e, d.beginPath(), d.moveTo(10.5, 19.375), d.bezierCurveTo(9.411, 19.375, 8.525, 18.489, 8.525, 17.4), d.lineTo(8.525, 13.884999999999998), d.lineTo(2.649, 7.541), d.bezierCurveTo(1.911, 6.743, 1.959, 5.4910000000000005, 2.757, 4.75), d.bezierCurveTo(3.122, 4.41, 3.598, 4.223, 4.097, 4.223), d.bezierCurveTo(4.646000000000001, 4.223, 5.175000000000001, 4.454, 5.549, 4.857), d.lineTo(8.618, 8.06), d.lineTo(8.6, 4.602), d.bezierCurveTo(8.6, 3.4930000000000003, 9.434999999999999, 2.625, 10.5, 2.625), d.bezierCurveTo(11.58, 2.625, 12.427, 3.493, 12.427, 4.6), d.lineTo(12.386, 8.055), d.lineTo(15.453999999999999, 4.853999999999999), d.bezierCurveTo(15.822, 4.4559999999999995, 16.351, 4.223999999999999, 16.9, 4.223999999999999), d.bezierCurveTo(17.398999999999997, 4.223999999999999, 17.875999999999998, 4.411, 18.241999999999997, 4.7509999999999994), d.bezierCurveTo(19.040999999999997, 5.491999999999999, 19.089, 6.744, 18.349999999999998, 7.542), d.lineTo(12.473999999999997, 13.887), d.lineTo(12.473999999999997, 17.401), d.bezierCurveTo(12.475, 18.488, 11.589, 19.375, 10.5, 19.375), d.lineTo(10.5, 19.375), d.closePath(), d.fill(), d.stroke(), d.restore(), d.save(), d.fillStyle = "#ffffff", d.beginPath(), d.moveTo(10.5, 3), d.bezierCurveTo(11.385, 3, 12.052, 3.716, 12.052, 4.6), d.lineTo(12, 9), d.lineTo(15.725, 5.1129999999999995), d.bezierCurveTo(16.041, 4.771999999999999, 16.47, 4.598999999999999, 16.901, 4.598999999999999), d.bezierCurveTo(17.29, 4.598999999999999, 17.68, 4.739999999999999, 17.988, 5.025999999999999), d.bezierCurveTo(18.634999999999998, 5.626999999999999, 18.676, 6.638999999999999, 18.076, 7.286999999999999), d.lineTo(12.1, 13.739), d.lineTo(12.1, 17.400000000000002), d.bezierCurveTo(12.1, 18.284000000000002, 11.385, 19.000000000000004, 10.5, 19.000000000000004), d.bezierCurveTo(9.615, 19.000000000000004, 8.9, 18.284000000000002, 8.9, 17.400000000000002), d.lineTo(8.9, 13.738000000000003), d.lineTo(2.925, 7.286), d.bezierCurveTo(2.3249999999999997, 6.638999999999999, 2.3649999999999998, 5.6259999999999994, 3.013, 5.0249999999999995), d.bezierCurveTo(3.319, 4.74, 3.709, 4.599, 4.098, 4.599), d.bezierCurveTo(4.529, 4.599, 4.958, 4.772, 5.276, 5.113), d.lineTo(9, 9), d.lineTo(8.975, 4.6), d.bezierCurveTo(8.975, 3.716, 9.615, 3, 10.5, 3), d.moveTo(10.5, 2.25), d.bezierCurveTo(9.224, 2.25, 8.225, 3.282, 8.225, 4.6), d.lineTo(8.24, 7.122), d.lineTo(5.816, 4.594), d.bezierCurveTo(5.38, 4.124, 4.751, 3.849, 4.098, 3.849), d.bezierCurveTo(3.504, 3.849, 2.937, 4.072, 2.502, 4.476), d.bezierCurveTo(1.553, 5.357, 1.4949999999999999, 6.846, 2.375, 7.795999999999999), d.lineTo(8.15, 14.032), d.lineTo(8.15, 17.4), d.bezierCurveTo(8.15, 18.695999999999998, 9.204, 19.75, 10.5, 19.75), d.bezierCurveTo(11.796, 19.75, 12.85, 18.696, 12.85, 17.4), d.lineTo(12.85, 14.032999999999998), d.lineTo(18.625, 7.795999999999998), d.bezierCurveTo(19.505, 6.845999999999997, 19.447, 5.3569999999999975, 18.497, 4.475999999999997), d.bezierCurveTo(18.061, 4.071999999999997, 17.494, 3.8489999999999975, 16.9, 3.8489999999999975), d.bezierCurveTo(16.247, 3.8489999999999975, 15.617999999999999, 4.123999999999998, 15.172999999999998, 4.603999999999997), d.lineTo(12.772, 7.11), d.lineTo(12.801, 4.609), d.bezierCurveTo(12.802, 3.282, 11.791, 2.25, 10.5, 2.25), d.lineTo(10.5, 2.25), d.closePath(), d.fill(), d.stroke(), d.restore(), d.restore(), d.restore(), c
    }
}(Gis), function (a) {
    "use strict";
    a.Additional.Icon.storm = function (a, b, c, d) {
        var e;
        return c = c || document.createElement("canvas"), c.width = 18, c.height = 18, Gis.Additional.Icon.fixPositionCanvas(b, 18, c), e = c.getContext("2d"), e.save(), e.translate(0, 0), e.beginPath(), e.moveTo(0, 0), e.lineTo(18, 0), e.lineTo(18, 18), e.lineTo(0, 18), e.closePath(), e.clip(), e.translate(0, 0), e.translate(0, 0), e.scale(1, 1), e.translate(0, 0), e.strokeStyle = "rgba(0, 0, 0, 0)", e.lineCap = "butt", e.lineJoin = "miter", e.miterLimit = 4, e.save(), e.save(), e.fillStyle = a, e.beginPath(), e.moveTo(2, 17.5), e.bezierCurveTo(1.173, 17.5, .5, 16.826999999999998, .5, 16), e.lineTo(.5, 2), e.bezierCurveTo(.5, 1.173, 1.173, .5, 2, .5), e.lineTo(16, .5), e.bezierCurveTo(16.826999999999998, .5, 17.5, 1.173, 17.5, 2), e.lineTo(17.5, 16), e.bezierCurveTo(17.5, 16.826999999999998, 16.826999999999998, 17.5, 16, 17.5), e.lineTo(2, 17.5), e.closePath(), e.fill(), e.stroke(), e.restore(), e.save(), d = d || "#ffffff", e.fillStyle = d, e.beginPath(), e.moveTo(16, 1), e.bezierCurveTo(16.55, 1, 17, 1.45, 17, 2), e.lineTo(17, 16), e.bezierCurveTo(17, 16.55, 16.55, 17, 16, 17), e.lineTo(2, 17), e.bezierCurveTo(1.45, 17, 1, 16.55, 1, 16), e.lineTo(1, 2), e.bezierCurveTo(1, 1.45, 1.45, 1, 2, 1), e.lineTo(16, 1), e.moveTo(16, 0), e.lineTo(2, 0), e.bezierCurveTo(.896, 0, 0, .896, 0, 2), e.lineTo(0, 16), e.bezierCurveTo(0, 17.104, .896, 18, 2, 18), e.lineTo(16, 18), e.bezierCurveTo(17.104, 18, 18, 17.104, 18, 16), e.lineTo(18, 2), e.bezierCurveTo(18, .896, 17.104, 0, 16, 0), e.lineTo(16, 0), e.closePath(), e.fill(), e.stroke(), e.restore(), e.restore(), e.save(), e.fillStyle = d, e.beginPath(), e.moveTo(8.028, 5.326), e.lineTo(7.028, 10.326), e.lineTo(9.028, 10.326), e.lineTo(8.028, 14.326), e.lineTo(12.028, 9.326), e.lineTo(10.028, 8.326), e.lineTo(11.028, 5.326), e.lineTo(8.028, 5.326), e.closePath(), e.fill(), e.stroke(), e.restore(), e.save(), e.fillStyle = d, e.beginPath(), e.moveTo(13.185, 3.374), e.bezierCurveTo(11.888, 3.374, 11.388, 3.577, 10.664000000000001, 4.178), e.bezierCurveTo(10.302000000000001, 3.6639999999999997, 10.05, 3.356, 9.372000000000002, 3.356), e.bezierCurveTo(8.372000000000002, 3.356, 8.242, 4.252, 8.030000000000001, 4.327999999999999), e.bezierCurveTo(8.093000000000002, 3.3759999999999994, 7.546000000000001, 2.3279999999999994, 6.030000000000001, 2.3279999999999994), e.bezierCurveTo(4.373000000000001, 2.3279999999999994, 3.030000000000001, 3.6709999999999994, 3.030000000000001, 5.327999999999999), e.bezierCurveTo(3.030000000000001, 7.968999999999999, 4.070000000000001, 9.056999999999999, 5.449000000000002, 9.28), e.lineTo(7.030000000000001, 5.327999999999999), e.lineTo(12.030000000000001, 5.327999999999999), e.lineTo(12.030000000000001, 8.328), e.lineTo(12.886000000000001, 9.184), e.bezierCurveTo(14.001000000000001, 8.844, 14.972000000000001, 8.58, 14.972000000000001, 6.587999999999999), e.bezierCurveTo(14.972, 4.605, 14.564, 3.374, 13.185, 3.374), e.closePath(), e.fill(), e.stroke(), e.restore(), e.restore(), c
    }
}(Gis), function (a) {
    "use strict";
    a.Additional.Icon.target = function (a, b, c, d) {
        var e;
        return c = c || document.createElement("canvas"), c.width = 18, c.height = 18, Gis.Additional.Icon.fixPositionCanvas(b, 18, c), e = c.getContext("2d"), e.save(), e.translate(0, 0), e.beginPath(), e.moveTo(0, 0), e.lineTo(18, 0), e.lineTo(18, 18), e.lineTo(0, 18), e.closePath(), e.clip(), e.translate(0, 0), e.translate(0, 0), e.scale(1, 1), e.translate(0, 0), d = d || "rgba(0, 0, 0, 0)", e.strokeStyle = d, e.lineCap = "butt", e.lineJoin = "miter", e.miterLimit = 4, e.save(), e.save(), e.fillStyle = a, e.beginPath(), e.moveTo(9, 1.8), e.bezierCurveTo(12.971, 1.8, 16.2, 5.029, 16.2, 9), e.bezierCurveTo(16.2, 12.972, 12.971, 16.198999999999998, 9, 16.198999999999998), e.bezierCurveTo(5.029, 16.198999999999998, 1.8, 12.972, 1.8, 9), e.bezierCurveTo(1.8, 5.029, 5.029, 1.8, 9, 1.8), e.moveTo(9, 0), e.bezierCurveTo(4.029, 0, 0, 4.03, 0, 9), e.bezierCurveTo(0, 13.969999999999999, 4.029, 18, 9, 18), e.bezierCurveTo(13.971, 18, 18, 13.969999999999999, 18, 9), e.bezierCurveTo(18, 4.030000000000001, 13.971, 0, 9, 0), e.lineTo(9, 0), e.closePath(), e.fill(), e.stroke(), e.restore(), e.restore(), e.save(), e.fillStyle = d, e.strokeStyle = a, e.beginPath(), e.moveTo(18, 0), e.lineTo(10.8, 7.2), e.fill(), e.stroke(), e.restore(), e.save(), e.fillStyle = d, e.strokeStyle = a, e.beginPath(), e.moveTo(18, 18), e.lineTo(10.8, 10.8), e.fill(), e.stroke(), e.restore(), e.save(), e.fillStyle = d, e.strokeStyle = a, e.beginPath(), e.moveTo(0, 18), e.lineTo(7.2, 10.8), e.fill(), e.stroke(), e.restore(), e.save(), e.fillStyle = d, e.strokeStyle = a, e.beginPath(), e.moveTo(0, 0), e.lineTo(7.2, 7.2), e.fill(), e.stroke(), e.restore(), e.restore(), c
    }
}(Gis), function (a) {
    "use strict";
    a.Additional.Icon.triangle = function (b, c, d) {
        var e, f = c / 8;
        return d = d || document.createElement("canvas"), d.width = c, d.height = c, e = d.getContext("2d"), e.fillStyle = b, e.beginPath(), e.moveTo(f, c - f), a.Canvas.lineByPath(e, c / 2 + "," + f + " " + (c - f) + "," + (c - f)), e.fill(), e.closePath(), e.lineWidth = f, e.strokeStyle = "white", e.stroke(), d
    }
}(Gis), Gis.Additional.Icon.TYPE.TRIANGLE = "triangle", function (a) {
    "use strict";
    a.Bounds = function (a, b) {
        if (a)for (var c = b ? [a, b] : a, d = 0, e = c.length; e > d; d++)this.extend(c[d])
    }, a.Bounds.prototype = {extend: function (b) {
        return b = a.point(b), this.min || this.max ? (this.min.x = Math.min(b.x, this.min.x), this.max.x = Math.max(b.x, this.max.x), this.min.y = Math.min(b.y, this.min.y), this.max.y = Math.max(b.y, this.max.y)) : (this.min = b.clone(), this.max = b.clone()), this
    }, getCenter: function (b) {
        return new a.Point((this.min.x + this.max.x) / 2, (this.min.y + this.max.y) / 2, b)
    }, getBottomLeft: function () {
        return new a.Point(this.min.x, this.max.y)
    }, getTopRight: function () {
        return new a.Point(this.max.x, this.min.y)
    }, getSize: function () {
        return this.max.subtract(this.min)
    }, contains: function (b) {
        var c, d;
        return b = "number" == typeof b[0] || b instanceof a.Point ? a.point(b) : a.bounds(b), b instanceof a.Bounds ? (c = b.min, d = b.max) : c = d = b, c.x >= this.min.x && d.x <= this.max.x && c.y >= this.min.y && d.y <= this.max.y
    }, intersects: function (b) {
        b = a.bounds(b);
        var c = this.min, d = this.max, e = b.min, f = b.max, g = f.x >= c.x && e.x <= d.x, h = f.y >= c.y && e.y <= d.y;
        return g && h
    }, isValid: function () {
        return!(!this.min || !this.max)
    }}, a.bounds = function (b, c) {
        return!b || b instanceof a.Bounds ? b : new a.Bounds(b, c)
    }
}(Gis), Gis.CustomSRS = Gis.BaseClass.extend({options: {code: void 0, proj4def: void 0, projectedBounds: void 0, options: void 0}, processTMS: function () {
    this.options.projectedBounds && this.options.projectedBounds.indexOf("merc") >= 0
}, initialize: function (a, b, c, d, e) {
    this.options.code = a, this.options.proj4def = b, this.options.projectedBounds = c, this.options.options = d, Gis.BaseClass.prototype.initialize.call(this), e && this.processTMS()
}, getCode: function () {
    return this.options.code
}, getProj4def: function () {
    return this.options.proj4def
}, getProjectedBounds: function () {
    return this.options.projectedBounds
}, getOptions: function () {
    return this.options.options
}}), Gis.customSRS = function (a, b, c, d) {
    return new Gis.CustomSRS(a, b, c, d)
}, Gis.LatLng = function (a, b) {
    var c, d;
    if (c = parseFloat(a), d = parseFloat(b), isNaN(c) || isNaN(d))throw new Error("Invalid LatLng object: (" + a + ", " + b + ")");
    this.lat = c, this.lng = d
}, Gis.Util.extend(Gis.LatLng, {DEG_TO_RAD: Math.PI / 180, RAD_TO_DEG: 180 / Math.PI, MAX_MARGIN: 1e-8}), Gis.LatLng.longitudeDifference = function (a, b) {
    var c = Gis.Util.isNumeric(a.lng) ? a.lng : a[1], d = Gis.Util.isNumeric(b.lng) ? b.lng : b[1];
    return Math.max(c, d) - Math.min(c, d)
}, Gis.LatLng.prototype = {equals: function (a) {
    if (!a)return!1;
    a = Gis.latLng(a);
    var b = Math.max(Math.abs(this.lat - a.lat), Math.abs(this.lng - a.lng));
    return b <= Gis.LatLng.MAX_MARGIN
}, toString: function (a) {
    return"LatLng(" + Gis.Util.formatNum(this.lat, a) + ", " + Gis.Util.formatNum(this.lng, a) + ")"
}, abs: function () {
    return Gis.latLng(Math.abs(this.lat), Math.abs(this.lng))
}, distanceTo: function (a, b) {
    a = Gis.latLng(a);
    var c = 6378137 + (b || 0), d = Gis.Util.gradToRad(a.lat - this.lat), e = Gis.Util.gradToRad(a.lng - this.lng), f = Gis.Util.gradToRad(this.lat), g = Gis.Util.gradToRad(a.lat), h = Math.sin(d / 2), i = Math.sin(e / 2), j = h * h + i * i * Math.cos(f) * Math.cos(g);
    return 2 * c * Math.atan2(Math.sqrt(j), Math.sqrt(1 - j))
}, wrap: function (a, b) {
    var c = this.lng;
    return a = a || -180, b = b || 180, c = (c + b) % (b - a) + (a > c || c === b ? b : a), new Gis.LatLng(this.lat, c)
}}, Gis.latLng = function (a, b) {
    return a instanceof Gis.LatLng ? a : a instanceof Array ? new Gis.LatLng(a[0], a[1]) : "object" == typeof a && a.hasOwnProperty("lat") && (a.hasOwnProperty("lng") || a.hasOwnProperty("lon")) ? new Gis.LatLng(a.lat, a.hasOwnProperty("lng") ? a.lng : a.lon) : isNaN(a) ? a : isNaN(a) ? a : new Gis.LatLng(a, b)
}, function (a) {
    "use strict";
    a.LatLngBounds = function (a, b) {
        var c, d, e;
        if (a)for (e = b ? [a, b] : a, c = 0, d = e.length; d > c; c += 1)this.extend(e[c])
    }, a.LatLngBounds.prototype = {extend: function (b) {
        return b = "number" == typeof b[0] || "string" == typeof b[0] || b.distanceTo ? a.latLng(b) : a.latLngBounds(b), b.distanceTo ? this._southWest || this._northEast ? (this._southWest.lat = Math.min(b.lat, this._southWest.lat), this._southWest.lng = Math.min(b.lng, this._southWest.lng), this._northEast.lat = Math.max(b.lat, this._northEast.lat), this._northEast.lng = Math.max(b.lng, this._northEast.lng)) : (this._southWest = new a.LatLng(b.lat, b.lng), this._northEast = new a.LatLng(b.lat, b.lng)) : b.getNorthEast && (this.extend(b._southWest), this.extend(b._northEast)), this
    }, pad: function (b) {
        var c = this._southWest, d = this._northEast, e = Math.abs(c.lat - d.lat) * b, f = Math.abs(c.lng - d.lng) * b;
        return new a.LatLngBounds(new a.LatLng(c.lat - e, c.lng - f), new a.LatLng(d.lat + e, d.lng + f))
    }, getCenter: function () {
        return new a.LatLng((this._southWest.lat + this._northEast.lat) / 2, (this._southWest.lng + this._northEast.lng) / 2)
    }, getSouthWest: function () {
        return this._southWest
    }, getNorthEast: function () {
        return this._northEast
    }, getNorthWest: function () {
        return new a.LatLng(this._northEast.lat, this._southWest.lng)
    }, getSouthEast: function () {
        return new a.LatLng(this._southWest.lat, this._northEast.lng)
    }, contains: function (b) {
        b = "number" == typeof b[0] || b instanceof a.LatLng ? a.latLng(b) : a.latLngBounds(b);
        var c, d, e = this._southWest, f = this._northEast;
        return b instanceof a.LatLngBounds ? (c = b.getSouthWest(), d = b.getNorthEast()) : c = d = b, c.lat >= e.lat && d.lat <= f.lat && c.lng >= e.lng && d.lng <= f.lng
    }, intersects: function (b) {
        b = a.latLngBounds(b);
        var c = this._southWest, d = this._northEast, e = b.getSouthWest(), f = b.getNorthEast(), g = f.lat >= c.lat && e.lat <= d.lat, h = f.lng >= c.lng && e.lng <= d.lng;
        return g && h
    }, toBBoxString: function () {
        var a = this._southWest, b = this._northEast;
        return[a.lng, a.lat, b.lng, b.lat].join(",")
    }, equals: function (b) {
        return b ? (b = a.latLngBounds(b), this._southWest.equals(b.getSouthWest()) && this._northEast.equals(b.getNorthEast())) : !1
    }, isValid: function () {
        return!(!this._southWest || !this._northEast)
    }}, a.latLngBounds = function (b, c) {
        return!b || b instanceof a.LatLngBounds ? b : new a.LatLngBounds(b, c)
    }
}(Gis), function (a) {
    "use strict";
    var proj4 = window.proj4; //remove this
    a.Util.extend(proj4.defs, {"EPSG:32629": "+proj=utm +zone=29 +ellps=WGS84 +datum=WGS84 +units=m +no_defs +over", "EPSG:4326": "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +over", "EPSG:2399": "+proj=tmerc +lat_0=0 +lon_0=15 +k=1 +x_0=5500000 +y_0=0 +ellps=krass +towgs84=24,-123,-94,0.02,-0.25,-0.13,1.1 +units=m +no_defs +over", "EPSG:26916": "+proj=utm +zone=16 +ellps=GRS80 +datum=NAD83 +units=m +no_defs +over", "EPSG:3857": "+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378137 +b=6378137 +towgs84=0,0,0,0,0,0,0 +units=m +nadgrids=@null +wktext +no_defs +over", "EPSG:3785": "+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378137 +b=6378137 +towgs84=0,0,0,0,0,0,0 +units=m +nadgrids=@null +wktext +no_defs +over", GOOGLE: "+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs +over", "EPSG:3395": "+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs +over +lon_wrap=360", "EPSG:41001": "+title=simple mercator EPSG:41001 +proj=merc +lat_ts=0 +lon_0=0 +k=1.000000 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +over"});
    var b = {};
    a.ProjectionDatuums = {getDatum: function (a) {
        return a = a && a.replace(":", ""), a && b[a.toUpperCase()]
    }}, proj4.defs["EPSG:900913"] = proj4.defs.GOOGLE;
    var c, d;
    for (d = 0; 60 >= d; d += 1)c = 10 > d ? "0" + d : d, proj4.defs["EPSG:284" + c] = "+proj=tmerc +lat_0=0 +lon_0=" + (6 * d - 3) + " +k=1 +x_0=" + d + "500000 +y_0=0 +ellps=krass +towgs84=24,-123,-94,-0.000000096963,0.000001212034,0.000000630258,1.0 +units=m +no_defs +over";
    for (var e in proj4.defs)proj4.defs.hasOwnProperty(e) && (b[e.replace(":", "")] = proj4.defs[e]);
    for (d = 0; 60 >= d; d += 1)c = 10 > d ? "0" + d : d, proj4.defs("EPSG:284" + c, proj4.defs["EPSG:284" + c])
}(Gis), function (a) {
    "use strict";
    var b = "LAYER_STATE", c = "key_additional", d = "key_custom";
    Gis.TmsLayer = a.BaseClass.extend({isMapLayer: !0, opacity: 1, options: {title: null, types: void 0, autoRefresh: void 0, type: void 0, key: void 0, url: void 0, maxZoom: void 0, minZoom: void 0, crs: void 0, dimension: void 0, customLayers: void 0, mapType: "map", mapData: {}}, getOpacity: function () {
        return this.opacity
    }, setOpacity: function (a) {
        this.opacity = a
    }, isLoaded: function () {
        return!0
    }, isLocal: function () {
        var a, b;
        if (Gis.Util.isArray(this.options.url)) {
            for (a = 0, b = this.options.url.length; b > a; a += 1)if (this._isUrlLocal(this.options.url[a]))return!0;
            return!1
        }
        return this._isUrlLocal(this.options.url)
    }, isLocalServer: function () {
        return this.isLocal()
    }, _isUrlLocal: function (a) {
        return a && (a.indexOf("localhost") >= 0 || a.indexOf("127.0.0.1") >= 0)
    }, initialize: function (b) {
        b.crs || this.options.crs || (b.crs = Gis.customSRS("EPSG:3857")), a.BaseClass.prototype.initialize.call(this, b), this.recover()
    }, getOptions: function () {
        var b = a.Util.extend({}, this.options);
        return delete b.url, b
    }, getType: function () {
        return this.options.type
    }, getMapType: function () {
        return this.options.types[this.options.mapType]
    }, getTitle: function () {
        return this.options.title || this.getKey()
    }, getTitleWidth: function () {
        return this.options.dimension && this.options.dimension.x || 256
    }, getTitleHeight: function () {
        return this.options.dimension && this.options.dimension.y || 256
    }, getURL: function () {
        return this.options.url
    }, getKey: function () {
        return this.options.key || this.options.url
    }, getCrs: function () {
        return this.options.crs
    }, getMaxZoom: function () {
        return this.options.maxZoom
    }, getMinZoom: function () {
        return this.options.minZoom
    }, isAutoRefresh: function () {
        return Gis.Util.isNumeric(this.options.autoRefresh)
    }, _getSaveKey: function () {
        return b + this.getKey()
    }, save: function () {
        Gis.Preferences.setPreferenceData(this._getSaveKey() + c, this._additionalLayers), Gis.Preferences.setPreferenceData(this._getSaveKey() + d, this._customLayers)
    }, recover: function () {
        this._additionalLayers = Gis.Preferences.getPreferenceData(this._getSaveKey() + c), this._customLayers = Gis.Preferences.getPreferenceData(this._getSaveKey() + d)
    }, setAdditionalLayers: function (a) {
        this._additionalLayers = a && a.slice(), this.save()
    }, getAdditionalLayers: function () {
        return this._additionalLayers && this._additionalLayers.slice()
    }, getAdditionalLayerInfo: function (a) {
        var b, c = 0, d = Gis.Util.isString(a) ? a : a.getKey ? a.getKey() : a.key;
        if (this._additionalLayers)for (b = this._additionalLayers.length; b > c; c += 1)if (this._additionalLayers[c].key === d)return Gis.Util.extend({}, this._additionalLayers[c])
    }, getCustomLayers: function () {
        return this.options.customLayers && this.options.customLayers.slice()
    }, setActiveCustomLayers: function (a) {
        this._customLayers = Gis.Util.isArray(a) ? a.slice() : void 0, this.save()
    }, getActiveCustomLayers: function () {
        return this._customLayers && this._customLayers.slice()
    }, isCustomLayerActive: function (a) {
        if (!this._customLayers || !this._customLayers.length)return!1;
        var b, c, d, e;
        if (Gis.Util.isNumeric(a) ? b = a : Gis.Util.isNumeric(a.index) && (b = a.index), Gis.Util.isDefine(b)) {
            if (c = this._customLayers[b], c === b)return!0;
            for (d = 0, e = this._customLayers.length; e > d; d += 1)if (c = this._customLayers[d], c === b)return!0
        }
    }, isAllCustomLayersSelected: function () {
        if (!Gis.Util.isArray(this._customLayers))return!0;
        for (var a = this.options.customLayers, b = 0, c = a.length; c > b; b += 1)if (!this.isCustomLayerActive(a[b].index))return!1;
        return!0
    }, getActiveCustomLayersMask: function () {
        var a, b, c, d;
        if (!this.isAllCustomLayersSelected()) {
            for (d = new BitSet(256), a = 0, b = this._customLayers.length; b > a; a += 1)d.set(this._customLayers[a], 1);
            return c = d[0].toString(16), "0x" + c
        }
        return""
    }}), Gis.TmsLayer._isTemplate = function (a) {
        return/\{\w\}/g.test(a)
    }, Gis.tmsLayer = function (b) {
        return new a.TmsLayer(b)
    }
}(Gis), function (a) {
    "use strict";
    var b = Gis.TmsLayer.extend({_title: "Bing", options: {url: "bing", title: "Bing."}, initialize: function (b, c) {
        return a.TmsLayer.prototype.initialize.call(this, c), this._key = b || Gis.config("tiles.bingKey"), this
    }, getApiKey: function () {
        return this._key
    }}), c = "bing", d = "bingSat", e = "bingHyb";
    Gis.TmsLayer[c] = function (d, e) {
        return new b(d, a.Util.extend(e || {}, {type: c, types: {map: "Road", terrain: "Aerial", hybrid: "AerialWithLabels"}, maxZoom: 18, minZoom: 0}))
    }, Gis.TmsLayer[d] = function (a, b) {
        return Gis.TmsLayer.bing(a, Gis.Util.extend(b || {}, {mapType: "terrain", title: "Bing.A", type: d, url: d}))
    }, Gis.TmsLayer[e] = function (a, b) {
        return Gis.TmsLayer.bing(a, Gis.Util.extend(b || {}, {mapType: "hybrid", title: "Bing.", type: e, url: e}))
    }
}(Gis), function (a) {
    "use strict";
    var b = Gis.TmsLayer.extend({_title: "Cloudmade", options: {url: "cloudmade", title: "Cloudmade"}, initialize: function (b, c) {
        if (b)return a.TmsLayer.prototype.initialize.call(this, c), this._key = b, this;
        throw new Error("key needed")
    }, getKey: function () {
        return this._key
    }});
    Gis.TmsLayer.cloudmade = function (c, d) {
        return new b(c, a.Util.extend(d || {}, {type: "cloudmade"}))
    }
}(Gis), function (a) {
    "use strict";
    var b = Gis.TmsLayer.extend({options: {url: "google", title: "Google."}}), c = "google", d = "googleSat", e = "googleHyb";
    Gis.TmsLayer[c] = function (d) {
        return new b(a.Util.extend(d || {}, {type: c, types: {map: "ROADMAP", terrain: "SATELLITE", hybrid: "HYBRID"}, maxZoom: 18, minZoom: 0}))
    }, Gis.TmsLayer[d] = function (b) {
        return a.TmsLayer.google(Gis.Util.extend(b || {}, {mapType: "terrain", title: "Google.", type: d, url: d}))
    }, Gis.TmsLayer[e] = function (b) {
        return a.TmsLayer.google(Gis.Util.extend(b || {}, {mapType: "hybrid", title: "Google.", type: e, url: e}))
    }
}(Gis), function () {
    "use strict";
    var a = Gis.customSRS("EPSG:3857"), b = "tilesaved";
    Gis.LocalCache = Gis.TmsLayer.extend({_ajaxRequest: null, _fileExt: null, _state: "prepare", local: !0, options: {title: null, type: "local", key: void 0, url: void 0, crs: void 0, mapType: "map", mapData: {}}, initialize: function (a, b) {
        this._url = a, this.options.key = a, Gis.TmsLayer.prototype.initialize.call(this, Gis.Util.extend({url: a}, b))
    }, isLocal: function () {
        return!0
    }, _getConfigUrl: function () {
        return Gis.Util.lastTrim(this._url, "/") + "/" + Gis.config("tiles.cacheConfigFile", "tmc_map_config.js")
    }, getTitle: function () {
        return this.options.title || this._generateAutoTitle() || Gis.TmsLayer.prototype.getTitle.call(this)
    }, load: function () {
        if ("loading" === this._state)return this;
        var a = this;
        this.fire("startloadconfig");
        try {
            requirejs([this._getConfigUrl()], function (b) {
                a._key = a.options.key, a.fire("loadconfig", {loaded: !0, target: a}), a._load(b)
            }, function () {
                a._state = "error", a.fire("loadconfig", {loaded: !1, target: a}), a._load()
            })
        } catch (b) {
            Gis.Logger.log("Error", b.message, b.stack)
        }
    }, _generateAutoTitle: function () {
        var a, b = this._url;
        if (!b)throw new Error(" url");
        return b.trim(), b = Gis.Util.lastTrim(b, "/"), a = b.split("/"), a[a.length - 1]
    }, _fillConfig: function (b) {
        var c, d, e;
        b ? (e = b.Title || b.TITLE || b.title, d = b.SRS || b.srs || b.Srs, c = b.ImageType || b.IMAGETYPE || b.imagetype || b.Imagetype || b.imageType, this.options.title = e ? e : this._generateAutoTitle(), this.options.crs = d ? Gis.customSRS(d) : a, this._fileExt = c ? c : Gis.config("tiles.forceCacheExtension")) : (this.options.title = this._generateAutoTitle(), this.options.crs = a, this._fileExt = Gis.config("tiles.forceCacheExtension"))
    }, _generateUrl: function () {
        var a, b = this._fileExt || this._getSavedUrl() || "?";
        a = Gis.Util.lastTrim(this._url, "/") + "/z{z}/{y}/{x}." + b, this.options.url = a
    }, _load: function (a) {
        if (!Gis.Util.isDefine(a) && !Gis.config("tiles.workWithoutCacheConfig"))throw this._isCache = !1, this._state = "error", this.fire("error"), new Error("    ");
        this._isCache = !0, this._fillConfig(a), this._generateUrl(), this._state = "loaded", this.fire("partialloaded", {map: this}), this.fire("load")
    }, isReady: function () {
        return"loaded" === this._state
    }, _localStorageKey: function () {
        return b + "." + this._url
    }, _getSavedUrl: function () {
        return Gis.Preferences.getPreferenceData(this._localStorageKey())
    }, saveIsLocal: function (a) {
        Gis.Preferences.setPreferenceData(this._localStorageKey(), a)
    }})
}(this), function (a) {
    "use strict";
    var b = Gis.TmsLayer.extend({options: {url: "osm", title: "OpenStreetMap"}});
    Gis.TmsLayer.osm = function (c) {
        return new b(a.Util.extend(c || {}, {type: "osm", types: {map: "ROADMAP", terrain: "SATELLITE"}, maxZoom: 18, minZoom: 0}))
    }
}(Gis), function (a) {
    "use strict";
    var b = Gis.TmsLayer.extend({options: {url: "yandex", title: "ndex.", crs: Gis.customSRS("EPSG:3395")}}), c = "yandex", d = "yandexSat", e = "yandexHyb";
    Gis.TmsLayer[c] = function (d) {
        return new b(a.Util.extend(d || {}, {type: c, types: {map: "map", terrain: "satellite", hybrid: "hybrid"}, maxZoom: 18, minZoom: 0}))
    }, Gis.TmsLayer[d] = function (b) {
        return a.TmsLayer.yandex(Gis.Util.extend(b || {}, {mapType: "terrain", title: "ndex.", type: d, url: d}))
    }, Gis.TmsLayer[e] = function (b) {
        return a.TmsLayer.yandex(Gis.Util.extend(b || {}, {mapType: "hybrid", title: "ndex.", type: e, url: e}))
    }
}(Gis), function () {
    "use strict";
    function a(a) {
        var b, c, d, e = a.querySelectorAll("CustomLayer");
        if (e && e.length)for (b = [], c = 0, d = e.length; d > c; c += 1)b.push({index: parseInt(e[c].getAttribute("index"), 10), name: e[c].getAttribute("name")});
        return b
    }

    Gis.TileMapService = Gis.BaseClass.extend({_type: "tilemapservice", _maps: null, _state: "prepare", _mapCountToLoad: 0, _profileData: {"global-geodetic": {SRS: "EPSG:4326", origin: [-180, -90], boundingBox: [-180, -90, 180, 90], getUpp: function (a) {
        return.703125 / Math.pow(2, a)
    }}, "global-mercator": {SRS: "EPSG:41001", origin: [-20037508.34, -20037508.34], getUpp: function (a) {
        return 78271.516 / Math.pow(2, a)
    }, boundingBox: [-20037508.34, -20037508.34, 20037508.34, 20037508.34]}, none: {getUpp: function () {
        return null
    }}, local: {getUpp: function (a) {
        return Math.pow(2, a)
    }}}, _mapServicesToLoad: 0, options: {url: null}, getProfileParam: function (a, b) {
        return this._profileData[a] && this._profileData[a][b]
    }, getType: function () {
        return this._type
    }, getURL: function () {
        return this.options.url
    }, getBaseUrl: function (a) {
        if (this.keyUrl && this.keyUrl[a])return this.keyUrl[a];
        var b = this.options.url.replace("root.xml", "/");
        return b.lastIndexOf("/") < b.length - 1 && (b += "/"), a && (b += a), b
    }, getKey: function () {
        return this.options.url
    }, getTitle: function () {
        return this.options.title || this.getKey()
    }, isLocalServer: function () {
        return this.options.url.indexOf("localhost") >= 0 || this.options.url.indexOf("127.0.0.1") >= 0
    }, getMapIndex: function (a) {
        var b, c;
        if (this._maps.hasOwnProperty(a))return a;
        for (b = 0, c = this._maps.length; c > b; b += 1) {
            var d = void 0 != this._maps[b].key ? this._maps[b].key : this._maps[b].title;
            if (d === a)return b
        }
    }, getCrs: function (a) {
        if (a = a || 0, a = this.getMapIndex(a), Gis.Util.isNumeric(a)) {
            if (this._crs[a]) {
                var b = this._crs[a].setData({projectedBounds: this._maps[a].boundingBox});
                b && (this._crs[a] = Gis.customSRS(this._maps[a].srs, Gis.ProjectionDatuums.getDatum(this._maps[a].srs), this._maps[a].boundingBox, {origin: this._maps[a].origin, resolutions: this._maps[a].resolutions}, !0))
            } else this._crs[a] = this._crs[a] || Gis.customSRS(this._maps[a].srs, Gis.ProjectionDatuums.getDatum(this._maps[a].srs), this._maps[a].boundingBox, {origin: this._maps[a].origin, resolutions: this._maps[a].resolutions}, !0);
            return this._crs[a]
        }
    }, onError: function () {
        this._state = "error"
    }, initialize: function () {
        this.on("error", this.onError, this), Gis.BaseClass.prototype.initialize.apply(this, arguments)
    }, load: function (a) {
        var b = this;
        this._tileServers = [], this._crs = [], this._maps = [], a = a || this.options.url;
        try {
            $.ajax({url: a, dataType: "xml", crossDomain: Gis.config("tiles.loadDataOtherOrigin"), success: function () {
                b._isTms = !0, b._loadTileMapService(a), b.fire("istms", {tms: !0, target: b})
            }, error: function () {
                if (-1 === a.indexOf("root.xml")) {
                    var c = b.options.url;
                    c.lastIndexOf("/") < c.length - 1 && (c += "/"), c += "root.xml", b.load(c)
                } else this._state = "error", b._isTms = !1, b.fire("istms", {tms: !1, target: b})
            }})
        } catch (c) {
            Gis.Logger.log("Error", c.message, c.stack)
        }
    }, checkIfTMS: function (a) {
        var b = this;
        return b.hasOwnProperty("_isTms") ? (b.fire("istms", {tms: b._isTms, target: b}), this) : (this.load(a), this)
    }, _loadTileMapService: function (a) {
        a = a || this.options.url, this._state = "loading";
        var b = this;
        this.ajax || (this.ajax = $.ajax({url: a, dataType: "xml", crossDomain: Gis.config("tiles.loadDataOtherOrigin"), success: function (c) {
            Gis.Logger.log("TMS loaded", a), b._parseTMS(c), b.fire("tmsloaded")
        }, error: function (c) {
            this._state = "error", Gis.Logger.log("Can not load tms", a, c), b.fire("error", {type: "tmsloaderror"})
        }, complete: function () {
            b.ajax = null
        }}))
    }, setUrl: function (a, b) {
        this.keyUrl || (this.keyUrl = {}), this.keyUrl[a] = b
    }, parseTileMaps: function (a) {
        var b, c, d, e, f, g, h;
        for (d = a.querySelectorAll("TileMap"), this._mapCountToLoad = d.length, b = 0, c = d.length; c > b; b += 1)f = d[b].getAttribute("href"), e = Gis.Util.lastTrim(f, "/"), g = e.split("/"), h = "map.xml" === g[g.length - 1] ? 1 : 0, this.setUrl(g[g.length - h - 1], f), this._loadTileMapData(g[g.length - h - 1], g.length > 1)
    }, _loadTileMaps: function (a) {
        var b = this;
        this.ajax = $.ajax({url: a, dataType: "xml", crossDomain: Gis.config("tiles.loadDataOtherOrigin"), success: function (c) {
            b._mapServicesToLoad -= 1, b.ajax = null, Gis.Logger.log("TileMaps loaded", a), b.parseTileMaps(c), b.fire("tilemapsloaded")
        }, error: function (c) {
            this._state = "error", Gis.Logger.log("Can not load TileMaps", a, c), b.fire("error", {type: "tilemapserror"}), b._mapServicesToLoad -= 1, b.ajax = null
        }})
    }, loadTileData: function (a) {
        this._mapCountToLoad += 1, this._setLoading(), this._loadTileMapData(a, !0)
    }, _loadTileMapData: function (a, b, c) {
        var d = this, e = b ? this.getBaseUrl(a + (c ? "/map.xml" : "")) : a;
        this.ajax = $.ajax({url: e, dataType: "xml", crossDomain: Gis.config("tiles.loadDataOtherOrigin"), success: function (b) {
            d._mapCountToLoad -= 1, d.ajax = null, Gis.Logger.log("TileMap data loaded", e), d.parseTileMapData(b, a), d.fire("tilemapdataloaded", {map: Gis.TileMapService.encodeKey(d.options.url, a)})
        }, error: function (f) {
            return Gis.Logger.log("Can not load TileMap data", e, f), c ? (d.fire("error", {type: "tilemapdataerror"}), d._mapCountToLoad -= 1, d.ajax = null, void d.checkIfLoaded()) : void d._loadTileMapData(a, b, !0)
        }})
    }, _parseTMS: function (a) {
        var b, c, d;
        for (d = a.querySelectorAll("TileMapService"), this._mapServicesToLoad += d.length, b = 0, c = d.length; c > b; b += 1)this._loadTileMaps(d[b].getAttribute("href"))
    }, _setLoadedOk: function () {
        this._loaded = !0, this._state = "loaded"
    }, _setLoading: function () {
        this._loaded = !1, this._state = "loading"
    }, checkIfLoaded: function () {
        this._mapServicesToLoad || this._mapCountToLoad || (Gis.Logger.log(this._maps.length ? "  TMS " : "    TMS", this.options.url), this._setLoadedOk(), this.fire(this._maps.length ? "load" : "error"))
    }, isLoaded: function () {
        return this._loaded
    }, profileCorrect: function (a) {
        return!!this._profileData[a]
    }, _getAwaitResolution: function (a, b) {
        return this._profileData[a] && this._profileData[a].getUpp && this._profileData[a].getUpp(b)
    }, _checkUppForZoom: function (a, b, c) {
        var d = this._getAwaitResolution(a, c);
        return!d || Math.abs(d - b) < 1e-8
    }, getExists: function (a) {
        for (var b = 0, c = this._maps.length; c > b; b += 1)if (this._maps[b].key === a)return b
    }, checkChanged: function (a) {
        return this._tileServers[a].setData(this.getMapData(a))
    }, parseTileMapData: function (b, c) {
        function d(a) {
            return parseFloat(a)
        }

        var e, f, g, h, i, j, k, l, m, n, o, p, q, r, s = [], t = [];
        if (f = b.querySelector("TileMap"), g = b.querySelector("TileSets"), h = g.getAttribute("profile"), h && !this.profileCorrect(h))throw new Error("  " + h);
        for (i = f.querySelector("BoundingBox"), j = f.querySelector("Origin"), r = "true" === f.getAttribute("dynamic") && 1e3 * Gis.Config.tileUpdateDelay, k = f.querySelector("TileFormat"), k = {extension: k.getAttribute("extension"), mimeType: k.getAttribute("mime-type"), height: k.getAttribute("height"), width: k.getAttribute("width")}, l = f.querySelectorAll("TileSet"), p = 0, q = +1 / 0, e = Gis.Util.lastTrim, m = 0, n = l.length; n > m; m += 1) {
            if (o = l[m].getAttribute("order"), s[o] = d(l[m].getAttribute("units-per-pixel")), !this._checkUppForZoom(h, s[o], o))throw new Error(' upp  "' + h + '" - "' + s + '"    ' + o);
            p = Math.max(p, o), q = Math.min(q, o), t[o] = e(l[m].getAttribute("href"), "/") + "/{x}/{y}" + (k.extension && "." + k.extension || "")
        }
        var u = f.querySelector("Title").childNodes, v = f.querySelector("SRS"), w = {key: c, title: u && u[0] && u[0].nodeValue || c, srs: this.getProfileParam(h, "SRS") || v && v.childNodes && v.childNodes[0] && v.childNodes[0].nodeValue, resolutions: s, urls: t, origin: j && [d(j.getAttribute("x")), d(j.getAttribute("y"))] || this.getProfileParam(h, "origin"), tileFormat: k, maxZoom: p, customLayers: a(f), minZoom: q, profile: h, autoRefresh: r, boundingBox: i && [d(i.getAttribute("minx")), d(i.getAttribute("miny")), d(i.getAttribute("maxx")), d(i.getAttribute("maxy"))] || this.getProfileParam(h, "boundingBox")}, x = this.getExists(w.key);
        Gis.Util.isDefine(x) ? (this._maps[x] = w, this.checkChanged(x, w) && this.fire(Gis.Map.TIME_MAP_DATA_CHANGED.TYPE, new Gis.Map.TIME_MAP_DATA_CHANGED(Gis.TileMapService.encodeKey(this.options.url, c)))) : (this._maps.push(w), x = this._maps.length - 1), this.fire("partialloaded", {map: this.getTileServer(x)}), this.checkIfLoaded()
    }, removeMap: function (a) {
        a = this.getMapIndex(a || 0), this._tileServers.splice(a, 1);
        this._maps.splice(a, 1);
        this.fire("mapremoved")
    }, getMapData: function (a) {
        return{type: "tms", key: this.getURL() + "|" + this._maps[a].key, url: this._maps[a].urls, crs: this.getCrs(a), maxZoom: this.getMaxZoom(a), minZoom: this.getMinZoom(a), title: this._maps[a].title, customLayers: this._maps[a].customLayers, dimension: Gis.point(this._maps[a].tileFormat.width, this._maps[a].tileFormat.height), autoRefresh: this._maps[a].autoRefresh}
    }, getCachedTileServer: function (a) {
        return this._tileServers[a] = this._tileServers[a] || Gis.tmsLayer(this.getMapData(a)), this._tileServers[a].parentTms = this, this._tileServers[a]
    }, getTileServer: function (a) {
        return a = this.getMapIndex(a || 0), this._maps[a] ? this.getCachedTileServer(a) : void 0
    }, getMaxZoom: function (a) {
        return a = a || 0, a = this.getMapIndex(a || 0), this._maps[a] ? this._maps[a].maxZoom : void 0
    }, getAvailableMaps: function () {
        return this._maps
    }, getMinZoom: function (a) {
        return a = a || 0, a = this.getMapIndex(a || 0), this._maps[a] ? this._maps[a].minZoom || 0 : void 0
    }}), Gis.TileMapService.decodeKey = function (a) {
        return a && a + "" != void 0 + "" ? a.split("|") : a
    }, Gis.TileMapService.encodeKey = function (a, b) {
        return b ? a + "|" + b : a
    }
}(), function () {
    "use strict";
    var a = 0;
    Gis.ProgressBarController = {init: function () {
        Gis.EventBus.on("tilesloading tilesloaded", this._tilesCountChanged, this)
    }, _tilesCountChanged: function (b) {
        switch (b.type) {
            case"tilesloading":
                a++;
                break;
            case"tilesloaded":
                a--, 0 > a && (a = 0)
        }
    }, isLoading: function () {
        return!!a
    }}
}(), function () {
    "use strict";
    var a = "remove", b = "add", c = {};
    c[a] = {}, c[b] = {}, Gis.Map = Gis.BaseClass.extend({includes: Gis.StyleContainerBehavior, _projection: Gis.Config.defaultProjection, _mapZoomKey: "MAP_ZOOM", _mapLatLngKey: "MAP_LAT_LNG", _mapKey: "MAP", options: {latlng: [51.505, -.09], zoom: 3, maxZoom: null, minZoom: null, maps: null, provider: null, projection: null}, _getInitLatLng: function () {
        return Gis.Preferences.getPreferenceData(this._mapLatLngKey) || this.options.latlng
    }, _getInitZoom: function () {
        return Gis.Preferences.getPreferenceData(this._mapZoomKey) || this.options.zoom
    }, _getInitSelectedMapKey: function () {
        return Gis.Preferences.getPreferenceData(this._mapKey)
    }, _initProvider: function () {
        this.options.provider.setData({container: this._id, latlng: this._getInitLatLng(), zoom: this._getInitZoom(), maxZoom: this.options.maxZoom, minZoom: this.options.minZoom, projection: this.options.projection}), this.fire("providerloaded", {target: this, provider: this.options.provider})
    }, getSetting: function (a) {
        return this._settings.getSetting(a)
    }, _saveInitMap: function () {
        Gis.Preferences.setPreferenceData(this._mapKey, this.getSelectedMapKey())
    }, _saveMapPosition: function () {
        Gis.Preferences.setPreferenceData(this._mapZoomKey, this.getZoom()), Gis.Preferences.setPreferenceData(this._mapLatLngKey, this.getCenter())
    }, saveMapState: function () {
        this._saveMapPosition(), this._saveInitMap()
    }, initialize: function (a, b) {
        Gis.Map.CURRENT_MAP = this, Gis.EventBus = new Gis.BaseClass, Gis.ProgressBarController.init();
        var c = b && b.settings, d = c && c.styles, e = this;
        this._settings = Gis.settings(c), delete b.settings, this._settings.on(Gis.Map.MAP_LIST_CHANGED.TYPE, function () {
            this.fire(Gis.Map.MAP_LIST_CHANGED.TYPE, new Gis.Map.MAP_LIST_CHANGED(this.getMapList()))
        }, this), this._settings.on(Gis.Map.TIME_MAP_DATA_CHANGED.TYPE, function (a) {
            this.fire(Gis.Map.TIME_MAP_DATA_CHANGED.TYPE, a), a.map === this.getSelectedMapKey() && this.setMapType(this.getSelectedMapKey())
        }, this), b.layer && this._settings.addToMaps(b.layer), this._onunload = function () {
            e.saveMapState()
        }, Gis.BaseClass.prototype.initialize.call(this, b), this.initStyleContainer(), this.options.provider = this.options.provider || new Gis.Maps.Leaflet.LeafletProvider, this.renderer = Gis.Maps.renderer({map: this.options.provider}), this.renderer.on("layerunselected layerselected layerchanged", this._layerEvent, this), this._id = a, this._initProvider(), this._initEvents(), this.loadTileMapsData(), this.putStyle(d)
    }, getRenderer: function () {
        return this.renderer
    }, _closed: function (a) {
        this.fire("closed", a)
    }, _defaultProviderEvent: function (a) {
        this.fire(a.type, a)
    }, _closeProviderEvents: function () {
        this.options.provider.off("closed", this._closed, this), this.options.provider.off("click", this._defaultProviderEvent, this), this.options.provider.off("maxboundschanged", this._defaultProviderEvent, this), this.options.provider.off("mousemove", this._defaultProviderEvent, this), this.options.provider.off("mousedown", this._defaultProviderEvent, this), this.options.provider.off("mouseup", this._defaultProviderEvent, this), this.options.provider.off("mouseout", this._defaultProviderEvent, this), this.options.provider.off("projectionchanged", this._defaultProviderEvent, this)
    }, activateProvierEvents: function () {
        this.options.provider.on("closed", this._closed, this), this.options.provider.on("click", this._defaultProviderEvent, this), this.options.provider.on("maxboundschanged", this._defaultProviderEvent, this), this.options.provider.on("mousemove", this._defaultProviderEvent, this), this.options.provider.on("mousedown", this._defaultProviderEvent, this), this.options.provider.on("mouseup", this._defaultProviderEvent, this), this.options.provider.on("mouseout", this._defaultProviderEvent, this), this.options.provider.on("projectionchanged", this._defaultProviderEvent, this), this.off("providerloaded", this.activateProvierEvents, this)
    }, _initEvents: function () {
        return this.options.provider ? this.activateProvierEvents() : this.on("providerloaded", this.activateProvierEvents, this), window.onunload = this._onunload, this
    }, _layerEvent: function (a) {
        this.fire(a.type, a)
    }, getObjectBounds: function (a) {
        return this.options.provider.getObjectBounds(a)
    }, getMapContainer: function () {
        return this.options.provider.getContainer()
    }, setCrs: function (a) {
        return this.options.provider.setProjection(a.getCode(), a.getProj4def(), a.getProjectedBounds(), a.getOptions()), this
    }, _recoverMap: function () {
        this.setMapType(this._getInitSelectedMapKey(), !1, !0)
    }, mapLoaded: function (a) {
        if ("partialloaded" === a.type && ("local" === a.map.getType() && this._settings.setMap(a.map.getKey(), a.map), this._mapShowed))if (a.map.getKey() === this._getInitSelectedMapKey())this.options.layer.getAdditionalLayers() || a.target.off("load partialloaded", this.mapLoaded, this), this._recoverMap(), this.setZoom(this._getInitZoom()), this.setCenter(this._getInitLatLng()); else if (this.options.layer) {
            var b = this.options.layer.getAdditionalLayerInfo(a.map);
            b && this.addMapLayer(a.map, b)
        }
    }, setZoomAround: function (a, b) {
        return this.options.provider.setZoomAround(a, b), this
    }, setMaxBounds: function (a) {
        return this.options.provider.setMaxBounds(a), this
    }, _isLayerTMS: function (a) {
        a.target.off("istms"), a.tms ? this.setMapType(a.tms ? a.target : Gis.tmsLayer({url: a.target.getURL()})) : this.loadFromCache(a.target.getURL())
    }, setActiveTileLayer: function (a) {
        var b = this.getTileLayerByKey(a);
        b && (b.crs && !b.tile && this.setCrs(b.crs), b.tile && this.setMapType(b.tile))
    }, getTileLayerByKey: function (a) {
        var b, c, d = Gis.TileMapService.decodeKey(a), e = d && this._settings.getMap(d[0]);
        return e ? (d[1] && e.getTileServer ? (b = e.getTileServer(d[1]), c = e.getCrs(d[1])) : e.getTileServer || (b = e, c = e.getCrs()), b && c && {tile: b, crs: c}) : void 0
    }, loadTileMapsData: function () {
        var a, b = this._settings.getMaps();
        if (b)for (a in b)b.hasOwnProperty(a) && this._loadLayer(a, b[a]);
        return this
    }, _loadLayer: function (a, b) {
        var c, d, e = this._settings;
        switch (typeof b) {
            case"string":
                Gis.TmsLayer[b] ? e.setMap(a, Gis.TmsLayer[b]()) : Gis.TmsLayer._isTemplate(b) ? (c = new Gis.LocalCache(b), e.setMap(a, c)) : (d = new Gis.TileMapService({url: b}), e.setMap(a, d), d.on("load partialloaded", this.mapLoaded, this), d.on("istms", this._isLayerTMS, this), d.checkIfTMS());
                break;
            case"object":
                e.setMap(a, b), b.getType && "tilemapservice" === b.getType() && b.load()
        }
        return this
    }, getSelectedMapKey: function () {
        return this._selectedMapKey
    }, getSelectedMap: function (a) {
        return this._settings.getMap(a)
    }, addTileLayer: function (a) {
        return this._settings.addToMaps(a), this
    }, clearMap: function (a, b, c) {
        var d, e, f, g = [];
        if (c = c || this.getLayerIDs(!0)) {
            for (Gis.Util.isArray(c) || (c = [c]), e = 0, d = c.length; d > e; e += 1)try {
                f = this.getLayer(c[e]), !f || a && !a(f) || (b ? g.push(c[e]) : this.removeLayer(f))
            } catch (h) {
                Gis.Logger.log("   - " + c[e] + " (" + h.message + ")", h.stack)
            }
            g.length && (this.hideLayersByID(g), this.clearSelected()), this.renderer.draw()
        }
    }, _recoverPosition: function (a) {
        return this._mapBounds ? (this.options.provider.setMapBounds(this._mapBounds), this._mapBounds = null) : this.setCenter(a), this
    }, _saveBounds: function () {
        return this._mapBounds = this.options.provider.getMapBounds(), this
    }, loadFromCache: function (a) {
        var b = new Gis.LocalCache(a);
        b.on("load partialloaded", this.mapLoaded, this), b.load()
    }, stopRefresh: function () {
        this._autoRefreshInterval && clearInterval(this._autoRefreshInterval)
    }, checkAutoRefresh: function () {
        var a = this.getSelectedMap(this._selectedMapKey), b = this;
        this.stopRefresh(), a && "tms" === a.getType() && a.isAutoRefresh() && a.parentTms && (this._autoRefreshInterval = setInterval(function () {
            a.parentTms.loadTileData(Gis.TileMapService.decodeKey(b._selectedMapKey)[1])
        }, 1e3 * Gis.Config.tileUpdateDelay))
    }, setAdditionalLayers: function (a) {
        var b, c, d, e = a.getAdditionalLayers();
        if (e)for (b = e.length - 1; b >= 0; b -= 1)d = e[b], c = this.getMap(d.key), c && d.checked && this.addMapLayer(c, Gis.Util.extend({}, d))
    }, setMapType: function (a, b, c) {
        if (!a)return this;
        var d, e, f = this.getCenter(), g = this.getActiveLayer();
        this.renderer.pause();
        try {
            switch (e = this._settings.getMap(a), typeof a) {
                case"string":
                    if (Gis.TmsLayer[a])d = e || Gis.TmsLayer[a](); else {
                        if (!this.getTileLayerByKey(a))return Gis.TmsLayer._isTemplate(a) ? (this.loadFromCache(a), this) : (e = e || new Gis.TileMapService({url: a}), e.on("istms", this._isLayerTMS, this), e.checkIfTMS(), this);
                        if (e = this.getTileLayerByKey(a), !e || !e.tile)return Gis.Logger.log("    " + a), this;
                        d = e.tile
                    }
                    break;
                case"object":
                    if (e = e || a, e.getType && ("tilemapservice" === e.getType() || "local" === e.getType()) && "loaded" !== e._state)return e.on("load partialloaded", this.mapLoaded, this), e.load(), this;
                    d = e
            }
            c || this._saveBounds(), this.getZoom() > d.getMaxZoom() ? this.setZoom(d.getMaxZoom(), !1) : this.getZoom() < d.getMinZoom() && this.setZoom(d.getMinZoom(), !1), this._selectedMapKey = d.getKey(), this.setCrs(d.getCrs()), this.options.provider.setMapType({layer: d}), c || g === d.getKey() || this._recoverPosition(f), this.options.layer = d, this.renderer.draw(), this.fire("tilelayerchanged"), this.setAdditionalLayers(d), !window.opera && !b || this._noNeedSaveMapState || this.saveMapState(), this.checkAutoRefresh()
        } finally {
            this.renderer.resume()
        }
        return this
    }, addMapLayer: function (a, b) {
        if (!a)return this;
        if (!this.options.layer)return this.setMapType(a);
        var c, d;
        switch (d = this._settings.getMap(a), typeof a) {
            case"string":
                if (Gis.TmsLayer[a])c = d || Gis.TmsLayer[a](); else {
                    if (!this.getTileLayerByKey(a))return Gis.TmsLayer._isTemplate(a) ? (this.loadFromCache(a), this) : (d = d || new Gis.TileMapService({url: a}), d.on("istms", this._isLayerTMS, this), d.checkIfTMS(), this);
                    if (d = this.getTileLayerByKey(a), !d || !d.tile)return Gis.Logger.log("    " + a), this;
                    c = d.tile
                }
                break;
            case"object":
                if (d = d || a, d.getType && ("tilemapservice" === d.getType() || "local" === d.getType()) && "loaded" !== d._state)return d.on("load partialloaded", this.mapLoaded, this), d.load(), this;
                c = d
        }
        return c.getCrs().getCode() === this.options.layer.getCrs().getCode() ? (this.options.provider.addMapTile({layer: c}, b), this.fire("tilelayeradd")) : (Gis.notify("   " + c.getCrs().getCode() + " != " + this.options.layer.getCrs().getCode(), "error"), Gis.Logger.log("   " + c.getCrs().getCode() + " != " + this.options.layer.getCrs().getCode() + ", current = " + this.getSelectedMapKey() + ", new " + c.getKey())), this
    }, getMapList: function (a) {
        return this._settings.getMapList(a)
    }, getMap: function (a) {
        return this._settings.getMap(a)
    }, getMapBounds: function () {
        return this.options.provider.getMapBounds()
    }, addLayer: function (d, e, f) {
        var g;
        if (d && d.isMapLayer)return this.setMapType(d), this;
        if (Gis.Util.isString(d))return this.addLayer(this.getLayer(d), e, f);
        if (this.renderer.isValidLayer(d)) {
            if (this._cache)return c[a][d.getId()] && delete c[a][d.getId()], c[b][d.getId()] = d, this;
            if (g = this.getLayer(d.getId())) {
                if (g.getType() !== d.getType())throw new Error("Layer " + d.getId() + " exists and type not equal");
                f && this.showLayersByID(g.getId()), g.setData(d.options, null, e)
            } else d.preAdd(this) ? (d.onAdd(this), this.renderer.addLayer(d, e), this.fire("layeradded", {target: d})) : d.isCachedGis() && d.pushToCache()
        }
        return this
    }, startCache: function () {
        this._cache = !0
    }, flush: function () {
        var d, e;
        this._cache = !1, e = c[a], c[a] = {};
        for (d in e)e.hasOwnProperty(d) && e[d] && this.removeLayer(e[d]);
        e = c[b], c[b] = {};
        for (d in e)e.hasOwnProperty(d) && e[d] && this.addLayer(e[d])
    }, removeLayer: function (d) {
        var e = this;
        if (Gis.Util.isArray(d))d.forEach(function (a) {
            "string" == typeof a && e.removeLayer("string" == typeof a ? e.getLayer(a) : a)
        }); else if (this.renderer.isValidLayer(d)) {
            if (this._cache)return c[a][d.getId()] = d, c[b][d.getId()] && delete c[b][d.getId()], this;
            this.renderer.removeLayer(d), this.fire("layerremoved", {target: d})
        } else Gis.Util.isString(d) && e.removeLayer(e.getLayer(d));
        return this
    }, hasLayer: function (a) {
        return this.renderer.layerExist(a)
    }, getLayer: function (a) {
        return this.renderer.getLayer(a)
    }, getZoom: function () {
        return this.options.provider.getZoom()
    }, setZoom: function (a, b) {
        return Gis.Util.isNumeric(a) && a >= this.options.provider.getMinZoom() && a <= this.options.provider.getMaxZoom() ? this.options.provider.setZoom(a, b) : a.ids || a.latitudes || a.longitudes ? this.setMapBounds(a) : Gis.Logger.log("Unexpected zoom", "zoom = " + a), this
    }, getMaxZoom: function () {
        return isFinite(this.options.provider.getMaxZoom()) ? this.options.provider.getMaxZoom() : 18
    }, getMinZoom: function () {
        return this.options.provider.getMinZoom() || 0
    }, zoomIn: function () {
        return this.options.provider.zoomIn(), this
    }, zoomOut: function () {
        return this.options.provider.zoomOut(), this
    }, setCenter: function (a, b) {
        return this.options.provider.setCenter(a, b), this
    }, getCenter: function () {
        return this.options.provider.getCenter()
    }, getMaxBounds: function () {
        return this.options.provider.getMaxBounds()
    }, getLayerIDs: function (a) {
        return this.renderer.getLayerIDs(a)
    }, getSelected: function () {
        return this.renderer.getSelected()
    }, getDefauldLayer: function () {
        return this.options.layer || this._settings && this._settings.getMap(0)
    }, getActiveLayer: function () {
        var a = this.getTileLayerByKey(this._getInitSelectedMapKey());
        return a && this._getInitSelectedMapKey() || this.getDefauldLayer()
    }, show: function () {
        return this.options.provider.showMap(), this._mapShowed = !0, this._noNeedSaveMapState = !0, this.setMapType(this.getActiveLayer(), !1, !0), this._noNeedSaveMapState = !1, this.options.provider.on("zoomstart", function (a) {
            this.fire("zoomstart", a)
        }, this), this.options.provider.on("zoomend", function (a) {
            this.fire("zoomend", a), window.opera ? this.saveMapState() : this._saveMapPosition()
        }, this), this.options.provider.on("moveend", function (a) {
            this.fire("moveend", a), window.opera ? this.saveMapState() : this._saveMapPosition()
        }, this), this.getSetting("ui") && !this.ui && (this.ui = new Gis.UI(this, {userSet: this.getSetting("ui")})), this.options.provider.getContainerReal()._gis_map_ = this, this.switchGridVisibility(null), this
    }, setMapBounds: function (a) {
        if (a) {
            var b = a.getSouthWest ? a : this._getLatLngBoundsToFit(a);
            if (b.lat)return this.setCenter(b), this;
            b && this.options.provider.setMapBounds(b)
        }
        return this
    }, _getLatLngBoundsToFit: function (a) {
        var b, c, d, e, f, g, h, i, j, k = Gis.Util.isNumeric, l = [], m = this.options.provider;
        if (a) {
            if (b = a.ids && this.renderer._getLatitudeBounds(a.ids instanceof Array ? a.ids : [a.ids]), c = b && b.getNorthWest(), d = b && b.getSouthEast(), f = a.latitudes, g = a.longitudes, h = Gis.Util.isArray, h(f) && h(g)) {
                for (e = Math.min(f.length, g.length), i = 0; e > i; i += 1)l[i] = Gis.latLng(f[i], g[i]);
                c = c || l[0], d = d || l[1]
            }
            try {
                c = L.latLng(c && k(c.lat) ? c.lat : null, c && k(c.lng) ? c.lng : null)
            } catch (n) {
                Gis.Logger.log("incorrect northWest for set zoom", void 0, n), c = !1
            }
            try {
                d = L.latLng(d && k(d.lat) ? d.lat : null, d && d.lng)
            } catch (o) {
                Gis.Logger.log("incorrect southEast for set zoom", void 0, o), d = !1
            }
            return c && d ? (j = Gis.bounds(m.latLngToLayerPoint(c), m.latLngToLayerPoint(d)), h(l) && l.forEach(function (a) {
                j.extend(m.project(a))
            }), this._getClosestLatLngBounds(j)) : c || d
        }
        return null
    }, _getClosestLatLngBounds: function (a) {
        var b = this.options.provider, c = a.getBottomLeft(), d = a.getTopRight(), e = b.layerPointToLatLng(c), f = b.layerPointToLatLng([d.x, c.y]), g = b.layerPointToLatLng(d), h = b.layerPointToLatLng([c.x, d.y]), i = Gis.latLng(Math.min(g.lat, h.lat), Math.min(g.lng, f.lng)), j = Gis.latLng(Math.max(f.lat, e.lat), Math.max(e.lng, h.lng));
        return Gis.latLngBounds(i, j)
    }, getMapProvider: function () {
        return this.options.provider
    }, getProjection: function () {
        return this.options.provider.getProjectionCode()
    }, latLngToLayerPoint: function (a) {
        return this.options.provider.latLngToLayerPoint(a)
    }, getSelectedGrid: function () {
        return this._grid_type
    }, _getMapOffset: function () {
        return this._grid_type === Gis.Map.GRID_TYPES.KILOMETR || this._grid_type === Gis.Map.GRID_TYPES.GRAD ? L.Grid.OFFSET : 0
    }, switchGridVisibility: function (a) {
        var b = this, c = this._grid_type;
        return a && !window.Kinetic ? void Gis.Util.loadKinetic(function () {
            b.switchGridVisibility(a)
        }) : (this._grid_type && this.options.provider.map.removeLayer(this._current_grid), a && this._grid_type !== a ? (this._grid_type = a, this._current_grid = new Gis.Map._GRID_TYPES_[a], this._current_grid.addTo(this.options.provider.map)) : this._grid_type = null, this.options.provider.gridVisibility(this._getMapOffset()), void this.fire(Gis.Map.GridVisibilityChanged.TYPE, new Gis.Map.GridVisibilityChanged(c, this._grid_type)))
    }, layerPointToLatLng: function (a) {
        return this.options.provider.layerPointToLatLng(a)
    }, setDraggableEnabled: function (a) {
        return this.options.provider.setDraggable(a), this
    }, isDraggableEnabled: function () {
        return this.options.provider.isDraggableEnabled()
    }, unselectLayer: function (a) {
        return this.renderer.removeFromSelected(a), this
    }, selectLayer: function (a) {
        return this.renderer.addSelected(a), this
    }, clearSelected: function () {
        return this.renderer.clearSelected(), this
    }, getFilterSelect: function () {
        return this.renderer.getFilterSelect()
    }, filterSelect: function (a, b) {
        return this.renderer.filterSelect(a, b), this
    }, isFilterable: function (a) {
        return this.renderer.isFilterable(a)
    }, clearSelectedOnClick: function (a) {
        return this.renderer.clearSelectedOnClick(a), this
    }, isClearOnClick: function () {
        return this.renderer.isClearOnClick()
    }, hideLayersByType: function (a) {
        return this.renderer.hideByType(a), this
    }, showLayersByType: function (a) {
        return this.renderer.showByType(a), this
    }, hideLayersByID: function (a) {
        return this.renderer.hideByIDs(a), this
    }, showLayersByID: function (a) {
        return this.renderer.showByIDs(a), this
    }, fitWorld: function () {
        return this.options.provider.fitWorld(), this
    }, fillObjects: function (a) {
        if (Gis.Util.isDefine(a))try {
            Gis.Util.isString(a) && (a = JSON.parse(a)), Gis.Util.fillMapFromObject(this, a)
        } catch (b) {
            Gis.Logger.log("  json", a + "")
        }
        return this
    }}), Gis.map = function (a, b) {
        return new Gis.Map(a, b)
    }, Gis.Map.GridVisibilityChanged = function (a, b) {
        this.oldGrid = a, this.newGrid = b, this.type = Gis.Map.GridVisibilityChanged.TYPE
    }, Gis.Map.GridVisibilityChanged.TYPE = "gridvisibilitychanged", Gis.Map.MAP_LIST_CHANGED = function (a) {
        this.maps = a, this.type = Gis.Map.MAP_LIST_CHANGED.TYPE
    }, Gis.Map.MAP_LIST_CHANGED.TYPE = "maplistchanged", Gis.Map.TIME_MAP_DATA_CHANGED = function (a) {
        this.map = a, this.type = Gis.Map.TIME_MAP_DATA_CHANGED.TYPE
    }, Gis.Map.TIME_MAP_DATA_CHANGED.TYPE = "tilamapdatachanged", Gis.Map.GRID_TYPES = {KILOMETR: 1, NOMENCLATE: 2, GRAD: 3}, Gis.Map._GRID_TYPES_ = {}
}(), function () {
    "use strict";
    Gis.ConnectionWorker = {CONFIG_REQUEST_UNKNOWN_KEY: "request.unknown.key", initialize: function (a) {
        a(), this._initConnection()
    }, _initConnection: function () {
        this._settings.getServer() && this.connect.apply(this, this._settings.getServer())
    }, requestObject: function (a, b, c) {
        if (this._connection && Gis.config(this.CONFIG_REQUEST_UNKNOWN_KEY, !0)) {
            Gis.Logger.log(" " + a + "  " + b.getType() + "=" + b.getId() + "  ,   ");
            var d = new Gis.Commands.getObject({gis: this, connection: this._connection, fromServer: !1, id: a});
            d.execute(), c || this.renderer.whenAdd(a, b)
        }
    }, getConnection: function () {
        return this._connection
    }, _connectionStatusChanged: function (a) {
        this.fire(a.type, a)
    }, connect: function (a, b, c) {
        if (b = b && parseInt(b, 10), !a || "string" != typeof a)throw Gis.Logger.log("Not correct domain", a), new Error("Not correct domain");
        if (!b)throw Gis.Logger.log("Not correct port", b), new Error("Not correct port");
        return b = b || Gis.Config.connection.port, c = c || Gis.Config.connection.portSecond, this.disconnect(), this._connection = Gis.connection({gis: this, domain: a, port: b, portSecond: c}), this.renderer.on(Gis.ObjectController.LAYER_CHANGED_EVENT.TYPE, this._connection.layerChanged, this._connection), this.renderer.on(Gis.ObjectController.LAYER_REMOVE_EVENT.TYPE, this._connection.layerRemoved, this._connection), this.renderer.on("customaction", this._connection._onCustomAction, this._connection), this.on(Gis.Objects.Overlay.OVERLAY_CHANGED_EVENT.TYPE, this._connection._onOverlayChanged, this._connection), this.on("projectionchanged", this._connection.sendConnect, this._connection), this._connection.on("statuschanged", this._connectionStatusChanged, this), this._connection.on("commandok", this._connectionCommandOk, this), this._connection.connect(), this
    }, disconnect: function () {
        return this._connection && (this.renderer.off("layerchanged", this._connection.layerChanged, this._connection), this.renderer.off("customaction", this._connection._onCustomAction, this._connection), this.off(Gis.Objects.Overlay.OVERLAY_CHANGED_EVENT.TYPE, this._connection._onOverlayChanged, this._connection), this._connection.off("commandok", this._connectionCommandOk, this), this._connection.off("statuschanged", this._connectionStatusChanged, this), this.off("projectionchanged", this._connection.sendConnect, this._connection), this._connection.disconnect()), this
    }, _connectionCommandOk: function (a) {
        this.fire(a.type, a)
    }}, Gis.Map.include(Gis.ConnectionWorker)
}(Gis), function (a) {
    "use strict";
    function b(b, c, d) {
        return a.Util.isDefine(b.percent) ? b.percent : (b.value - d) / c
    }

    a.Objects.HeatMap = a.Objects.Selectable.extend({events: a.Core.Events.availableDomEvents, options: {tacticObjectType: "heatmap", id: void 0, drawPath: !0, reset: !1, matrix: void 0}, optionsFire: ["tacticObjectType", "id", "tags", "name", "caption", "customActions", "tooltip", "matrix"], setOpacity: function (b) {
        this._opacity = b, this.fire(a.Objects.Base.NEED_REDRAW_EVENT.TYPE)
    }, setData: function () {
        var b = a.Objects.Selectable.prototype.setData.apply(this, arguments);
        return this._changed = this._changed || this._isChanged(b), b
    }, initialize: function (b) {
        this._changed = ["matrix"], a.Objects.Selectable.prototype.initialize.call(this, b), this._opacity = a.config("heatmap.opacity", .6)
    }, onAdd: function (b) {
        a.Objects.Selectable.prototype.onAdd.call(this, b)
    }, isHasCorrectData: function (b) {
        var c, d, e, f, g, h;
        if (b && a.Util.isArray(b))for (e = b.length, g = Math.floor(e / 2), h = Math.floor(b[0] / 2), c = 0; e > c; c += 1)for (f = b[c].length, d = 0; f > d; d += 1)if (!isNaN(b[c][d]) && c !== g && d !== h)return!0;
        return!1
    }, notifyIsNan: function (b) {
        this.isHasCorrectData(b) || a.notify("      ", "warning")
    }, setUserSelectedGradient: function (b) {
        this._selectedGradient = b, this._changed = !0, this.fire(a.Objects.Base.NEED_REDRAW_EVENT.TYPE, {target: this})
    }, getSelectedGradient: function () {
        return this._selectedGradient
    }, onDelete: function (b) {
        a.Objects.Selectable.prototype.onDelete.call(this, b)
    }, preDraw: function () {
        return a.Objects.Selectable.prototype.preDraw.apply(this, arguments)
    }, _isChanged: function (a) {
        return a && a.indexOf("matrix") > -1
    }, draw: function (b) {
        if (this.preDraw()) {
            var c = this._changed, d = this.getOptionsWithStyle();
            this._lowLevelObject = b.drawHeatMap({opacity: this._opacity, colors: this._selectedGradient || d.matrix.gradient, changed: c, drawPath: d.drawPath, points: d.matrix.values, caption: d.caption, width: d.matrix.width, reset: d.reset, height: d.matrix.height, selected: this.isSelected(), tooltip: d.tooltip, bounds: L.latLngBounds(L.latLng(d.matrix.n, d.matrix.w), L.latLng(d.matrix.s, d.matrix.e)), events: {type: this.events, callback: this.fireEventsFromLowLevel, context: this}}, this._lowLevelObject), this._changed = !1, a.Objects.Selectable.prototype.draw.call(this, b)
        }
    }, getGradient: function () {
        var a = this.getOptionsWithStyle();
        return a.matrix && a.matrix.gradient.slice()
    }, getLatLng: function () {
        var a = this.getOptionsWithStyle();
        return[a.matrix.s + (a.matrix.n - a.matrix.s) / 2, a.matrix.w + (a.matrix.e - a.matrix.w) / 2]
    }, getLatLngBounds: function () {
        var b = this.getOptionsWithStyle();
        return a.latLngBounds(a.latLng(b.matrix.n, b.matrix.w), a.latLng(b.matrix.s, b.matrix.e))
    }}), a.heat_map = function (b) {
        return new a.Objects.HeatMap(b)
    }, a.heatmap = a.heat_map, a.ObjectFactory.list.heatmap = a.Objects.HeatMap, a.ObjectFactory.list["heat-map"] = a.Objects.HeatMap, a.Objects.HeatMap.parseColors = function (c) {
        var d, e;
        return this._foundMaxMin(c), d = this._max, e = this._min, c = c.map(function (c) {
            var f = {value: c.value, percent: b(c, d, e)};
            return f.color = a.Objects.HeatMap.getRbg(c.color), f
        }), c = c.sort(function (b, c) {
            var f = a.Util.isDefine(b.percent) ? b.percent : (b.value - e) / d, g = a.Util.isDefine(c.percent) ? c.percent : (c.value - e) / d;
            return f - g
        })
    }, a.Objects.HeatMap.unParseColors = function (c) {
        var d, e;
        return this._foundMaxMin(c), d = this._max, e = this._min, c = c.map(function (c) {
            var f = {value: c.value, percent: b(c, d, e)};
            return f.color = a.Objects.HeatMap.getRbg(c.color).toRGBA(), f
        }), c = c.sort(function (b, c) {
            var f = a.Util.isDefine(b.percent) ? b.percent : (b.value - e) / d, g = a.Util.isDefine(c.percent) ? c.percent : (c.value - e) / d;
            return f - g
        })
    }, a.Objects.HeatMap._foundMaxMin = function (b) {
        var c, d, e;
        for (this._max = -1 / 0, this._min = 1 / 0, c = 0, d = b.length; d > c; c += 1)e = b[c].value, a.Util.isDefine(e) && !isNaN(e) && (this._max = Math.max(this._max, e), this._min = Math.min(this._min, e))
    }, a.Objects.HeatMap.getRbg = function (b, c) {
        return a.Util.isDefine(b.r) && a.Util.isDefine(b.g) && a.Util.isDefine(b.b) ? b : c ? (c.parseColor(b), c) : new RGBColor(b)
    }, a.Objects.HeatMap.NAN_COLOR_CONGIG_KEY = "heatmap.nan_color"
}(Gis), function (a) {
    a.Objects.ArealRelief = a.Objects.HeatMap.extend({events: a.Core.Events.availableDomEvents, options: {tacticObjectType: "areal-relief", reset: !0, name: " ", n: null, s: null, w: null, e: null, accuracy: null, drawPath: !1, count: 0}, onAdd: function () {
        var b = a.Objects.HeatMap.prototype.onAdd.apply(this, arguments);
        return this._changed = !1, this._requestMatrix(), this.on("select", this._onSelect), b
    }, onDelete: function () {
        var b = a.Objects.HeatMap.prototype.onDelete.apply(this, arguments);
        return this.on("off", this._onSelect), this._lowLevelObject = null, this.options.matrix = null, b
    }, getGradient: function () {
        var b = this.getOptionsWithStyle(), c = b.matrix && b.matrix.gradient || a.config(a.Objects.ArealRelief.CONFIG_GRADIENT_KEY);
        return c && c.slice()
    }, _requestMatrix: function () {
        var b = this;
        this._map && this._needRequest && (this._needRequest = !1, this.options.matrix = null, L.ReliefControlSquare.getInstance().showRadar(!0), this._$ajax && this._$ajax.abort(), this._$ajax = this._map.getHeightsAreal(this.getArealBounds(), this.getAccuracyCoefficient(), function (c) {
            b._$ajax = null, L.ReliefControlSquare.getInstance().showRadar(!1);
            var d = a.extend({gradient: this._selectedGradient || b.getGradient(), values: c, n: b.getOption("n"), s: b.getOption("s"), w: b.getOption("w"), e: b.getOption("e")});
            b.notifyIsNan(d.values), a.Objects.HeatMap.prototype.setData.call(b, {matrix: d})
        }, function () {
            b._$ajax = null, L.ReliefControlSquare.getInstance().showRadar(!1), b.fire("loaddataerror")
        }))
    }, _onSelect: function () {
        this._$ajax && L.ReliefControlCircle.getInstance().showRadar(!0)
    }, getAccuracyCoefficient: function () {
        var b = this.getOption("accuracy"), c = a.config("gis.area-relief.count") || 100;
        return b = b && parseFloat(b), b ? b * c : c
    }, setData: function () {
        var b = a.Objects.HeatMap.prototype.setData.apply(this, arguments);
        return b && (b.indexOf("accuracy") > -1 || b.indexOf("n") > -1 || b.indexOf("s") > -1 || b.indexOf("w") > -1 || b.indexOf("e") > -1) && (this._needRequest = !0, this._requestMatrix()), b
    }, initialize: function () {
        return this._needRequest = !0, a.Objects.HeatMap.prototype.initialize.apply(this, arguments)
    }, preDraw: function () {
        return this.options.matrix && a.Objects.HeatMap.prototype.preDraw.apply(this, arguments)
    }, getCenter: function () {
        return this.getArealBounds().getCenter()
    }, getLatLng: function () {
        return this.getCenter()
    }, getNorthWest: function () {
        return a.latLng([this.getOption("n"), this.getOption("w")])
    }, getSouthEast: function () {
        return a.latLng([this.getOption("s"), this.getOption("e")])
    }, getArealBounds: function () {
        return a.latLngBounds(this.getNorthWest(), this.getSouthEast())
    }}), a.Objects.ArealRelief.CONFIG_GRADIENT_KEY = "gis.areal-relief.gradient", a.setConfig(a.Objects.ArealRelief.CONFIG_GRADIENT_KEY, [
        {color: "black", percent: 0},
        {color: "#1300BE", percent: .2},
        {color: "#00C5FF", percent: .4},
        {color: "#24FF00", percent: .6},
        {color: "#EFFF00", percent: .7},
        {color: "#FF0000", percent: .9},
        {color: "#FF0AE9", percent: 1}
    ]), a.arealRelief = function (b) {
        return new a.Objects.ArealRelief(b)
    }
}(Gis), function (a) {
    "use strict";
    var b = ["Pt", "Pr", "A", "B", "freq", "gTr", "gRec", "h_a", "d_k"];
    a.Objects.VisibilityMap = a.Objects.HeatMap.extend({events: a.Core.Events.availableDomEvents, options: {tacticObjectType: "visibility", reset: !0, center: null, radius: null, name: " ", alt: null, accuracy: null, "areal-alt": null, "alt-type": "relative", "areal-alt-type": "relative", "visibility-type": "visibility", Pt: null, Pr: null, A: null, B: null, freq: null, gTr: null, gRec: null, h_a: null, d_k: null, drawPath: !1, count: 0}, onAdd: function () {
        var b = a.Objects.HeatMap.prototype.onAdd.apply(this, arguments);
        return this._changed = !1, this._requestMatrix(), this.on("select", this._onSelect), b
    }, onDelete: function () {
        var b = a.Objects.HeatMap.prototype.onDelete.apply(this, arguments);
        return this.on("off", this._onSelect), this._lowLevelObject = null, this.options.matrix = null, b
    }, getAdditionalRequestParams: function () {
        var a = {}, c = this;
        return b.forEach(function (b) {
            a[b] = c.getOption(b)
        }), a.phi = this.getCenter().lat, a.freq *= 1e6, a
    }, _requestMatrix: function () {
        var b = this;
        this._map && (L.ReliefControlCircle.getInstance().showRadar(!0), this._$ajax && this._$ajax.abort(), this._$ajax = this._map.getVisibility(this.getCenter(), this.getRadius(), function (c) {
            b._$ajax = null, L.ReliefControlCircle.getInstance().showRadar(!1);
            var d = a.extend({gradient: a.config(a.Objects.VisibilityMap.CONFIG_GRADIENT_KEY)}, c);
            b.notifyIsNan(d.values), a.Objects.HeatMap.prototype.setData.call(b, {matrix: d})
        }, function () {
            b._$ajax = null, L.ReliefControlCircle.getInstance().showRadar(!1), b.fire("loaddataerror")
        }, this.getHeight(), this.getArealHeight(), this.getOption("alt-type"), this.getOption("areal-alt-type"), this.getAccuracyCoefficient(), "visibility" !== this.options["visibility-type"] ? this.getAdditionalRequestParams() : void 0))
    }, _onSelect: function () {
        this._$ajax && L.ReliefControlCircle.getInstance().showRadar(!0)
    }, getAccuracyCoefficient: function () {
        var b = this.getOption("accuracy"), c = a.config("gis.region-of-sight.count") || 100;
        return b ? b * c : c
    }, setData: function () {
        var b = a.Objects.HeatMap.prototype.setData.apply(this, arguments);
        return this._requestMatrix(), b
    }, preDraw: function () {
        return this.options.matrix && a.Objects.HeatMap.prototype.preDraw.apply(this, arguments)
    }, getCenter: function () {
        return this.getOption("center")
    }, getLatLng: function () {
        return this.getCenter()
    }, getRadius: function () {
        return this.getOption("radius")
    }, getHeight: function () {
        return this.getOption("alt")
    }, getArealHeight: function () {
        return this.getOption("areal-alt")
    }, getVisibilityType: function () {
        return this.getOption("visibility-type")
    }}), a.Objects.VisibilityMap.CONFIG_GRADIENT_KEY = "gis.visibilitymap.gradient", a.setConfig(a.Objects.VisibilityMap.CONFIG_GRADIENT_KEY, [
        {color: "rgba(0, 0, 0, 1)", value: 1},
        {color: "rgba(255, 255, 255, 0.5)", value: 0}
    ]), a.visibilitymap = function (b) {
        return new a.Objects.VisibilityMap(b)
    }
}(Gis);
var prefix = "_bearing";
Gis.Objects.Bearing = Gis.Objects.Base.extend({required: ["postId", "sourceId", "timeStamp", "latitude", "longitude", "bearing"], fixed: "sourceId postId tacticObjectType", _maxLongitude: 360, step: 10, stepKilometres: 2e5, options: {tacticObjectType: "bearing", sourceId: void 0, postId: void 0, timeStamp: void 0, latitude: void 0, longitude: void 0, course: void 0, bearing: void 0}, optionsFire: ["tacticObjectType", "sourceId", "postId", "caption", "tooltip", "timeStamp", "latitude", "longitude", "bearing", "customActions", "course"], initialize: function () {
    this._id = Gis.Util.generateGUID(), Gis.Objects.Base.prototype.initialize.apply(this, arguments)
}, preAdd: function (a) {
    var b = a.getLayer(this.options.sourceId), c = b && b.isBearingVisible(this), d = a.getLayer(this.options.postId);
    return b || a.requestObject(this.options.sourceId, this), d || a.requestObject(this.options.postId, this), c || Gis.Logger.log("Bearing not visible", this._id, c), c && d
}, getLayers: function () {
    return Gis.Objects.Base.prototype.getLayers.call(this) || this._source && this._source.getLayers() || []
}, _clearData: function () {
    Gis.Objects.Base.prototype._clearData.call(this), Gis.Util.extend(this.options, {sourceId: void 0, postId: void 0, timeStamp: void 0, latitude: void 0, longitude: void 0, course: void 0, bearing: void 0}), this._points = null, this._needRecalculate = !0, this._post = void 0, this._source = void 0, this._insertPosition = null, this._markerIcon = null, this._isVisible = !1
}, onAdd: function (a) {
    var b = this;
    Gis.Objects.Base.prototype.onAdd.call(this, a), this._source = a.getLayer(this.options.sourceId), this._post = a.getLayer(this.options.postId), this._zoom = a.getZoom(), b._needRecalculate = !0, this._zoomFunc = function () {
        b._zoom = a.getZoom(), b._needRecalculate = !0
    }, this._post.on("remove hided clearmeta", this._parentRemoved, this), this._post.on("change", this._postChanged, this), this._source.on("zoomchanged", this._zoomFunc, this), this._source.fire("attach", {to: this})
}, onClosePoint: function () {
    this._map || Gis.Map.CURRENT_MAP ? (this._map || Gis.Map.CURRENT_MAP).removeLayer(this) : console.error("this._map not found in bearung!!!!")
}, onDelete: function (a) {
    this.hide(a.from), this._disableParentActions(), Gis.Objects.Base.prototype.onDelete.call(this, a), this.pushToCache()
}, _disableParentActions: function () {
    this._post && (this._post.off("remove hided clearmeta", this._parentRemoved, this), this._post.off("change", this._postChanged, this)), this._source && this._source.off("zoomchanged", this._zoomFunc, this)
}, _parentRemoved: function () {
    this._map.removeLayer(this)
}, _postChanged: function () {
    this._markerIcon = void 0, this._source.fire(Gis.Objects.Base.NEED_REDRAW_EVENT.TYPE)
}, _parentWantToClean: function () {
}, isVisible: function () {
    return this._isVisible
}, hide: function (a) {
    this._isVisible && (a.removeLayer(this), this._disableParentActions(), this._isVisible = !1)
}, getAngle: function () {
    var a = this.getOptionsWithStyle();
    return this._markerIcon && this._markerIcon.isRotatable() && a.course || 0
}, showBearing: function (a) {
    var b, c, d, e, f;
    this._points = this._needRecalculate ? this._getLinePointsByLen(null, a) : this._points, this._needRecalculate = !1, f = this.getOptionsWithStyle(), b = f.caption, c = f.tooltip, e = a.drawPolyline({latlng: this._points, tooltip: c, line: this._source.getBearingStyle()}, this._lowLevelObject && this._lowLevelObject.line), this._markerIcon = this._markerIcon || Gis.icon({type: "arrow", width: 15, color: this._post.options.icon.getColor()}), d = a.drawMarker(Gis.Util.extend({}, this._post.options, {latlng: this.getLatLng(), caption: b, icon: this._markerIcon, popup: c, position: this._post._position, angle: this.getAngle(), className: "gis-bearing"}), this._lowLevelObject && this._lowLevelObject.marker), this._isVisible = !0, this._lowLevelObject = {inset: !0, marker: d, line: e}
}, draw: function (a) {
    this.preDraw() && !this._isVisible && this.showBearing(a)
}, _calculateLatitude: function (a, b, c) {
    var d, e, f, g = Gis.Util.gradToRad(a[0]), h = Gis.Util.gradToRad(b[1]), i = Gis.Util.gradToRad(a[1]), j = Gis.Util.gradToRad(b[0]);
    return c = Gis.Util.gradToRad(c), e = Math.tan(j) / Math.sin(h - i), f = Math.tan(g) / Math.sin(h - i), d = Math.atan(e * Math.sin(c - i) + f * Math.sin(h - c)), Gis.Util.radToGrad(d)
}, _calcLatByAngle: function (a, b, c) {
    var d = Gis.Util.gradToRad, e = d(a), f = d(c), g = d(b[0]), h = d(b[1]), i = Math.tan, j = Math.cos;
    return Gis.Util.radToGrad(Math.atan((i(f - h) / (i(e) * j(g)) + i(g)) * j(f - h)))
}, _calculateBearingLength: function (a) {
    var b = Gis.Projection.L;
    return a = Math.abs(a), 180 === a || 0 === a || -360 === a ? Gis.Projection.L / 2 : b * Math.cos(Gis.Util.gradToRad(this.options.latitude))
}, bearingByAngle: function (a, b, c) {
    var d, e, f, g = [];
    if (b %= 360, f = Math.abs(b), b = b > 180 ? b - 360 : -180 > b ? b + 360 : b, c = c || this.step, 180 === f || 0 === b) {
        for (c = 180 === f ? -c : c, d = a[1], e = a[0]; Math.abs(e) < 85; e += c)g.push([e, d]);
        return g
    }
    return g
}, bearingByLen: function (a, b, c) {
    var d, e, f, g, h, i = [], j = b % 360, k = this._calculateBearingLength(b);
    for (c = c || this.stepKilometres, f = 180 > j && j > 0 || -180 > j, g = j > 180 || j > -180 && 0 > j, d = 0; Math.abs(d) < Gis.Projection.L && (e = this._pointByLen(d, a, b), h = i[i.length - 1], !d || !(d > k || f && e[1] < h[1] || g && e[1] > h[1])); d += c)i.push(e);
    return i
}, _pointByLen: function (a, b, c) {
    return Gis.Projection.nextPointByLen(a, b, c)
}, _getLinePoints: function (a) {
    var b, c, d;
    return d = this.options.longitude, c = [this.options.latitude, d], a = a || this.step / (this._zoom || 1), b = this.bearingByAngle(c, this.options.bearing, a), this._needRecalculate = !1, b
}, _getLinePointsByLen: function (a) {
    var b, c, d;
    return d = this.options.longitude, c = [this.options.latitude, d], a = a || this.stepKilometres / (Math.log(this._zoom || 1) + 1), b = this.bearingByLen(c, this.options.bearing, a), this._needRecalculate = !1, b
}, getCaption: function () {
    return this.getOption("caption")
}, getLatLng: function () {
    return[this.getOption("latitude"), this.getOption("longitude")]
}, getId: function () {
    return prefix + this.options.sourceId + this.options.timeStamp
}, getTimeStamp: function () {
    return this.options.timeStamp
}, isControllable: function () {
    return!1
}}), Gis.bearing = function (a) {
    return new Gis.Objects.Bearing(a)
}, Gis.ObjectFactory.list.bearing = Gis.Objects.Bearing, function (a) {
    "use strict";
    a.Course = {_step: 10, _isVisible: !0, _defaultCourseStyle: null, getCourse: function () {
        return this.options.course
    }, getDefaultCourseStyle: function () {
        return this._defaultCourseStyle = this._defaultCourseStyle || a.Config.style.DefaultCourseStyle && a.lineStyle(a.Util.extend({}, a.Config.style.DefaultCourseStyle)), this._defaultCourseStyle
    }, needDrawCourse: function () {
        return!!this.getOption("courseStyle")
    }, drawCourse: function (b, c, d, e) {
        var f, g = this.options.courseStyle || this.getDefaultCourseStyle();
        return this.selfDraw() && !this.selfDraw().course && (g = a.lineStyle({color: "rgba(0,0,0,0)", border: "rgba(0,0,0,0)"})), f = this.recalculateCoursePoints(e, d, b), f && f.length > 1 && g && (c = b.drawPolyline({latlng: f, line: g}, c)), c
    }, recalculateCoursePoints: function (a, b, c) {
        return this.getCoursePoints(a || this.getLatLng(), b, c)
    }, getCoursePoints: function (a, b, c) {
        var d, e, f, g, h, i, j = a[1], k = [], l = c.getMaxBounds();
        if (b !== !1 && void 0 !== b) {
            if (b %= 360, d = a[0], h = function (a, b) {
                return Math.abs(a) <= Math.abs(b)
            }, e = l && l.getNorthEast().lat || 85, f = l && l.getNorthEast().lng || 180, g = (c.getCurveStep() || this._step) / (c.getZoom() || 1), Math.abs(b) > 90 && Math.abs(b) <= 270 ? (l && (d = Math.min(d, l.getNorthEast().lat), j = Math.min(j, l.getNorthEast().lng)), e = l && l.getSouthEast().lat || -e, h = function (a, b) {
                return a >= b
            }, g = -g) : l && (d = Math.max(d, l.getSouthEast().lat), j = Math.max(j, l.getNorthWest().lng)), 270 !== b && 90 !== b)for (d; h(d, e); d += g)i = [d, this.calculateCourseLongitude(d, a, b)], (!l || l.contains(Gis.latLng(i))) && k.push(i); else for (270 === b && (f = l && l.getSouthWest().lng || -f), j; h(j, f); j += g)i = [d, j], (!l || l.contains(Gis.latLng(i))) && k.push(i);
            return k
        }
        return!1
    }, calculateCourseLongitude: function (b, c, d) {
        var e, f = a.Util.gradToRad, g = f(c[0]), h = f(c[1]), i = Math.tan, j = Math.log;
        return b = f(b), d = f(d), e = d !== Math.PI / 2 && d !== 1.5 * Math.PI ? h + i(d) * (j(i(Math.PI / 4 + b / 2)) - j(i(Math.PI / 4 + g / 2))) : h + (b - g), a.Util.radToGrad(e)
    }}
}(Gis), function (a) {
    "use strict";
    Gis.Objects.Draggable = {onAdd: function () {
        a.Objects.Base.prototype.onAdd.apply(this, arguments), this.on("drag", this._onDrag, this), this.on("dragend", this._onDragEnd, this)
    }, onDelete: function () {
        a.Objects.Base.prototype.onDelete.apply(this, arguments), this.off("drag", this._onDrag, this), this.off("dragend", this._onDragEnd, this)
    }, options: {draggable: !1}, isDraggable: function () {
        return this.options.draggable
    }}
}(Gis), Gis.Objects.ImageLabel = Gis.Objects.Selectable.extend({events: Gis.Core.Events.availableDomEvents, required: ["id", "latitude", "longitude", "icon"], fixed: "id tacticObjectType", options: {tacticObjectType: "image", id: void 0, latitude: void 0, longitude: void 0, selectable: void 0, draggable: void 0, icon: void 0, position: "center", captionPosition: "centerright", className: void 0, angle: void 0}, optionsFire: ["tacticObjectType", "id", "tags", "latitude", "longitude", "selectable", "draggable", "icon", "name", "caption", "customActions", "tooltip"], setData: function (a, b, c) {
    {
        var d;
        this.getIcon() && this.getIcon().clone()
    }
    return b = this._fillOption(a, b, "icon", Gis.icon), d = Gis.Objects.Selectable.prototype.setData.call(this, a, b, c), d && this.options.icon && (this._icoUrl = this.getIcon().getImageUrl(), this.fire(Gis.Objects.Base.NEED_REDRAW_EVENT.TYPE)), d
}, getOriginalType: function () {
    return"image"
}, getImageType: function () {
    return this.getIcon().getType()
}, getImageColor: function () {
    return this.getIcon().getColor()
}, isDraggable: function () {
    return this.options.draggable
}, getPopup: function () {
    return this.options.tooltip
}, initialize: function (a) {
    a.icon && (a.icon = Gis.icon(a.icon)), Gis.Objects.Selectable.prototype.initialize.call(this, a), this.options.icon = a.icon && Gis.icon(a.icon), this._icoUrl = this.options.icon.getImageUrl()
}, _isPredefinedType: function () {
    return Gis.Objects.ImageLabel.types.indexOf(this.options.icon.type) >= 0
}, _onDrag: function (a) {
    this._dragCalculate(a, !1)
}, _dragCalculate: function (a, b) {
    this._dragged = !0, this.options.latitude = a.latLng.latitude, this.options.longitude = a.latLng.longitude, this.fire("change", {target: this, rows: ["latitude", "longitude"], notFireToServer: !b})
}, _onDragEnd: function (a) {
    this._dragCalculate(a, !0)
}, onAdd: function (a) {
    Gis.Objects.Selectable.prototype.onAdd.call(this, a), this.on("drag", this._onDrag, this), this.on("dragend", this._onDragEnd, this), this.on("sizechange", this._onSizeChange, this)
}, onDelete: function (a) {
    Gis.Objects.Selectable.prototype.onDelete.call(this, a), this.off("drag", this._onDrag, this), this.off("dragend", this._onDragEnd, this), this.off("sizechange", this._onSizeChange, this), delete this._icoUrl
}, _onSizeChange: function (a) {
    this._width = a.width, this._height = a.height
}, getIcon: function () {
    return this.getOption("icon") && Gis.icon(this.getOption("icon"))
}, getIcoUrl: function () {
    return this._icoUrl || this.getIcon() && this.getIcon().getImageUrl()
}, draw: function (a) {
    var b, c, d;
    this.preDraw() && (Gis.Objects.Selectable.prototype.draw.call(this, a), Gis.Util.isNumeric(this.options.latitude) && Gis.Util.isNumeric(this.options.longitude) && (b = this.getIcon(), d = this.getOptionsWithStyle(), c = b.isRotatable() ? this.getOption("angle") : 0, this._lowLevelObject = a.drawMarker({latlng: [d.latitude, d.longitude], selectable: d.selectable && this.isThisEventable(), selected: this._selected, draggable: d.draggable && this.isThisEventable(), position: d.position, angle: c, popup: this.getOption("tooltip"), caption: this.getOption("caption"), captionPosition: d.captionPosition, gisClass: Gis.Config.imageLabelClass, className: d.className || "", icon: b, iconUrl: this.getIcoUrl(), events: {type: this.events, callback: this.fireEventsFromLowLevel, context: this}}, this._lowLevelObject)))
}, getLatLng: function () {
    return[this.options.latitude, this.options.longitude]
}, getCurrentLatLngBounds: function () {
    return this._lowLevelObject && this._lowLevelObject.marker ? this._map.getObjectBounds(this._lowLevelObject.marker) : void 0
}, getLatLngBounds: function () {
    return Gis.latLngBounds(this.getLatLng(), this.getLatLng())
}}), Gis.imageLabel = function (a) {
    return new Gis.Objects.ImageLabel(a)
}, Gis.ObjectFactory.list.image = Gis.Objects.ImageLabel, Gis.Objects.Overlay = Gis.Objects.Selectable.extend({events: "contextmenu dragend click dblclick keydown keypress keyup resize rotate", required: ["id", "image", "imageCoords", "geoCoords"], fixed: "id tacticObjectType", _savedLatLng: void 0, _customOpacity: void 0, _opacity: 1, _currentOpacity: 1, _scale: 1, _rotation: 0, _baseScale: 1, _baseRotation: 0, _startScale: 1, _startRotation: 0, options: {tacticObjectType: "overlay", id: void 0, image: void 0, imageCoords: void 0, draggable: void 0, transparency: void 0, geoCoords: void 0}, optionsFire: ["tacticObjectType", "id", "image", "tags", "imageCoords", "name", "customActions", "draggable", "transparency", "geoCoords"], isSelectable: function () {
    return this.options.draggable
}, _drawOpacity: function (a) {
    if (this.getLowLevelObject()) {
        var b = this.getLowLevelObject().overlay;
        b.image && b.image.setOpacity(a)
    }
}, setOpacity: function (a) {
    this._customOpacity = a, this.setTempOpacity(void 0), this._drawOpacity(a), this.fire(Gis.Objects.Base.LOCAL_CHANGE_EVENT.TYPE, new Gis.Objects.Base.LOCAL_CHANGE_EVENT(this))
}, setTempOpacity: function (a) {
    this._currentOpacity = a, Gis.Util.isDefine(this._currentOpacity) && (this._drawOpacity(a), this.fire(Gis.Objects.Base.LOCAL_CHANGE_EVENT.TYPE, new Gis.Objects.Base.LOCAL_CHANGE_EVENT(this)))
}, setData: function (a, b, c) {
    return this._changed = !0, Gis.Objects.Selectable.prototype.setData.call(this, a, b, c)
}, _updateImage: function (a) {
    var b = this;
    this._pic = this._pic || document.createElement("img"), this._pic.src !== a ? (this._pic.onload = function () {
        b.recalculateImage(!0), b.fire(Gis.Objects.Base.NEED_REDRAW_EVENT.TYPE, {target: b})
    }, this._pic.src = a) : b.recalculateImage(!0)
}, setImageSrc: function (a) {
    a.setProjection(this._map.getProjection()), this.options.image = a, this._updateImage(a.createImageUri()), this.fire("change", {target: this, rows: ["image"]})
}, initialize: function (a) {
    Gis.Objects.Selectable.prototype.initialize.call(this, a), this._lideStyle = Gis.lineStyle({color: "blue", dash: "dash"});
    var b = this;
    Gis.Util.loadKinetic(function () {
        b._layer = new Kinetic.Layer
    })
}, getCanvas: function () {
    return this._layer
}, getGeoPoint: function (a) {
    return this._map.getMapProvider().projectToZoom(Gis.latLng(this.options.geoCoords[a]), this._map.getMaxZoom())
}, calculateBaseZoomWidth: function () {
    var a = this._map.getMapProvider().map.options.crs, b = this._map.getMapProvider().projectToZoom(Gis.latLng(this.options.geoCoords[0]), this._map.getMaxZoom()), c = this._map.getMapProvider().projectToZoom(Gis.latLng(this.options.geoCoords[1]), this._map.getMaxZoom()), d = Gis.point(this.options.imageCoords[0]), e = Gis.point(this.options.imageCoords[1]);
    this._baseCoeff = c.distanceTo(b) / d.distanceTo(e) / a.scale(this._map.getMaxZoom())
}, _calculateCornerPoints: function () {
}, recalculateImage: function (a) {
    var b, c, d, e, f, g, h = this._map.getMapProvider().map.options.crs;
    a && this.calculateBaseZoomWidth(), a && (this._sWidth = this._pic.width, this._sHeight = this._pic.height, b = this.getGeoPoint(0), c = this.getGeoPoint(1), d = Gis.point(this.options.imageCoords[0]), e = Gis.point(this.options.imageCoords[1]), d = d.multiplyBy(b.distanceTo(c) / d.distanceTo(e)), f = Gis.point(b.x - d.x, b.y - d.y), g = f.add(Gis.point(this._sWidth * h.scale(this._map.getMaxZoom()) * this._baseCoeff, this._sHeight * h.scale(this._map.getMaxZoom()) * this._baseCoeff)), this._latlng = d.distanceTo(Gis.point(0, 0)) > 0 ? this._map.getMapProvider().unproject(f, this._map.getMaxZoom()) : Gis.latLng(this.options.geoCoords[0]), this._latlngBorromRight = e.distanceTo(Gis.point(this._sWidth, this._sHeight)) > 0 ? this._map.getMapProvider().unproject(g, this._map.getMaxZoom()) : Gis.latLng(this.options.geoCoords[1]), this.isMoved() || (this._latlngSrc = Gis.latLng(this._latlng.lat, this._latlng.lng), this._latlngBorromRightSrc = Gis.latLng(this._latlngBorromRight.lat, this._latlngBorromRight.lng))), f = this._map.getMapProvider().project(this._latlngSrc), g = this._map.getMapProvider().project(this._latlngBorromRightSrc), this._dWidth = Math.abs(f.x - g.x), this._dHeight = Math.abs(f.y - g.y)
}, _onNeedUpdateImage: function () {
    this.options.image.setProjection(this._map.getProjection()), this._updateImage(this.options.image.createImageUri())
}, onAdd: function (a) {
    Gis.Objects.Selectable.prototype.onAdd.call(this, a), this.setImageSrc(Gis.image(this.getOption("image"))), this.recalculateImage(!0), a.on("zoomend", this._onZoomEnd, this), this.on("dragend", this._onDragEnd, this), this.on("resize", this._onResize, this), this.on("rotate", this._onRotate, this)
}, onDelete: function (a) {
    this._map.off("zoomend", this._onZoomEnd, this), this.off("dragend", this._onDragEnd, this), this.off("resize", this._onResize, this), this.off("rotate", this._onRotate, this), Gis.Objects.Selectable.prototype.onDelete.call(this, a)
}, getScale: function () {
    return this._scale
}, getAngle: function () {
    return this._rotation
}, isDeformed: function () {
    return this._scale !== this._startScale || this._rotation !== this._startRotation
}, isScaleChanged: function () {
    return this._scale !== this._baseScale
}, isAngleChanged: function () {
    return this._rotation !== this._baseRotation
}, saveAngle: function () {
    this._baseRotation = this._rotation
}, saveScale: function () {
    this._baseScale = this._scale
}, resetAngle: function (a) {
    a && (this._baseRotation = this._startRotation), this._rotation = this._baseRotation
}, resetScale: function (a) {
    a && (this._baseScale = this._startScale), this._scale = this._baseScale
}, _onResize: function (a) {
    if (this._scale = a.scale, this._rotation = a.rotation, a && a.latlng) {
        var b = a && Gis.latLng(a.latlng.lat, a.latlng.lng);
        this.setTempLatlng(b)
    }
    this.recalculateImage(!0), this.fire(Gis.Objects.Base.LOCAL_CHANGE_EVENT.TYPE, new Gis.Objects.Base.LOCAL_CHANGE_EVENT(this))
}, _onRotate: function (a) {
    this._rotation = a.rotation, this.fire(Gis.Objects.Base.LOCAL_CHANGE_EVENT.TYPE, new Gis.Objects.Base.LOCAL_CHANGE_EVENT(this))
}, _onZoomEnd: function () {
    this.recalculateImage(), this.redraw()
}, setTempLatlng: function (a) {
    this._temp_latlng = a, this.fire(Gis.Objects.Base.LOCAL_CHANGE_EVENT.TYPE, new Gis.Objects.Base.LOCAL_CHANGE_EVENT(this))
}, getTempLatlng: function () {
    return this._temp_latlng && Gis.latLng(this._temp_latlng.lat, this._temp_latlng.lng)
}, getLatLngDelta: function () {
    var a, b;
    return this._temp_latlng ? (a = this.getNewCenter(), b = this.getOldCenter(), Gis.latLng(a.lat - b.lat, a.lng - b.lng)) : Gis.latLng(0, 0)
}, isMoved: function () {
    return this._temp_latlng || this._savedLatLng
}, getNewCenter: function () {
    var a, b;
    return this._temp_latlng && (b = this.getNewBounds()) ? (a = this._map.getMaxZoom(), this._map.getMapProvider().unproject(Gis.bounds(b[0], b[1]).getCenter(), a)) : null
}, getNewBounds: function () {
    var a, b, c, d, e, f;
    return this._temp_latlng ? (f = this._map.getMaxZoom(), a = this._map.getMapProvider().projectToZoom(this._latlngSrc, f), b = this._map.getMapProvider().projectToZoom(this._temp_latlng, f), c = b.subtract(a), d = this._map.getMapProvider().projectToZoom(Gis.latLng(this.options.geoCoords[0]), f), e = this._map.getMapProvider().projectToZoom(Gis.latLng(this.options.geoCoords[1]), f), [d.add(c), e.add(c)]) : null
}, getOldCenter: function () {
    var a, b, c;
    return c = this._map.getMaxZoom(), a = this._map.getMapProvider().projectToZoom(Gis.latLng(this.options.geoCoords[0]), c), b = this._map.getMapProvider().projectToZoom(Gis.latLng(this.options.geoCoords[1]), c), this._map.getMapProvider().unproject(Gis.bounds(a, b).getCenter(), c)
}, getUpdatedCenter: function () {
    if (this._savedLatLng) {
        var a, b, c;
        return c = this._map.getMaxZoom(), a = this._map.getMapProvider().projectToZoom(Gis.latLng(this._savedLatLng[0]), c), b = this._map.getMapProvider().projectToZoom(Gis.latLng(this._savedLatLng[1]), c), this._map.getMapProvider().unproject(Gis.bounds(a, b).getCenter(), c)
    }
}, fullSave: function (a, b) {
    var c = this.getTempLatlng() && this.saveTempLatlng(a, b);
    this.saveAngle(), this.saveScale(), this._currentOpacity = void 0, this._map.fire(Gis.Objects.Overlay.OVERLAY_CHANGED_EVENT.TYPE, new Gis.Objects.Overlay.OVERLAY_CHANGED_EVENT(this, c, this.getAngle(), this.getScale()))
}, saveTempLatlng: function (a, b) {
    var c;
    if (a) {
        c = this.getLatLngDelta();
        var d, e = this.getNewBounds();
        d = this._map.getMaxZoom(), this._savedLatLng = [this._map.getMapProvider().unproject(Gis.point(e[0]), d), this._map.getMapProvider().unproject(Gis.point(e[1]), d)], this._topLeftSaved = this._temp_latlng, this._temp_latlng = null
    } else this.setTempLatlng(null), this._savedLatLng = null, this._topLeftSaved = null, c = this.getLatLngDelta();
    return this.recalculateImage(!0), b || (this.redraw(), this.fire(Gis.Objects.Base.LOCAL_CHANGE_EVENT.TYPE, new Gis.Objects.Base.LOCAL_CHANGE_EVENT(this))), c
}, _onDragEnd: function (a) {
    var b = a && Gis.latLng(a.latLng.latitude, a.latLng.longitude);
    this.setTempLatlng(b)
}, _getLocalPosiiton: function (a, b) {
    return a = a || !b && this._temp_latlng, a && [a.lat, a.lng]
}, isCorrectOpacity: function (a) {
    return Gis.Util.isNumeric(a) && a >= 0 && 1 >= a
}, getOpacity: function (a) {
    var b = this._customOpacity, c = this.getOption("transparency");
    return a && this.isCorrectOpacity(this._currentOpacity) ? this._currentOpacity : this.isCorrectOpacity(b) ? b : this.isCorrectOpacity(c) ? c : this._opacity
}, preDraw: function () {
    return Gis.Objects.Selectable.prototype.preDraw.call(this) && this._layer
}, draw: function (a) {
    if (this.preDraw()) {
        this._changed && (this._changed = !1, this._updateImage(Gis.image(this.getOption("image")).createImageUri()), this.recalculateImage(!0));
        var b = [this._latlng.lat, this._latlng.lng], c = this._getLocalPosiiton(), d = c || this._topLeftSaved || b;
        this._lowLevelObject = this._lowLevelObject || {inset: !0}, this._lowLevelObject.overlay = a.drawOverlay({opacity: this._currentOpacity || this.getOpacity(), layer: this._layer, selected: this._selected, draggable: this.getOption("draggable") && this._map.isFilterable(this.getType()), imageData: {latlng: d, latlngBottomRight: d, image: this._pic, sWidth: this._sWidth, clearDrag: !0, rotation: this.getAngle(), scale: this.getScale(), sHeight: this._sHeight, dWidth: this._dWidth, dHeight: this._dHeight}, events: {type: this.events, callback: this.fireEventsFromLowLevel, context: this}}, this._lowLevelObject.overlay)
    }
}, getLatLng: function () {
    return this.getNewCenter() || this.getUpdatedCenter() || this.getOldCenter()
}, getLatLngBounds: function () {
    return Gis.latLngBounds(this._latlng, this._latlngBorromRight)
}}), Gis.Overlay = Gis.Objects.Overlay, Gis.overlay = function (a) {
    return new Gis.Overlay(a)
}, Gis.Objects.Overlay.RESIZE_EVENT = function () {
    this.type = Gis.Objects.Overlay.RESIZE_EVENT.TYPE
}, Gis.Objects.Overlay.RESIZE_EVENT.TYPE = "resize", Gis.Objects.Overlay.OVERLAY_CHANGED_EVENT = function (a, b, c, d) {
    var e = a._topLeftSaved || a._latlngSrc, f = a._dWidth * d, g = a._dHeight * d, h = Gis.Map.CURRENT_MAP, i = h.latLngToLayerPoint(e).add(Gis.point(f / 2, g / 2));
    Gis.Util.extend(this, {target: a, delta: b, angle: c, scale: d}), this.srcBounds = Gis.latLngBounds(a._latlngSrc, a._latlngBorromRightSrc), this.topLeftTarget = h.layerPointToLatLng(i.add(Gis.Util.rotate(Gis.point(-f / 2, -g / 2), -c))), this.topRightTarget = h.layerPointToLatLng(i.add(Gis.Util.rotate(Gis.point(f / 2, -g / 2), -c))), this.bottomRightTarget = h.layerPointToLatLng(i.add(Gis.Util.rotate(Gis.point(f / 2, g / 2), -c))), this.bottomLeftTarget = h.layerPointToLatLng(i.add(Gis.Util.rotate(Gis.point(-f / 2, g / 2), -c))), this.geoCoords = [
        {old: {lat: this.srcBounds.getNorthWest().lat, lon: this.srcBounds.getNorthWest().lng}, "new": {lat: this.topLeftTarget.lat, lon: this.topLeftTarget.lng}},
        {old: {lat: this.srcBounds.getNorthEast().lat, lon: this.srcBounds.getNorthEast().lng}, "new": {lat: this.topRightTarget.lat, lon: this.topRightTarget.lng}},
        {old: {lat: this.srcBounds.getSouthEast().lat, lon: this.srcBounds.getSouthEast().lng}, "new": {lat: this.bottomRightTarget.lat, lon: this.bottomRightTarget.lng}},
        {old: {lat: this.srcBounds.getSouthWest().lat, lon: this.srcBounds.getSouthWest().lng}, "new": {lat: this.bottomLeftTarget.lat, lon: this.bottomLeftTarget.lng}}
    ], this.type = Gis.Objects.Overlay.OVERLAY_CHANGED_EVENT.TYPE
}, Gis.Objects.Overlay.OVERLAY_CHANGED_EVENT.TYPE = "overlaychanged", Gis.Objects.Overlay.ROTATE_EVENT = function () {
    this.type = Gis.Objects.Overlay.ROTATE_EVENT.TYPE
}, Gis.Objects.Overlay.ROTATE_EVENT.TYPE = "rotate", Gis.ObjectFactory.list.overlay = Gis.Objects.Overlay, Gis.Objects.PathPoint = Gis.Objects.ImageLabel.extend({events: Gis.Core.Events.availableDomEvents, required: ["id", "latitude", "longitude"], fixed: "id tacticObjectType", _isCountable: !1, options: {tacticObjectType: "point", simplify: null}, optionsFire: ["tacticObjectType", "id", "tags", "latitude", "longitude", "icon", "caption", "customActions", "tooltip"], _detachFromPrevious: function () {
    this._prevPoint && (this._prevPoint.off("change delete", this._previousEvent, this), this._prevPoint = null)
}, _previousEvent: function (a) {
    switch (a.type) {
        case"remove":
            this._detachFromPrevious(), this.simplifyPoint(), this.fire("change");
            break;
        case"change":
            this.simplifyPoint(), this.fire("change")
    }
}, simplifyPoint: function () {
    if (this.options.simplify && this._parent) {
        var a, b, c = this._parent.getPoints()[this.getIndex() - 1];
        c && (this._prevPoint && c === this._prevPoint || (this._detachFromPrevious(), this._prevPoint = c, this._prevPoint.on("change delete", this._previousEvent, this)), a = Gis.latLng(c.getLatLng()), b = Gis.latLng(this.options.latitude, this.options.longitude), b = Gis.Projection.getNextBearingPointSimplifiedLongitude(a, b), this._parent.isOrthodrome() && (b = Gis.Projection.calculateNextBearingPoint(a, b)), this.options.longitude = b.lng, this.options.latitude = b.lat)
    }
}, setData: function (a, b, c) {
    var d = Gis.Objects.ImageLabel.prototype.setData.apply(this, arguments);
    return d && (this.simplifyPoint(), !c && this._map && this._map.getLayer(this.options.parentId) && (d.indexOf("latitude") > -1 || d.indexOf("longitude") > -1) && this._map.getLayer(this.options.parentId).fire("change", {rows: ["points"]})), d
}, _dragCalculate: function (a, b) {
    this._dragged = !0, this.options.latitude = a.latLng.latitude, this.options.longitude = a.latLng.longitude, this.simplifyPoint(), this.fire("change", {target: this, rows: ["latitude", "longitude"], notFireToServer: !b})
}, initialize: function (a) {
    a.id = a.id || Gis.Util.generateGUID(), Gis.Objects.Selectable.prototype.initialize.call(this, a), a.icon && (this.options.icon = a.icon && Gis.icon(a.icon), this._icoUrl = this.options.icon.getImageUrl())
}, _getParentIcon: function () {
    var a = this._map && this.options.parentId && this._map.getLayer(this.options.parentId).getParams().icon;
    return this._parentIcon = this._parentIcon || a && a.clone(), this._parentIcon
}, getIcon: function () {
    return Gis.Objects.ImageLabel.prototype.getIcon.call(this) || this._getParentIcon()
}, preDraw: function () {
    return Gis.Objects.ImageLabel.prototype.preDraw.apply(this, arguments) && this.getIcon()
}, hideFromMap: function () {
    this._map && (this._map.removeLayer(this), this._lowLevelObject = null)
}, draw: function () {
    if (!this.getIcon())return void this.hideFromMap();
    try {
        Gis.Objects.ImageLabel.prototype.draw.apply(this, arguments)
    } catch (a) {
        console.log(a.stack)
    }
}, onAdd: function () {
    Gis.Objects.ImageLabel.prototype.onAdd.apply(this, arguments), this._parent = this._map.getLayer(this.options.parentId), this.simplifyPoint(), this._parent.on("change", this._parentChange, this)
}, onDelete: function () {
    this._detachFromPrevious(), this._parent.off("change", this._parentChange, this), delete this._parent, Gis.Objects.ImageLabel.prototype.onDelete.apply(this, arguments)
}, preAdd: function (a) {
    return this._parent = a.getLayer(this.options.parentId), this._parent
}, _parentChange: function (a) {
    a.rows && (a.rows.indexOf("icon") > -1 ? (this._parentIcon = void 0, this.fire("change", {notFireToServer: a.notFireToServer})) : a.rows.indexOf("points") > -1 && (this.simplifyPoint(), this.fire("change", {notFireToServer: a.notFireToServer})))
}, setIndex: function (a) {
    this.index = a
}, getIndex: function () {
    return this.index
}, getOriginalType: function () {
    return"point"
}}), Gis.pathPoint = function (a) {
    return a.getType && "point" === a.getType() ? a : new Gis.Objects.PathPoint(a)
}, Gis.ObjectFactory.list.point = Gis.Objects.PathPoint, Gis.Objects.Path = Gis.Objects.Polyline.extend({_isCached: !0, events: Gis.Core.Events.availableDomEvents, fixed: "id tacticObjectType", required: ["id", "points"], options: {tacticObjectType: "path", id: void 0, isCycle: !1, orthodrome: void 0}, optionsFire: ["tacticObjectType", "id", "points", "line", "isCycle", "tags", "icon", "selectable", "draggable", "name", "caption", "customActions", "tooltip"], getColor: function (a) {
    return Gis.lineStyle(a ? this.options.line : this.getOption("line")).getColor()
}, _drawPointMarker: function (a) {
    var b, c, d, e;
    d = this.getMarkersArray()[a], d && (b = d.isSelected(), e = {draggable: this.getOption("draggable") && this._iconDraggable && this.isThisEventable(), selectable: this.getOption("selectable") && this._iconSelectable && this.isThisEventable()}, d.setSelected(this._selected && this._selectedAdditional && this._selectedAdditional.markerKey === a), c = d.setData(e), this._map.hasLayer(d) ? c || b === d.isSelected() || d.fire("change") : (d.addTo(this._map), d.on(this._markerEvents, this._markerEvent, d)))
}, getOrthodromeArray: function (a) {
    return this._getLatLngArray(this.getLatitudes(), this.getLongitudes(), this.getOptionsWithStyle().orthodrome, a)
}, draw: function (a) {
    var b;
    a && this.preDraw() && (this._latLngDraw = void 0, this.getOption("points") && this.getOption("points").length ? (this._lowLevelObject = this._lowLevelObject || {inset: !0}, b = this.getOptionsWithStyle(), this._lowLevelObject.line = a.drawPolyline(Gis.Util.extend({}, b, {latlng: this.getOrthodromeArray(), drawIcon: !1, line: this.getLineStyle(), draggable: b.draggable && this.isThisEventable(), selectable: b.selectable && this.isThisEventable(), events: {type: this.events, callback: this.fireEventsFromLowLevel, context: this}}), this._lowLevelObject && this._lowLevelObject.line), Gis.Objects.Polyline.prototype.draw.call(this, a)) : this._lowLevelObject && a.removeLayer(this._lowLevelObject))
}}), Gis.Objects.Path.CoordinateTypeFull = 1, Gis.Objects.Path.CoordinateTypeLatitudes = 2, Gis.Objects.Path.CoordinateTypeLongitudes = 3, Gis.path = function (a) {
    return new Gis.Objects.Path(a)
}, Gis.ObjectFactory.list.path = Gis.Objects.Path, Gis.Objects.Polygon = Gis.Objects.Polyline.extend({_isCached: !0, events: Gis.Core.Events.availableDomEvents, fixed: "id tacticObjectType", required: ["id", "points"], _cycled: !0, options: {tacticObjectType: "polygon", id: void 0, fill: void 0}, optionsFire: ["tacticObjectType", "id", "points", "icon", "fill", "line", "selectable", "tags", "name", "caption", "tooltip", "customActions", "draggable"], getColor: function (a) {
    return Gis.fillStyle(a ? this.options.fill : this.getOption("fill")).getColor()
}, getLineColor: function (a) {
    return Gis.lineStyle(a ? this.options.line : this.getOption("line")).getColor()
}, setData: function (a, b, c) {
    return b = this._fillOption(a, b, "fill", Gis.fillStyle), Gis.Objects.Polyline.prototype.setData.call(this, a, b, c)
}, initialize: function (a) {
    this._fillOption(a, null, "icon", Gis.icon), a.fill = Gis.fillStyle(a.fill || {color: Gis.Color.DEFAULT}), Gis.Objects.Polyline.prototype.initialize.call(this, a)
}, draw: function (a) {
    var b;
    a && this.preDraw() && (this._latLngDraw = void 0, b = this.getOptionsWithStyle(), b.points && b.points.length ? (this._lowLevelObject = this._lowLevelObject || {inset: !0}, this._lowLevelObject.line = a.drawPolygon(Gis.Util.extend({}, b, {latlng: this._getLatLngArray(), line: this.getLineStyle(), fill: Gis.fillStyle(this.getOption("fill")), draggable: b.draggable && this.isThisEventable(), selectable: b.selectable && this.isThisEventable(), events: {type: this.events, callback: this.fireEventsFromLowLevel, context: this}}), this._lowLevelObject && this._lowLevelObject.line), Gis.Objects.Polyline.prototype.draw.call(this, a)) : this._lowLevelObject && a.removeLayer(this._lowLevelObject))
}}), Gis.polygon = function (a) {
    return new Gis.Objects.Polygon(a)
}, Gis.ObjectFactory.list.polygon = Gis.Objects.Polygon, Gis.Objects.Polygon.generateSquareLatLng = function (a, b, c, d) {
    function e(a, b) {
        return f = a && a.getParams().id || null, Gis.pathPoint(Gis.extend({}, f && {id: f} || {}, b))
    }

    var f, g = [];
    return d ? {latitudes: [a.latitude, b.latitude, b.latitude, a.latitude], longitudes: [a.longitude, a.longitude, b.longitude, b.longitude]} : (c = c || [], g[0] = e(c[0], a), g[1] = e(c[1], {latitude: a.latitude, longitude: b.longitude}), g[2] = e(c[2], b), g[3] = e(c[3], {latitude: b.latitude, longitude: a.longitude}), g)
}, function () {
    "use strict";
    Gis.Objects.GeoPath = Gis.Objects.Path.extend({_isControllableByServer: Gis.NETWORK_LOCAL, required: ["id"], options: {routing: null, path: null, tacticObjectType: "geo-path"}, initialize: function () {
        Gis.Objects.Path.prototype.initialize.apply(this, arguments), this.options.path && (this.options.path._current_route && this.options.path._current_route.route && this.options.path._current_route.route.on("click", function (a) {
            this.fire("click", a)
        }, this), this.options.path.saved = !0, this.options.path.route = this.options.routing)
    }, getLatLngArray: function () {
        var a;
        if (this.options.routing) {
            a = [];
            for (var b = 0, c = this.options.routing.length; c > b; b += 1)a.push(Gis.latLng(this.options.routing[b].lat, this.options.routing[b].lng))
        }
        return a
    }, setData: function () {
        Gis.Objects.Path.prototype.setData.apply(this, arguments), this.options.path && (this.options.path.route = this.options.routing)
    }, draw: function () {
    }, getColor: function () {
        return this.options.path._current_route_style.color
    }, onDelete: function () {
        this.options.path.reset(), Gis.Objects.Path.prototype.onDelete.apply(this, arguments)
    }, getCenter: function () {
        var a = this.getLatLngBounds().getCenter();
        return Gis.latLng(a.lat, a.lng)
    }, getRouting: function () {
        return this.options.routing.slice()
    }, getPath: function () {
        return this.options.path
    }, getLatLngBounds: function () {
        for (var a = Gis.latLngBounds(this.options.routing[0], this.options.routing[1]), b = 2, c = this.options.routing.length; c > b; b += 1)a.extend(this.options.routing[b]);
        return a
    }}), Gis.geoPath = function (a) {
        return new Gis.Objects.GeoPath(a)
    }, Gis.ObjectFactory.list.geoPath = Gis.Objects.GeoPath, Gis.ObjectFactory.list["geo-path"] = Gis.Objects.GeoPath
}(), Gis.Objects.Ellipse = Gis.Objects.Selectable.extend({_isCached: !0, events: Gis.Core.Events.availableDomEvents, required: ["id", "latitude", "longitude", "alpha", "betta", "gamma"], options: {tacticObjectType: "ellipse", id: void 0, latitude: 0, longitude: 0, draggable: void 0, line: void 0, fill: void 0, alpha: void 0, betta: void 0, gamma: void 0}, optionsFire: ["tacticObjectType", "id", "latitude", "longitude", "tags", "draggable", "selectable", "line", "fill", "alpha", "betta", "gamma", "name", "caption", "customActions", "tooltip"], isDraggable: function () {
    return this.getOption("draggable")
}, getAlpha: function () {
    return this.getOption("alpha")
}, getBetta: function () {
    return this.getOption("betta")
}, getGamma: function () {
    return this.getOption("gamma")
}, getColor: function (a) {
    return Gis.fillStyle(a ? this.options.fill : this.getOption("fill")).getColor()
}, initialize: function (a) {
    Gis.Objects.Selectable.prototype.initialize.call(this, a), this.getOption.line = Gis.lineStyle(a.line || {color: "#0033ff"}), this.options.fill = Gis.fillStyle(a.fill || {color: Gis.Color.DEFAULT})
}, _dragCalculate: function (a, b) {
    this._dragged = !0, this.options.latitude = a.latLng.latitude, this.options.longitude = a.latLng.longitude, this.fire("change", {target: this, rows: ["latitude", "longitude"], notFireToServer: !b})
}, _onDrag: function (a) {
    this._dragCalculate(a, !1)
}, _onDragEnd: function (a) {
    this._dragCalculate(a, !0)
}, onAdd: function (a) {
    Gis.Objects.Selectable.prototype.onAdd.call(this, a), this.on("drag", this._onDrag, this), this.on("dragend", this._onDragEnd, this)
}, onDelete: function () {
    Gis.Objects.Selectable.prototype.onDelete.apply(this, arguments), this.off("drag", this._onDrag, this), this.off("dragend", this._onDragEnd, this)
}, draw: function (a) {
    var b;
    a && this.preDraw() && this.options.latitude && this.options.longitude && (b = this.getOptionsWithStyle(), Gis.Objects.Selectable.prototype.draw.call(this, a), this._lowLevelObject = a.drawEllipse({latlng: this.getLatLng(), alpha: b.alpha, betta: b.betta, gamma: b.gamma, line: this.getLineStyle(), caption: b.caption, tooltip: b.tooltip, fill: Gis.fillStyle(b.fill), selectable: b.selectable && this.isThisEventable(), draggable: b.draggable && this.isThisEventable(), events: {type: this.events, callback: this.fireEventsFromLowLevel, context: this}}, this._lowLevelObject))
}, getLatLng: function () {
    return[parseFloat(this.getOption("latitude")), parseFloat(this.getOption("longitude"))]
}, getLatLngBounds: function () {
    var a, b, c, d, e = this.getLatLng(), f = this.getOption("alpha");
    return a = Gis.Projection.nextPointByLen(f, e, 0), b = Gis.Projection.nextPointByLen(f, e, 180), c = Gis.Projection.nextPointByLen(f, e, -90), d = Gis.Projection.nextPointByLen(f, e, 90), Gis.latLngBounds(Gis.latLng(b[0], c[1]), Gis.latLng(a[0], d[1]))
}}), Gis.ellipse = function (a) {
    return new Gis.Objects.Ellipse(a)
}, Gis.ObjectFactory.list.ellipse = Gis.Objects.Ellipse, Gis.Objects.Sector = Gis.Objects.Selectable.extend({_isCached: !0, events: Gis.Core.Events.availableDomEvents, fixed: "id tacticObjectType", required: ["id", "latitude", "longitude", "startAngle", "finishAngle", "radius"], options: {tacticObjectType: "sector", id: void 0, latitude: void 0, longitude: void 0, startAngle: void 0, finishAngle: void 0, radius: void 0, innerRadius: 0, line: void 0, fill: void 0, selectable: void 0, draggable: void 0}, optionsFire: ["tacticObjectType", "id", "tags", "latitude", "longitude", "startAngle", "finishAngle", "radius", "innerRadius", "line", "fill", "selectable", "draggable", "name", "caption", "customActions", "tooltip"], isDraggable: function () {
    return this.getOption("draggable")
}, getRadius: function () {
    return this.getOption("radius")
}, getColor: function (a) {
    return Gis.fillStyle(a ? this.options.fill : this.getOption("fill")).getColor()
}, getInnerRadius: function () {
    var a = this.getOptionsWithStyle();
    return a.innerRadius > a.radius ? a.radius - 1 : a.innerRadius
}, getStartAngle: function () {
    return this.getOption("startAngle") % 360
}, getFinishAngle: function () {
    var a = this.getOption("finishAngle") % 360;
    return a >= 0 ? a : 360 + a
}, initialize: function (a) {
    Gis.Objects.Selectable.prototype.initialize.call(this, a), this.options.line = Gis.lineStyle(a.line || {color: "#0033ff"}), this.options.fill = Gis.fillStyle(a.fill || {color: Gis.Color.DEFAULT})
}, onAdd: function (a) {
    Gis.Objects.Selectable.prototype.onAdd.call(this, a), this.on("drag", this._onDrag, this), this.on("dragend", this._onDragEnd, this)
}, onDelete: function (a) {
    Gis.Objects.Selectable.prototype.onDelete.call(this, a), this.off("drag", this._onDrag, this), this.off("dragend", this._onDragEnd, this)
}, draw: function (a) {
    if (a && this.preDraw()) {
        var b = this.getOptionsWithStyle();
        b.latitude && b.longitude && (Gis.Objects.Selectable.prototype.draw.call(this, a), this._lowLevelObject = a.drawSector(Gis.Util.extend({}, b, {latlng: this.getLatLng(), line: this.getLineStyle(), fill: Gis.fillStyle(this.getOption("fill")), startAngle: this.getStartAngle(), finishAngle: this.getFinishAngle(), draggable: b.draggable && this.isThisEventable(), selectable: b.selectable && this.isThisEventable(), events: {type: this.events, callback: this.fireEventsFromLowLevel, context: this}}), this._lowLevelObject))
    }
}, _dragCalculate: function (a, b) {
    this._dragged = !0, this.options.latitude = a.latLng.latitude, this.options.longitude = a.latLng.longitude, this.fire("change", {target: this, rows: ["latitude", "longitude"], notFireToServer: !b})
}, _onDrag: function (a) {
    this._dragCalculate(a, !1)
}, _onDragEnd: function (a) {
    this._dragCalculate(a, !0)
}, getLatLng: function () {
    return[parseFloat(this.getOption("latitude")), parseFloat(this.getOption("longitude"))]
}, getLatLngBounds: function () {
    var a, b, c, d, e = this.getLatLng(), f = this.options.radius;
    return a = Gis.Projection.nextPointByLen(f, e, 0), b = Gis.Projection.nextPointByLen(f, e, 180), c = Gis.Projection.nextPointByLen(f, e, -90), d = Gis.Projection.nextPointByLen(f, e, 90), Gis.latLngBounds(Gis.latLng(b[0], c[1]), Gis.latLng(a[0], d[1]))
}}), Gis.sector = function (a) {
    return new Gis.Objects.Sector(a)
}, Gis.ObjectFactory.list.sector = Gis.Objects.Sector, Gis.Objects.TextLabel = Gis.Objects.Selectable.extend({events: Gis.Core.Events.availableDomEvents, required: ["id", "latitude", "longitude", "caption"], fixed: "id tacticObjectType", options: {tacticObjectType: "text", id: void 0, latitude: void 0, longitude: void 0, selectable: void 0, draggable: void 0, foreColor: "#FFFFFF", backColor: "#AB1D4A", position: "centerright", className: void 0, drawPoint: !0}, optionsFire: ["tacticObjectType", "id", "latitude", "longitude", "caption", "tags", "selectable", "draggable", "foreColor", "backColor", "name", "caption", "customActions", "tooltip"], getText: function () {
    return this.getOption("caption")
}, getBackColor: function (a) {
    return a ? this.options.backColor : this.getOption("backColor")
}, isDraggable: function () {
    return this.getOption("draggable")
}, onAdd: function (a) {
    Gis.Objects.Selectable.prototype.onAdd.call(this, a), this.on("drag", this._onDrag, this), this.on("dragend", this._onDragEnd, this)
}, _removePoint: function () {
    this._point && (this._point.off("drag", this._pointDrag, this), this._point.off("dragend", this._pointDrag, this), this._map.getLayer(this._point.getId()) && this._map.removeLayer(this._point))
}, onDelete: function (a) {
    this._removePoint(), this.off("drag", this._onDrag, this), this.off("dragend", this._onDragEnd, this), Gis.Objects.Selectable.prototype.onDelete.call(this, a)
}, _dragCalculate: function (a, b) {
    this._dragged = !0, this.options.latitude = a.latLng.latitude, this.options.longitude = a.latLng.longitude, this.fire("change", {target: this, rows: ["latitude", "longitude"], notFireToServer: !b})
}, _onDrag: function (a) {
    this._dragCalculate(a, !1)
}, _onDragEnd: function (a) {
    this._dragCalculate(a, !0)
}, _pointDrag: function () {
    this.setData({latitude: this._point.getLatLng()[0], longitude: this._point.getLatLng()[1]})
}, _pointSelected: function (a) {
    var b = a.layer;
    b === this._point && this._map.setSelected(this)
}, _addPoint: function () {
    var a = Gis.Util.extend({}, this.options, this.getStyle());
    this._point ? this._point.setData({latitude: a.latitude, longitude: a.longitude, draggable: a.draggable && this.isThisEventable(), selectable: !1, icon: {type: "circle", width: 10, color: this.getBackColor()}}) : (this._point = Gis.imageLabel({id: Gis.Util.generateGUID(), tacticObjectType: this.getType(), latitude: a.latitude, longitude: a.longitude, draggable: a.draggable && this.isThisEventable(), selectable: a.selectable && this.isThisEventable(), icon: {type: "circle", width: 10, color: this.getBackColor()}}), this._point.setCountable(!1), this._point.setControllableByServer(!1), this._point.on("drag", this._pointDrag, this), this._point.on("dragend", this._pointDrag, this)), this._map.getLayer(this._point.getId()) || this._point.addTo(this._map)
}, getName: function () {
    return Gis.Objects.Selectable.prototype.getName.call(this) || this.getOption("caption")
}, draw: function (a) {
    if (this.preDraw() && Gis.Util.isNumeric(this.options.latitude) && Gis.Util.isNumeric(this.options.longitude)) {
        Gis.Objects.Selectable.prototype.draw.call(this, a);
        var b = this.getOptionsWithStyle();
        this._lowLevelObject = a.drawText(Gis.Util.extend({}, b, {latlng: this.getLatLng(), draggable: b.draggable && this.isThisEventable(), selectable: b.selectable && this.isThisEventable(), popup: b.tooltip, selected: this._selected, events: {type: this.events, callback: this.fireEventsFromLowLevel, context: this}}), this._lowLevelObject), this.options.drawPoint ? this._addPoint() : this._removePoint()
    }
}, getCurrentLatLngBounds: function () {
    return this._map.getObjectBounds(this._lowLevelObject.label)
}, getLatLng: function () {
    return[parseFloat(this.options.latitude), parseFloat(this.options.longitude)]
}}), Gis.textLabel = function (a) {
    return new Gis.Objects.TextLabel(a)
}, Gis.ObjectFactory.list.text = Gis.Objects.TextLabel, Gis.Objects.TrackedBase = Gis.Objects.Base.extend({events: "contextmenu", intervalTime: 500, _fullPath: !1, _isMetaData: !0, _points: void 0, required: ["id", "name", "icon"], fixed: "id tacticObjectType", _position: "center", options: {id: void 0, icon: void 0, trackStyle: void 0, trackBehavior: void 0}, initialize: function (a) {
    this._pathBehavior = new Gis.DrawPathBehavior(this), this._fillOption(a, null, "icon", Gis.icon), this._fillOption(a, null, "trackStyle", Gis.lineStyle), a && (a.trackBehavior = Gis.trackBehavior(a.trackBehavior || {})), this._points = {position: new Gis.Objects.PathData, bearing: new Gis.Objects.PathData}, Gis.Objects.Base.prototype.initialize.call(this, a)
}, getAngle: function () {
    return this.options.icon && this.options.icon.isRotatable() && this._currentPosition.getCourse() || 0
}, clearMeta: function () {
    return this._hideArtifact(), this._currentPosition = null, this.clearPoints(), this.fire("clearmeta"), this
}, clearPoints: function () {
    var a, b = this._map, c = this, d = function (a) {
        this.remove(a), b && b.removeLayer(a), c._mapRender && c._mapRender.removeLayer(a)
    };
    for (var e in this._points)this._points.hasOwnProperty(e) && (a = this._points[e], a.each(d, a))
}, _recalculatePoints: function (a, b) {
    return this._lastPoints = this._pathBehavior.getPathPoints(a, b), this._lastPoints
}, _hideArtifact: function (a) {
    this._pointForDraw && this._pointForDraw.closeArtifacts(a)
}, drawArtifacts: function (a, b) {
    var c = this._pathBehavior.getCurrentPosition(b);
    this._pointForDraw !== c && (this._hideArtifact(a), c && (this._pointForDraw = c, this._pointForDraw.drawArtifacts(a)))
}, initAutoUpdate: function (a, b) {
    var c = Gis.bearingBehavior(this.getOption("bearingBehavior")), d = b && !!c.gerBearingShowTimeSeconds();
    a > 1 && Gis.trackBehavior(this.getOption("trackBehavior")).getTraceLengthSeconds() || b && b > Gis.Additional.BearingBehavior.ALWAYS_SHOW_COUNT && d ? this.fire("needupdate", {layer: this}) : this.fire("noneedupdate", {layer: this})
}, onAdd: function (a) {
    Gis.Objects.Base.prototype.onAdd.call(this, a), this.on("attach", this._attached, this), this.on("hided", this.clearMeta, this)
}, onDelete: function (a) {
    Gis.Objects.Base.prototype.onDelete.call(this, a), this.off("attach", this._attached, this), this.off("hided", this.clearMeta, this)
}, _attached: function (a) {
    var b, c = a.to;
    if (!c || !c.getLatLng)throw new Error("Not correct child");
    b = this._points[c.getType()], b.add(c), "position" === c.getType() && (!this._currentPosition || this._currentPosition.getTimeStamp() <= c.getTimeStamp()) && (this._currentPosition = c), this.fire("change", {target: this})
}, getLatLng: function () {
    return this._currentPosition ? this._currentPosition.getLatLng() : void 0
}}), function () {
    "use strict";
    Gis.DrawPathBehavior = Gis.Class.extend({initialize: function (a) {
        this._object = a
    }, checkPointsVisible: function (a, b) {
        var c, d, e = this._object, f = e._points.position, g = [];
        if (a)for (c = 0, d = a.length; d > c; c += 1)b.isObjectVisible(f.getPoint(c)) && g.push(a[c]);
        return g
    }, getPathPoints: function (a, b) {
        return this.checkPointsVisible(this._object._points.position.getSorted(Gis.trackBehavior(this._object._selfDraw.track ? a.trackBehavior : {traceLengthMeters: .1})), b)
    }, drawMarker: function (a, b, c) {
        var d, e = this._object, f = this.getCurrentPosition(c), g = f.getCaption() || b.caption, h = f.getToolTip() || b.tooltip;
        return!c || c.isObjectVisible(f) ? d = a.drawMarker(Gis.Util.extend({}, b, {latlng: f.getLatLng(), caption: g, popup: h, draggable: !1, selectable: !1, position: e._position, angle: e.getAngle(), className: e._className, events: {type: e.events, callback: e.fireEventsFromLowLevel, context: e}}), e._lowLevelObject && e._lowLevelObject.marker) : e._lowLevelObject && e._lowLevelObject.marker && a.removeLayer(e._lowLevelObject.marker), d
    }, getCurrentPosition: function (a) {
        var b, c, d = this._object, e = d._points.position;
        if (d._currentPosition && a.isObjectVisible(d._currentPosition))return d._currentPosition;
        if (this._lastPoints)for (b = d._lastPoints.length; b--;)if (c = e.getPoint(b), a.isObjectVisible(e.getPoint(b)))return c
    }, drawPath: function (a, b) {
        var c, d = this._object;
        return a.trackStyle ? c = b.drawPolyline(Gis.Util.extend({}, {latlng: d._lastPoints, line: a.trackStyle, smoothFactor: a.trackStyle && a.trackStyle.getSmoothFactor() || d.defaultSmoothFactor, icon: null}), d._lowLevelObject && d._lowLevelObject.path) : d._lowLevelObject && d._lowLevelObject.path && b.removeLayer(d._lowLevelObject.path), c
    }})
}(), function () {
    "use strict";
    var a = "_position";
    Gis.Objects.Position = Gis.Objects.Base.extend({required: ["parentId", "timeStamp", "latitude", "longitude"], fixed: "parentId tacticObjectType", lastShowedStamp: void 0, _id: Gis.Util.generateGUID(), options: {tacticObjectType: "position", parentId: void 0, timeStamp: void 0, latitude: void 0, longitude: void 0, course: void 0, artifacts: void 0}, optionsFire: ["tacticObjectType", "id", "latitude", "longitude", "parentId", "course", "tags", "caption", "tooltip", "artifacts"], initialize: function (a) {
        this._id = Gis.Util.generateGUID(), Gis.Objects.Base.prototype.initialize.call(this, a)
    }, getLayers: function () {
        return Gis.Objects.Base.prototype.getLayers.call(this) || this._parent && this._parent.getLayers()
    }, setData: function (a) {
        return this.clearPositions(), a && (a.artifacts || "artifacts" === a) && this.closeArtifacts(), Gis.Objects.Base.prototype.setData.apply(this, arguments)
    }, getCourse: function () {
        return this.getOption("course")
    }, getArtifacts: function () {
        return this.getOption("artifacts")
    }, drawArtifacts: function () {
        var a = this.options.artifacts, b = this;
        a && a.length && a.forEach(function (a, c) {
            a.tacticObjectType && (a = Gis.ObjectFactory.createObject(Gis.Util.extend(a, {draggable: !1, selectable: !1})), b.options.artifacts[c] = a), b._map.hasLayer(a) || (a.setControllableByServer(!1), a.setData({draggable: !1, selectable: !1})), a.addTo(b._map)
        })
    }, closeArtifacts: function (a) {
        if (a = this._map || Gis.Map.CURRENT_MAP) {
            var b = this.options.artifacts;
            b && b.length && (b.forEach(function (b) {
                b.draw && a.removeLayer(b)
            }), delete this.options.artifacts)
        }
    }, getLastShowedTime: function (a, b) {
        return this.lastShowedStamp = this.lastShowedStamp || this.calculateNextStamp(a, b), this.lastShowedStamp
    }, setLastShowedTime: function (a) {
        return this.lastShowedStamp = a, this
    }, calculateNextStamp: function (a, b) {
        var c = (new Date).getTime() / 1e3;
        return b ? a ? a.getTimeStamp() + (a.getTimeStamp() - b.getTimeStamp()) / 2 : b.getTimeStamp() : c
    }, getParentId: function () {
        return this.options.parentId
    }, onAdd: function (a) {
        this._parent = a.getLayer(this.options.parentId), this._parent || console.error("Parent with id =" + this.options.parentId + " not found in object controller"), Gis.Objects.Base.prototype.onAdd.call(this, a), this._parent.on("remove hided clearmeta", this.onClosePoint, this), this._parent.on("hided", this.closeArtifacts, this), this._parent.fire("attach", {to: this})
    }, clearPositions: function () {
        this._latLng = void 0, this._latLngObject = void 0, this._distanceTo = void 0
    }, onDelete: function (a) {
        this._parent && (this._parent.off("remove hided clearmeta", this.onClosePoint, this), this._parent.off("hided", this.closeArtifacts, this)), this.clearPositions(), this.closeArtifacts(), Gis.Objects.Base.prototype.onDelete.call(this, a), this.pushToCache()
    }, preAdd: function (a) {
        var b = a.getLayer(this.options.parentId);
        return b || a.requestObject(this.options.parentId, this), b
    }, _clearData: function () {
        Gis.Objects.Base.prototype._clearData.call(this), this._mapRenderer = void 0, this._parent = void 0, Gis.Util.extend(this.options, {parentId: void 0, timeStamp: void 0, latitude: void 0, longitude: void 0, course: void 0, artifacts: void 0}), this.clearPositions()
    }, onClosePoint: function () {
        this._map || Gis.Map.CURRENT_MAP ? (this._map || Gis.Map.CURRENT_MAP).removeLayer(this) : console.error("this._map not found un Position!!!!")
    }, getCaption: function () {
        return this.getOption("caption")
    }, getToolTip: function () {
        return this.getOption("toolTip")
    }, getLatLng: function () {
        return this._latLng || (this._latLng = [parseFloat(this.getOption("latitude")), parseFloat(this.getOption("longitude"))]), this._latLng
    }, getLatLngObject: function () {
        return this._latLngObject || (this._latLngObject = Gis.latLng(parseFloat(this.getOption("latitude")), parseFloat(this.getOption("longitude")))), this._latLngObject
    }, getId: function () {
        return a + this.options.parentId + this.options.timeStamp
    }, distanceTo: function (a) {
        return this._toPoint === a && this._distanceTo || (this._distanceTo = this.getLatLngObject().distanceTo(a.getLatLngObject()), this._toPoint = a), this._distanceTo
    }, getTimeStamp: function () {
        return this.options.timeStamp
    }, setTimeStamp: function (a) {
        return this.options.timeStamp = a, this
    }, isControllable: function () {
        return!1
    }}), Gis.position = function (a) {
        return new Gis.Objects.Position(a)
    }, Gis.Objects.Position.sortFunction = function (a, b, c) {
        var d = a.getTimeStamp(), e = b.getTimeStamp(), f = c ? -1 : 1;
        return(d > e ? 1 : e > d ? -1 : 0) * f
    }, Gis.Objects.Position.sort = function (a) {
        return a.sort(Gis.Objects.Position.sortFunction)
    }, Gis.ObjectFactory.list.position = Gis.Objects.Position
}(), Gis.Objects.Post = Gis.Objects.TrackedBase.extend({_selfDraw: {track: !0, course: !0}, _className: "gis-post", defaultSmoothFactor: 1, includes: Gis.Course, options: {tacticObjectType: "post", courseStyle: void 0}, optionsFire: ["tacticObjectType", "id", "name", "caption", "tooltip", "icon", "tags", "trackStyle", "trackBehavior", "customActions", "courseStyle"], initialize: function (a) {
    this._fillOption(a, null, "courseStyle", Gis.lineStyle), a.trackBehavior = a.trackBehavior ? Gis.trackBehavior(a.trackBehavior) : Gis.Config.PostTrackBehavior, a.icon = a.icon && Gis.icon(a.icon), Gis.Objects.TrackedBase.prototype.initialize.call(this, a)
}, setData: function (a, b, c) {
    b = this._fillOption(a, b, "courseStyle", Gis.lineStyle), b = this._fillOption(a, b, "trackStyle", Gis.lineStyle), b = this._fillOption(a, b, "trackBehavior", Gis.trackBehavior), b = this._fillOption(a, b, "icon", Gis.icon), Gis.Objects.TrackedBase.prototype.setData.call(this, a, b, c)
}, _attached: function (a) {
    "position" === a.to.getType() && Gis.Objects.TrackedBase.prototype._attached.call(this, a)
}, getOptionsWithStyle: function () {
    var a = Gis.Objects.TrackedBase.prototype.getOptionsWithStyle.apply(this, arguments);
    return Gis.Util.extend({trackBehavior: a.trackBehavior || Gis.trackBehavior(Gis.Config.style.DefaultTrackBehavior), trackStyle: a.trackStyle || Gis.Config.style.DefaultTrackStyle && Gis.lineStyle(Gis.Config.style.DefaultTrackStyle), courseStyle: a.courseStyle || Gis.Config.style.DefaultCourseStyle && Gis.lineStyle(Gis.Config.style.DefaultCourseStyle)}, a)
}, draw: function (a, b) {
    if (this.preDraw()) {
        var c, d, e, f, g, h = this._pathBehavior;
        if (Gis.Objects.TrackedBase.prototype.draw.call(this, a), f = this.getOptionsWithStyle(), this._recalculatePoints(f, b), g = h.getCurrentPosition(b), g && this.options.icon) {
            d = h.drawMarker(a, f, b), c = h.drawPath(f, a, b), this.needDrawCourse() && g ? e = this.drawCourse(a, this._lowLevelObject && this._lowLevelObject.course, g.getCourse(), g.getLatLng()) : this._lowLevelObject && this._lowLevelObject.course && a.removeLayer(this._lowLevelObject.course), this.initAutoUpdate(this._lastPoints.length), this._map.startCache();
            try {
                this.drawArtifacts(a, b)
            } finally {
                this._map.flush()
            }
            this._lowLevelObject = {inset: !0, marker: d, path: c, course: e}
        } else a.removeLayer(this._lowLevelObject)
    }
}}), Gis.post = function (a) {
    return new Gis.Objects.Post(a)
}, Gis.ObjectFactory.list.post = Gis.Objects.Post, Gis.Objects.Source = Gis.Objects.TrackedBase.extend({_selfDraw: {bearing: !0, track: !0}, _className: "gis-source", defaultSmoothFactor: "", options: {tacticObjectType: "source", bearingStyle: void 0, bearingBehavior: void 0}, optionsFire: ["tacticObjectType", "id", "name", "caption", "tooltip", "icon", "trackStyle", "tags", "trackBehavior", "bearingStyle", "customActions", "bearingBehavior"], initialize: function (a) {
    var b;
    b = a.bearingStyle || (a.icon ? {color: a.icon.color, thickness: 2} : {color: "blue", thickness: 2}), a.bearingStyle = Gis.lineStyle(b), this._fillOption(a, null, "trackStyle", Gis.lineStyle), a.bearingBehavior = a.bearingBehavior ? Gis.bearingBehavior(a.bearingBehavior) : Gis.Config.SourceBearingBehavior, a.trackBehavior = a.trackBehavior ? Gis.trackBehavior(a.trackBehavior) : Gis.Config.SourceTrackBehavior, Gis.Objects.TrackedBase.prototype.initialize.call(this, a)
}, setData: function (a, b, c) {
    b = this._fillOption(a, b, "bearingStyle", Gis.lineStyle), b = this._fillOption(a, b, "bearingBehavior", Gis.bearingBehavior), b = this._fillOption(a, b, "trackBehavior", Gis.trackBehavior), b = this._fillOption(a, b, "trackStyle", Gis.lineStyle), b = this._fillOption(a, b, "icon", Gis.icon), Gis.Objects.TrackedBase.prototype.setData.call(this, a, b, c)
}, _drawBearing: function (a, b) {
    a.draw(b)
}, clearMeta: function () {
    this._hideAllBearing(), Gis.Objects.TrackedBase.prototype.clearMeta.call(this)
}, onAdd: function (a) {
    Gis.Objects.TrackedBase.prototype.onAdd.call(this, a);
    var b = this;
    this._zoomFunc = function () {
        b.fire("zoomchanged"), b.fire("change", {target: b})
    }, a.on("zoomend", this._zoomFunc)
}, onDelete: function (a) {
    this._map.off("zoomend", this._zoomFunc), delete this._zoomFunc, Gis.Objects.TrackedBase.prototype.onDelete.call(this, a)
}, _hideAllBearing: function () {
    var a = this;
    this._points.bearing && this._points.bearing.getSortedPoints().forEach(function (b) {
        a._hideBearing(b)
    })
}, _hideBearing: function (a) {
    this._map.removeLayer(a)
}, _drawBearingList: function (a, b) {
    var c, d, e;
    if (this._points.bearing && (d = this._points.bearing.getSortedPoints(Gis.bearingBehavior(this.getOption("bearingBehavior"))), this._selfDraw.bearing))for (c = 0, e = d.length; e > c; c += 1)b.isObjectVisible(d[c]) ? this._drawBearing(d[c], a) : d[c].hide(a)
}, isBearingVisible: function (a, b) {
    var c = Gis.bearingBehavior(this.getOption("bearingBehavior"));
    b = Gis.Util.isNumeric(b) ? b : this._points.bearing.searchPositionToInsert(a);
    var d = this._points.bearing.size();
    return!c || c.isBearingVisible(a, d ? d - b : 1)
}, getBearingStyle: function () {
    return Gis.lineStyle(this.getOption("bearingStyle"))
}, getOptionsWithStyle: function () {
    return Gis.Util.extend({trackBehavior: Gis.trackBehavior(Gis.Config.DefaultTrackBehavior), bearingBehavior: Gis.bearingBehavior(Gis.Config.DefaultBearingBehavior)}, Gis.Objects.TrackedBase.prototype.getOptionsWithStyle.apply(this, arguments))
}, draw: function (a, b) {
    if (this.preDraw()) {
        var c, d, e, f, g, h = this._pathBehavior;
        if (Gis.Objects.TrackedBase.prototype.draw.call(this, a), f = this.getOptionsWithStyle(), e = this._recalculatePoints(f, b), g = h.getCurrentPosition(b), this._drawBearingList(a, b), g) {
            d = h.drawMarker(a, f, b), c = h.drawPath(f, a, b), this.initAutoUpdate(e.length, this._points.bearing && this._points.bearing.getSortedPoints().length), this._map.startCache();
            try {
                this.drawArtifacts(a, b)
            } finally {
                this._map.flush()
            }
            this._lowLevelObject = {inset: !0, marker: d, path: c}
        } else this.initAutoUpdate(0, this._points.bearing && this._points.bearing.getSortedPoints().length), a.removeLayer(this._lowLevelObject)
    }
}}), Gis.source = function (a) {
    return new Gis.Objects.Source(a)
}, Gis.ObjectFactory.list.source = Gis.Objects.Source, Gis.Maps = Gis.Maps || {}, Gis.Maps.Base = Gis.BaseClass.extend({includes: Gis.Core.Events, setCenter: function () {
    Gis.extendError()
}, gridVisibility: function () {
    Gis.extendError()
}, getContainer: function () {
    Gis.extendError()
}, setDraggable: function () {
    Gis.extendError()
}, setZoomAround: function () {
    Gis.extendError()
}, setMapBounds: function () {
    Gis.extendError()
}, getCurrentScale: function () {
    return Gis.extendError(), 0
}, getProjectionCode: function () {
    Gis.extendError()
}, getMaxBounds: function () {
    Gis.extendError()
}, getPixelBounds: function () {
    Gis.extendError()
}, setMapType: function () {
    Gis.extendError()
}, _setOptionsConverter: function (a) {
    this._converter = a
}, _getOptionsConverter: function () {
    return this._converter
}, getCenter: function () {
    Gis.extendError()
}, closeMap: function () {
    Gis.extendError()
}, fitWorld: function () {
    Gis.extendError()
}, getZoom: function () {
    Gis.extendError()
}, getMinZoom: function () {
    Gis.extendError()
}, getMaxZoom: function () {
    Gis.extendError()
}, drawPolygon: function () {
    Gis.extendError()
}, drawPolyline: function () {
    Gis.extendError()
}, drawOverlay: function () {
    Gis.extendError()
}, drawMultiPolyline: function () {
    Gis.extendError()
}, drawRectangle: function () {
    Gis.extendError()
}, drawCycle: function () {
    Gis.extendError()
}, drawEllipse: function () {
    Gis.extendError()
}, drawText: function () {
    Gis.extendError()
}, drawPopup: function () {
    Gis.extendError()
}, showMap: function () {
    Gis.extendError()
}, zoomIn: function () {
    Gis.extendError()
}, zoomOut: function () {
    Gis.extendError()
}, setZoom: function () {
    Gis.extendError()
}, setMaxBounds: function () {
    Gis.extendError()
}, removeLayer: function () {
}, latLngToLayerPoint: function () {
    Gis.extendError()
}, layerPointToLatLng: function () {
    Gis.extendError()
}}), function (a) {
    "use strict";
    var b = 3e4, c = 20;
    Gis.ObjectController = a.BaseClass.extend({options: {map: null}, _visibilityController: void 0, toRender: [], _framesPerSecond: 25, _calculatedPerSecond: 0, _frameRequested: !1, excluded: {id: [], type: []}, _listToUpdate: {}, _clearSelectedOnMapClick: !0, _intervalTime: 300, selected: {}, _map: void 0, attachMap: function (a) {
        this._map = a, this._map.on("click", this._mapClicked, this), this._map.on("zoomstart", this._disableAnimation, this), this._map.on("zoomend", this._enableAnimation, this), this._map.on("change", this.draw, this)
    }, clearLayer: function (a) {
        a.detachFromMap(this._map)
    }, attachLayerToMap: function (a) {
        a.attachToMap(this._map)
    }, pause: function () {
        this.stopDraw = !0
    }, stop: function () {
        this.pause(), this.list.each(this.clearLayer, this), this.listUncontrol.each(this.clearLayer, this)
    }, start: function () {
        this.resume(), this.list.each(this.attachLayerToMap, this), this.listUncontrol.each(this.attachLayerToMap, this), this.draw()
    }, resume: function () {
        this.stopDraw = !1
    }, detachMap: function (a) {
        this._map = !1, a.off("click", this._mapClicked, this), a.off("zoomstart", this._disableAnimation, this), a.off("zoomend", this._enableAnimation, this), a.off("change", this.draw, this), a.closeMap()
    }, requestFrame: function () {
        Gis.requestAnimationFrame(50)(this._animate)
    }, calculateTime: function () {
        return 1e3 / Math.min(this._calculatedPerSecond, this._framesPerSecond)
    }, getIdealTimePerFrame: function () {
        return 1e3 / this._framesPerSecond
    }, getAnimateTime: function () {
        var a = this.calculateTime();
        return this._lastFrameDrawed / a > .2 && this._calculatedPerSecond > 1 ? (this._calculatedPerSecond -= 1, a = this.calculateTime()) : this._calculatedPerSecond < this._framesPerSecond && (this._calculatedPerSecond += 1, a = this.calculateTime()), a
    }, initAnimation: function () {
        var a = this;
        this._animate = function () {
            a.renderFrame(), setTimeout(function () {
                a.initAnimation()
            }, a.getAnimateTime())
        }, this.requestFrame()
    }, initialize: function (d) {
        var e = this;
        if (this._typeCount = {}, this.options = a.Util.extend({}, this.options, d), !this.options.map || "object" != typeof this.options.map)throw new Error("need map object");
        this.list = new HashList, this._addAfterAdd = new HashArray(c), this._addAfterAddRequestedTime = {}, setTimeout(function () {
            var a, c = Date.now();
            for (a in e._addAfterAddRequestedTime)e._addAfterAddRequestedTime.hasOwnProperty(a) && c - e._addAfterAddRequestedTime[a] > b && e.clearWaitForObject(a)
        }, b), this._drawAfterResume = new HashList, this.listUncontrol = new HashList, this.listNotForObjectProvider = new HashList, this.attachMap(this.options.map), this.initAnimation(), this._visibilityController = new Gis.ObjectVisibilityController(this), this._visibilityController.on(Gis.ObjectVisibilityController.VISIBILITY_CHANGE_EVENT.TYPE, function () {
            this.draw()
        }, this), delete this.options.map
    }, getVisibilityController: function () {
        return this._visibilityController
    }, _enableAnimation: function () {
        this.stopDraw = !1, this.draw(this._drawAfterResume), this._drawAfterResume.clear()
    }, _disableAnimation: function () {
        this.stopDraw = !0
    }, _layerFireAutoUpdate: function (a) {
        this.addLayerToAutoUpdate(a.layer)
    }, _layerNoNeedAutoUpdate: function (a) {
        this.removeLayerFromUpdate(a.layer)
    }, addLayerToAutoUpdate: function (a) {
        this.addToLaterDraw(a, !0)
    }, removeLayerFromUpdate: function (a) {
        var b = a.getId();
        this._listToUpdate[b] && delete this._listToUpdate[b]
    }, _onCustomLayerEvent: function (a) {
        this.fire(a.type, a)
    }, removeLayer: function (a) {
        a.isMetaData() && a.clearMeta(), a.off("change", this.layerChanged, this), a.off(Gis.Objects.Base.NEED_REDRAW_EVENT.TYPE, this._redrawLayer, this), a.off("customaction", this._onCustomLayerEvent, this), a.off("needupdate", this._layerFireAutoUpdate, this), a.off("noneedupdate", this._layerNoNeedAutoUpdate, this), this._incrementType(a.getType(), -1), this.removeLayerFromUpdate(a), a.isControllable() ? a.isControllableByServer() !== Gis.FULL_LOCAL ? this.list.remove(a.getType(), a.getId()) : this.listUncontrol.remove(a.getType(), a.getId()) : this.listNotForObjectProvider.remove(a.getType(), a.getId()), this._drawAfterResume.remove(a.getType(), a.getId()), a.isSelectable && a.off("select", this._layerSelect, this), this.removeFromSelected(a, !0), this.clearWaitForObject(a.getId()), this._map.removeLayer(a), a.fire("remove", {from: this._map, target: a}), this.fire(Gis.ObjectController.LAYER_REMOVE_EVENT.TYPE, new Gis.ObjectController.LAYER_REMOVE_EVENT(a))
    }, isValidLayer: function (a) {
        var b, c, d = ["getType"];
        if (!a)return!1;
        for (b = 0, c = d.length; c > b; b += 1)if (!a[d[b]])return!1;
        return!0
    }, getLayerIDs: function (a) {
        var b = [];
        return this.list.each(function (a) {
            b.push(a.getId())
        }), a && this.listUncontrol.each(function (a) {
            b.push(a.getId())
        }), b
    }, getLayers: function () {
        var a = [];
        return this.list.each(function (b) {
            a.push(b)
        }), this.listUncontrol.each(function (b) {
            a.push(b)
        }), this.listNotForObjectProvider.each(function (b) {
            a.push(b)
        }), a
    }, layerExist: function (a) {
        return!!this.list.getObject(a.getType(), a.getId()) || !!this.listUncontrol.getObject(a.getType(), a.getId())
    }, removeFromSelected: function (a, b) {
        return a && a.isSelectable && a.isSelectable() && (a.setSelected(!1), this.fire("layerunselected", {layer: a}), delete this.selected[a.getId()]), b || this.renderLayer(a), this
    }, getSelected: function () {
        return a.Util.extend({}, this.selected)
    }, isSelected: function (a) {
        return!!this.selected[a.getId()]
    }, addSelected: function (a, b) {
        a.isSelectable && a.isSelectable() && (this.isFilterable(a.getType()) || b) && (this.selected[a.getId()] = a, a.setSelected(!0), this.fire("layerselected", {layer: a}), this.renderLayer(a))
    }, clearSelectedOnClick: function (a) {
        this._clearSelectedOnMapClick = a
    }, isClearOnClick: function () {
        return this._clearSelectedOnMapClick
    }, _mapClicked: function () {
        this._clearSelectedOnMapClick && this.clearSelected()
    }, _layerSelect: function (a) {
        var b = a.target, c = this.isSelected(b);
        (a.force || this.isFilterable(b.getType())) && (a.addToSelection || this.clearSelected(b), a.addToSelection && c ? this.removeFromSelected(b) : this.addSelected(b, a.force))
    }, layerChanged: function (a) {
        var b = a.target;
        this.renderLayer(b), this.fire(Gis.ObjectController.LAYER_CHANGED_EVENT.TYPE, new Gis.ObjectController.LAYER_CHANGED_EVENT(a))
    }, _redrawLayer: function (a) {
        var b = a.target;
        this.renderLayer(b)
    }, hideByType: function (a) {
        this._hideLayersByHidingType("type", a)
    }, showByType: function (a) {
        this._showLayersByHidingType("type", a)
    }, hideByIDs: function (a) {
        this._hideLayersByHidingType("id", a)
    }, showByIDs: function (a) {
        this._showLayersByHidingType("id", a)
    }, _showLayersByHidingType: function (a, b) {
        var c, d, e, f = b.split(" "), g = [], h = this.excluded[a], i = !1, j = [];
        for (c = 0, d = h.length; d > c; c += 1)e = f.indexOf(h[c]) > -1, i = i || e, e ? j.push(h[c]) : g.push(h[c]);
        i && (this.excluded[a] = g, this._hideLayers(j), this.fire("layervisibilitychanged"), this.draw())
    }, _hideLayersByHidingType: function (a, b) {
        var c, d, e = this.excluded[a], f = Gis.Util.isArray(b) ? b : b.split(" "), g = [];
        for (c = 0, d = f.length; d > c; c += 1)-1 === g.indexOf(f[c]) && -1 === e.indexOf(f[c]) && g.push(f[c]);
        return g.length ? (this.excluded[a] = this.excluded[a].concat(g), this._hideLayers(g), this.fire("layervisibilitychanged"), void this.draw()) : this
    }, clearSelected: function (a) {
        var b, c, d, e = this;
        if (b = this.selected, b && Object.keys(b).length) {
            for (c in b)b.hasOwnProperty(c) && (d = b[c], a && (d.getType() === a || d === a || a.getParentId && a.getParentId() === d.getId()) || e.removeFromSelected(d));
            this.draw()
        }
    }, _incrementType: function (a, b) {
        b = b || 1, Gis.Util.isDefine(this._typeCount[a]) || (this._typeCount[a] = 0), this._typeCount[a] += b
    }, getKnownTypes: function () {
        var a, b = [];
        for (a in this._typeCount)this._typeCount.hasOwnProperty(a) && this._typeCount[a] > 0 && b.push(a);
        return b
    }, addLayer: function (a, b) {
        var c;
        if (!this.isValidLayer(a))throw new Error("need valid layer object");
        a.isControllable() ? this.layerExist(a) || (a.isControllableByServer() !== Gis.FULL_LOCAL ? this.list.add(a.getType(), a.getId(), a) : this.listUncontrol.add(a.getType(), a.getId(), a), this._incrementType(a.getType()), a.on("change", this.layerChanged, this), a.on(Gis.Objects.Base.NEED_REDRAW_EVENT.TYPE, this._redrawLayer, this), a.on("customaction", this._onCustomLayerEvent, this), a.on("needupdate", this._layerFireAutoUpdate, this), a.on("noneedupdate", this._layerNoNeedAutoUpdate, this), a.isSelectable && a.isSelectable() && a.on("select", this._layerSelect, this), a.fire("change", {isAdd: !0, target: a, notFireToServer: !a.isControllableByServer() || b, realRows: Object.keys(a.getParams()), rows: a._getRowsChanged(a.objectOfficialData())}), c = this._addAfterAdd.getList(a.getId()), c && c.length && (Gis.Logger.log(" ,  " + a.getId() + " (" + c.length + ").     ."), this.clearWaitForObject(a.getId()), setTimeout(function () {
            var a, b;
            for (a = 0, b = c.length; b > a; a += 1)Gis.Map.CURRENT_MAP.addLayer(c[a])
        }, 50))) : this.listNotForObjectProvider.add(a.getType(), a.getId(), a), this.fire(Gis.ObjectController.LAYER_ADD_EVENT.TYPE, new Gis.ObjectController.LAYER_ADD_EVENT(a))
    }, getLayer: function (a) {
        return this.list.getObject(a) || this.listUncontrol.getObject(a)
    }, addToLaterDraw: function (a) {
        this.renderLayer(a)
    }, _realRenderLayer: function (a) {
        if (a._frame_requested = !1, this.stopDraw)return void this._drawAfterResume.add(a.getType(), a.getId(), a);
        var b = this.isLayerHided(a);
        this.layerExist(a) && !b ? a.draw(this._map, this._visibilityController) : b && this.hideLayer(a)
    }, renderLayer: function (a) {
        var b, c = this, d = this.isLayerHided(a);
        d || a._frame_requested ? d && this.hideLayer(a) : (a._frame_requested = !0, b = this.getIdealTimePerFrame(), setTimeout(function () {
            Gis.requestAnimationFrame(100)(function () {
                c._realRenderLayer(a)
            })
        }, b))
    }, renderChanged: function () {
        var a, b, c, d = this.toRender;
        for (this.toRender = [], a = 0, b = d.length; b > a; a += 1)c = d[a], this._realRenderLayer(c)
    }, renderFrame: function () {
        this._lastFrameDrawed = Date.now(), this.renderChanged(), this._lastFrameDrawed = Date.now() - this._lastFrameDrawed
    }, isLayerHided: function (a) {
        return a && (-1 !== this.excluded.type.indexOf(a.getType()) || -1 !== this.excluded.id.indexOf(a.getId()) || !this._visibilityController.isObjectVisible(a) && !a.getOption("forcePaint") && !a.isMetaData())
    }, hideLayer: function (a) {
        var b, c, d;
        if (this.isLayerHided(a))this._map.removeLayer(a), a.fire("hided", {target: a}); else if (a.selfDraw()) {
            b = a.selfDraw(), c = this;
            for (d in b)b.hasOwnProperty(d) && (-1 !== c.excluded.type.indexOf(d) ? a.disableDraw(d) : a.enableDraw(d));
            this.renderLayer(a)
        }
    }, filterSelect: function (a, b) {
        a = a || this._oldFilterSelected;
        var c = this._filterSelected !== a;
        this._oldFilterSelected = this._filterSelected, this._filterSelected = a, c && !b ? this.clearSelected(a) : this.draw()
    }, isFilterable: function (b) {
        return!this._filterSelected || this._filterSelected === a.ObjectController.FILTER_ALL || this._filterSelected === b
    }, getFilterSelect: function () {
        return this._filterSelected
    }, whenAdd: function (a, c) {
        Gis.Logger.log(" " + a + "  " + c.getType() + "=" + c.getId() + "   " + b / 1e3 + "."), this._addAfterAddRequestedTime[a] = this._addAfterAddRequestedTime[a] || Date.now(), this._addAfterAdd.add(a, c)
    }, clearWaitForObject: function (a) {
        this._addAfterAdd.getList(a) && this._addAfterAdd.getList(a).length && Gis.Logger.log((this.getLayer(a) ? "" : " " + a + "  . ") + "   ."), delete this._addAfterAddRequestedTime[a], this._addAfterAdd.clear(a)
    }, draw: function (a) {
        return a && a.each ? void a.each(this.renderLayer, this) : (this.list.each(this.renderLayer, this), void this.listUncontrol.each(this.renderLayer, this))
    }, _hideLayers: function (a) {
        var b, c;
        if (a)for (b = 0, c = a.length; c > b; b += 1)this.hideLayer(this.getLayer(a[b])); else this.list.each(this.hideLayer, this), this.listUncontrol.each(this.hideLayer, this)
    }, _getLatitudeBounds: function (b) {
        var c, d, e, f, g, h, i = {southWest: [], northEast: []}, j = !1;
        for (c = 0, d = b.length; d > c; c += 1)f = this.getLayer(b[c]), e = f && f.getCurrentLatLngBounds(), e && (g = e.getSouthWest(), h = e.getNorthEast(), i.southWest[0] = i.southWest[0] ? Math.min(i.southWest[0], g.lat) : g.lat, i.southWest[1] = i.southWest[1] ? Math.max(i.southWest[1], g.lng) : g.lng, i.northEast[0] = i.northEast[0] ? Math.max(i.northEast[0], h.lat) : h.lat, i.northEast[1] = i.northEast[1] ? Math.min(i.northEast[1], h.lng) : h.lng, j = !0);
        return j ? a.latLngBounds(i.southWest, i.northEast) : !1
    }}), a.ObjectController.FILTER_ALL = -2, a.ObjectController.FILTER_NOTHING = -1, Gis.ObjectController.LAYER_CHANGED_EVENT = function (a) {
        if (!a)throw new Error("Need layer to bee set");
        Gis.Util.extend(this, a), this.type = Gis.ObjectController.LAYER_CHANGED_EVENT.TYPE
    }, Gis.ObjectController.LAYER_CHANGED_EVENT.TYPE = "layerchanged", Gis.ObjectController.LAYER_REMOVE_EVENT = function (a) {
        if (!a)throw new Error("Need target to bee set");
        this.target = a, this.type = Gis.ObjectController.LAYER_REMOVE_EVENT.TYPE
    }, Gis.ObjectController.LAYER_REMOVE_EVENT.TYPE = "layerremove", Gis.ObjectController.LAYER_ADD_EVENT = function (a) {
        if (!a)throw new Error("Need target to bee set");
        this.target = a, this.type = Gis.ObjectController.LAYER_ADD_EVENT.TYPE
    }, Gis.ObjectController.LAYER_ADD_EVENT.TYPE = "layeradd", a.Maps.renderer = function (b) {
        return new a.ObjectController(b)
    }
}(Gis), function () {
    "use strict";
    function a(a) {
        var b = a.getLayers();
        return b && Gis.Util.isString(b) ? b = [b] : b && (b = b.slice()), b && b.length ? b : [Gis.ObjectVisibilityController.BASE_LAYER_KEY]
    }

    var b, c, d, e, f, g = "OBJECTVISIBILITYCONTROLLER", h = 5e3;
    f = function (b) {
        this.layerChanged = function (a) {
            a.target.isCountable() && a.rows && a.rows.indexOf("tags") > -1 && b.calculateLayersDelayed()
        }, this.layerRemoved = function (a) {
            a.target.isCountable() && b.calculateLayersDelayed()
        }, this.layerAdded = function (c) {
            var d, e;
            c.target.isCountable() && (d = a(c.target), d.length > 0 && (e = b.addLayersFromObject(c.target), e.length && this.fire(Gis.ObjectVisibilityController.LIST_CHANGE_EVENT.TYPE, new Gis.ObjectVisibilityController.LIST_CHANGE_EVENT(e))))
        }
    }, Gis.ObjectVisibilityController = Gis.Class.extend({includes: Gis.Core.Events, initialize: function (a) {
        b = a, e = new f(this), this.recoverFromStorage(), c = [], b.on(Gis.ObjectController.LAYER_CHANGED_EVENT.TYPE, e.layerChanged, this), b.on(Gis.ObjectController.LAYER_REMOVE_EVENT.TYPE, e.layerRemoved, this), b.on(Gis.ObjectController.LAYER_ADD_EVENT.TYPE, e.layerAdded, this), this.on(Gis.ObjectVisibilityController.VISIBILITY_CHANGE_EVENT.TYPE, this.saveToStorage, this)
    }, getLayersFromObject: function (b) {
        return b && a(b)
    }, getLayers: function () {
        return c.slice()
    }, isObjectVisible: function (a) {
        if (!d.length)return!0;
        var c, e, f = this.getLayersFromObject(Gis.Util.isString(a) ? b.getLayer(a) : a);
        if (f)for (c = 0, e = f.length; e > c; c += 1)if (this.isLayerVisible(f[c]))return!0;
        return!1
    }, getLayersInfo: function () {
        var a, b, d, e = [];
        for (b = 0, d = c.length; d > b; b += 1)a = c[b], e.push(new Gis.ObjectVisibilityController.VisibilityData(a, this.isLayerVisible(a)));
        return e
    }, setLayerVisible: function (a, b, c) {
        Gis.Util.isDefine(a) || (a = Gis.ObjectVisibilityController.BASE_LAYER_KEY);
        var e = d.indexOf(a);
        return b && e > -1 ? (d.splice(e, 1), c || this.fire(Gis.ObjectVisibilityController.VISIBILITY_CHANGE_EVENT.TYPE, new Gis.ObjectVisibilityController.VISIBILITY_CHANGE_EVENT(a, b)), new Gis.ObjectVisibilityController.VisibilityData(a, b)) : b || -1 !== e ? void 0 : (d.push(a), c || this.fire(Gis.ObjectVisibilityController.VISIBILITY_CHANGE_EVENT.TYPE, new Gis.ObjectVisibilityController.VISIBILITY_CHANGE_EVENT(a, b)), new Gis.ObjectVisibilityController.VisibilityData(a, b))
    }, setLayersVisible: function (a) {
        var b, c, d, e = [];
        if (a) {
            for (b = 0, c = a.length; c > b; b += 1)d = a[b], this.setLayerVisible(d.layer, d.visibility, !0) && e.push(d);
            this.fire(Gis.ObjectVisibilityController.VISIBILITY_CHANGE_EVENT.TYPE, new Gis.ObjectVisibilityController.VISIBILITY_CHANGE_EVENT(e))
        }
        return e
    }, getInvisibleLayers: function () {
        return d.slice()
    }, isLayerVisible: function (a) {
        Gis.Util.isDefine(a) || (a = Gis.ObjectVisibilityController.BASE_LAYER_KEY);
        var b = this.getInvisibleLayers();
        return b && -1 === b.indexOf(a)
    }, addLayersFromObject: function (a, d) {
        var e, f, g = Gis.Util.isString(a) ? b.getLayer(a) : a, h = g && g.isCountable() && this.getLayersFromObject(g), i = [];
        if (d = d || c, h)for (e = 0, f = h.length; f > e; e += 1)-1 === d.indexOf(h[e]) && (d.push(h[e]), i.push(h[e]));
        return i
    }, calculateLayersDelayed: function () {
        var a = this;
        this._timeoutCalculate || (this._timeoutCalculate = setTimeout(function () {
            a.calculateLayers(), a._timeoutCalculate = null
        }, h))
    }, calculateLayers: function () {
        var a, d, e = b.getLayerIDs(), f = this, g = [], h = [], i = [];
        if (e)for (a = 0, d = e.length; d > a; a += 1)this.addLayersFromObject(e[a], h);
        for (b.listNotForObjectProvider && b.listNotForObjectProvider.each(function (a) {
            f.addLayersFromObject(a, h)
        }), a = 0, d = c.length; d > a; a += 1)-1 === h.indexOf(c[a]) && i.push(c[a]);
        for (a = 0, d = h.length; d > a; a += 1)-1 === c.indexOf(h[a]) && g.push(h[a]);
        (g.length || i.length) && (c = h, this.fire(Gis.ObjectVisibilityController.LIST_CHANGE_EVENT.TYPE, new Gis.ObjectVisibilityController.LIST_CHANGE_EVENT(g, i)))
    }, recoverFromStorage: function () {
        d = Gis.Preferences.getPreferenceData(g) || []
    }, saveToStorage: function () {
        Gis.Preferences.setPreferenceData(g, d)
    }}), Gis.ObjectVisibilityController.VISIBILITY_CHANGE_EVENT = function (a, b) {
        b = Gis.Util.isDefine(b) ? b : void 0, this.layers = a, this.visibility = b, this.type = Gis.ObjectVisibilityController.VISIBILITY_CHANGE_EVENT.TYPE
    }, Gis.ObjectVisibilityController.VISIBILITY_CHANGE_EVENT.TYPE = "layervisibilitychanged", Gis.ObjectVisibilityController.LIST_CHANGE_EVENT = function (a, b) {
        a = a || void 0, b = b || void 0, this.added = a, this.removed = b, this.type = Gis.ObjectVisibilityController.LIST_CHANGE_EVENT.TYPE
    }, Gis.ObjectVisibilityController.LIST_CHANGE_EVENT.TYPE = "layerlistchanged", Gis.ObjectVisibilityController.BASE_LAYER_KEY = "", Gis.ObjectVisibilityController.BASE_LAYER_NAME = " ", Gis.ObjectVisibilityController.VisibilityData = function (a, b) {
        this.layer = a, this.visibility = b
    }
}(), L.customProjection = function (a, b, c, d) {
    return new L.Proj.CRS.TMS(a, b, c, d)
}, function (a) {
    "use strict";
    var b = function (b) {
        var c = b;
        switch (b.type) {
            case"click":
            case"mouseout":
            case"dblclick":
            case"mouseover":
            case"mousedown":
            case"contextmenu":
                c = a.Maps.Leaflet.EventConverter._mouseEvent(b);
                break;
            case"drag":
            case"dragstart":
            case"dragend":
                c = a.Maps.Leaflet.EventConverter._latlngEvent(b)
        }
        return c
    };
    a.Maps.Leaflet = a.Maps.Leaflet || {}, a.Maps.Leaflet.EventConverter = {_event: function (a) {
        return{type: a.type, target: a.target}
    }, _mouseEvent: function (b) {
        return a.Util.extend(this._latlngEvent(b), {originalEvent: b.originalEvent})
    }, _latlngEvent: function (b) {
        var c, d, e = b.latlng || b.latLng, f = {};
        c = e && (void 0 !== e.lat || void 0 !== e.latitude), d = e && (void 0 !== e.lng || void 0 !== e.longitude);
        try {
            f.latitude = c ? void 0 !== e.lat ? e.lat : e.latitude : b.target.getLatLng().lat, f.longitude = d ? void 0 !== e.lng ? e.lng : e.longitude : b.target.getLatLng().lng
        } catch (g) {
            console.log(g)
        }
        return a.Util.extend(this._event(b), {latLng: f})
    }, setEvents: function (a, c) {
        var d, e;
        a && (d = a.callback, e = a.context || this, e._TEMP_FUNC = e._TEMP_FUNC || {}, e._TEMP_FUNC[c] = function (a) {
            d.call(e || this, b(a))
        }, d && a.type && c.on(a.type, e._TEMP_FUNC[c], e))
    }, deleteEvents: function (a, b) {
        var c;
        c = a.context || this, c._TEMP_FUNC[b] && (a.type && b.off(a.type, c._TEMP_FUNC[b], c), delete c._TEMP_FUNC[b])
    }, Convert: b}
}(Gis), function (a) {
    "use strict";
    a.Maps.Leaflet.EventController = {_fireEventFromLowLevel: function (b) {
        this.fire(b.type, a.Maps.Leaflet.EventConverter.Convert(b))
    }, addEventListener: function (b, c, d) {
        a.Core.Events.addEventListener.call(this, b, c, d), this.map ? this.map.on(b, this._fireEventFromLowLevel, this) : (this._laterAttach = this._laterAttach || [], this._laterAttach.push({types: b, fn: c, context: d}), a.Core.Events.addEventListener.call(this, "mapattached", this._mapAttached, this))
    }, on: function (a, b, c) {
        this.addEventListener(a, b, c)
    }, addEventToLayer: function (a, b) {
        function c(d) {
            var f, g;
            if (d && "object" == typeof d)for (f in d)d.hasOwnProperty(f) && (g = d[f], g && (g.inset ? c(g) : g.on && g.on(b, e._fireEventFromLowLevel, a)))
        }

        var d = a.getLowLevelObject(), e = this;
        d && c(d)
    }, removeEventFromLayer: function (a, b) {
        function c(e) {
            var g;
            if (e && "object" == typeof e)for (g in e)e.hasOwnProperty(g) && (d = e[g], e.inset ? c(d) : d.off(b, f._fireEventFromLowLevel, a))
        }

        var d, e = a.getLowLevelObject(), f = this;
        c(e)
    }}
}(Gis), Gis.Maps.Leaflet = Gis.Maps.Leaflet || {}, Gis.Maps.Leaflet.LeafletProvider = Gis.Maps.Base.extend({_mapContainerId: "leaflet-map-gis", _cachedObjects: {}, _tileLayer: {}, _draggable: !0, _maxInCache: Gis.Config.maxInCache, options: {container: void 0, latlng: void 0, zoom: 3, layer: void 0, maxZoom: null, minZoom: null, projection: null}, setDraggable: function (a) {
    this._dragable = a, a ? this.map.dragging.enable() : this.map.dragging.disable()
}, getCurveStep: function () {
    var a = this.getMaxBounds();
    return a ? (a.getNorthEast().lat - a.getSouthEast().lat) / 100 : void 0
}, getCurveStepKilometr: function () {
    var a = this.map.getBounds();
    return a ? a.getNorthEast().distanceTo(a.getSouthEast()) / 100 : void 0
}, isDraggableEnabled: function () {
    return this._dragable
}, closeMap: function () {
    var a, b;
    this.map && (this.map.off("click", this._onMouseEvent, this), this.map.off("mousedown", this._onMouseEvent, this), this.map.off("mouseup", this._onMouseEvent, this), this.map.off("mousemove", this._onMouseEvent, this), this.map.off("mouseout", this._onMouseEvent, this), this.map.off("zoomstart", this._onZoomStart, this), this.map.off("zoomend", this._onZoomEnd, this), this.map.off("moveend", this._onMoveEnd, this), this.fire("closed"), this.map = !1, a = document.getElementById(this.options.container), b = document.getElementById(this._mapContainerId), b && a.removeChild(b))
}, zoomIn: function () {
    this.map.zoomIn()
}, zoomOut: function () {
    this.map.zoomOut()
}, getContainer: function () {
    return document.getElementById(this._mapContainerId)
}, getContainerReal: function () {
    return document.getElementById(this.options.container)
}, _enableMapContainer: function () {
    var a, b;
    a = document.getElementById(this.options.container), a && (b = document.createElement("div"), b.addEventListener("resize", function () {
        this.map && this.map.invalidateSize()
    }), b.id = this._mapContainerId, b.style.width = "100%", b.style.height = "100%", a.appendChild(b))
}, _getProjection: function (a) {
    return a && L.CRS[a] && L.CRS[a] || L.CRS.EPSG3857
}, getProjectionCode: function () {
    return this._CRS && this._CRS.code || this.map.options.crs.code
}, projectToZoom: function (a, b) {
    var c = this.map.project(L.latLng(a.lat, a.lng), b);
    return c ? Gis.point(c.x, c.y) : void 0
}, project: function (a) {
    a = Gis.latLng(a);
    var b = this.map.latLngToLayerPoint([a.lat, a.lng]);
    return Gis.point(b.x, b.y)
}, unproject: function (a, b) {
    a = Gis.point(a);
    var c = this.map.unproject(L.point(a.x, a.y), b);
    return c ? Gis.latLng(c.lat, c.lng) : void 0
}, _getMap: function (a) {
    if (!this.map) {
        {
            a.mapBounds || [
                [-95, -360],
                [85, 360]
            ]
        }
        this._enableMapContainer();
        var b = L.map(this._mapContainerId, {zoomControl: !1, boxZoom: !1, attributionControl: !0, crs: this._getProjection(a.projection)}).setView(a.latlng, a.zoom);
        return L.control.scale({imperial: !1}).addTo(b), b
    }
    return this.map
}, reinit: function () {
    this.closeMap(), this.showMap(), this.fire("change")
}, setZoom: function (a, b) {
    this.options.zoom = a, this.map.setZoom(a, {animate: b})
}, fitWorld: function () {
    this.map.fitWorld()
}, getScale: function (a) {
    try {
        var b = this.map.options.crs.scale(Gis.Util.isNumeric(a) ? a : this.getZoom());
        return Gis.Util.isNumeric(b) ? b : -1
    } catch (c) {
        Gis.Logger.log("Error getScale", c, c.stack)
    }
    return-1
}, getZoom: function () {
    return this.map && this.map.getZoom()
}, setMaxBounds: function (a, b) {
    var c, d = a && a.getSouthEast(), e = a && a.getNorthWest();
    return this.maxBounds = a, c = this.map[b ? "setMaxBounds" : "setMaxCenterBounds"](a && L.latLngBounds(L.latLng(d.lat, d.lng), L.latLng(e.lat, e.lng))), c && this.fire("maxboundschanged"), c
}, _convertBounds: function (a) {
    var b, c;
    return b = a.getSouthWest(), c = a.getNorthEast(), Gis.latLngBounds(Gis.latLng(b.lat, b.lng), Gis.latLng(c.lat, c.lng))
}, getMapBounds: function () {
    var a;
    return a = this.map.getBounds(), a ? this._convertBounds(a) : null
}, getMaxBounds: function () {
    var a, b = this.map.options.maxBounds;
    return b && (a = this._convertBounds(b)), b = this.map.options.maxCenterBounds, b && (a = this._convertBounds(b)), a
}, getCenter: function () {
    var a = this.map.getCenter();
    return Gis.latLng(a.lat, a.lng)
}, getMinZoom: function () {
    return this.map.getMinZoom()
}, getMaxZoom: function () {
    return this.map.getMaxZoom()
}, setMapBounds: function (a, b) {
    var c, d;
    a && (c = a.getSouthWest(), d = a.getNorthEast(), b ? this.map.panInsideBounds(L.latLngBounds(L.latLng(c.lat, c.lng), L.latLng(d.lat, d.lng))) : this.map.fitBounds(L.latLngBounds(L.latLng(c.lat, c.lng), L.latLng(d.lat, d.lng))))
}, _fixBbox: function (a) {
    this.map._bbox = [this._CRS.projection.unproject(L.point(a.slice(0, 2))), this._CRS.projection.unproject(L.point(a[0], a[3])), this._CRS.projection.unproject(L.point(a.slice(2, 4))), this._CRS.projection.unproject(L.point(a[2], a[1]))]
}, setProjection: function (a, b, c, d) {
    var e, f = this._CRS && this._CRS.code;
    return this._CRS = Gis.Maps.Leaflet.LeafletProvider.getCustomCrs(a, b, c, d), c && (this._fixBbox(c), e = L.latLngBounds(this.map._bbox[0], this.map._bbox[2]), e.extend(this._CRS.projection.unproject(L.point(c[0], c[3]))), e.extend(this._CRS.projection.unproject(L.point(c[2], c[1])))), this.setMaxBounds(e), this.map.options.crs = this._CRS, this._CRS.code !== f && this.fire("projectionchanged"), !1
}, initialize: function (a) {
    Gis.Maps.Base.prototype.initialize.call(this, a), this._setOptionsConverter(Gis.Maps.Leaflet.optionsConverter())
}, _getLineStyle: function (a) {
    return{stroke: {weight: a.getThickness() + 2, stroke: !!a.getBorder(), opacity: 1, dashArray: a.getDash(), color: a.getBorder()}, line: {opacity: 1, fill: !1, weight: a.getThickness(), dashArray: a.getDash(), stroke: !!a.getColor(), color: a.getColor()}}
}, _getFillStyle: function (a) {
    return{fill: a.getColor(), fillColor: a.getColor(), fillOpacity: 1, hatch: new L.HatchClass(a.getHatch(), a.getHatchColor())}
}, drawPolygon: function (a, b) {
    var c, d, e, f, g = this._getFillStyle(a.fill), h = this._getLineStyle(a.line);
    return f = a.latlng, c = Gis.Util.extend({}, a, h.stroke, g, {clickable: !0}), d = Gis.Util.extend({}, a, h.line, {draggable: !1, tooltip: null, caption: null, selectable: !1}), e = {polygon: this._polygon(f, c, b && b.polygon), line: this._polygon(f, d, b && b.line)}, b || Gis.Maps.Leaflet.EventConverter.setEvents(a.events, e.polygon), this.setLabel(a, e.polygon), e
}, drawOverlay: function (a, b) {
    var c = b && b.image || new L.Overlay(a.layer, Gis.Util.extend({className: Gis.Config.overlayClass}, a));
    return this.map.hasLayer(c) || c.addTo(this.map), c.setImage(a.imageData), b && this._converter.setOptions(this._converter.overlaySetters(), a, c), b || Gis.Maps.Leaflet.EventConverter.setEvents(a.events, c), {image: c}
}, gridVisibility: function (a) {
    var b = document.querySelector(".leaflet-control-scale").style, c = L.Grid.OFFSET_TEXT_BOTTOM + 15, d = L.Grid.OFFSET_TEXT_LEFT + 15;
    a && (d += a, c += a), b.marginLeft = d + "px", b.marginBottom = c + "px"
}, drawHeatMap: function (a, b) {
    var c = b && b.image || new L.HeatMap(a.canvas, Gis.Util.extend({className: Gis.Config.heatMapClass}, a));
    return this.map.hasLayer(c) ? a.changed && (c.setPoints(a.points, !0), c.setBounds(a.bounds, !0), c.setColors(a.colors, !0), c.setOpacity(a.opacity, a.reset), a.reset && (c._updateHeatMapViewport(), c.resetForce())) : (c.addTo(this.map), Gis.Maps.Leaflet.EventConverter.setEvents(a.events, c)), c.setSelected(a.selected), this.setLabel(a, c), a.tooltip ? c._popup ? c._popup.setContent(a.tooltip) : c.bindPopup(a.tooltip, Gis.Util.extend({className: Gis.Config.popupClass}), !0) : c.unbindPopup(), {image: c}
}, drawPolyline: function (a, b, c) {
    var d, e, f, g = this._getLineStyle(a.line);
    return e = c ? this._multiPolyline : this._polyline, a.isCycle && a.latlng.push(a.latlng[0]), f = Gis.Util.extend(this._converter.path(Gis.Util.extend({}, a, g.line)), {clickable: !0}), d = {polylineBorder: e.call(this, a.latlng.slice(0), Gis.Util.extend(this._converter.path(Gis.Util.extend({}, a, g.stroke)), {clickable: !1, draggable: !1, className: void 0}), b && b.polylineBorder), polyline: e.call(this, a.latlng.slice(0), f, b && b.polyline), marker: a.icon && a.drawIcon ? this.drawMarker({latlng: a.latlng[0], icon: a.icon}, b && b.marker) : void 0}, b || Gis.Maps.Leaflet.EventConverter.setEvents(a.events, d.polyline), this.setLabel(a, d.polyline), d
}, _polyline: function (a, b, c) {
    var d, e;
    return b.className = (b.className || "") + (b.clickable ? " gis-polyline" : ""), d = c || L.polyline(a, b), this.map.hasLayer(d) || d.addTo(this.map), c ? (e = b.clickable || b.tooltip, delete b.clickable, d.setStyle(b), this._converter.setOptions(this._converter.polylineSetters(), Gis.Util.extend(b, {clickable: !0}), d)) : d.setClassName(b.className), b.tooltip ? d._popup ? d._popup.setContent(b.tooltip) : d.bindPopup(b.tooltip, Gis.Util.extend({className: Gis.Config.popupClass}), !0) : d.unbindPopup(), d
}, _multiPolyline: function (a, b, c) {
    var d, e;
    return b.className = (b.className || "") + (b.clickable ? " gis-polyline" : ""), d = c || L.multiPolyline(a, b), this.map.hasLayer(d) || d.addTo(this.map), c ? (e = b.clickable || b.tooltip, delete b.clickable, d.setStyle(b), this._converter.setOptions(this._converter.polylineSetters(), Gis.Util.extend(b, {clickable: !0}), d)) : d.setClassName(b.className), b.tooltip ? d._popup ? d._popup.setContent(b.tooltip) : d.bindPopup(b.tooltip, Gis.Util.extend({className: Gis.Config.popupClass}), !0) : d.unbindPopup(), d
}, _polygon: function (a, b, c) {
    var d, e;
    return e = !0, Gis.Util.extend(b, {clickable: e}), d = c || L.polygon(a, b), this.map.hasLayer(d) || d.addTo(this.map), c && (delete b.clickable, d.setStyle(b), b.clickable = e, this._converter.setOptions(this._converter.polygonSetters(), b, d)), b.tooltip ? d._popup ? d._popup.setContent(b.tooltip) : d.bindPopup(b.tooltip, Gis.Util.extend({className: Gis.Config.popupClass}), !0) : d.unbindPopup(), d
}, setLabel: function (a, b) {
    a.caption ? b.bindLabel(a.caption, b._label ? void 0 : Gis.Util.extend({className: Gis.Config.captionClass, position: a.captionPosition})) : b.unbindLabel()
}, drawMarker: function (a, b) {
    var c, d, e, f = a.events;
    return(a.iconUrl || a.icon) && (e = a.iconUrl || a.icon.getImageUrl(), b && b.iconUrl && b.iconUrl === e ? delete a.icon : a.icon = a.icon.isPredefinedType() ? new L.Icon.Canvas({className: a.className, clickableClass: "gis-clickable", src: e}) : L.icon({className: a.className, clickableClass: "gis-clickable", iconUrl: e})), d = Gis.Util.extend(this._converter.marker(a), {clickable: !0}), b ? (c = b.marker, this._converter.setOptions(this._converter.markerSetters(), d, c)) : (c = L.markerGis(a.latlng, d), Gis.Maps.Leaflet.EventConverter.setEvents(f, c)), a.gisClass && c.addClass(a.gisClass), c[a.selected ? "addClass" : "removeClass"](Gis.Config.gisSelectedClass), this.map.hasLayer(c) || c.addTo(this.map), a.popup ? c._popup ? c._popup.setContent(a.popup) : c.bindPopup(a.popup, Gis.Util.extend({className: Gis.Config.popupClass}), !0) : c.unbindPopup(), this.setLabel(a, c), {marker: c, iconUrl: e}
}, drawText: function (a, b) {
    a.text = a.caption + "";
    var c = Gis.Util.extend(this._converter.textLabel(a), {clickable: !0, selectedClass: Gis.Config.gisSelectedClass}), d = b && b.label || new L.Label(Gis.Util.extend({}, c, {className: a.className || Gis.Config.textLabelClass})), e = a.events;
    return this._converter.setOptions(this._converter.textSetters(), c, d), d.openOn(this.map), d.setDraggable(c.draggable), b || Gis.Maps.Leaflet.EventConverter.setEvents(e, d), a.popup ? d._popup ? d._popup.setContent(a.popup) : d.bindPopup(a.popup, Gis.Util.extend({className: Gis.Config.popupClass}), !0) : d.unbindPopup(), {label: d}
}, drawEllipse: function (a, b) {
    var c, d, e, f, g = this._getLineStyle(a.line), h = this._getFillStyle(a.fill);
    return f = b || this.getFromCache("ellipse"), c = Gis.Util.extend(this._converter.ellipse(Gis.Util.extend({}, a)), g.stroke, h, {clickable: !0}), d = Gis.Util.extend(this._converter.ellipse(Gis.Util.extend({}, a)), g.line, {draggable: !1}), e = {ellipse: this._ellipse(a.latlng, a.alpha, a.betta, a.gamma, c, f && f.ellipse), stroke: this._ellipse(a.latlng, a.alpha, a.betta, a.gamma, d, f && f.stroke)}, b || Gis.Maps.Leaflet.EventConverter.setEvents(a.events, e.ellipse), this.setLabel(a, e.ellipse), e
}, deleteEvents: function (a, b) {
    Gis.Maps.Leaflet.EventConverter.deleteEvents(a, b)
}, _ellipse: function (a, b, c, d, e, f) {
    var g;
    return f ? (g = f, delete e.clickable, g.setStyle(e), this._converter.setOptions(this._converter.ellipseSetters(), Gis.Util.extend(e, {clickable: !0}), g)) : g = L.ellipse(a, b, c, d, e), e.tooltip ? g._popup ? g._popup.setContent(e.tooltip) : g.bindPopup(e.tooltip, Gis.Util.extend({className: Gis.Config.popupClass}), !0) : g.unbindPopup(), this.map.hasLayer(g) || g.addTo(this.map), g
}, drawSector: function (a, b) {
    var c, d, e, f, g = this._getLineStyle(a.line), h = this._getFillStyle(a.fill);
    return f = b || this.getFromCache("sector"), a.stopAngle = a.finishAngle, d = Gis.Util.extend(this._converter.sector(Gis.Util.extend({}, a)), g.stroke, h, {clickable: !0}), e = Gis.Util.extend(this._converter.sector(Gis.Util.extend({}, a)), g.line, {draggable: !1}), c = {sector: this._sector(a.latlng, a.radius, d, f && f.sector), line: this._sector(a.latlng, a.radius, e, f && f.line)}, b || Gis.Maps.Leaflet.EventConverter.setEvents(a.events, c.sector), this.setLabel(a, c.sector), c
}, _sector: function (a, b, c, d) {
    var e, f;
    return d ? (e = d, f = !0, delete c.clickable, e.setStyle(c), this._converter.setOptions(this._converter.sectorSetters(), Gis.Util.extend(c, {clickable: !0}), e)) : e = L.sector(a, b, c), c.tooltip ? e._popup ? e._popup.setContent(c.tooltip) : e.bindPopup(c.tooltip, Gis.Util.extend({className: Gis.Config.popupClass}), !0) : e.unbindPopup(), this.map.hasLayer(e) || e.addTo(this.map), e
}, getObjectBounds: function (a) {
    return a.getContainerBounds ? this._convertBounds(a.getContainerBounds()) : null
}, _onZoomStart: function (a) {
    this.fire("zoomstart", a)
}, _onZoomEnd: function (a) {
    this.options.zoom = this.getZoom(), this.fire("zoomend", a)
}, _onMoveEnd: function (a) {
    this.options.latlng = this.getCenter(), this.fire("moveend", a)
}, _tileLoad: function (a) {
    a.target.key && (a.target.parentData && a.target.parentData.saveIsLocal && a.target.parentData.saveIsLocal(a.target.key), this.removeTileLayer(this.getTileLayer(a.target.getURL().replace(a.target.key, a.target.del)))), this.fire("tileload", Gis.Util.extend(a))
}, getTileLayer: function (a) {
    return this._tileLayer && this._tileLayer[a]
}, removeTileLayer: function (a) {
    return a && (a.off("tileloadok", this._tileLoad, this), this.map.removeLayer(a), delete this._tileLayer[a.getURL()]), this
}, removeAllLayers: function () {
    var a, b = this._tileLayer;
    if (b)for (a in b)b.hasOwnProperty(a) && this.removeTileLayer(b[a]);
    return this
}, initLayer: function (a, b, c) {
    var d, e, f = a.getCrs(), g = a.getOptions(), h = Gis.Maps.Leaflet.LeafletProvider.getCustomCrs(f.getCode(), f.getProj4def(), f.getProjectedBounds(), f.getOptions()), i = Gis.Util.extend({attribution: Gis.moduleName.ru, tileSize: g && g.dimension && g.dimension.x && parseInt(a.getOptions().dimension.x, 10) || 256, maxZoom: a.getMaxZoom(), minZoom: a.getMinZoom(), errorTileUrl: c ? void 0 : Gis.Config.image.ErrorTile || Gis.Config.image("ErrorTile")}, a.getOptions(), b, {crs: h});
    return Gis.config("no-wrap-layer") && (i.noWrap = !0), a && Gis.Maps.Leaflet.TYPES[a.getType()] ? e = Gis.Maps.Leaflet.TYPES[a.getType()](a, i) : (d = a.getURL(), "?" === d[d.length - 1] ? (e = [], e[0] = L.tileLayer(d.substr(0, d.length - 1) + "png", i), e[0].key = "jpg", e[0].del = "png", e[1] = L.tileLayer(d.substr(0, d.length - 1) + "jpg", i), e[0].key = "png", e[0].del = "jpg") : e = L.tileLayer(d, i)), e
}, _addTileLayer: function (a) {
    var b = this;
    return Gis.Util.isArray(a) ? void a.forEach(function (a) {
        b._addTileLayer(a)
    }) : this._tileLayer.hasOwnProperty(a.getURL()) && this.map.hasLayer(this._tileLayer[a.getURL()]) ? void Gis.Logger.log(" " + a.getURL() + "  ") : (this._tileLayer[a.getURL()] = a, a.on("tileloadok", this._tileLoad, this), this.map.addLayer(a), void this.map.setView(this.map.getCenter()))
}, setMapType: function (a) {
    var b, c, d, e = a.layer;
    if (this.map && e) {
        if (this.removeAllLayers(), this._zIndexCurrent = 100, b = this.initLayer(e, {zIndex: this._zIndexCurrent}), Gis.Util.isArray(b))for (c = 0, d = b.length; d > c; c += 1)b[c].parentData = a; else b.parentData = a;
        this._addTileLayer(b, !0), this.map.fire("baselayerchange", {layer: b})
    }
    return this
}, _extendProjectedBounds: function (a) {
    var b, c, d, e = a.layer.getCrs(), f = a.layer.getCrs().getProjectedBounds();
    this.maxBounds && (f ? (d = L.bounds(this._CRS.projectedBounds.slice(0, 2), this._CRS.projectedBounds.slice(2, 4)), d.extend(f.slice(0, 2)), d.extend(f.slice(2, 4)), this.maxBounds = L.latLngBounds(this._CRS.projection.unproject(d.min), this._CRS.projection.unproject(d.max))) : (c = L.CRS[e.getCode().replace(":", "")], b = c && c.projection.MAX_LATITUDE, b && (this.maxBounds.extend(L.latLng(b, 180)), this.maxBounds.extend(L.latLng(-b, -180)))), this.setMaxBounds(this.maxBounds))
}, addMapTile: function (a, b) {
    var c, d, e, f = a.layer;
    if (this._lastLayer = a, this._zIndexCurrent += 1, this.map && f) {
        if (c = this.initLayer(f, Gis.Util.extend(b, {zIndex: this._zIndexCurrent, maxNativeZoom: f.getMaxZoom()}), !0), Gis.Util.isArray(c))for (d = 0, e = c.length; e > d; d += 1)c[d].parentData = a; else c.parentData = a;
        this._extendProjectedBounds(a), this._addTileLayer(c)
    }
    return this
}, showMap: function () {
    return this.map = this._getMap(this.options), this.setMapType(this.options), this.map.on("click", this._onMouseEvent, this), this.map.on("mousedown", this._onMouseEvent, this), this.map.on("mouseup", this._onMouseEvent, this), this.map.on("mousemove", this._onMouseEvent, this), this.map.on("mouseout", this._onMouseEvent, this), this.map.on("zoomstart", this._onZoomStart, this), this.map.on("zoomend", this._onZoomEnd, this), this.map.on("moveend", this._onMoveEnd, this), this.fire("mapattached"), this
}, getPixelBounds: function () {
    return this.map.getPixelBounds()
}, _pointInAvailableBounds: function (a) {
    var b = this.map.options.maxCenterBounds || this.map.options.maxBounds;
    return b ? this.map.getPixcelBounds(b).contains(a) : !0
}, setCenter: function (a, b) {
    return this.map && this._pointInAvailableBounds(this.map.project(L.latLng(a))) && (this.options.latlng = a instanceof Array ? Gis.latLng(a[0], a[1]) : a, b ? this.map.setView(L.latLng(this.options.latlng.lat, this.options.latlng.lng), this.map.getZoom()) : this.map.panTo(L.latLng(this.options.latlng.lat, this.options.latlng.lng))), this
}, setZoomAround: function (a, b) {
    return b = Gis.Util.isDefine(a) ? b : this.map.getZoom(), this.map && this._pointInAvailableBounds(this.map.project(L.latLng(a))) && this.map.setZoomAround(a, b), this
}, latLngToLayerPoint: function (a) {
    a = Gis.latLng(a);
    var b = this.map.latLngToLayerPoint([a.lat, a.lng]);
    return Gis.point(b.x, b.y)
}, layerPointToLatLng: function (a) {
    a = Gis.point(a);
    var b = this.map.layerPointToLatLng([a.x, a.y]);
    return Gis.latLng(b.lat, b.lng)
}, _onMouseEvent: function (a) {
    this.fire(a.type, Gis.Maps.Leaflet.EventConverter._mouseEvent(a))
}, pushToCache: function (a) {
    var b = a.getType();
    this._cachedObjects[b] = this._cachedObjects[b] || [], this._cachedObjects[b].length < this._maxInCache && this._cachedObjects[b].push(a.getLowLevelObject())
}, getFromCache: function (a) {
    return this._cachedObjects[a] && this._cachedObjects[a].length ? this._cachedObjects[a].pop() : null
}, removeLayer: function (a) {
    function b(c) {
        var e;
        if (c && "object" == typeof c)for (e in c)c.hasOwnProperty(e) && void 0 !== c[e] && (c.inset ? b(c[e]) : (d.map.removeLayer(c[e]), a.events && d.deleteEvents({context: a, type: a.events}, c[e])))
    }

    var c, d = this;
    a && (c = a.getLowLevelObject ? a.getLowLevelObject() : a, a.getType && a.isCached() && this.pushToCache(a), b(c), c && a.setLowLevelObject && a.setLowLevelObject())
}, _mapAttached: function () {
    var a, b = this;
    this._laterAttach = !1;
    for (a in this._laterAttach)this._laterAttach.hasOwnProperty(a) && b.map.on(this._laterAttach[a].types, this._fireEventFromLowLevel, b)
}, layerRendered: function (a) {
    this.addEventToLayer(a.target, a.target[Gis.Core.Events.eventsKey])
}});
var crsCache = {};
Gis.Maps.Leaflet.LeafletProvider.getCustomCrs = function (a, b, c, d) {
    var e, f = a.replace(":", "");
    return(e = crsCache[a + b + c + d]) ? e : (L.CRS.hasOwnProperty(f) && !c ? e = L.CRS[f] : b || Gis.ProjectionDatuums.getDatum(a) ? e = L.customProjection(a, b || Gis.ProjectionDatuums.getDatum(a), c, d) : (Gis.notify("  " + a, "error"), Gis.Logger.log("  " + a)), crsCache[a + b + c + d] = e, e)
}, Gis.Maps.Leaflet.TYPES = {getMapParams: function (a) {
    var b, c = "";
    if (a)for (b in a)a.hasOwnProperty(b) && (c += "&" + encodeURIComponent(b) + "=" + encodeURIComponent(a[b]));
    return c
}, google: function (a, b) {
    var c = b && b.mapData || {};
    return c = Gis.extend({v: "3.2", sensor: !1}, c), new L.DeferredLayer({name: "Google", js: [Gis.Config.relativePath + "libs/Google.js", "http://maps.google.com/maps/api/js?v=3.exp&callback=L.Google.asyncInitialize" + this.getMapParams(c)], init: function () {
        return new L.Google(a.getMapType(), b)
    }})
}, tms: function (a, b) {
    var c, d = a.getCrs(), e = !0, f = d.getProjectedBounds(), g = a.getActiveCustomLayersMask();
    return f && b.crs && (c = L.latLngBounds(b.crs.projection.unproject(L.point(f.slice(0, 2))), b.crs.projection.unproject(L.point(f.slice(2, 4)))), e = b.noWrap || Math.abs(c.getNorthEast().lng - c.getNorthWest().lng - 360) > 1e-8), b.tms = !0, new L.TMSLayer(a.getURL(), Gis.Maps.Leaflet.LeafletProvider.getCustomCrs(d.getCode(), d.getProj4def(), f, d.getOptions()), Gis.Util.extend({continuousWorld: !1, noWrap: e, getParams: g ? {layers: g} : null}, b))
}, osm: function (a, b) {
    return new L.TileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", b)
}, cloudmade: function (a, b) {
    return new L.TileLayer("http://{s}.tile.cloudmade.com/" + a.getKey() + "/997/256/{z}/{x}/{y}.png", b)
}, yandex: function (a, b) {
    var c = b && b.mapData || {};
    return c = Gis.extend({lang: "ru-RU"}, c), new L.DeferredLayer({name: "Yandex", js: [Gis.Config.relativePath + "libs/Yandex.js", "http://api-maps.yandex.ru/2.0/?load=package.map" + this.getMapParams(c)], init: function () {
        return new L.Yandex(a.getMapType(), b)
    }})
}, bing: function (a, b) {
    return new L.DeferredLayer({name: "Bing", js: [Gis.Config.relativePath + "libs/Bing.js"], init: function () {
        return new L.BingLayer(a.getApiKey(), Gis.extend({}, b, {type: b.types[b.mapType]}))
    }})
}}, L.CaptionBehavior = function (a) {
    "use strict";
    return{bindLabel: function (b, c) {
        if (this._label && !c)return this._label.setContent(b), this._moveLabel(), this._map && !this._map.hasLayer(this._label) && this.showLabel(), this;
        var d = a.point(0, 0);
        return d = d.add(a.Label.prototype.options.offset), c && c.offset && (d = d.add(c.offset)), c = a.Util.extend({offset: d}, c), this._label || (this.on("remove", this.hideLabel, this).on("move", this._moveLabel, this), this._haslabelHandlers = !0), this._label = new a.Label(c, this).setContent(b), this.showLabel(), this._label.setIconOffset(this._labelIconOffset()), this._label.setOffset(this._calculateLabelOffset()), this
    }, _calculateLabelOffset: function () {
        return a.point(0, 0)
    }, _labelIconOffset: function () {
        return a.point(0, 0)
    }, getLabelLatLng: function () {
        Gis.extendError()
    }, hideLabel: function () {
        return this._label && (this._label.close(), this._map.closeLabel(this._label)), this
    }, showLabel: function () {
        return this._label && this._map && (this._label.setLatLng(this.getLabelLatLng()), this._map.showLabel(this._label)), this
    }, _moveLabel: function () {
        this._label && this._label.setLatLng(this.getLabelLatLng())
    }, unbindLabel: function () {
        return this._label && (this.hideLabel(), delete this._label, this._haslabelHandlers && this.off("remove", this.hideLabel).off("move", this._moveLabel), this._haslabelHandlers = !1), this
    }}
}(L), function (a) {
    "use strict";
    a.PopupBehavior = {_opened: !1, bindPopup: function (b, c) {
        return this._popup || (this.on("mouseover", this.openPopup, this).on("mousemove", this._movePopup, this).on("mouseout remove", this.closePopup, this), a.Browser.touch && this.on("click", this.openPopup, this)), this._popup = new a.PopupGis(c, this).setContent(b), this._popup.setOffset(a.point(0, -5)), this
    }, unbindPopup: function () {
        return this._popup && (this.closePopup(), this._popup = null, this.off("mouseover", this.openPopup).off("mousemove", this._movePopup).off("mouseout remove", this.closePopup)), this
    }, autoTooltip: function (a) {
        this.getToolTip && this.getToolTip(a.latlng) && this._popup.setContent(this.getToolTip(a.latlng))
    }, _movePopup: function (a) {
        this.openPopup(a), this.autoTooltip(a), this._popup.setLatLng(a.latlng)
    }, openPopup: function (a) {
        return!this._opened && this._popup && this._map && (this._popup.setLatLng(a.latlng), this.autoTooltip(a), this._map.openPopup(this._popup), this._opened = !0), this
    }, closePopup: function () {
        return this._popup && (this._popup._close(), this._opened = !1), this
    }}
}(L), L.DraggableCanvas = L.Draggable.extend({_updatePosition: function () {
    this.fire("predrag"), this._canvas.setLayerPosition(this._newPos), this.fire("drag")
}, setElement: function (a) {
    this._canvas = a
}, _onDown: function (a) {
    this._canvas.inImage(a) && L.Draggable.prototype._onDown.call(this, a)
}}), L.Handler.CanvasDrag = L.Handler.extend({initialize: function (a) {
    this._canvas = a
}, addHooks: function () {
    var a = this._canvas._canvas;
    this._draggable || (this._draggable = new L.DraggableCanvas(a, this._canvas._map._panes.overlayPane).on("dragstart", this._onDragStart, this).on("drag", this._onDrag, this).on("dragend", this._onDragEnd, this), this._draggable.setElement(this._canvas)), this._draggable.enable()
}, removeHooks: function () {
    this._draggable.disable()
}, moved: function () {
    return this._draggable && this._draggable._moved
}, _onDragStart: function () {
    this._canvas.fire("movestart").fire("dragstart")
}, _onDrag: function () {
    var a = this._canvas, b = L.DomUtil.getPosition(a._canvas), c = a._map.layerPointToLatLng(b);
    a._latlng = c, a.fire("move", {latlng: c}).fire("drag")
}, _onDragEnd: function () {
    this._canvas.fire("moveend").fire("dragend")
}}), function (a) {
    "use strict";
    var b, c = function (a) {
        var b, c = a * this.percent, d = (a - c) / c, e = 0, f = "";
        for (e; c > e; e += 1)for (b = 0; c > b; b += 1)f += "M" + (b * d + b) + "," + (e * d + e) + " h1 v1 h-1 z";
        return f
    }, d = function () {
        return"fill:" + (this.options.color || "black") + ";stroke:none;"
    }, e = 10, f = function (a) {
        var b = 2, c = a - b, d = a / 2 - b;
        return"M0,0 h" + c + " v" + d + "h-" + c + "z M 0, " + (d + b) + " h" + (c / 2 - b) + " v" + d + "h-" + (c / 2 - b) + "z M " + c / 2 + ", " + (d + b) + " h" + (c / 2 + b) + " v" + d + "h-" + (c / 2 + b) + "z"
    }, g = function (a) {
        var b = this.getHeight() / 2, c = this.getWidth() / 3, d = "l" + b + "," + c + " " + b + ", -" + c, e = [-(a / 4), a / 4, 3 * a / 4], f = "";
        return e.forEach(function (a) {
            f += "M0," + a + " " + d
        }), f
    };
    a.PathFillExtend = {options: {fillHatch: !1}, setFillHatch: function (b) {
        var c = this.options.fillHatch, d = !c && b.isHatch() && a.HatchClass.CHANGED || c && c.compare(b) && a.HatchClass.CHANGED;
        d && (this.options.fillHatch = b, this._recalculateHatch(d === a.HatchClass.COLOR_CHANGED))
    }, _setPattern: function (a) {
        this._pattern = a, a.getPattern(this._container), this._path.setAttribute("fill", "url(#" + a.getPatternId() + ")")
    }, _recalculateHatch: function (a) {
        var c;
        a || (c = b[this.options.fillHatch.getStyle()]({color: this.options.fillHatch.getColor(), fillColor: this.options.fillColor, container: this._container}), c && this._setPattern(c)), this._pattern && this._pattern.setColor(this.options.fillHatch.getColor())
    }}, a.Hatch = a.Class.extend({dim: 10, strokeWidth: 1, path: function (a) {
        return"M0,0 l0," + a
    }, options: {color: "#000000", fillColor: void 0}, initialize: function (a) {
        this.options.color = a.color || "black", this.options.fillColor = a.fillColor || void 0, this._parentContainer = a.container
    }, _createElement: function (b) {
        return document.createElementNS(a.Path.SVG_NS, b)
    }, setColor: function (a) {
        this.options.color = a
    }, _initPath: function (a) {
        this._pattern = a.getElementsByTagName("pattern")[0], this._pattern ? (this._container = this._pattern.childNodes[0], this._bg = this._container.childNodes[0], this._path = this._container.childNodes[1]) : (this._pattern = this._createElement("pattern"), this._pattern.setAttribute("patternUnits", "userSpaceOnUse"), this._container = this._createElement("g"), this._path = this._createElement("path"), this._bg = this._createElement("path"), this._container.appendChild(this._bg), this._container.appendChild(this._path), this._pattern.appendChild(this._container), Gis.DomUtil.prepend(a, this._pattern))
    }, getPatternId: function () {
        return"fillpatern"
    }, getWidth: function () {
        return this.dim
    }, getHeight: function () {
        return this.dim
    }, getFillPath: function () {
        return"M0,0  H " + this.getWidth() + " V " + this.getHeight() + " H 0 V 0"
    }, pathStyle: function () {
        return"fill:none;stroke:" + (this.options.color || "black") + "; stroke-width:" + this.strokeWidth
    }, getFillStyle: function () {
        return"fill:" + (this.options.fillColor || "none") + ";"
    }, getTransform: function () {
        return""
    }, strokeDashArray: function () {
        return""
    }, _initPattern: function () {
        return this._pattern.setAttribute("id", this.getPatternId()), this._pattern.setAttribute("x", 0), this._pattern.setAttribute("y", 0), this._pattern.setAttribute("width", this.getWidth()), this._container.setAttribute("fill-rule", "evenodd"), this._pattern.setAttribute("height", this.getHeight()), this._pattern.setAttribute("transform", this.getTransform()), this._bg.setAttribute("style", this.getFillStyle()), this._bg.setAttribute("d", this.getFillPath()), this._path.setAttribute("style", this.pathStyle()), this._path.setAttribute("stroke-dasharray", this.strokeDashArray()), this._path.setAttribute("d", this.path(this.dim)), this._pattern
    }, getPattern: function (a) {
        if (!this._pattern) {
            if (!a && this._parentContainer)throw new Error("not seted container");
            this._initPath(a || this._parentContainer)
        }
        return this._initPattern()
    }}), a.Hatch = a.extend(a.Hatch, {HatchStyleHorizontal: 0, HatchStyleVertical: 1, HatchStyleForwardDiagonal: 2, HatchStyleBackwardDiagonal: 3, HatchStyleCross: 4, HatchStyleDiagonalCross: 5, HatchStyle05Percent: 6, HatchStyle10Percent: 7, HatchStyle20Percent: 8, HatchStyle25Percent: 9, HatchStyle30Percent: 10, HatchStyle40Percent: 11, HatchStyle50Percent: 12, HatchStyle60Percent: 13, HatchStyle70Percent: 14, HatchStyle75Percent: 15, HatchStyle80Percent: 16, HatchStyle90Percent: 17, HatchStyleLightDownwardDiagonal: 18, HatchStyleLightUpwardDiagonal: 19, HatchStyleDarkDownwardDiagonal: 20, HatchStyleDarkUpwardDiagonal: 21, HatchStyleWideDownwardDiagonal: 22, HatchStyleWideUpwardDiagonal: 23, HatchStyleLightVertical: 24, HatchStyleLightHorizontal: 25, HatchStyleNarrowVertical: 26, HatchStyleNarrowHorizontal: 27, HatchStyleDarkVertical: 28, HatchStyleDarkHorizontal: 29, HatchStyleDashedDownwardDiagonal: 30, HatchStyleDashedUpwardDiagonal: 31, HatchStyleDashedHorizontal: 32, HatchStyleDashedVertical: 33, HatchStyleSmallConfetti: 34, HatchStyleLargeConfetti: 35, HatchStyleZigZag: 36, HatchStyleWave: 37, HatchStyleDiagonalBrick: 38, HatchStyleHorizontalBrick: 39, HatchStyleDivot: 42, HatchStyleDottedGrid: 43, HatchStyleDottedDiamond: 44, HatchStyleShingle: 45, HatchStyleTrellis: 46, HatchStyleSphere: 47, HatchStyleSmallGrid: 48, HatchStyleSmallCheckerBoard: 49, HatchStyleLargeCheckerBoard: 50, HatchStyleOutlinedDiamond: 51, HatchStyleSolidDiamond: 52, HatchStyleTotal: 53}), a.Hatch.HatchStyleLargeGrid = a.Hatch.HatchStyleCross, a.Hatch.HatchStyleMin = a.Hatch.HatchStyleHorizontal, a.Hatch.HatchStyleMax = a.Hatch.HatchStyleTotal - 1, b = {}, b[a.Hatch.HatchStyleHorizontal] = function (b) {
        return new (a.Hatch.extend({path: function (a) {
            return"M0,0 l" + a + ",0"
        }}))(b)
    }, b[a.Hatch.HatchStyleVertical] = function (b) {
        return new (a.Hatch.extend({path: function (a) {
            return"M0,0 l0," + a
        }}))(b)
    }, b[a.Hatch.HatchStyleForwardDiagonal] = function (b) {
        return new (a.Hatch.extend({path: function (a) {
            return"M0,0 " + a + "," + a
        }}))(b)
    }, b[a.Hatch.HatchStyleBackwardDiagonal] = function (b) {
        return new (a.Hatch.extend({path: function (a) {
            return"M0," + a + " " + a + ",0"
        }}))(b)
    }, b[a.Hatch.HatchStyleCross] = function (b) {
        return new (a.Hatch.extend({path: function (a) {
            return"M0,0 H " + a + " V " + a
        }}))(b)
    }, b[a.Hatch.HatchStyleSmallGrid] = function (b) {
        return new (a.Hatch.extend({dim: 5, path: function (a) {
            return"M0,0 H " + a + " V " + a
        }}))(b)
    }, b[a.Hatch.HatchStyleDottedGrid] = function (b) {
        return new (a.Hatch.extend({dim: 5, strokeDashArray: function () {
            return this.strokeWidth + " " + this.strokeWidth
        }, path: function (a) {
            return"M0,0 H " + a + " V " + a
        }}))(b)
    }, b[a.Hatch.HatchStyleDiagonalCross] = function (b) {
        return new (a.Hatch.extend({path: function (a) {
            return"M0,0 l" + a + "," + a + " M" + a + ",0 l-" + a + "," + a
        }}))(b)
    }, b[a.Hatch.HatchStyle05Percent] = function (b) {
        return new (a.Hatch.extend({percent: .05, path: c, dim: e, pathStyle: d}))(b)
    }, b[a.Hatch.HatchStyle10Percent] = function (b) {
        return new (a.Hatch.extend({percent: .1, path: c, dim: e, pathStyle: d}))(b)
    }, b[a.Hatch.HatchStyle20Percent] = function (b) {
        return new (a.Hatch.extend({percent: .2, path: c, dim: e, pathStyle: d}))(b)
    }, b[a.Hatch.HatchStyle25Percent] = function (b) {
        return new (a.Hatch.extend({percent: .25, path: c, dim: e, pathStyle: d}))(b)
    }, b[a.Hatch.HatchStyle30Percent] = function (b) {
        return new (a.Hatch.extend({percent: .3, path: c, dim: e, pathStyle: d}))(b)
    }, b[a.Hatch.HatchStyle40Percent] = function (b) {
        return new (a.Hatch.extend({percent: .4, path: c, dim: e, pathStyle: d}))(b)
    }, b[a.Hatch.HatchStyle50Percent] = function (b) {
        return new (a.Hatch.extend({percent: .5, path: c, dim: e, pathStyle: d}))(b)
    }, b[a.Hatch.HatchStyle60Percent] = function (b) {
        return new (a.Hatch.extend({percent: .6, path: c, dim: e, pathStyle: d}))(b)
    }, b[a.Hatch.HatchStyle70Percent] = function (b) {
        return new (a.Hatch.extend({percent: .7, path: c, dim: e, pathStyle: d}))(b)
    }, b[a.Hatch.HatchStyle75Percent] = function (b) {
        return new (a.Hatch.extend({percent: .75, path: c, dim: e, pathStyle: d}))(b)
    }, b[a.Hatch.HatchStyle80Percent] = function (b) {
        return new (a.Hatch.extend({percent: .8, path: c, dim: e, pathStyle: d}))(b)
    }, b[a.Hatch.HatchStyle90Percent] = function (b) {
        return new (a.Hatch.extend({percent: .9, path: c, dim: e, pathStyle: d}))(b)
    }, b[a.Hatch.HatchStyleLightDownwardDiagonal] = function (b) {
        return new (a.Hatch.extend({dim: 5, path: function (a) {
            return"M0,0 l" + a + "," + a
        }}))(b)
    }, b[a.Hatch.HatchStyleLightUpwardDiagonal] = function (b) {
        return new (a.Hatch.extend({dim: 5, path: function (a) {
            return"M0," + a + " L" + a + ",0"
        }}))(b)
    }, b[a.Hatch.HatchStyleDarkUpwardDiagonal] = function (b) {
        return new (a.Hatch.extend({dim: 5, path: function (a) {
            return"M0," + a + " L" + a + ",0"
        }}))(b)
    }, b[a.Hatch.HatchStyleDarkDownwardDiagonal] = function (b) {
        return new (a.Hatch.extend({dim: 5, path: function (a) {
            return"M0,0 l" + a + "," + a
        }}))(b)
    }, b[a.Hatch.HatchStyleWideDownwardDiagonal] = function (b) {
        return new (a.Hatch.extend({strokeWidth: 2, dim: 5, path: function (a) {
            return"M0,0 l" + a + "," + a
        }}))(b)
    }, b[a.Hatch.HatchStyleWideUpwardDiagonal] = function (b) {
        return new (a.Hatch.extend({strokeWidth: 2, dim: 5, path: function (a) {
            return"M0," + a + " L" + a + ",0"
        }}))(b)
    }, b[a.Hatch.HatchStyleLightHorizontal] = function (b) {
        return new (a.Hatch.extend({dim: 5, path: function (a) {
            return"M0,0 H" + a
        }}))(b)
    }, b[a.Hatch.HatchStyleLightVertical] = function (b) {
        return new (a.Hatch.extend({dim: 5, path: function (a) {
            return"M0,0 V" + a
        }}))(b)
    }, b[a.Hatch.HatchStyleNarrowHorizontal] = function (b) {
        return new (a.Hatch.extend({dim: 7, path: function (a) {
            return"M0,0 l" + a + ",0"
        }}))(b)
    }, b[a.Hatch.HatchStyleNarrowVertical] = function (b) {
        return new (a.Hatch.extend({dim: 7, path: function (a) {
            return"M0,0 l0," + a
        }}))(b)
    }, b[a.Hatch.HatchStyleDarkHorizontal] = function (b) {
        return new (a.Hatch.extend({dim: 5, strokeWidth: 2, path: function (a) {
            return"M0,0 l" + a + ",0"
        }}))(b)
    }, b[a.Hatch.HatchStyleDarkVertical] = function (b) {
        return new (a.Hatch.extend({dim: 5, strokeWidth: 2, path: function (a) {
            return"M0,0 l0," + a
        }}))(b)
    }, b[a.Hatch.HatchStyleDashedDownwardDiagonal] = function (b) {
        return new (a.Hatch.extend({getHeight: function () {
            return 2 * this.dim
        }, path: function (a) {
            return"M0,0 l" + a + "," + a
        }}))(b)
    }, b[a.Hatch.HatchStyleDashedUpwardDiagonal] = function (b) {
        return new (a.Hatch.extend({getHeight: function () {
            return 2 * this.dim
        }, path: function (a) {
            return"M0," + a + " L" + a + ",0"
        }}))(b)
    }, b[a.Hatch.HatchStyleDashedHorizontal] = function (b) {
        return new (a.Hatch.extend({path: function (a) {
            return"M0," + (a / 2 - this.strokeWidth) + " H" + a / 2 + " M" + a / 2 + "," + (a - this.strokeWidth) + " H " + a
        }}))(b)
    }, b[a.Hatch.HatchStyleTrellis] = function (b) {
        return new (a.Hatch.extend({strokeWidth: 1, pathStyle: function () {
            return"fill:none;stroke:" + (this.options.fillColor || "none") + "; stroke-width:" + this.strokeWidth
        }, getFillStyle: function () {
            return"fill:" + (this.options.color || "black") + ";"
        }, path: function (a) {
            return"M0," + (a / 2 - this.strokeWidth) + " H" + a / 2 + " M" + a / 2 + "," + (a - this.strokeWidth) + " H " + a
        }}))(b)
    }, b[a.Hatch.HatchStyleHorizontalBrick] = function (b) {
        return new (a.Hatch.extend({dim: 20, pathStyle: function () {
            return"fill:" + (this.options.color || "black") + ";"
        }, path: f}))(b)
    }, b[a.Hatch.HatchStyleDiagonalBrick] = function (b) {
        return new (a.Hatch.extend({dim: 20, pathStyle: function () {
            return"fill:" + (this.options.color || "black") + ";"
        }, path: f}))(b)
    }, b[a.Hatch.HatchStyleDashedVertical] = function (b) {
        return new (a.Hatch.extend({path: function (a) {
            return"M" + (a / 2 - this.strokeWidth) + ",0 V" + a / 2 + " M" + (a - this.strokeWidth) + "," + a / 2 + " V" + a
        }}))(b)
    }, b[a.Hatch.HatchStyleSmallConfetti] = function (b) {
        return new (a.Hatch.extend({strokeWidth: 1, getFillStyle: function () {
            return"fill:" + (this.options.fillColor || "none") + ";"
        }, strokeDashArray: function () {
            return"1 1"
        }, dim: 8, path: g}))(b)
    }, b[a.Hatch.HatchStyleLargeConfetti] = function (b) {
        return new (a.Hatch.extend({strokeWidth: 2, strokeDashArray: function () {
            return"2 2"
        }, dim: 16, path: g}))(b)
    }, b[a.Hatch.HatchStyleZigZag] = function (b) {
        return new (a.Hatch.extend({dim: 8, path: g}))(b)
    }, b[a.Hatch.HatchStyleWave] = function (b) {
        return new (a.Hatch.extend({dim: 8, path: function (a) {
            var b = (this.getWidth() - this.strokeWidth) / 3, c = this.getHeight() / 3, d = "l" + b + "," + c + " " + b + ", -" + c + " " + b + ", " + c, e = [-(a / 4), a / 4, 3 * a / 4], f = "";
            return e.forEach(function (a) {
                f += "M0," + a + " " + d
            }), f
        }}))(b)
    }, b[a.Hatch.HatchStyleSolidDiamond] = function (b) {
        return new (a.Hatch.extend({pathStyle: function () {
            return"fill:" + (this.options.color || "black") + ";stroke:none"
        }, path: function (a) {
            return"M" + a / 2 + ",0 L" + a + "," + a / 2 + " L" + a / 2 + "," + a + " L0," + a / 2 + "z"
        }}))(b)
    }, b[a.Hatch.HatchStyleLargeCheckerBoard] = function (b) {
        return new (a.Hatch.extend({pathStyle: function () {
            return"fill:" + (this.options.color || "black") + ";stroke:none"
        }, path: function (a) {
            return"M0,0 h" + a / 2 + " v" + a / 2 + " h" + -a / 2 + "zM" + a / 2 + "," + a / 2 + " h" + a / 2 + " v" + a / 2 + " h" + -a / 2 + "z"
        }}))(b)
    }, b[a.Hatch.HatchStyleSmallCheckerBoard] = function (b) {
        return new (a.Hatch.extend({dim: 5, pathStyle: function () {
            return"fill:" + (this.options.color || "black") + ";stroke:none"
        }, path: function (a) {
            return"M0,0 h" + a / 2 + " v" + a / 2 + " h" + -a / 2 + "zM" + a / 2 + "," + a / 2 + " h" + a / 2 + " v" + a / 2 + " h" + -a / 2 + "z"
        }}))(b)
    }, b[a.Hatch.HatchStyleOutlinedDiamond] = function (b) {
        return new (a.Hatch.extend({path: function (a) {
            return"M" + a / 2 + ",0 L" + a + "," + a / 2 + " L" + a / 2 + "," + a + " L0," + a / 2 + "z"
        }}))(b)
    }, b[a.Hatch.HatchStyleDottedDiamond] = function (b) {
        return new (a.Hatch.extend({strokeDashArray: function () {
            return this.strokeWidth + " " + this.strokeWidth
        }, path: function (a) {
            return"M" + a / 2 + ",0 L" + a + "," + a / 2 + " L" + a / 2 + "," + a + " L0," + a / 2 + "z"
        }}))(b)
    }, b[a.Hatch.HatchStyleSphere] = function (b) {
        return new (a.Hatch.extend({pathStyle: function () {
            return"fill:" + (this.options.color || "black") + ";stroke:none"
        }, path: function (a) {
            return"M0," + a / 2 + " A" + a / 2 + "," + a / 2 + " 0 1 0 0," + (a / 2 - 1e-5) + "z M" + a / 2 + "," + a / 4 + " A" + a / 6 + "," + a / 10 + " 0 1 1 " + a / 2 + "," + (a / 4 - 1e-5) + "z"
        }}))(b)
    }, b[a.Hatch.HatchStyleDivot] = function (b) {
        return new (a.Hatch.extend({path: function (a) {
            var b = a / 3, c = a / 6;
            return"M0,0 l" + b + "," + c + " l" + -b + "," + c + " M" + 3 * b + "," + 3 * c + " l" + -b + "," + c + " l" + b + "," + c + " "
        }}))(b)
    }
}(L), function () {
    "use strict";
    L.Grid = L.Class.extend({includes: [L.Mixin.Events], initialize: function () {
        var a = this;
        this._countRect = 0, this._countLine = 0, this._textCount = 0, this._texts = [], this._rects = [], this._lines = [], this.drawGrid = function () {
            a.drawLines(), a.drawHeaders(), a._layer.draw()
        }
    }, addTo: function (a) {
        return a.addLayer(this), this
    }, onAdd: function (a) {
        this._map = a;
        var b = this;
        a.initKinetic(), this._layer = new Kinetic.Layer, this._groupLines = new Kinetic.Group, this._groupWhite = new Kinetic.Group, this._layer.add(this._groupWhite), this._layer.add(this._groupLines), this._map._kineticStage.add(this._layer), this.fire("add"), this.initEvents(), Gis.requestAnimationFrame(10)(function () {
            b.draw(), Gis.requestAnimationFrame(10)(function () {
                b._layer.setZIndex(1)
            })
        })
    }, onRemove: function () {
        this.deInitEvents(), this._layer.remove()
    }, initEvents: function () {
        this._map.on("moveend", this.moveEnd, this), this._map.on("movestart", this.moveStart, this), Gis.EventBus.on("skchanged", this.draw, this), this._map.on("zoomend", this._zoomEnd, this)
    }, deInitEvents: function () {
        this._map.off("moveend", this.moveEnd, this), this._map.off("movestart", this.moveStart, this), Gis.EventBus.off("skchanged", this.draw, this), this._map.off("zoomend", this._zoomEnd, this)
    }, moveEnd: function () {
        this.draw()
    }, moveStart: function () {
        this._groupWhite && (this._groupWhite.hide(), this._layer.draw())
    }, _zoomEnd: function () {
        this.draw()
    }, _getFreeLine: function () {
        var a = this._countLine++, b = this._lines[a];
        return b || (b = new Kinetic.Line({x: 0, y: 0, points: [0, 0, 200, 200], strokeWidth: 2, stroke: Gis.config("grid.line_color", L.Grid.DEFAULT_GRID_COLOR)}), this._lines[a] = b), this._groupLines.add(b), b
    }, _getFreeRect: function (a, b) {
        a = Gis.Util.isDefine(a) ? a : this._countRect++;
        var c = this._rects[a], d = b || this._groupWhite;
        return c || (c = new Kinetic.Rect({width: 100, height: 50, fill: "rgba(0, 0, 0, 0.3)"}), this._rects[a] = c), d.add(c), c
    }, _clearTextFrom: function () {
        var a, b = this._textCount;
        for (a = this._texts.length; a > b; b += 1)this._texts[b].remove();
        this._textCount = 0
    }, _clearLinesFrom: function () {
        var a, b = this._countLine;
        for (a = this._lines.length; a > b; b += 1)this._lines[b].remove();
        this._countLine = 0
    }, _clearRectsFrom: function () {
        var a, b = this._countRect;
        for (a = this._rects.length; a > b; b += 1)this._rects[b].remove();
        this._countRect = 0
    }, _getFreeText: function () {
        var a = this._textCount++, b = this._texts[a];
        return b || (b = new Kinetic.Text({x: 10, y: 15, offsetX: -3, text: "", fontSize: L.Grid.FONT_SIZE, shadowColor: "black", fill: "white", shadowBlur: 2}), this._texts[a] = b), this._groupLines.add(b), b
    }, getViewLatLng: function () {
        return this._map.getBounds()
    }, getViewPort: function () {
        var a;
        return a = this._map.getPixcelBoundsLayer(this.getViewLatLng()), a && this._map._kineticViewport.inters(a)
    }, getDimension: function (a) {
        var b = a && this.getViewPort(a) || this._map._kineticViewport;
        return L.point(b.max.x - b.min.x, b.max.y - b.min.y)
    }, draw: function () {
        Gis.requestAnimationFrame(10)(this.drawGrid)
    }, _drawSingleRect: function (a, b, c, d, e) {
        a.x(b), a.y(c), a.width(d), a.height(e)
    }, _drawWhite: function (a) {
        var b, c = a ? a.getSize().x : document.body.clientWidth, d = a ? a.getSize().y : document.body.clientHeight, e = a ? 0 : L.Grid.OFFSET_TEXT_LEFT, f = a ? 0 : L.Grid.OFFSET_TEXT_TOP, g = a ? 0 : L.Grid.OFFSET_TEXT_RIGHT, h = a ? 0 : L.Grid.OFFSET_TEXT_BOTTOM, i = L.Grid.OFFSET + e, j = L.Grid.OFFSET + f, k = L.Grid.OFFSET + g, l = L.Grid.OFFSET + h, m = a ? a.min.x : 0, n = a ? a.min.y : 0;
        this._drawSingleRect(this._getFreeRect(0), m, n, c, j), this._drawSingleRect(this._getFreeRect(1), m + c - k, n + j, k, d - j - l), this._drawSingleRect(this._getFreeRect(2), m, n + j, i, d - l), this._drawSingleRect(this._getFreeRect(3), m + i, n + d - l, c - k, l), b = this._getFreeRect(4, this._groupLines), b.fill("transparent"), b.stroke(Gis.config("grid.line_color", L.Grid.DEFAULT_GRID_COLOR)), b.strokeWidth(2), b.x(i + m), b.y(j + n), b.width(c - k - i), b.height(d - l - j), b = this._getFreeRect(5, this._groupLines), b.fill("transparent"), b.stroke(Gis.config("grid.line_color", L.Grid.DEFAULT_GRID_COLOR)), b.strokeWidth(2), b.x(e + m), b.y(f + n), b.width(c - e - g), b.height(d - f - h), this._groupWhite.show()
    }, getVerticalBounds: function (a) {
        return a ? [L.bounds(L.point(a.min.x + L.Grid.TEXT_HIDE, a.min.y), L.point(a.max.x - L.Grid.TEXT_HIDE, a.min.y + L.Grid.TEXT_SHOW_IN_BOUNDS)), L.bounds(L.point(a.min.x + L.Grid.TEXT_HIDE, a.max.y), L.point(a.max.x - L.Grid.TEXT_HIDE, a.max.y - L.Grid.TEXT_SHOW_IN_BOUNDS))] : [L.bounds(L.point(L.Grid.OFFSET_TEXT_LEFT + L.Grid.OFFSET + L.Grid.TEXT_HIDE, L.Grid.OFFSET_TEXT_TOP), L.point(document.body.clientWidth - L.Grid.OFFSET_TEXT_RIGHT - L.Grid.OFFSET - L.Grid.TEXT_HIDE, L.Grid.OFFSET_TEXT_TOP + L.Grid.TEXT_SHOW_IN_BOUNDS)), L.bounds(L.point(L.Grid.OFFSET_TEXT_LEFT + L.Grid.OFFSET + L.Grid.TEXT_HIDE, document.body.clientHeight - L.Grid.OFFSET_TEXT_BOTTOM - L.Grid.TEXT_HIDE), L.point(document.body.clientWidth - L.Grid.OFFSET_TEXT_RIGHT - L.Grid.OFFSET - L.Grid.TEXT_HIDE, document.body.clientHeight - L.Grid.TEXT_SHOW_IN_BOUNDS))]
    }, getHorisontalBounds: function (a) {
        return a ? [L.bounds(L.point(a.min.x, a.min.y + L.Grid.OFFSET + L.Grid.TEXT_HIDE), L.point(a.min.x + L.Grid.TEXT_SHOW_IN_BOUNDS, a.max.y - L.Grid.OFFSET - L.Grid.TEXT_HIDE)), L.bounds(L.point(a.max.x, a.min.y + L.Grid.OFFSET + L.Grid.TEXT_HIDE), L.point(a.max.x - L.Grid.TEXT_SHOW_IN_BOUNDS, a.max.y - L.Grid.OFFSET - L.Grid.TEXT_HIDE))] : [L.bounds(L.point(L.Grid.OFFSET_TEXT_LEFT, L.Grid.OFFSET_TEXT_LEFT + L.Grid.OFFSET + L.Grid.TEXT_HIDE), L.point(L.Grid.OFFSET_TEXT_LEFT + L.Grid.TEXT_SHOW_IN_BOUNDS, document.body.clientHeight - L.Grid.OFFSET_TEXT_BOTTOM - L.Grid.OFFSET - L.Grid.TEXT_HIDE)), L.bounds(L.point(document.body.clientWidth - L.Grid.OFFSET_TEXT_RIGHT, L.Grid.OFFSET_TEXT_TOP + L.Grid.OFFSET + L.Grid.TEXT_HIDE), L.point(document.body.clientWidth - L.Grid.OFFSET_TEXT_RIGHT - L.Grid.TEXT_SHOW_IN_BOUNDS, document.body.clientHeight - L.Grid.OFFSET_TEXT_BOTTOM - L.Grid.OFFSET - L.Grid.TEXT_HIDE))]
    }}), L.Grid.OFFSET_TEXT_TOP = 0, L.Grid.OFFSET_TEXT_LEFT = 0, L.Grid.OFFSET_TEXT_RIGHT = 0, L.Grid.OFFSET_TEXT_BOTTOM = 0, L.Grid.OFFSET = 20, L.Grid.TEXT_SHOW_IN_BOUNDS = 2, L.Grid.TEXT_HIDE = 15, L.Grid.DEFAULT_GRID_STEP = 100, L.Grid.DEFAULT_GRID_STEPS = [1, 2, 4], L.Grid.STEP_500_000 = 2, L.Grid.STEP_200_000 = 6, L.Grid.STEP_100_000 = 12, L.Grid.STEP_50_000 = 24, L.Grid.DEFAULT_GRID_STEPS_NOMEN = [L.Grid.STEP_50_000, L.Grid.STEP_100_000, L.Grid.STEP_200_000, L.Grid.STEP_500_000, 1, 1], L.Grid.DEFAULT_GRID_STEPS_GRAD = [30, 15, 10, 6, 5, 3, 2, 1], L.Grid.DEFAULT_GRID_COLOR = "rgb(0, 0, 0)", L.Grid.FONT_SIZE = 14
}(), function () {
    "use strict";
    var a, b, c = 30;
    L.GradGrid = L.Grid.extend({includes: [L.Mixin.Events], _checkPoint: function (a, b, c, d, e) {
        var f = this._map.layerPointToLatLng(a.getCenter()).wrap(), g = this._map.latLngToLayerPoint(f).distanceTo(this._map.latLngToLayerPoint(L.latLng(f.lat, f.lng + b)));
        return g >= c && d >= g ? {original: L.latLng(b, b), step: L.latLng(e ? 0 : b, b)} : void 0
    }, calculateLatLngStep: function (a) {
        var b, c, d = Gis.config("grid.grid_steps_nomen", L.Grid.DEFAULT_GRID_STEPS_GRAD), e = document.body.offsetWidth / 3, f = 100;
        if (a) {
            for (b = d.length - 1; b >= 0; b -= 1)if (0 === b && (f = 30), c = this._checkPoint(a, d[b], f, e))return c;
            return this._checkPoint(a, d[0], f, document.body.offsetWidth / 2.5)
        }
    }, drawText: function (a, b, c, d, e) {
        var f, g;
        f = this._getFreeText(), f.position({x: b.x, y: b.y}), f.text(Math.abs(a)), f.fontSize(11);
        var h = L.Grid.OFFSET - 2;
        f.offsetY(d && c ? h : -2), f.offsetX(c && !d ? h : -2), d ? f.offsetX(f.getWidth() / 2) : f.offsetY(f.getHeight()), g = this._getFreeText(), g.text(e), g.fontSize(11), g.fill("#CCCCCC"), g.offset(f.offset()), g.position(d ? {x: f.x() + f.width() + 2, y: f.y()} : {x: f.x(), y: f.y() + f.height() + 2})
    }, _calculatePoints: function (a, b, c, d, e, f) {
        var g, h, i, j, k = [], l = [];
        if (e) {
            h = this.fromGeoToPx(L.latLng(b.lat, b.lng));
            var m = c.lat + 1e-5 * d.lat;
            for (i = b.lat + d.lat; m > i; i += d.lat)m > i && d.lat + i > m && (i = c.lat), g = this.fromGeoToPx(L.latLng(i, b.lng)), j = L.LineUtil.clipSegment(h, g, f), j ? (k.push(j[0].x), k.push(j[0].y), j[1] !== g || i + d.lat > c.lat ? (k.push(j[1].x), k.push(j[1].y), h = g) : h = j[1], g = j[0]) : (k.length && (l.push(k), k = []), h = g)
        } else for (h = this.fromGeoToPx(L.latLng(b.lat, b.lng)), i = b.lng + d.lng; i <= c.lng; i += d.lng)g = this.fromGeoToPx(L.latLng(b.lat, i)), j = L.LineUtil.clipSegment(h, g, f), j ? (k.push(j[0].x), k.push(j[0].y), j[1] !== g ? (k.push(j[1].x), k.push(j[1].y), h = g) : h = j[1], g = j[0]) : (k.length && (l.push(k), k = []), h = g);
        return k.length && l.push(k), l
    }, _getBounds: function (a, b, c) {
        var d, e, f = a;
        if (!a) {
            var g = this._map.getPixelBounds();
            g.min._subtract(this._map.getPixelOrigin()), g.max._subtract(this._map.getPixelOrigin());
            var h = this._map.getPixelCrop();
            if (h && (g = g.getIntersect(h), !g))return;
            d = this._map.layerPointToLatLng(g.min), e = this._map.layerPointToLatLng(g.max), f = L.latLngBounds(d, e), d = this._map.layerPointToLatLng(L.point(g.min.x, g.max.y)), f.extend(d), d = this._map.layerPointToLatLng(L.point(g.max.x, g.min.y)), f.extend(d), d = this._map.layerPointToLatLng(L.point(g.min.x + (g.max.x - g.min.x) / 2, g.max.y)), f.extend(d), d = this._map.layerPointToLatLng(L.point(g.min.x + (g.max.x - g.min.x) / 2, g.min.y)), f.extend(d);
            var i = b ? b.lat : 1, j = b ? b.lng : 1;
            i = i ? i : j, c || (f._southWest.lat = Math.ceil(f._southWest.lat / i) * i, f._southWest.lng = Math.floor(f._southWest.lng / j) * j, f._northEast.lat = Math.floor(f._northEast.lat / i) * i, f._northEast.lng = Math.ceil(f._northEast.lng / j) * j)
        }
        return f
    }, getViewPort: function () {
    }, fromGeoToPx: function (a) {
        return this._map.latLngToLayerPoint(a)._subtract(this._map._kineticViewport.min)
    }, _zoneIndex: function (a) {
        return Math.ceil((a.lng + 180) % 360 / 6)
    }, _zoneLongitude: function (a) {
        return this._zoneIndex(a) * c - 180
    }, getLatLngDelta: function (a, b, c) {
        return L.latLng(Math.ceil(a.lat / (b.lat * c)) * b.lat * c - a.lat, a.lng - Math.floor(a.lng / (b.lng * c)) * b.lng * c)
    }, drawMeridians: function (c, d, e, f, g, h) {
        var i, j, k, l, m, n, o, p, q, r, s, t;
        for (s = this.getVerticalBounds(f), i = c.getNorthWest().lng; i <= c.getNorthEast().lng; i += d.lng)if (k = L.latLng(b, i), l = L.latLng(a, i), m = this.fromGeoToPx(k), n = this.fromGeoToPx(l), o = this._calculatePoints(n, k, l, e, !0, f), o.length) {
            for (j = 0; j < o.length; j += 1)p = this._getFreeLine(), p.points(o[j]);
            r = L.point(o[0][0], o[0][1]), q = s[1].contains(r), t = i > 0 ? "" : i ? "" : "", (s[0].contains(r) || q) && h.push({base: i, under: t, startPointCurrent: r, toLeft: !q, vertical: !0});
            var u = o[o.length - 1];
            r = L.point(u[u.length - 2], u[u.length - 1]), q = s[1].contains(r), (s[0].contains(r) || q) && h.push({base: i, under: t, startPointCurrent: r, toLeft: !q, vertical: !0})
        }
    }, drawLines: function () {
        var c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u = [], v = this._map.getPixelBounds(), w = this._map.getPixelCrop();
        if (w && (v.min._subtract(this._map.getPixelOrigin()), v.max._subtract(this._map.getPixelOrigin()), v = v.getIntersect(w)), c = this.calculateLatLngStep(v), i = c && this._getBounds(null, c.original), !c || !i)return void this._layer.hide();
        this._layer.show(), m = c.original, c = c.step, k = L.bounds(L.point(L.Grid.OFFSET_TEXT_LEFT, L.Grid.OFFSET_TEXT_TOP), L.point(document.body.clientWidth - L.Grid.OFFSET_TEXT_RIGHT, document.body.clientHeight - L.Grid.OFFSET_TEXT_BOTTOM)), w && (w.min._subtract(this._map._kineticViewport.min), w.max._subtract(this._map._kineticViewport.min), k = k.getIntersect(w)), this._drawWhite(k), k.min._add(L.point(L.Grid.OFFSET, L.Grid.OFFSET)), k.max._subtract(L.point(L.Grid.OFFSET, L.Grid.OFFSET)), j = c && this._getBounds(null, c.original, !0), a = j.getNorthWest().lat, b = j.getSouthEast().lat;
        var x = i.getSouthWest().lat - c.lat, y = i.getNorthWest().lat + 2 * c.lat;
        if (c.lat)for (q = this.getHorisontalBounds(k), p = x; y >= p; p += c.lat)if (g = L.latLng(p, i.getNorthWest().lng), h = L.latLng(p, i.getNorthEast().lng), e = this.fromGeoToPx(g), f = this.fromGeoToPx(h), l = this._calculatePoints(f, g, h, m, null, k), l.length) {
            for (n = 0; n < l.length; n += 1)d = this._getFreeLine(), d.points(l[n]);
            r = L.point(l[0][0], l[0][1]), s = q[1].contains(r), t = p > 0 ? "" : p ? "" : "", (q[0].contains(r) || s) && u.push({base: p, under: t, startPointCurrent: r, toLeft: !s, vertical: !1});
            var z = l[l.length - 1];
            r = L.point(z[z.length - 2], z[z.length - 1]), s = q[1].contains(r), (q[0].contains(r) || s) && u.push({base: p, under: t, startPointCurrent: r, toLeft: !s, vertical: !1})
        }
        for (y > x && (k = L.bounds(L.point(L.Grid.OFFSET_TEXT_LEFT, L.Grid.OFFSET_TEXT_TOP), L.point(document.body.clientWidth - L.Grid.OFFSET_TEXT_RIGHT, document.body.clientHeight - L.Grid.OFFSET_TEXT_BOTTOM)), w && (k = k.getIntersect(w)), k.min._add(L.point(L.Grid.OFFSET, L.Grid.OFFSET)), k.max._subtract(L.point(L.Grid.OFFSET, L.Grid.OFFSET)), this.drawMeridians(L.latLngBounds(L.latLng(x, i.getNorthWest().lng), L.latLng(y, i.getNorthEast().lng)), c, m, k, c, u)), p = 0, o = u.length; o > p; p += 1)d = u[p], this.drawText(d.base, d.startPointCurrent, d.toLeft, d.vertical, d.under);
        this._clearTextFrom(), this._clearLinesFrom()
    }, drawHeaders: function () {
    }}), Gis.Map._GRID_TYPES_[Gis.Map.GRID_TYPES.GRAD] = L.GradGrid
}(), function () {
    "use strict";
    function a(a) {
        return Gis.Util.getZoneFromLongitude(a.lng)
    }

    function b(a) {
        return a >= 10 ? a : "0" + a
    }

    L.KilometrGrid = L.Grid.extend({includes: [L.Mixin.Events], _checkPoint: function (a, b, c, d, e) {
        var f = b.getCenter(), g = this.fromGeoToPx(a, [f.x, f.y]), h = this.fromGeoToPx(a, [f.x + 1e3 * c, f.y]), i = h.distanceTo(g);
        return i >= d && e >= i ? L.point(1e3 * c, 1e3 * c) : void 0
    }, calculateLatLngStep: function (a, b) {
        var c, d, e, f = Gis.config("grid.grid_steps", L.Grid.DEFAULT_GRID_STEPS), g = document.body.offsetWidth / 3, h = 100;
        for (c = 0, d = f.length; d > c; c += 1)if (c === d - 1 && (h = 50), e = this._checkPoint(a, b, f[c], h, g))return e;
        return this._checkPoint(a, b, f[0], h, document.body.offsetWidth / 2.5)
    }, drawText: function (a, c, d, e, f, g) {
        var h, i, j, k = 2, l = 3, m = g && !f ? 0 : L.Grid.FONT_SIZE + k;
        d ? (i = this._getFreeText(), i.position({x: e.x, y: e.y - m}), i.fontSize(11), i.offsetY(g && !f ? -2 : 0), i.text(a), h = {x: g ? -i.width() - l : 0, y: g ? 0 : i.height() + 4 * l}) : h = {x: 0, y: 0}, j = this._getFreeText(), j.offsetY(g && !f ? -2 : 0), j.fontSize(L.Grid.FONT_SIZE), j.position({x: e.x + h.x, y: e.y - m + h.y}), j.text(b(c - 100 * a)), (f || g) && (i && i.x(i.x() - i.width() - 2 * k - l - 0), j.x(j.x() - (g ? -l : j.width()) - 2 * k - h.x))
    }, _calculatePoints: function (a, b, c, d, e, f, g) {
        var h, i, j, k, l = [];
        if (f)for (i = this.fromGeoToPx(a, [c[0], c[1]]), j = c[0] + e.x; j <= d[0] + 2 * e.x; j += e.x)h = this.fromGeoToPx(a, [j, c[1]]), k = L.LineUtil.clipSegment(i, h, g), k && (l.push(k[0].x), l.push(k[0].y), k[1] !== h && (l.push(k[1].x), l.push(k[1].y)), i = h, h = k[0]); else for (i = this.fromGeoToPx(a, [c[0], c[1]]), j = c[1] - e.y; j >= d[1] - 2 * e.y; j -= e.y)h = this.fromGeoToPx(a, [c[0], j]), k = L.LineUtil.clipSegment(i, h, g), k && (l.push(k[0].x), l.push(k[0].y), k[1] !== h && (l.push(k[1].x), l.push(k[1].y)), i = h, h = k[0]);
        return l
    }, fromGeoToPx: function (a, b) {
        var c = a.inverse(b);
        return c = L.latLng(c[1], c[0]), this._map.latLngToLayerPoint(c)._subtract(this._map._kineticViewport.min)
    }, _getBounds: function (a, b, c) {
        var d, e, f;
        if (!b) {
            var g = this._map.getPixelBounds();
            g.min._subtract(this._map.getPixelOrigin()), g.max._subtract(this._map.getPixelOrigin());
            var h = this._map.getPixelCrop();
            h && (g = g.getIntersect(h)), e = this._map.layerPointToLatLng(g.min), f = this._map.layerPointToLatLng(g.max), d = L.bounds(a.forward([e.lng, e.lat]), a.forward([f.lng, f.lat])), e = this._map.layerPointToLatLng(L.point(g.min.x, g.max.y)), d.extend(a.forward([e.lng, e.lat])), e = this._map.layerPointToLatLng(L.point(g.max.x, g.min.y)), d.extend(a.forward([e.lng, e.lat]));
            var i = c ? c.x : 1e3, j = c ? c.y : 1e3;
            return d.min.x = Math.floor(d.min.x / i) * i, d.min.y = Math.floor(d.min.y / j) * j, d.max.x = Math.ceil(d.max.x / i) * i, d.max.y = Math.ceil(d.max.y / j) * j, d
        }
        return d = L.bounds(a.forward([b.getSouthWest().lng, b.getSouthWest().lat]), a.forward([b.getNorthEast().lng, b.getNorthEast().lat])), d.extend(a.forward([b.getNorthWest().lng, b.getNorthWest().lat])), d.extend(a.forward([b.getSouthEast().lng, b.getSouthEast().lat])), d
    }, getViewPort: function () {
    }, drawLines: function () {
        var c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s = 0 / 0, t = a(this._map.getCenter()), u = [], v = [], w = 0 / 0, x = proj4("EPSG:284" + b(t)), y = [];
        if (n = this._getBounds(x), f = this.calculateLatLngStep(x, n), n = this._getBounds(x, null, f), !f)return void this._layer.hide();
        this._layer.show(), this._drawWhite(), p = L.bounds(L.point(L.Grid.OFFSET_TEXT_LEFT + L.Grid.OFFSET, L.Grid.OFFSET_TEXT_TOP), L.point(document.body.clientWidth - L.Grid.OFFSET_TEXT_RIGHT - L.Grid.OFFSET, document.body.clientHeight - L.Grid.OFFSET_TEXT_BOTTOM)), q = this.getVerticalBounds();
        var z = f.multiplyBy(3);
        for (d = n.min.x; d <= n.max.x; d += f.x)j = [d, n.max.y], k = [d, n.min.y], g = this.fromGeoToPx(x, j), i = this.fromGeoToPx(x, k), r = this._calculatePoints(x, i, j, k, z, null, p), r.length && (c = this._getFreeLine(), c.points(r), w = Math.floor(j[0] / 1e5), h = L.point(r[0], r[1]), (q[0].contains(h) || q[1].contains(h)) && (y.push({base: w, distance: Math.floor(j[0] / 1e3), drawSmall: w !== u[0], startPointCurrent: h, toLeft: !1, vertical: !0}), u[0] = w), h = L.point(r[r.length - 2], r[r.length - 1]), (q[0].contains(h) || q[1].contains(h)) && (y.push({base: w, distance: Math.floor(j[0] / 1e3), drawSmall: w !== u[1], startPointCurrent: L.point(r[r.length - 2], r[r.length - 1]), toLeft: !0, vertical: !0}), u[1] = w));
        for (u = [], v = [!0, !0], p = L.bounds(L.point(L.Grid.OFFSET_TEXT_LEFT, L.Grid.OFFSET_TEXT_TOP + L.Grid.OFFSET), L.point(document.body.clientWidth - L.Grid.OFFSET_TEXT_RIGHT, document.body.clientHeight - L.Grid.OFFSET_TEXT_BOTTOM - L.Grid.OFFSET)), q = this.getHorisontalBounds(), e = n.max.y; e >= n.min.y; e -= f.y)j = [n.min.x, e], k = [n.max.x, e], g = this.fromGeoToPx(x, j), i = this.fromGeoToPx(x, k), l = s, s = Math.floor(j[1] / 1e3), r = this._calculatePoints(x, i, j, k, z, !0, p), r.length && (c = this._getFreeLine(), c.points(r), l && (w = Math.floor(s / 100), h = L.point(r[0], r[1]), m = Math.abs(Math.floor(l / 100) - w) >= 1, (q[0].contains(h) || q[1].contains(h)) && (y.push({base: w, distance: s, drawSmall: v[0] || m, startPointCurrent: h}), v[0] = !1), h = L.point(r[r.length - 2], r[r.length - 1]), (q[0].contains(h) || q[1].contains(h)) && (y.push({base: w, distance: s, drawSmall: v[1] || m, startPointCurrent: h, toLeft: !0}), v[1] = !1)));
        for (d = 0, o = y.length; o > d; d += 1)c = y[d], this.drawText(c.base, c.distance, c.drawSmall, c.startPointCurrent, c.toLeft, c.vertical);
        this._clearTextFrom(), this._clearLinesFrom()
    }, drawHeaders: function () {
    }}), Gis.Map._GRID_TYPES_[Gis.Map.GRID_TYPES.KILOMETR] = L.KilometrGrid
}(), function () {
    "use strict";
    function a(a) {
        return a >= 100 ? a : a >= 10 ? "0" + a : "00" + a
    }

    var b, c, d = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"], e = {COEFF_QUATTRO: 1, NAME_FUNC: function (a, b, c, d) {
        return d ? this[a + "," + b] + "," + this[a + 1 + "," + b] + "," + this[a + 2 + "," + b] : c ? this[a + "," + b] + "," + this[a + 1 + "," + b] : this[a + "," + b]
    }}, f = {}, g = {}, h = 60, i = 76, j = 88, k = "rgba(255, 255, 255, 0.7)", l = function (a, b, c) {
        return c ? this[a + "," + b] + "," + this[a + 1 + "," + b] : this[a + "," + b]
    };
    b = {DOUBLE: !0, COEFF_QUATTRO: 2, NAME_FUNC: l, "0,0": "", "1,0": "", "0,1": "", "1,1": ""}, c = function (a, b, c) {
        a.COEFF_QUATTRO || (a.COEFF_QUATTRO = 2), a.NAME_FUNC || (a.NAME_FUNC = l), c = c || function (a) {
            return a + 1
        };
        for (var d = 0; b > d; d += 1)for (var e = 0; b > e; e += 1)a[e + "," + d] = c(d * b + e, e, d)
    }, c(e, L.Grid.STEP_200_000), c(f, L.Grid.STEP_100_000, function (b) {
        return a(b + 1)
    }), c(g, L.Grid.STEP_50_000, function (a, c, d) {
        return b[c % 2 + "," + d % 2]
    }), L.NomenclateGrid = L.Grid.extend({includes: [L.Mixin.Events], _checkPoint: function (a, b, c, d, e) {
        var f = this._map.layerPointToLatLng(a.getCenter()).wrap(), g = this._map.latLngToLayerPoint(f).distanceTo(this._map.latLngToLayerPoint(L.latLng(f.lat, f.lng + 6 / b)));
        return g >= c && d >= g ? {original: L.latLng(4 / b, 6 / b), step: L.latLng(e ? 0 : 4 / b, 6 / b)} : void 0
    }, calculateLatLngStep: function (a) {
        var b, c, d, e, f = Gis.config("grid.grid_steps_nomen", L.Grid.DEFAULT_GRID_STEPS_NOMEN), g = document.body.offsetWidth / 3, h = 100;
        for (b = 0, c = f.length; c > b; b += 1)if (e = b === c - 1, e && (h = 30), d = this._checkPoint(a, f[b], h, g, e))return d;
        return this._checkPoint(a, f[0], h, document.body.offsetWidth / 2.5)
    }, drawText: function (a, b) {
        var c, d, e = 2;
        d = this._getFreeRect(void 0, this._groupLines), c = this._getFreeText(), c.fontSize(12), c.fill("black"), c.shadowColor("white"), d.fill(k), c.position({x: b.x, y: b.y}), d.position({x: b.x - e, y: b.y - e}), c.text(a), c.offsetX(c.width() / 2), d.offsetX(c.width() / 2), d.width(c.width() + 2 * e), d.height(c.height() + 2 * e), d.cornerRadius(e)
    }, _calculatePoints: function (a, b, c, d, e, f) {
        var g, h, i, j, k = [], l = [];
        if (e)for (h = this.fromGeoToPx(L.latLng(b.lat, b.lng)), i = b.lat + d.lat; i < c.lat + 1e-5 * d.lat; i += d.lat)g = this.fromGeoToPx(L.latLng(i, b.lng)), j = L.LineUtil.clipSegment(h, g, f), j ? (k.push(j[0].x), k.push(j[0].y), (j[1] !== g || i + d.lat > c.lat) && (k.push(j[1].x), k.push(j[1].y)), h = j[1], g = j[0]) : (k.length && (l.push(k), k = []), h = g); else for (h = this.fromGeoToPx(L.latLng(b.lat, b.lng)), i = b.lng + d.lng; i <= c.lng; i += d.lng)g = this.fromGeoToPx(L.latLng(b.lat, i)), j = L.LineUtil.clipSegment(h, g, f), j ? (k.push(j[0].x), k.push(j[0].y), j[1] !== g && (k.push(j[1].x), k.push(j[1].y)), h = j[1], g = j[0]) : (k.length && (l.push(k), k = []), h = g);
        return k.length && l.push(k), l
    }, _getBounds: function (a, b) {
        var c, d, e = a;
        if (!a) {
            var f = this._map.getPixelBounds();
            f.min._subtract(this._map.getPixelOrigin()), f.max._subtract(this._map.getPixelOrigin());
            var g = this._map.getPixelCrop();
            if (g && (f = f.getIntersect(g), !f))return;
            c = this._map.layerPointToLatLng(f.min), d = this._map.layerPointToLatLng(f.max), e = L.latLngBounds(c, d), c = this._map.layerPointToLatLng(L.point(f.min.x, f.max.y)), e.extend(c), c = this._map.layerPointToLatLng(L.point(f.max.x, f.min.y)), e.extend(c), c = this._map.layerPointToLatLng(L.point(f.min.x + (f.max.x - f.min.x) / 2, f.max.y)), e.extend(c), c = this._map.layerPointToLatLng(L.point(f.min.x + (f.max.x - f.min.x) / 2, f.min.y)), e.extend(c);
            var h = b ? b.lat : 1, i = b ? b.lng : 1;
            h = h ? h : i, e._southWest.lat = Math.floor(e._southWest.lat / h) * h, e._southWest.lng = Math.floor(e._southWest.lng / i) * i, e._northEast.lat = Math.ceil(e._northEast.lat / h) * h, e._northEast.lng = Math.ceil(e._northEast.lng / i) * i
        }
        return e
    }, getViewPort: function () {
    }, fromGeoToPx: function (a) {
        return this._map.latLngToLayerPoint(a)._subtract(this._map._kineticViewport.min)
    }, getZoneName: function (a, b) {
        var c = a.lat < 0 ? " (. .)" : "";
        return 6 === b.lng ? this._getMillionName(a.wrap(), !0, !0) + c : b.lng === 6 / L.Grid.STEP_500_000 ? this._get500000Name(a.wrap(), b) + c : b.lng === 6 / L.Grid.STEP_200_000 ? this._get200000Name(a.wrap(), b) + c : b.lng === 6 / L.Grid.STEP_100_000 ? this._get100000Name(a.wrap(), b) + c : b.lng === 6 / L.Grid.STEP_50_000 ? this._get50000Name(a.wrap(), b) + c : this._getMillionName(a.wrap(), !0, !0) + c
    }, _zoneIndex: function (a) {
        return Math.ceil((a.lng + 180) % 360 / 6)
    }, _zoneLongitude: function (a) {
        return 6 * this._zoneIndex(a) - 180
    }, _getMillionName: function (a, b, c) {
        var e = Math.abs(a.lat), f = d[Math.floor(e / 4)], g = this._zoneIndex(a);
        return b && c && e > j ? f : (f += "-" + g, b && e > h && (f += "," + (g + 1), c && e > i && (f += "," + (g + 2) + "," + (g + 3))), f)
    }, getLatLngDelta: function (a, b, c) {
        var d = Math.abs(a.lat), e = a.lat < 0, f = e ? -1 : 1;
        return L.latLng(Math.abs(f * Math.ceil(d / (b.lat * c)) * b.lat * c - f * d), a.lng - Math.floor(a.lng / (b.lng * c)) * b.lng * c)
    }, _getName: function (a, b, c, d, e) {
        return this._getMillionName(a, c.DOUBLE && a.lat > i, c.QUATTRO) + "-" + this._realName(a, b, c, d, e)
    }, _realName: function (a, b, c, d, e) {
        var f = "", g = this.getLatLngDelta(a, b, d), j = Math.abs(a.lat) > h && !e, k = Math.abs(a.lat) > i && !e, l = Math.floor(g.lat / b.lat), m = Math.floor(g.lng / (b.lng * (k ? c.COEFF_QUATTRO : 1)));
        return f += c.NAME_FUNC(m, l, j, k)
    }, _get500000Name: function (a, c) {
        return this._getName(a, c, b, L.Grid.STEP_500_000)
    }, _get200000Name: function (a, b) {
        return this._getName(a, b, e, L.Grid.STEP_200_000)
    }, _get100000Name: function (a, b, c) {
        return this._getName(a, b, f, L.Grid.STEP_100_000, c)
    }, _get50000Name: function (a, b) {
        return this._get100000Name(a, L.latLng(2 * b.lat, 2 * b.lng), !0) + "-" + this._realName(a, b, g, L.Grid.STEP_50_000)
    }, drawMeridians: function (a, b, c, d, e) {
        var f, g, h, i, j, k, l, m, n, o, p = {}, q = L.latLng(0, 0), r = a.getNorthWest().lat + (b.lat ? 0 : 4);
        for (f = a.getNorthWest().lng; f <= a.getNorthEast().lng; f += b.lng) {
            if (i = L.latLng(a.getSouthWest().lat, f), j = L.latLng(r, f), k = this.fromGeoToPx(i), l = this.fromGeoToPx(j), m = this._calculatePoints(l, i, j, c, !0, d), m.length)for (h = 0; h < m.length; h += 1)n = this._getFreeLine(), n.points(m[h]);
            if (b.lat)for (g = a.getNorthWest().lat; g >= a.getSouthWest().lat; g -= b.lat)q.lat = g - b.lat / 2, q.lng = f + b.lng / 2, a.contains(q) && (o = this.fromGeoToPx(q), d.contains(o) && !p[o.x + "-" + o.y] && (p[o.x + "-" + o.y] = o, this.drawText(this.getZoneName(L.latLng(g - b.lat / 4, f + b.lng / 4), e), o))); else q.lat = Math.abs(i.lat - j.lat) / 2 + i.lat, q.lng = f + b.lng / 2, a.contains(q) && (o = this.fromGeoToPx(q), d.contains(o) && this.drawText(Gis.Util.getZoneFromLongitude(q.lng), o))
        }
    }, drawLines: function () {
        function a(a, b, c, e) {
            return e = e || 0, c > a ? (s.drawMeridians(L.latLngBounds(L.latLng(c, Math.floor(l.getNorthWest().lng / (d.lng * b)) * d.lng * b + e), L.latLng(Math.max(a, t), Math.ceil(l.getNorthEast().lng / (d.lng * b)) * d.lng * b)), L.latLng(d.lat, d.lng * b), o, m, d), c = a) : 0 > a && a > c && (s.drawMeridians(L.latLngBounds(L.latLng(c, Math.floor(l.getNorthWest().lng / (d.lng * b)) * d.lng * b + e), L.latLng(Math.max(a, t), Math.ceil(l.getNorthEast().lng / (d.lng * b)) * d.lng * b)), L.latLng(d.lat, d.lng * b), o, m, d), c = a), c
        }

        var b, c, d, e, f, g, k, l, m, n, o, p, q = this._map.getPixelBounds(), r = this._map.getPixelCrop();
        if (r && (q.min._subtract(this._map.getPixelOrigin()), q.max._subtract(this._map.getPixelOrigin()), q = q.getIntersect(r)), d = q && this.calculateLatLngStep(q), l = d && this._getBounds(null, d.original), !d || !l)return void this._layer.hide();
        this._layer.show(), o = d.original, d = d.step;
        var s = this;
        m = L.bounds(L.point(0, 0), L.point(document.body.clientWidth, document.body.clientHeight)), r && (r.min._subtract(this._map._kineticViewport.min), r.max._subtract(this._map._kineticViewport.min), m = m.getIntersect(r));
        var t = l.getSouthWest().lat - d.lat, u = l.getNorthWest().lat + 2 * d.lat;
        if (d.lat) {
            for (c = t; u >= c; c += d.lat)if (g = L.latLng(c, l.getNorthWest().lng), k = L.latLng(c, l.getNorthEast().lng), e = this.fromGeoToPx(g), f = this.fromGeoToPx(k), n = this._calculatePoints(f, g, k, o, null, m), n.length)for (p = 0; p < n.length; p += 1)b = this._getFreeLine(), b.points(n[p]);
            u > j && (u = j);
            var v = d.lng === 6 / L.Grid.STEP_200_000 ? 3 : 4;
            u = a(i, v, u, -12), u = a(h, 2, u), t = a(-i, v, t, -12), t = a(-h, 2, t)
        }
        u > t && this.drawMeridians(L.latLngBounds(L.latLng(t, l.getNorthWest().lng), L.latLng(u, l.getNorthEast().lng)), d, o, m, d), this._clearTextFrom(), this._clearLinesFrom(), this._clearRectsFrom()
    }, drawHeaders: function () {
    }}), Gis.Map._GRID_TYPES_[Gis.Map.GRID_TYPES.NOMENCLATE] = L.NomenclateGrid
}(), L.HatchClass = L.Class.extend({options: {color: void 0, style: void 0}, initialize: function (a, b) {
    this.options.color = b, this.options.style = a
}, getColor: function () {
    return this.options.color
}, getStyle: function () {
    return this.options.style
}, compare: function (a) {
    return this._compareStyle(a) ? this._compareColor(a) ? L.HatchClass.NOTHING_CHANGED : L.HatchClass.COLOR_CHANGED : L.HatchClass.CHANGED
}, _compareStyle: function (a) {
    return this.options.style === a.getStyle()
}, _compareColor: function (a) {
    return this.options.style === a.getColor()
}, isHatch: function () {
    return void 0 !== this.options.style && this.options.style !== !1
}}), L.HatchClass.COLOR_CHANGED = -1, L.HatchClass.NOTHING_CHANGED = 0, L.HatchClass.CHANGED = 1, function (a) {
    "use strict";
    function b(a) {
        return void 0 != a && null != a
    }

    function c(a, c) {
        return b(a.r) && b(a.g) && b(a.b) ? a : c ? (c.parseColor(a), c) : new RGBColor(a)
    }

    function d(a, b, c) {
        return isNaN(a.percent) ? isNaN(b) || isNaN(b) ? null : (a.value - c) / (b - c) : a.percent
    }

    function e(a, d, e) {
        if (isNaN(a.percent) || !(a.percent - d.percent))return[a.color.r, a.color.g, a.color.b, b(a.color.a) ? 255 * a.color.a : 255];
        e = Math.min((e - a.percent) / (d.percent - a.percent), 1);
        var f = c(a.color, p), g = c(d.color, q), h = b(f.a) ? 255 * f.a : 255, i = b(g.a) ? 255 * g.a : 255, j = f.r + e * (g.r - f.r), k = f.b + e * (g.b - f.b), l = f.g + e * (g.g - f.g), m = h + e * (i - h);
        return[j, l, k, m]
    }

    function f(a, b, c, d) {
        var e = (c.x - b.x) * (c.y - b.y), f = c.y - a.y, g = a.y - b.y, h = a.x - b.x, i = c.x - a.x;
        n.x = c.x, n.y = b.y, o.x = b.x, o.y = c.y;
        var j = d(b), k = d(n), l = d(o), m = d(c);
        return isNaN(j) || isNaN(k) || isNaN(l) || isNaN(m) ? 0 / 0 : 0 !== e ? j * i * f / e + k * h * f / e + l * i * g / e + m * h * g / e : e
    }

    function g(a, b) {
        var c, d, e;
        if (!a)return s;
        if (isNaN(b))return[r, r];
        for (c = 0, d = a.length; d > c; c += 1)if (e = a[c], e.percent > b)return 0 === c ? [e, e] : [a[c - 1], e];
        return[e, e]
    }

    function h() {
        r = {color: new RGBColor(Gis.config(Gis.Objects.HeatMap.NAN_COLOR_CONGIG_KEY, "rbga(0, 0, 0, 0)")), percent: 0 / 0, value: 0 / 0}
    }

    function i(a, b) {
        return function (c) {
            b.call(a, c)
        }
    }

    var j, k = a.point(0, 0), l = a.point(0, 0), m = a.point(0, 0), n = a.point(0, 0), o = a.point(0, 0), p = new RGBColor("white"), q = new RGBColor("black"), r = {color: new RGBColor("rbga(0, 0, 0, 0)"), percent: 0 / 0, value: 0 / 0}, s = Gis.config("heatmap.color"), t = a.point(0, 0), u = a.point(0, 0), v = 0, w = {}, x = 256, y = 6, z = 4;
    a.HeatMap = a.Class.extend({includes: [a.Mixin.Events], _linePainted: void 0, _leafletHeatMap: "l-heat-map", _selectedPath: void 0, options: {maxPointsToCalculateOne: x * x, className: "", bounds: void 0, preloadSize: a.point(400, 400), clickable: !0, opacity: 1, colors: s, points: void 0, skipWW: void 0, drawPath: !0}, findMinMaxInColors: function (a) {
        var c = -1 / 0, d = 1 / 0;
        a.colors.forEach(function (a) {
            b(a.value) && !isNaN(a.value) && (c = Math.max(c, a.value), d = Math.min(d, a.value))
        }), isFinite(c) && isFinite(d) && (this._max = c, this._min = d)
    }, parseColors: function (a) {
        var e, f;
        e = this._max, f = this._min, a.colors = a.colors.map(function (a) {
            var b = {value: a.value, percent: d(a, e, f)};
            return b.color = c(a.color), b
        }), a.colors = a.colors.sort(function (a, c) {
            var d = b(a.percent) ? a.percent : (a.value - f) / e, g = b(c.percent) ? c.percent : (c.value - f) / e;
            return d - g
        })
    }, findByColors: function (a) {
        if (!b(this._min) || !b(this._max)) {
            var c, d, e, f, g, h, i, j, k, l, m;
            if (a && a.colors)for (c = 0, d = a.colors.length; d > c; c += 1)e = a.colors[c].value, f = a.colors[c].percent, !isNaN(e) && b(e) && b(f) && (!isNaN(g) && b(g) && b(h) && (j = Math.min(h, f), l = Math.max(h, f), k = Math.min(g, e), m = Math.max(g, e), i = (m - k) / (l - j), this._min = Math.abs(j) < .001 ? k : k - j * i, this._max = Math.abs(l - 1) < .001 ? m : m + (1 - l) * i), g = e, h = f)
        }
    }, doParseFloat: function (a) {
        var b, c, d, e;
        for (b = 0, d = a.length; d > b; b += 1)for (c = 0, e = a[b].length; e > c; c += 1)isNaN(a[b][c]) || (a[b][c] = parseFloat(a[b][c]))
    }, findMax: function (a) {
        if (this._min = void 0, this._max = void 0, this.doParseFloat(a.points), this.findMinMaxInColors(a), this.findByColors(a), !b(this._min) || !b(this._max)) {
            var c, d, e, f = a.points.length, g = -1 / 0, h = 1 / 0;
            for (c = 0; f > c; c += 1)for (e = 0, d = a.points[c].length; d > e; e += 1)isNaN(a.points[c][e]) || (this._max || (g = Math.max(a.points[c][e], g)), this._min || (h = Math.min(a.points[c][e], h)));
            this._max = g, this._min = h
        }
    }, checkDiff: function () {
        var a = this.options.bounds.getNorthWest().lng, b = Math.abs(a - this.options.bounds.getNorthEast().lng), c = this.options.bounds.getNorthWest().lat, d = Math.abs(c - this.options.bounds.getSouthWest().lat);
        this._diffX = b, this._diffY = d, this._startLn = this.options.bounds.getSouthWest().lng, this._startLat = this.options.bounds.getNorthEast().lat, this._xWidth = this.options.points.length - 1, this._yWidth = this.options.points[0].length - 1
    }, _pathPoints: function (a) {
        return[a.bounds.getSouthEast(), a.bounds.getSouthWest(), a.bounds.getNorthWest(), a.bounds.getNorthEast(), a.bounds.getSouthEast()]
    }, initWebWorker: function () {
        try {
            j || (j = cw(a.HeatMapWorker, a.HeatMap.threads), j.on("calc", i(this, this._thenPromiseEvent)))
        } catch (b) {
            console.error(b), this.redraw = this._localRedraw, this.redraw()
        }
    }, initialize: function (b, c) {
        this._requestFrame = 0, this._currentDrawPosition = 0, this.GUID = Date.now(), this._guid = Date.now(), h(), this._latLngBoundsCache = a.latLngBounds(a.latLng(0, 0), a.latLng(1, 1)), this._linePainted = void 0, this._threads = z, this._boundsProjected = void 0, c && c.maxPointsToCalculateOne || (this.options.maxPointsToCalculateOne = a.HeatMap.perTile * a.HeatMap.perTile), this._selectedPath = a.polyline(this._pathPoints(c), {stroke: !0, color: "rgb(75, 84, 255)", weight: 5}), (c.points || c.colors) && this.findMax(c), c.colors && this.parseColors(c), a.setOptions(this, c), this.checkDiff(), a.HeatMap.SKIP_WW || this.options.skipWW || !Gis.Concurrency.isWebWorkers() ? this.redraw = this._localRedraw : (this.redraw = this._wwRedraw2, this.initWebWorker())
    }, _thenPromiseEvent: function (a) {
        var b = w[a.thisGUID];
        a.guid === b._guid && (b._frameRequested = !0, setTimeout(function () {
            Gis.requestAnimationFrame(100)(function () {
                b._noDraw || b._updateFromThread(a), a.isLastData && (!b.isNeedDrawFrame() && Gis.Util.isDefine(b._drawAfterTo) && (b._currentDrawPosition = b._drawAfterTo, b._drawAfterTo = void 0), b.isNeedDrawFrame() && b.redraw())
            })
        }, 40))
    }, _thenPromiseError: function (a) {
        this._requestFrame -= 1, !this.isNeedDrawFrame() && Gis.Util.isDefine(this._drawAfterTo) && (this._currentDrawPosition = this._drawAfterTo, this._drawAfterTo = void 0), this.isNeedDrawFrame() && this.redraw(), console.error(a)
    }, _thenPromiseOk: function () {
        this._requestFrame -= 1, !this.isNeedDrawFrame() && Gis.Util.isDefine(this._drawAfterTo) && (this._currentDrawPosition = this._drawAfterTo, this._drawAfterTo = void 0), this.isNeedDrawFrame() && this.redraw()
    }, setSelected: function (a) {
        this.options.drawPath && this._selected !== a && this._map && (a ? this._selectedPath.addTo(this._map) : this._map.removeLayer(this._selectedPath)), this._selected = a
    }, _fireMouseEvent: function (b) {
        if (this.hasEventListeners(b.type)) {
            if (!this.options.bounds.contains(b.latlng))return"mousemove" === b.type && this._lastEntered && (b.type = "mouseout", this.fire("mouseout", b)), void(this._lastEntered = !1);
            if ("mousemove" === b.type && !this._lastEntered)return b.type = "mouseover", this.fire("mouseover", b), void(this._lastEntered = !0);
            this.fire(b.type, b), "contextmenu" === b.type && a.DomEvent.preventDefault(b), "mousemove" !== b.type && a.DomEvent.stopPropagation(b)
        }
    }, _initEvents: function () {
        var b, c;
        if (this.options.clickable)for (a.DomUtil.addClass(this.canvas, "leaflet-clickable"), c = ["click", "dblclick", "mousedown", "mouseover", "mouseout", "mousemove", "contextmenu"], b = 0; b < c.length; b += 1)this._map.on(c[b], this._fireMouseEvent, this)
    }, _deinitEvents: function () {
        var a, b, c = ["click", "dblclick", "mousedown", "mouseover", "mouseout", "mousemove", "contextmenu"];
        for (a = 0, b = c.length; b > a; a++)this._map.off(c[a], this._fireMouseEvent, this)
    }, onDelete: function () {
        this._deinitEvents()
    }, onAdd: function (b) {
        this._map = b, b._initHeatMapRoot(), v += 1, this.canvas = this.canvas || document.createElement("canvas"), w[this.GUID] = this, this.canvas.parentNode || this._map._heatMapRoot.appendChild(this.canvas), this._initEvents(), this.fire("add"), a.DomUtil.addClass(this.canvas, this._leafletHeatMap), this.options.className && a.DomUtil.addClass(this.canvas, this.options.className), b.options.zoomAnimation && b.options.markerZoomAnimation && (a.DomUtil.addClass(this.canvas, "leaflet-zoom-animated"), b.on("zoomanim", this._animateZoomHeatmap, this)), b.on("zoomstart", this._zoomStart, this), b.on({redraw_heatmap: this.onViewreset, viewreset: this.onViewreset, moveend: this.onMoveEnd}, this), this.canvas.style.opacity = this.options.opacity, this._updateHeatMapViewport(), this.redraw()
    }, onMoveEnd: function () {
        this._updateHeatMapViewport(), this.reset()
    }, onViewreset: function () {
        this._updateHeatMapViewport(), this.startDraw(), this._linePainted = void 0, this.resetForce(!1, !0)
    }, resetForce: function (a, b) {
        a ? this._toClean = !0 : (this.canvas.getContext("2d").clearRect(0, 0, this.canvas.width, this.canvas.height), this._currentDrawPosition = 0, this._redrawRequestedBounds = void 0), this._redrawRequested = void 0, this._boundsProjected = void 0, b || this.reset()
    }, _zoomStart: function () {
        this._guid = Date.now()
    }, reset: function () {
        h(), this._startPoint = void 0, this._endPoint = void 0, this.isNeedDrawFrame() ? this._drawAfterTo = this._currentDrawPosition || void 0 : (this._redrawRequestedBounds = void 0, this._currentDrawPosition = 0), this.startDraw(), this.redraw()
    }, setOpacity: function (a, c) {
        b(a) && (this.options.opacity = parseFloat(a), c || (this.canvas.style.opacity = this.options.opacity, this.resetForce(!0)))
    }, setBounds: function (b, c) {
        b && (this.options.bounds = a.latLngBounds(b), this.checkDiff(), this._selectedPath.setLatLngs(this._pathPoints(this.options)), c || this.resetForce())
    }, setPoints: function (a, b) {
        a && (this.options.points = a, b || (this.options.points && this.findMax(this.options), this.resetForce(!0)))
    }, _checkIsMinMaxCorrect: function () {
        (isNaN(this._min) || isNaN(this._max)) && (this._min = void 0, this._max = void 0, this.findMax(this.options))
    }, setColors: function (a, b) {
        a && (this.options.colors = a, this.findMinMaxInColors(this.options), this._checkIsMinMaxCorrect(), this.parseColors(this.options), this.findMax(this.options), b || this.resetForce(!0))
    }, addTo: function (a) {
        return a.addLayer(this), this
    }, onRemove: function (a) {
        v -= 1, delete w[this.GUID], a._heatMapRoot.removeChild(this.canvas), this._map.removeLayer(this._selectedPath), this.fire("remove"), this._map = null, a.off("zoomanim", this._animateZoomHeatmap, this), a.off("zoomstart", this._zoomStart, this), a.off({redraw_heatmap: this.onViewreset, viewreset: this.onViewreset, moveend: this.onMoveEnd}, this)
    }, setStyle: function (b) {
        return a.setOptions(this, b), this
    }, drawPoint: function (a, b, c) {
        var d = this.canvas.getContext("2d");
        d.fillStyle = c, d.fillRect(a, b, 1, 1)
    }, getInterpolatedValue: function (a, c, d) {
        var e, g, h, i, j, n = this.options.points, o = this;
        return e = Math.floor(a), g = Math.floor(c), i = Math.ceil(a), h = Math.ceil(c), i === e && (i > 0 ? e -= 1 : i += 1), h === g && (h > 0 ? g -= 1 : h += 1), k.x = a, k.y = c, l.x = e, l.y = g, m.x = i, m.y = h, j = f(k, l, m, function (a) {
            return b(n[a.x]) && b(n[a.x][a.y]) ? isNaN(n[a.x][a.y]) ? n[a.x][a.y] : (n[a.x][a.y] - o._min) / (d - o._min) : 0 / 0
        })
    }, getPixcelColor: function (a, b) {
        var c = this.getInterpolatedValue(a, b, this._max), d = g(this.options.colors, c);
        return e(d[0], d[d.length - 1], c)
    }, getBounds: function (b) {
        var c, d, e = this._map.getPixelBounds();
        return e.min._subtract(b), e.max._add(b), c = this._map.unproject(e.getBottomLeft()), d = this._map.unproject(e.getTopRight()), new a.LatLngBounds(c, d)
    }, getXY: function (a) {
        return u.x = Math.abs(a.lng - this._startLn) / this._diffX * this._xWidth, u.y = Math.abs(a.lat - this._startLat) / this._diffY * this._yWidth, u
    }, getValue: function (a) {
        var b = this.getXY(a);
        return this.getInterpolatedValue(b.x, b.y, this._max)
    }, getPixcelColorByCoord: function (a) {
        var b = this.getXY(a);
        return this.getPixcelColor(b.x, b.y)
    }, _renderPoints: function () {
        var b, c, d, e = this.options.bounds.getSouthWest().lng, f = this.options.bounds.getSouthWest().lat, g = this.options.bounds.getNorthEast().lat, h = this.options.bounds.getNorthEast().lng, i = (h - e) / (this.options.points.length - 1), j = (g - f) / (this.options.points[0].length - 1), k = 0, l = this.canvas.getContext("2d");
        for (d = 0; d < this.options.points.length; d += 1) {
            for (k = this.options.points[0].length - 1, b = f; j > b - g; b += j)l.beginPath(), c = this._map.latLngToLayerPoint(a.latLng(b, e)).subtract(this._heatMapViewport.min), l.arc(c.x, c.y, 4, 0, 2 * Math.PI), l.fillStyle = "white", l.fill(), l.lineWidth = 2, l.strokeStyle = "black", l.stroke(), l.fillStyle = "white", l.font = "18px Verdana", l.shadowBlur = 3, l.shadowColor = "black", l.fillText(this.options.points[d][k], c.x, c.y), k -= 1;
            e += i
        }
    }, _updateFromThread: function (b) {
        if (this._map) {
            for (var c = this._heatMapViewport.min.subtract(a.point(b.viewPort)), d = this.canvas.getContext("2d"), e = d.getImageData(b.start - c.x, b.end - c.y, b.width, b.height), f = 0, g = b.data.length; g > f; f += 1)e.data[f] = b.data[f];
            this._redrawRequested = !0, d.putImageData(e, b.start - c.x, b.end - c.y), a.HeatMap.DEBUG && this._renderPoints()
        }
    }, getCalculatePixelPerLine: function () {
        return Math.max(this.canvas.width, this.options.maxPointsToCalculateOne)
    }, isNeedDrawFrame: function () {
        return!this._redrawRequestedBounds || this._redrawRequestedBounds.length > this._currentDrawPosition
    }, _startCalculate: function (b, c, d, e, f, g, h) {
        this._requestFrame += 1, j.calculate({pixelBounds: [
            [this._heatMapViewport.min.x, this._heatMapViewport.min.y],
            [this._heatMapViewport.max.x, this._heatMapViewport.max.y]
        ], boundsProjected: [
            [b.min.x, b.min.y],
            [b.max.x, b.max.y]
        ], heatMap: c, linePainted: [d], maxPointsToCalculateOne: this.getCalculatePixelPerLine(), width: this.canvas.width, SKIP_INTERSECT_CHECK: a.HeatMap.SKIP_INTERSECT_CHECK, height: e, delta: h, position: a.DomUtil.getPosition(this.canvas), zoom: this._map.getZoom(), projectionName: f.code, projectionString: Gis.ProjectionDatuums.getDatum(f.code), projectedBounds: f.projectedBounds, options: a.extend({}, f.options, {transformation: void 0}), pixelOrigin: [g.x, g.y]}).then(void 0, _thenPromiseError(this, this._thenPromiseError))
    }, _startCalculate2: function (b, c, d, e, f, g, h) {
        var k, l, m, n, o, p, q, r = Math.ceil(b.length / y), s = this.getCalculatePixelPerLine(), t = Gis.ProjectionDatuums.getDatum(f.code), u = a.DomUtil.getPosition(this.canvas), v = a.extend({}, f.options, {transformation: void 0}), w = [
            [this._heatMapViewport.min.x, this._heatMapViewport.min.y],
            [this._heatMapViewport.max.x, this._heatMapViewport.max.y]
        ];
        for (n = 0, o = r; o > n; n += 1) {
            for (k = [], q = n * y, l = 0, m = y; m > l && (p = q + l, b.length > p); l += 1)k.push([
                [b[p].min.x, b[p].min.y],
                [b[p].max.x, b[p].max.y]
            ]);
            this._requestFrame += 1, j.batch.calculate([
                {thisGUID: this.GUID, pixelBounds: w, boundsProjected: k, heatMap: c, guid: this._guid, linePainted: [d], maxPointsToCalculateOne: s, width: this.canvas.width, SKIP_INTERSECT_CHECK: a.HeatMap.SKIP_INTERSECT_CHECK, height: e, transparent: Gis.config(Gis.Objects.HeatMap.NAN_COLOR_CONGIG_KEY, "rbga(0, 0, 0, 0)"), delta: h, position: u, zoom: this._map.getZoom(), projectionName: f.code, projectionString: t, projectedBounds: f.projectedBounds, options: v, pixelOrigin: [g.x, g.y]}
            ]).then(i(this, this._thenPromiseOk), i(this, this._thenPromiseError))
        }
    }, getQueue: function (b) {
        for (var c, d, e, f = b.getCenter(), g = [], h = b.min.y; h <= b.max.y; h += a.HeatMap.perTile)for (e = Math.min(h + a.HeatMap.perTile, b.max.y), c = b.min.x; c <= b.max.x; c += a.HeatMap.perTile)d = Math.min(c + a.HeatMap.perTile, b.max.x), g.push(a.bounds(a.point(c, h), a.point(d, e)));
        return g.sort(function (a, b) {
            return a.getCenter().distanceTo(f) - b.getCenter().distanceTo(f)
        }), g
    }, _checkIntersects: function () {
        var b, c, d, e;
        if (this._startPoint && this._endPoint && this._boundsProjected)return!1;
        this._startPoint = this._map.latLngToLayerPoint(this.options.bounds.getNorthWest()).add(this._map.getPixelOrigin()), b = this._map.latLngToLayerPoint(this.options.bounds.getSouthWest()).add(this._map.getPixelOrigin()), this._endPoint = this._map.latLngToLayerPoint(this.options.bounds.getSouthEast()).add(this._map.getPixelOrigin()), c = this._map.latLngToLayerPoint(this.options.bounds.getNorthEast()).add(this._map.getPixelOrigin()), this._startPoint.x = Math.min(this._startPoint.x, b.x, this._endPoint.x, c.x), this._startPoint.y = Math.min(this._startPoint.y, c.y, this._endPoint.y, b.y), this._endPoint.x = Math.max(this._startPoint.x, b.x, this._endPoint.x, c.x), this._endPoint.y = Math.max(this._startPoint.y, c.y, this._endPoint.y, b.y);
        var f = this._map.getPixelBounds();
        if (f.min._subtract(this.options.preloadSize), f.max._add(this.options.preloadSize), d = f.getIntersect(a.bounds(this._startPoint, this._endPoint)), !d)return this._linePainted = void 0, !1;
        if (this._boundsProjected) {
            if (e = this._boundsProjected.equals(d) || this._laetPixelBounds.contains(this._map.getPixelBounds()), e && !this._linePainted)return!1;
            e || (this._linePainted = void 0, this._redrawRequested = void 0, this._updateHeatMapViewport())
        } else this._linePainted = void 0;
        return this._laetPixelBounds = d, d
    }, setPixelColor: function (a, b, c, d, e) {
        var f = a.x, g = a.y;
        if (c > f && d > g) {
            var h = 4 * (f + g * c);
            e[h] = a.z[0], e[h + 1] = a.z[1], e[h + 2] = a.z[2], e[h + 3] = a.z[3]
        }
    }, isIntersects: function (a, b) {
        return this._latLngBoundsCache._northEast.lat = a.lat, this._latLngBoundsCache._northEast.lng = b.lng, this._latLngBoundsCache._southWest.lat = b.lat, this._latLngBoundsCache._southWest.lng = a.lng, this.options.bounds.intersects(this._latLngBoundsCache)
    }, isContainsPoint: function (a) {
        return this.options.bounds.contains(a)
    }, interpolatePoints: function (b, c, d, e, f, g, h, i) {
        var j, k, l = i.layerPointToLatLng(b), m = i.layerPointToLatLng(c), n = !0, o = (m.lng - l.lng) / (c.x - b.x), p = (m.lat - l.lat) / (c.y - b.y), q = l.lng;
        for (j = b.y; j < c.y; j += 1) {
            for (l.lng = q, t.y = j - h.y, k = b.x; k < c.x; k += 1)t.x = k - h.x, (a.HeatMap.SKIP_INTERSECT_CHECK || this.isContainsPoint(l)) && (t.z = this.getPixcelColorByCoord(l), this.setPixelColor(t, d, e, f, g)), l.lng = l.lng + o;
            l.lat = l.lat + p
        }
        return n
    }, _wwRedraw2: function () {
        var b, c, d, e = this._map.options.crs, f = this._map.getPixelOrigin();
        if (this._map && !this._noDraw && this._requestFrame < this._threads) {
            if (d = this._checkIntersects(), this._boundsProjected = this._laetPixelBounds, !this._boundsProjected)return;
            this._redrawRequestedBounds && this.isNeedDrawFrame() && this._currentDrawPosition || (this._redrawRequestedBounds = this.getQueue(this._boundsProjected));
            var g = this._redrawRequestedBounds[0];
            if (!g)return;
            var h = this._boundsProjected.max.y - this._boundsProjected.min.y, i = a.extend({}, this.options);
            i.canvas = void 0, i.relativePath = Gis.config("relativePath"), i.events = void 0, i.bounds = [
                [i.bounds.getNorthEast().lat, i.bounds.getNorthEast().lng],
                [i.bounds.getSouthWest().lat, i.bounds.getSouthWest().lng]
            ], i.colors = i.colors.map(function (a) {
                return{value: a.value, percent: a.percent, color: a.color.toRGBA()}
            });
            var j = [];
            for (b = 0, c = (a.HeatMap.threads - this._requestFrame) * y; c > b && this.isNeedDrawFrame(); b += 1)j.push(this._redrawRequestedBounds[this._currentDrawPosition++]);
            j.length && this._startCalculate2(j, i, 0, h, e, f, a.HeatMap.DELTA)
        }
        return this
    }, _localRedraw: function () {
        var b, c, d, e, f, g, h = this, i = function () {
            h.redraw()
        }, j = a.point(0, 0), f = a.point(0, 0);
        if (this._map && !this._noDraw) {
            if (this._checkIntersects(), this._boundsProjected = this._laetPixelBounds, !this._boundsProjected)return;
            d = this._heatMapViewport.min;
            var k = this._map.getPixelOrigin();
            this.isNeedDrawFrame() && this._currentDrawPosition || (this._redrawRequestedBounds = this.getQueue(this._boundsProjected));
            var l = this._redrawRequestedBounds[this._currentDrawPosition++];
            if (!l)return void(this._currentDrawPosition = 0);
            var m = l.min.subtract(k), n = l.max.subtract(k), o = n.x - m.x, p = n.y - m.y, q = 8, r = m.x - d.x, s = m.y - d.y, t = this.canvas.getContext("2d");
            for (e = t.getImageData(r, s, o, p), g = !1, c = m.y; c < n.y; c += q)for (b = m.x; b < n.x; b += q)j.x = b, j.y = c, f.x = b + q, f.y = c + q, g = this.interpolatePoints(j, f, d, o, p, e.data, m, this._map) || g;
            g && (t.putImageData(e, r, s), a.HeatMap.DEBUG && this._renderPoints()), this.isNeedDrawFrame() ? Gis.requestAnimationFrame(100)(i) : Gis.Util.isDefine(this._drawAfterTo) && (this._currentDrawPosition = this._drawAfterTo, this._drawAfterTo = void 0)
        }
        return this
    }, stopDraw: function () {
        this._noDraw = !0
    }, _animateZoomHeatmap: function (b) {
        var c = b.scale, d = b.offset.multiplyBy(-c)._add(this._heatMapViewport.min);
        this.canvas.style[a.DomUtil.TRANSFORM] = a.DomUtil.getTranslateString(d) + " scale(" + c + ") ", this.stopDraw()
    }, startDraw: function () {
        this._noDraw = !1
    }, _updateHeatMapViewport: function () {
        if (this._map) {
            this.latlng = this._map.getBounds().getNorthWest();
            var b, c, d = Math.min(this._map.getSize().x, document.body.clientWidth) + 2 * this.options.preloadSize.x;
            d !== this.canvas.width && (this.canvas.width = d);
            var e = Math.min(this._map.getSize().y, document.body.clientHeight) + 2 * this.options.preloadSize.y;
            e !== this.canvas.height && (this.canvas.height = e);
            var f = this._map.getSize(), g = a.DomUtil.getPosition(this._map._mapPane), h = g.multiplyBy(-1).subtract(this.options.preloadSize), i = h.add(f._round()).add(this.options.preloadSize.multiplyBy(2));
            this._heatMapViewport = new a.Bounds(h, i);
            var j = a.DomUtil.getPosition(this.canvas);
            j && (j = h.subtract(j), c = this.canvas.getContext("2d"), b = c.getImageData(0, 0, d, e), c.clearRect(0, 0, d, e)), a.DomUtil.setPosition(this.canvas, this._heatMapViewport.min), b && c.putImageData(b, -j.x, -j.y)
        }
    }}), a.HeatMap.include(a.CaptionBehavior), a.HeatMap.include({getLabelLatLng: function () {
        return this.options.bounds.getCenter()
    }}), a.HeatMap.include(a.PopupBehavior), a.HeatMap.SKIP_INTERSECT_CHECK = !0, a.HeatMap.SKIP_WW = !1, a.Map && a.Map.include({_initHeatMapRoot: function () {
        if (!this._heatMapRoot) {
            var a = this._heatMapRoot = document.createElement("div");
            a.className = "leaflet-heatmap-container", Gis.DomUtil.prepend(this._panes.overlayPane, a)
        }
    }}), a.HeatMap.perTile = x, a.HeatMap.threads = z, a.HeatMap.DELTA = 6
}(L), function () {
    L.HeatMapWorker = {calculate: function (a) {
        function b(a, b, c, d) {
            var e, f = a.replace(":", "");
            return L.CRS.hasOwnProperty(f) && !c ? e = L.CRS[f] : b && (e = new L.Proj.CRS.TMS(a, b, c, d)), e
        }

        function c(a) {
            var b = L.point(a).add(g);
            return h.pointToLatLng(b, f)
        }

        function d(a) {
            var b, d, f, g, h, j, k, l, m, n, o, p, q, r, s = L.point(0, 0), t = L.point(0, 0);
            for (f = a.position, p = 8, q = 0, r = a.boundsProjected.length; r > q; q += 1) {
                for (l = L.bounds(a.boundsProjected[q]), j = l.min.subtract(a.pixelOrigin), k = l.max.subtract(a.pixelOrigin), j.y = j.y + (a.linePainted ? a.linePainted[0] : 0), n = k.x - j.x, o = k.y - j.y, g = new Uint8Array(n * o * 4), h = !1, d = j.y; d < k.y; d += a.delta)for (b = j.x; b < k.x; b += a.delta)s.x = b, s.y = d, 1 === a.delta ? (m = c(s), e.options.bounds.contains(m) && (s = s.subtract(j), s.z = e.getPixcelColorByCoord(m), e.setPixelColor(s, f, n, g), h = 1)) : (t.x = b + p, t.y = d + p, h = e.interpolatePoints(s, t, f, n, o, g, j, c) || h);
                i.fire("calc", {guid: a.guid, thisGUID: a.thisGUID, viewPort: a.pixelBounds[0], type: "points", stamp: a.stamp, data: g, width: n, height: o, start: j.x - f.x, end: j.y - f.y, isLastData: q + 1 === r})
            }
            return{}
        }

        importScripts("deploy/scripts/gis.webwork.js");
        var e, f, g, h, i = this;
        return L.HeatMap.SKIP_INTERSECT_CHECK = a.SKIP_INTERSECT_CHECK, e = new L.HeatMap(void 0, L.extend(a.heatMap, {skipWW: !0, transparent: a.transparent})), h = b(a.projectionName, a.projectionString, a.projectedBounds, a.options), g = a.pixelOrigin, f = a.zoom, d(a)
    }}
}(), function (a) {
    "use strict";
    a.ImageOverlay.include({setBounds: function (b) {
        this._bounds = a.latLngBounds(b), this._reset()
    }, setUrl: function (a) {
        this._url = a, this._reset()
    }})
}(L), function (a) {
    "use strict";
    a.Util.isArray = Array.isArray || a.Util.isArray, a.LatLngBounds.prototype.getIntersect = function (b) {
        if (b && this.intersects(b)) {
            var c = this.getSouthWest(), d = b.getSouthWest(), e = this.getNorthEast(), f = b.getNorthEast(), g = a.latLng(Math.max(c.lat, d.lat), Math.max(c.lng, d.lng)), h = a.latLng(Math.min(e.lat, f.lat), Math.min(e.lng, f.lng));
            return a.latLngBounds(g, h)
        }
    }, a.Bounds.prototype.getIntersect = function (b) {
        if (b && this.intersects(b)) {
            var c = this.min, d = b.min, e = this.max, f = b.max, g = a.point(Math.max(c.x, d.x), Math.max(c.y, d.y)), h = a.point(Math.min(e.x, f.x), Math.min(e.y, f.y));
            return a.bounds(g, h)
        }
    }, a.Bounds.prototype.equals = function (a) {
        return!a || a.min.equals(this.min) && a.max.equals(this.max)
    }
}(L), function (a) {
    "use strict";
    var b = [];
    a.latLng = function (b, c, d, e) {
        return b instanceof a.LatLng ? e ? new a.LatLng(b.lat, b.lng, b.alt) : b : a.Util.isArray(b) ? "number" == typeof b[0] || "string" == typeof b[0] ? new a.LatLng(b[0], b[1], b[2]) : null : void 0 === b || null === b ? b : "object" == typeof b && "lat"in b ? new a.LatLng(b.lat, "lng"in b ? b.lng : b.lon) : void 0 === c ? null : new a.LatLng(b, c)
    }, a.LatLng.cache = function () {
    }, a.point = function (c, d, e, f) {
        var g;
        return c instanceof a.Point ? f ? b.length ? (g = b.pop(), g.x = c.x, g.y = c.y, g) : new a.Point(c.x, c.y) : c : (b.length && (g = b.pop()), a.Util.isArray(c) ? g ? (g.x = c[0], g.y = c[1], g) : new a.Point(c[0], c[1]) : void 0 === c || null === c ? c : g ? (g.x = e ? Math.round(c) : c, g.y = e ? Math.round(d) : d, g) : new a.Point(c, d, e))
    }, a.Point.cache = function () {
    }
}(L), function (a) {
    "use strict";
    a.DomUtil.setRotate = function (b, c) {
        b.style[a.DomUtil.TRANSFORM] = b.style[a.DomUtil.TRANSFORM].replace(/rotate[3d]*\([0, 0, 1, ]*[\d+\.*\d*]+deg\)/g, "") + a.DomUtil.getRotateString(c)
    }, a.DomUtil.getRotateString = function (b) {
        var c = a.Browser.webkit3d, d = "rotate" + (c ? "3d" : "") + "(" + (c ? "0,0,1," : "");
        return d + b + "deg)"
    }
}(L), function (a) {
    "use strict";
    a.LatLng.prototype.abs = function () {
        return a.latLng(Math.abs(this.lat), Math.abs(this.lng))
    }
}(L), function (a) {
    "use strict";
    var b, c = a.Map.prototype.invalidateSize, d = a.Map.prototype.setZoomAround;
    a.DomUtil.TRANSITION && a.Map.addInitHook(function () {
        this._zoomAnimated = this.options.zoomAnimation && a.DomUtil.TRANSITION && a.Browser.any3d && !a.Browser.android23 && !a.Browser.mobileOpera, this._zoomAnimated || a.DomEvent.on(this._mapPane, a.DomUtil.TRANSITION_END, this._catchTransitionEnd, this)
    }), a.Map.include({_mapMoved: function () {
        return this.options.maxCenterBounds ? this.setMaxCenterBounds(this.options.maxCenterBounds) : this
    }, _animateZoom: function (b, c, d, e, f, g) {
        this._animatingZoom = !0, a.DomUtil.addClass(this._mapPane, "leaflet-zoom-anim"), this._animateToCenter = b, this._animateToZoom = c, a.Draggable && (a.Draggable._disabled = !0), this.fire("zoomanim", {center: b, zoom: c, origin: d, scale: e, delta: f, offset: this._getCenterOffset(b), backwards: g})
    }, getMinZoom: function () {
        var a = void 0 === this._layersMinZoom ? 0 : this._layersMinZoom, b = void 0 === this._boundsMinZoom ? 0 : this._boundsMinZoom;
        return void 0 === this.options.minZoom ? Math.max(a, b) : this.options.minZoom
    }, getPixcelBounds: function (b) {
        return b && new a.Bounds(this.project(b.getNorthEast()), this.project(b.getSouthWest()))
    }, getPixcelBoundsLayer: function (b) {
        return b && new a.Bounds(this.latLngToLayerPoint(b.getNorthEast()), this.latLngToLayerPoint(b.getSouthWest()))
    }, getMaxBounds: function () {
        var a = this.options.maxBounds;
        return a ? a : (a = this.options.maxCenterBounds, a ? a : a)
    }, getPixelCrop: function () {
        var b;
        return this.getMaxBounds() && this._bbox ? (b = a.bounds(this.latLngToLayerPoint(this._bbox[0]), this.latLngToLayerPoint(this._bbox[1])), b.extend(this.latLngToLayerPoint(this._bbox[2])), b.extend(this.latLngToLayerPoint(this._bbox[3])), b) : this.getBounds() ? a.bounds(this.latLngToLayerPoint(this.getBounds().getNorthWest()), this.latLngToLayerPoint(this.getBounds().getSouthEast())) : void 0
    }, setMaxCenterBounds: function (c) {
        c = a.latLngBounds(c);
        var d;
        if (!this.options.maxCenterBounds && c ? this.on("moveend", this._mapMoved, this) : c || this.off("moveend", this._mapMoved, this), this.options.maxCenterBounds = c, !c)return!this._bbox && b && this.removeLayer(b), this;
        window.L_DEBUG && (b ? b.setLatLngs(this._bbox) : b = a.polygon(this._bbox, {stroke: !0, color: "blue", fill: !0, fillColor: "blue", fillOpacity: .2}), b.addTo(this));
        try {
            d = this.getPixcelBounds(c);
            var e = d.intersects(this.getPixelBounds());
            this._loaded && !e ? (this._lastCenter && !c.contains(this._lastCenter) && (this._lastCenter = void 0), this.panTo(this._lastCenter || c.getCenter())) : this._lastCenter = e ? this.getCenter() : null
        } catch (f) {
            console.log("error pan to bounds, may be no corretc projection")
        }
        return this
    }, setZoomAround: function (a, b, c) {
        this.getZoomScale(b) && d.call(this, a, b, c)
    }, invalidateSize: function (a) {
        var b = this;
        return c.call(this, a), this.options.maxCenterBounds && (b = this.setMaxCenterBounds(this.options.maxCenterBounds)), b
    }, _updateSvgViewport: function () {
        if (!this._pathZooming) {
            this._updatePathViewport();
            var b = this._pathViewport, c = b.min, d = b.max, e = d.x - c.x, f = d.y - c.y, g = this._pathRoot, h = this._panes.overlayPane;
            a.Browser.mobileWebkit && h.removeChild(g), a.DomUtil.setPosition(g, c, navigator.userAgent.toLowerCase().indexOf("javafx") > -1), g.setAttribute("width", e), g.setAttribute("height", f), g.setAttribute("viewBox", [c.x, c.y, e, f].join(" ")), a.Browser.mobileWebkit && h.appendChild(g)
        }
    }, _initPathRoot: function () {
        this._pathRoot || (this._pathRoot = a.Path.prototype._createElement("svg"), this._panes.overlayPane.appendChild(this._pathRoot), this.options.zoomAnimation && a.Browser.any3d ? (a.DomUtil.addClass(this._pathRoot, "leaflet-zoom-animated"), this.on({zoomanim: this._animatePathZoom, zoomend: this._endPathZoom})) : a.DomUtil.addClass(this._pathRoot, "leaflet-zoom-hide"), this.on("moveend", this._updateSvgViewport), this._updateSvgViewport())
    }})
}(L), function (a) {
    "use strict";
    var b = a.Marker.prototype._setPos, c = a.Marker.prototype.closePopup, d = a.Marker.prototype.openPopup, e = a.Marker.prototype.onRemove, f = a.Marker.prototype.setLatLng;
    a.Handler.MarkerDragGis = a.Handler.MarkerDrag.extend({_onDrag: function () {
        var b = this._marker, c = b._shadow, d = a.DomUtil.getPosition(b._icon).add(b._calculateOffset()).round(), e = b._map.layerPointToLatLng(d);
        c && a.DomUtil.setPosition(c, d), b._latlng = e, b.fire("move", {latlng: e}).fire("drag")
    }}), a.MarkerGis = a.Marker.extend({}), a.MarkerGis.include(a.CaptionBehavior), a.MarkerGis.include({options: {selectedClass: "gis-selected", angle: 0, position: "topleft", labelPosition: "topleft"}, setClickable: function (a) {
        this.options.clickable !== a && (this.options.clickable = a, this._map && a ? this._initClickable() : this._map && this._deInitClickable())
    }, _initClickable: function () {
        if (this.options.clickable) {
            var b, c, d = this._icon, e = ["dblclick", "mousedown", "mouseover", "mouseout", "contextmenu"];
            for (this.options.icon.setClickable ? this.options.icon.setClickable(!0) : a.DomUtil.addClass(d, "gis-clickable"), a.DomEvent.on(d, "click", this._onMouseClick, this), b = 0, c = e.length; c > b; b += 1)a.DomEvent.on(d, e[b], this._fireMouseEvent, this)
        }
    }, _deInitClickable: function () {
        var b, c, d = this._icon, e = ["dblclick", "mousedown", "mouseover", "mouseout", "contextmenu"];
        for (this.options.icon.setClickable ? this.options.icon.setClickable(!1) : a.DomUtil.removeClass(d, "gis-clickable"), a.DomEvent.off(d, "click", this._onMouseClick, this), b = 0, c = e.length; c > b; b += 1)a.DomEvent.off(d, e[b], this._fireMouseEvent, this)
    }, _initIcon: function () {
        var b, c = this.options, d = this._map, e = d.options.zoomAnimation && d.options.markerZoomAnimation, f = e ? "leaflet-zoom-animated" : "leaflet-zoom-hide", g = !1;
        this._icon || (this._icon = c.icon.createIcon(), c.title && (this._icon.title = c.title), this._initInteraction(), g = this.options.opacity < 1, a.DomUtil.addClass(this._icon, f), c.riseOnHover && a.DomEvent.on(this._icon, "mouseover", this._bringToFront, this).on(this._icon, "mouseout", this._resetZIndex, this)), this._shadow || (this._shadow = c.icon.createShadow(), this._shadow && (a.DomUtil.addClass(this._shadow, f), g = this.options.opacity < 1)), g && this._updateOpacity(), b = this._map._panes, b.markerPane.appendChild(this._icon), this._shadow && b.shadowPane.appendChild(this._shadow), this.options.icon.on("load", this.update, this)
    }, getContainerBounds: function () {
        var b, c, d, e = this.options.icon, f = e.getWidth() || 0, g = e.getHeight() || 0;
        return d = this._map.latLngToLayerPoint(this._latlng).subtract(this._calculateOffset()).round(), b = this._map.layerPointToLatLng(d), c = this._map.layerPointToLatLng(new a.Point(d.x + g, d.y + f)), new a.LatLngBounds(b, c)
    }, _removeIcon: function () {
        var b, c = this._map._panes;
        this.options.riseOnHover && a.DomEvent.off(this._icon, "mouseover", this._bringToFront).off(this._icon, "mouseout", this._resetZIndex), b = c.markerPane, b && this._icon && b.removeChild(this._icon), this._shadow && this._map._panes.shadowPane.removeChild(this._shadow), this._deInitClickable(), this._icon = this._shadow = null
    }, _initInteraction: function () {
        this._initClickable(), this.setDraggable(this.options.draggable)
    }, setDraggable: function (b) {
        a.Handler.MarkerDragGis && (this.dragging && this._oldIconDrag && this._oldIconDrag !== this._icon && (this.dragging.disable(), this.dragging = new a.Handler.MarkerDragGis(this)), this._oldIconDrag = this._icon, this.dragging = this.dragging || new a.Handler.MarkerDragGis(this), this.options.draggable = b, this.options.draggable ? this.dragging.enable() : this.dragging && this.dragging.disable())
    }, addClass: function (a) {
        this.options.icon.addClass(a)
    }, setSelected: function (a) {
        a ? this.options.icon.addClass(this.options.selectedClass) : this.options.icon.removeClass(this.options.selectedClass)
    }, removeClass: function (a) {
        this.options.icon.removeClass(a)
    }, getLabel: function () {
        return this._label
    }, _calculateLabelOffset: function () {
        return this._labelIconOffset().subtract(this._calculateOffset())
    }, _labelIconOffset: function () {
        var b = this.options.icon, c = b.getWidth() || 0, d = b.getHeight() || 0;
        return a.point(c, d)
    }, setIcon: function (a) {
        return this.options.icon !== a ? (this._oldPosition = null, this._map && this._removeIcon(), this.options.icon = a, this._map && (this._initIcon(), this.update()), this) : void 0
    }, updateLabelContent: function (a) {
        this._label && this._label.setContent(a)
    }, getLabelLatLng: function () {
        return this._latlng
    }, update: function () {
        if (this._icon) {
            var a = this._map.latLngToLayerPoint(this._latlng).subtract(this._calculateOffset()).round();
            this._setPos(a)
        }
        return this.options.icon && (this._label && this._label.setOffset(this._calculateLabelOffset()), this._popup && this._popup.setOffset(this._calculateLabelOffset().add([0, -this.options.icon.getHeight()]))), this
    }, _animateZoom: function (a) {
        var b = this._map._latLngToNewLayerPoint(this._latlng, a.zoom, a.center).subtract(this._calculateOffset());
        this._setPos(b)
    }, _calculateOffset: function () {
        if (this._oldIcon === this.options.icon && this._oldPosition && this.options.position === this._lastPosition && !isNaN(this._oldPosition.x) && !isNaN(this._oldPosition.y))return this._oldPosition;
        this._oldIcon = this.options.icon, this._lastPosition = this.options.position;
        var b, c = this.options.icon, d = c.getWidth(), e = c.getHeight(), f = this.options.position || "bottomcenter";
        switch (f) {
            case"topright":
                b = a.point(d, 0);
                break;
            case"bottomright":
                b = a.point(d, e);
                break;
            case"bottomleft":
                b = a.point(0, e);
                break;
            case"bottomcenter":
                b = a.point(d / 2, e);
                break;
            case"topcenter":
                b = a.point(d / 2, 0);
                break;
            case"centerleft":
                b = a.point(0, e / 2);
                break;
            case"centerright":
                b = a.point(d, e / 2);
                break;
            case"center":
                b = a.point(d / 2, e / 2);
                break;
            default:
                b = a.point(0, 0)
        }
        return!isNaN(b.x) && !isNaN(b.y) && d > 0 && e > 0 && (this._oldPosition = b), b
    }, _setPos: function (c) {
        var d;
        b.call(this, c), this.options.angle && (d = this.options.angle % 360, a.DomUtil.setRotate(this._icon, d), this._shadow && a.DomUtil.setRotate(this._shadow, d))
    }, setAngle: function (a) {
        return this.options.angle = a, this.update(), this
    }, setPosition: function (a) {
        return this.options.position = a, this.update(), this
    }, bindPopup: function (b, c, d) {
        var e = this.options.icon, f = this, g = f.options.icon.getWidth(), h = a.point(e.options.popupAnchor) || a.point(g / 2 || 0, 0);
        return e.on("load", function () {
            f._popup.setOffset(f._calculateLabelOffset().add([this.getWidth(), -this.getHeight()])), f._label && f._label.setIconOffset(f._labelIconOffset())
        }), h = h.add(a.PopupGis.prototype.options.offset), c && c.offset && (h = h.add(c.offset)), c = a.extend({offset: h}, c), this._popup || (d ? this.on("mouseover", this.openPopup, this).on("mouseout", this.closePopup, this) : this.on("click", this.openPopup, this).on("remove", this.closePopup, this), this.on("move", this._movePopup, this)), this._popup = new a.PopupGis(c, this).setContent(b), f._popup.setOffset(f._calculateLabelOffset().add([0, -e.getHeight()])), this
    }, openPopup: function () {
        return this._timeout ? (clearTimeout(this._timeout), this._timeout = void 0) : d.call(this), this
    }, closePopup: function () {
        var a = this;
        return clearTimeout(this._timeout), this._timeout = setTimeout(function () {
            a._timeout = void 0, c.call(a)
        }, 150), this
    }, unbindPopup: function (a) {
        return this._popup && (this._popup = null, a ? this.off("mouseover", this.openPopup).off("mouseout", this.closePopup) : this.off("click", this.openPopup).off("remove", this.closePopup), this.off("move", this._movePopup)), this
    }, _movePopup: function (a) {
        this._popup.setLatLng(a.latlng)
    }, setLatLng: function (b) {
        return a.LatLng.cache(this._latlng), f.call(this, b)
    }, _deInitInteraction: function () {
        var b = this._icon, c = ["dblclick", "mousedown", "mouseover", "mouseout", "contextmenu"];
        if (b) {
            a.DomEvent.off(b, "click", this._onMouseClick, this), a.DomEvent.off(b, "keypress", this._onKeyPress, this);
            for (var d = 0; d < c.length; d++)a.DomEvent.off(b, c[d], this._fireMouseEvent, this)
        }
        this.dragging && this.dragging.disable()
    }, onRemove: function (b) {
        this.getPosition && this.getPosition() && a.Point.cache(this.getPosition()), a.LatLng.cache(this._latlng), e.call(this, b)
    }}), a.markerGis = function (b, c) {
        return new a.MarkerGis(b, c)
    }
}(L), function () {
    "use strict";
    var a = 5, b = "#5C7EE7", c = .8;
    L.ReliefControl = {TIME_TO_ANIMATE: 300, BORDER_COLOR: b, DEFAULT_POINT_RADIUS: a, BIG_POINT_RADIUS: 10, DEFAULT_OPACITY: c, HOVERED_OPACITY: 1, DRAGGABLE_POINT_STYLE: {radius: a, fill: "white", stroke: b, strokeWidth: 2, draggable: !0}, RADAR_LINE_POINT_STYLE: {fill: b, stroke: b, strokeWidth: 2}, SHAPE_STYLE: {stroke: b, fill: "rgba(92, 126, 231, 0.49)", strokeWidth: 2, opacity: c}}
}(), function () {
    "use strict";
    var a, b, c, d, e, f;
    L.ReliefControlCircle = L.Class.extend({options: {radius: void 0, draggedPoint: void 0, center: void 0}, includes: [L.Mixin.Events], initialize: function () {
        if (L.ReliefControlCircle.instance)throw new Error("Already created");
        var b = this;
        L.ReliefControlCircle.instance = this, this.drawRelief = function () {
            b.updatePointPositions(), a.draw()
        }
    }, fillDraggedPointFromRadius: function (a) {
        if (a.radius) {
            var b = this.options.draggedPoint && Gis.Projection.calculateAsimuth(this.options.center, this.options.draggedPoint) || 90;
            this.options.draggedPoint = L.latLng(Gis.Projection.nextPointByLen(a.radius, this.options.center, b))
        }
    }, setOptions: function (a, b) {
        L.Util.setOptions(this, a), this.fillDraggedPointFromRadius(a), b || this.fire("dragend"), this.draw()
    }, getCenter: function () {
        return this.options.center
    }, getAvailableBounds: function () {
        var a = this._map.getPixelBounds(), b = this._map.getPixelCrop();
        return b && (a.min._subtract(this._map.getPixelOrigin()), a.max._subtract(this._map.getPixelOrigin()), a = a.getIntersect(b)), a
    }, addTo: function (a) {
        return a.addLayer(this), this
    }, recalculateDraggedPoint: function () {
        var a = this.getAvailableBounds();
        this.options.draggedPoint = this._map.layerPointToLatLng(a.getCenter().add(L.point(a.getSize().x / 4, 0))).wrap()
    }, updateDraggedPointPosition: function () {
        this.options.center = this._map.layerPointToLatLng(L.point(f.x(), f.y()).add(this._map._kineticViewport.min)), this.options.draggedPoint = this._map.layerPointToLatLng(L.point(c.x(), c.y()).add(this._map._kineticViewport.min))
    }, moveDragWithCenter: function () {
        var a = this._map.latLngToLayerPoint(this.options.center).subtract(this._map._kineticViewport.min), b = L.point(f.x(), f.y());
        this.options.center = this._map.layerPointToLatLng(b.add(this._map._kineticViewport.min)), this.options.draggedPoint = this._map.layerPointToLatLng(L.point(c.x(), c.y()).add(b.subtract(a)).add(this._map._kineticViewport.min))
    }, moveDragWithCenterPoint: function () {
        var a = this._map.latLngToLayerPoint(this.options.center).subtract(this._map._kineticViewport.min), b = L.point(d.x(), d.y());
        this.options.center = this._map.layerPointToLatLng(b.add(this._map._kineticViewport.min)), this.options.draggedPoint = this._map.layerPointToLatLng(L.point(c.x(), c.y()).add(b.subtract(a)).add(this._map._kineticViewport.min))
    }, _fillOptions: function () {
        var a = this.getAvailableBounds(), b = this._map.layerPointToLatLng(a.getCenter()).wrap();
        this.fillDraggedPointFromRadius(this.options), void 0 == this.options.draggedPoint && this.recalculateDraggedPoint(), void 0 == this.options.center && (this.options.center = b), void 0 == this.options.height && (this.options.height = 5e3)
    }, getPixelRadius: function () {
        return this._map.latLngToLayerPoint(this.options.center).distanceTo(this._map.latLngToLayerPoint(this.options.draggedPoint))
    }, getRadius: function () {
        return this.options.center && this.options.draggedPoint && this.options.center.distanceTo(this.options.draggedPoint) || 0
    }, updatePointPositions: function () {
        c.position(this.getPosition(this.options.draggedPoint)), d.position(this.getPosition(this.options.center)), b.position(this.getPosition(this.options.center)), b.points(this.getRadarPoints()), f.position(this.getPosition(this.options.center))
    }, getPosition: function (a) {
        return this._map.latLngToLayerPoint(a)._subtract(this._map._kineticViewport.min)
    }, initPointsEvents: function () {
        var b = this, e = function () {
            b.moveDragWithCenter(), b.drawRelief()
        }, g = function () {
            b.moveDragWithCenterPoint(), b.drawRelief()
        }, h = function () {
            b.updateDraggedPointPosition(), f.radius(b.getPixelRadius()), b.drawRelief()
        }, i = function () {
            b.fire("dragend")
        };
        f.dragBoundFunc(function (a) {
            return Gis.requestAnimationFrame(50)(e), a
        }), d.dragBoundFunc(function (a) {
            return Gis.requestAnimationFrame(50)(g), a
        }), c.dragBoundFunc(function (a) {
            return Gis.requestAnimationFrame(50)(h), a
        }), d.on("mouseover", L.KineticFuncs.zoomInFunc(L.ReliefControl.TIME_TO_ANIMATE, L.ReliefControl.BIG_POINT_RADIUS, a)), d.on("mouseout", L.KineticFuncs.zoomOutFunc(L.ReliefControl.TIME_TO_ANIMATE, L.ReliefControl.DEFAULT_POINT_RADIUS, a)), c.on("mouseover", L.KineticFuncs.zoomInFunc(L.ReliefControl.TIME_TO_ANIMATE, L.ReliefControl.BIG_POINT_RADIUS, a)), c.on("mouseout", L.KineticFuncs.zoomOutFunc(L.ReliefControl.TIME_TO_ANIMATE, L.ReliefControl.DEFAULT_POINT_RADIUS, a)), f.on("mouseover", L.KineticFuncs.zoomInFuncOpacity(L.ReliefControl.TIME_TO_ANIMATE, L.ReliefControl.HOVERED_OPACITY, a)), f.on("mouseout", L.KineticFuncs.zoomOutFuncOpacity(L.ReliefControl.TIME_TO_ANIMATE, L.ReliefControl.DEFAULT_OPACITY, a)), c.on("dragend", i), d.on("dragend", i), f.on("dragend", i)
    }, getRadarPoints: function () {
        var a = this.getPosition(this.options.center), b = this.getPosition(this.options.draggedPoint).subtract(a);
        return[0, 0, b.x, b.y]
    }, showRadar: function (c) {
        if (this._showRadar = c, b) {
            var d = 0, e = b, f = 1e3;
            if (c)b._anim_s && b._anim_s.stop(), L.KineticFuncs.zoomInFuncOpacity(f, L.ReliefControl.HOVERED_OPACITY, a).call(b), b._anim_s = new Kinetic.Animation(function (a) {
                var b;
                b = d + 180 * (a.time / 1e3), e.rotation(b)
            }, a), b._anim_s.start(); else {
                L.KineticFuncs.zoomOutFuncOpacity(2 * f, 0, a).call(b);
                var g = b._anim_s;
                g && setTimeout(function () {
                    g.stop()
                }, 2 * f)
            }
        }
    }, initElements: function () {
        if (this._fillOptions(), !a) {
            a = new Kinetic.Layer;
            var g = this.getPosition(this.options.center), h = this.getPosition(this.options.draggedPoint);
            c = c || new Kinetic.Circle(Gis.extend({}, h, L.ReliefControl.DRAGGABLE_POINT_STYLE)), b = b || new Kinetic.Line(L.extend({x: g.x, y: g.y, opacity: 0, points: this.getRadarPoints()}, L.ReliefControl.RADAR_LINE_POINT_STYLE)), d = d || new Kinetic.Circle(Gis.extend({}, g, L.ReliefControl.DRAGGABLE_POINT_STYLE)), e = e || new Kinetic.Circle(Gis.extend({}, L.ReliefControl.DRAGGABLE_POINT_STYLE)), f = f || new Kinetic.Circle(L.extend({radius: this.getPixelRadius(), draggable: !0}, g, L.ReliefControl.SHAPE_STYLE)), a.add(f), a.add(b), a.add(d), a.add(c), this.initPointsEvents()
        }
    }, onAdd: function (b) {
        this._map = b;
        var c = this;
        b.initKinetic(), this.initElements(), this._map.showTopKinetic(!0), this._map._kineticStageTop.add(a), this.fire("add"), this.initEvents(), this.showRadar(this._showRadar), Gis.requestAnimationFrame(10)(function () {
            c.draw(), Gis.requestAnimationFrame(10)(function () {
                a.setZIndex(1)
            })
        })
    }, onRemove: function () {
        this._map.showTopKinetic(!1), this.deInitEvents(), a.remove()
    }, initEvents: function () {
        this._map.on("moveend", this.moveEnd, this), this._map.on("movestart", this.moveStart, this), Gis.EventBus.on("skchanged", this.draw, this), this._map.on("zoomend", this._zoomEnd, this)
    }, deInitEvents: function () {
        this._map.off("moveend", this.moveEnd, this), this._map.off("movestart", this.moveStart, this), Gis.EventBus.off("skchanged", this.draw, this), this._map.off("zoomend", this._zoomEnd, this)
    }, moveEnd: function () {
        this.draw()
    }, moveStart: function () {
    }, _zoomEnd: function () {
        this.draw()
    }, draw: function () {
        this._map && this.options.draggedPoint && this.options.center && (c.position(this.getPosition(this.options.draggedPoint)), d.position(this.getPosition(this.options.center)), b.position(this.getPosition(this.options.center)), b.points(this.getRadarPoints()), f.position(this.getPosition(this.options.center)), f.radius(this.getPixelRadius()), Gis.requestAnimationFrame(10)(this.drawRelief))
    }}), L.ReliefControlCircle.getInstance = function (a) {
        return L.ReliefControlCircle.instance ? a && L.ReliefControlCircle.instance.setOptions(a) : new L.ReliefControlCircle(a), L.ReliefControlCircle.instance
    }
}(), function () {
    "use strict";
    var a, b, c, d, e, f, g, h, i, j = 0;
    L.ReliefControlSquare = L.Class.extend({options: {bounds: void 0}, includes: [L.Mixin.Events], initialize: function () {
        i = this, this.drawRelief = function () {
            i.updatePointPositions(), a.draw()
        }
    }, getCenter: function () {
        return this.options.bounds.getCenter()
    }, getNorthWest: function () {
        return this.options.bounds.getNorthWest()
    }, getSouthEast: function () {
        return this.options.bounds.getSouthEast()
    }, getAvailableBounds: function () {
        var a = this._map.getPixelBounds(), b = this._map.getPixelCrop();
        return b && (a.min._subtract(this._map.getPixelOrigin()), a.max._subtract(this._map.getPixelOrigin()), a = a.getIntersect(b)), a
    }, addTo: function (a) {
        return a.addLayer(this), this
    }, recalculateDraggedPoint: function () {
        var a = this.getAvailableBounds();
        this.options.bounds = L.latLngBounds(this._map.layerPointToLatLng(a.getCenter().subtract(a.getSize().divideBy(4))).wrap(), this._map.layerPointToLatLng(a.getCenter().add(a.getSize().divideBy(4))).wrap())
    }, updateDraggedPointPosition: function (a) {
        a ? (this.options.bounds = L.latLngBounds(this._map.layerPointToLatLng(L.point(b.x(), b.y()).add(a).add(this._map._kineticViewport.min)), this._map.layerPointToLatLng(L.point(g.x(), g.y()).add(a).add(this._map._kineticViewport.min))), this.options.bounds.extend(this._map.layerPointToLatLng(L.point(e.x(), e.y()).add(a).add(this._map._kineticViewport.min))), this.options.bounds.extend(this._map.layerPointToLatLng(L.point(f.x(), f.y()).add(a).add(this._map._kineticViewport.min)))) : (this.options.bounds = L.latLngBounds(this._map.layerPointToLatLng(L.point(b.x(), b.y()).add(this._map._kineticViewport.min)), this._map.layerPointToLatLng(L.point(g.x(), g.y()).add(this._map._kineticViewport.min))), this.options.bounds.extend(this._map.layerPointToLatLng(L.point(e.x(), e.y()).add(this._map._kineticViewport.min))), this.options.bounds.extend(this._map.layerPointToLatLng(L.point(f.x(), f.y()).add(this._map._kineticViewport.min))))
    }, moveDragWithCenter: function () {
        var a = this._oldCenter || L.point(0, 0), b = L.point(h.x(), h.y());
        this._oldCenter = b, this.updateDraggedPointPosition(b.subtract(a))
    }, _fillOptions: function () {
        var a = this.getAvailableBounds();
        if (void 0 == this.options.bounds) {
            var b = a.getSize().divideBy(4);
            this.options.bounds = L.latLngBounds(this._map.layerPointToLatLng(a.getCenter().subtract(b)), this._map.layerPointToLatLng(a.getCenter().add(b)))
        }
    }, updateSquarePoints: function () {
        var a = h.x(), c = h.y();
        h.points([b.x() - a, b.y() - c, e.x() - a, e.y() - c, g.x() - a, g.y() - c, f.x() - a, f.y() - c])
    }, updatePointPositions: function () {
        b.position(this.getPosition(this.options.bounds.getNorthWest())), e.position(this.getPosition(this.options.bounds.getNorthEast())), f.position(this.getPosition(this.options.bounds.getSouthWest())), g.position(this.getPosition(this.options.bounds.getSouthEast())), c.points(this.getRadarPoints()), d.points(this.getRadarPointsVertical()), this.updateSquarePoints()
    }, getPosition: function (a) {
        return this._map.latLngToLayerPoint(a)._subtract(this._map._kineticViewport.min)
    }, initPointsEvents: function () {
        function c(b, c) {
            b.on("mouseover", L.KineticFuncs.zoomInFunc(L.ReliefControl.TIME_TO_ANIMATE, L.ReliefControl.BIG_POINT_RADIUS, a)), b.on("mouseout", L.KineticFuncs.zoomOutFunc(L.ReliefControl.TIME_TO_ANIMATE, L.ReliefControl.DEFAULT_POINT_RADIUS, a)), b.on("dragend", k);
            var d = function () {
                c.call(b)
            };
            b.dragBoundFunc(function (a) {
                return Gis.requestAnimationFrame(50)(d), a
            })
        }

        var d = this, i = function () {
            d.moveDragWithCenter(), d.drawRelief()
        }, j = function () {
            var a = d._map.layerPointToLatLng(L.point(this.x(), this.y()).add(d._map._kineticViewport.min));
            this === b ? (d.options.bounds._northEast.lat = a.lat, d.options.bounds._southWest.lng = a.lng) : this === e ? (d.options.bounds._northEast.lat = a.lat, d.options.bounds._northEast.lng = a.lng) : this === g ? (d.options.bounds._southWest.lat = a.lat, d.options.bounds._northEast.lng = a.lng) : this === f && (d.options.bounds._southWest.lat = a.lat, d.options.bounds._southWest.lng = a.lng), d.drawRelief()
        }, k = function () {
            d.fire("dragend")
        };
        c(f, j), c(g, j), c(b, j), c(e, j), h.on("mouseover", L.KineticFuncs.zoomInFuncOpacity(L.ReliefControl.TIME_TO_ANIMATE, L.ReliefControl.HOVERED_OPACITY, a)), h.on("mouseout", L.KineticFuncs.zoomOutFuncOpacity(L.ReliefControl.TIME_TO_ANIMATE, L.ReliefControl.DEFAULT_OPACITY, a)), h.on("dragend", k), h.dragBoundFunc(function (a) {
            return Gis.requestAnimationFrame(50)(i), a
        })
    }, getRadarPoints: function () {
        var a = this.getPosition(this.options.bounds.getNorthWest()), b = this.getPosition(this.options.bounds.getNorthEast()), c = this.getPosition(this.options.bounds.getSouthWest()), d = this.getPosition(this.options.bounds.getSouthEast()), e = (c.x - a.x) * j, f = (d.x - b.x) * j, g = (c.y - a.y) * j;
        return[a.x + e, a.y + g, b.x + f, b.y - b.subtract(d).y * j]
    }, getRadarPointsVertical: function () {
        var a = this.getPosition(this.options.bounds.getNorthWest()), b = this.getPosition(this.options.bounds.getNorthEast()), c = this.getPosition(this.options.bounds.getSouthWest()), d = this.getPosition(this.options.bounds.getSouthEast()), e = (b.x - a.x) * j, f = (d.x - c.x) * j, g = (b.y - a.y) * j;
        return[a.x + e, a.y + g, c.x + f, c.y - c.subtract(d).y * j]
    }, onAdd: function (i) {
        this._map = i;
        var j = this;
        if (this._fillOptions(), i.initKinetic(), !a) {
            a = new Kinetic.Layer, h = h || new Kinetic.Line(L.extend({closed: !0, draggable: !0}, L.ReliefControl.SHAPE_STYLE)), a.add(h);
            var k = this.getPosition(this.options.bounds.getNorthWest()), l = this.getPosition(this.options.bounds.getNorthEast());
            c = c || new Kinetic.Line(L.extend({x: 0, y: 0, opacity: 0, points: this.getRadarPoints()}, L.ReliefControl.RADAR_LINE_POINT_STYLE)), d = d || new Kinetic.Line(L.extend({x: 0, y: 0, opacity: 0, points: this.getRadarPointsVertical()}, L.ReliefControl.RADAR_LINE_POINT_STYLE)), b = new Kinetic.Circle(Gis.extend(k, L.ReliefControl.DRAGGABLE_POINT_STYLE)), e = new Kinetic.Circle(Gis.extend(l, L.ReliefControl.DRAGGABLE_POINT_STYLE)), f = new Kinetic.Circle(Gis.extend(this.getPosition(this.options.bounds.getSouthWest()), L.ReliefControl.DRAGGABLE_POINT_STYLE)), g = new Kinetic.Circle(Gis.extend(this.getPosition(this.options.bounds.getSouthEast()), L.ReliefControl.DRAGGABLE_POINT_STYLE)), this.updateSquarePoints(), a.add(c), a.add(d), a.add(b), a.add(e), a.add(f), a.add(g), this.initPointsEvents()
        }
        this._map.showTopKinetic(!0), this._map._kineticStageTop.add(a), this.fire("add"), this.initEvents(), Gis.requestAnimationFrame(10)(function () {
            j.draw(), Gis.requestAnimationFrame(10)(function () {
                a.setZIndex(1)
            })
        })
    }, onRemove: function () {
        this._map.showTopKinetic(!1), this.deInitEvents(), a.remove()
    }, initEvents: function () {
        this._map.on("moveend", this.moveEnd, this), this._map.on("movestart", this.moveStart, this), Gis.EventBus.on("skchanged", this.draw, this), this._map.on("zoomend", this._zoomEnd, this)
    }, deInitEvents: function () {
        this._map.off("moveend", this.moveEnd, this), this._map.off("movestart", this.moveStart, this), Gis.EventBus.off("skchanged", this.draw, this), this._map.off("zoomend", this._zoomEnd, this)
    }, moveEnd: function () {
        this.draw()
    }, moveStart: function () {
    }, showRadar: function (b) {
        if (this._showRadar = b, c) {
            var e = 1e3;
            if (b) {
                var f = 1;
                j = 0, c._anim_s && c._anim_s.stop(), L.KineticFuncs.zoomInFuncOpacity(e, L.ReliefControl.HOVERED_OPACITY, a).call([c, d]), c._anim_s = new Kinetic.Animation(function (a) {
                    var b = a.timeDiff / 2e3 * f, e = j + b;
                    e > 1 || 0 > e ? (f = -f, j = Math.round(j)) : j = e, c.points(i.getRadarPoints()), d.points(i.getRadarPointsVertical())
                }, a), c._anim_s.start()
            } else {
                L.KineticFuncs.zoomOutFuncOpacity(e, 0, a).call([c, d]);
                var g = c._anim_s;
                g && setTimeout(function () {
                    g.stop(), j = 0
                }, e)
            }
        }
    }, _zoomEnd: function () {
        this.draw()
    }, setOptions: function (a) {
        L.Util.setOptions(this, a), this.fire("dragend"), this._map && this.draw()
    }, draw: function () {
        Gis.requestAnimationFrame(10)(this.drawRelief)
    }}), L.ReliefControlSquare.getInstance = function (a) {
        return i ? a && i.setOptions(a) : new L.ReliefControlSquare(a), i
    }
}(), function (a) {
    "use strict";
    a.PolylineExtend = {options: {className: void 0}, _updateStyle: function () {
        a.Path.prototype._updateStyle.call(this)
    }, setClassName: function (a) {
        this.removeClass(this.options.className), a && this.addClass(a), this.options.className = a
    }, addClass: function (b) {
        var c;
        return a.Path.SVG && this._path ? (c = this._path.getAttribute("class"), c ? this._path.setAttribute("class", c.trim() + " " + b) : this._path.setAttribute("class", b)) : void 0
    }, removeClass: function (a) {
        return this._path && this._path.getAttribute("class") ? this._path && this._path.setAttribute("class", this._path.getAttribute("class").replace(a, "").trim()) : void 0
    }, getLatLng: function () {
        return this.getMiddleLatLng()
    }, _diff: function (a) {
        var b = this.getMiddleLatLng();
        return[a.lat - b.lat, a.lng - b.lng]
    }, setLayerPosition: function (a) {
        return this.increaseLatLngs(this._diff(this._map.layerPointToLatLng(a))), this.redraw()
    }, increaseLatLngs: function (a) {
        var b, c = this._latlngs, d = a[0], e = a[1];
        for (b in c)c.hasOwnProperty(b) && (c[b].lat = c[b].lat + d, c[b].lng = c[b].lng + e)
    }, getMiddleLatLng: function () {
        return this._latlngs[0]
    }, setDraggable: function (b) {
        if (a.Path.SVG) {
            var c = this.options || this._options;
            c.draggable = !!b, a.Handler.SvgDrag && (c.draggable ? (this.dragging = new a.Handler.SvgDrag(this), this.dragging.enable()) : this.dragging && (this.dragging.disable(), this.dragging = void 0))
        }
    }}
}(L), function (a) {
    "use strict";
    a.ClickableSvg = function (b) {
        var c;
        return b && b._initEvents && (c = b._initEvents), {_initEvents: function () {
            c && c.apply(this, arguments), this._initClickable(), this.setDraggable(this.options.draggable)
        }, setClickable: function (a) {
            this.options.clickable !== a && (this.options.clickable = a, this._map && a ? this._initClickable() : this._map && this._deInitClickable())
        }, _initClickable: function () {
            if (a.Path.SVG) {
                if (!this.options.clickable)return;
                a.Path.SVG && this._path.setAttribute("class", "leaflet-clickable gis-clickable"), a.DomEvent.on(this._container, "click", this._onMouseClick, this);
                var b, c, d = ["dblclick", "mousedown", "mouseover", "mouseout", "mousemove", "contextmenu"];
                for (b = 0, c = d.length; c > b; b += 1)a.DomEvent.on(this._container, d[b], this._fireMouseEvent, this)
            }
        }, _deInitClickable: function () {
            if (a.Path.SVG) {
                if (this.options.clickable)return;
                a.Path.SVG ? this._path.setAttribute("class", "") : !a.Browser.svg && a.Browser.canvas, a.DomEvent.off(this._container, "click", this._onMouseClick, this);
                var b, c, d = ["dblclick", "mousedown", "mouseover", "mouseout", "mousemove", "contextmenu"];
                for (b = 0, c = d.length; b < d.length; b += 1)a.DomEvent.off(this._container, d[b], this._fireMouseEvent, this)
            }
        }}
    }
}(L), L.PathCaptionBehavior = L.extend({}, L.CaptionBehavior, {bindLabel: function (a, b) {
    this._label || (b = b || {}, b.position = "centerright", b.offset = L.point(10, 0)), L.CaptionBehavior.bindLabel.call(this, a, b)
}, getLabelLatLng: function () {
    var a;
    return a = this._originalPoints[0], this._originalPoints.forEach(function (b) {
        a.y < b.y && (a = b)
    }), this._map.layerPointToLatLng(a)
}}), function (a) {
    "use strict";
    a.Bounds.prototype.inters = function (b) {
        var c = Math.max(b.min.x, this.min.x), d = Math.min(b.max.x, this.max.x), e = Math.max(b.min.y, this.min.y), f = Math.min(b.max.y, this.max.y);
        return new a.Bounds([c, e], [d, f])
    }, a.ClipPath = {_clipPoints: function () {
        var b, c, d, e = this._originalPoints, f = e.length;
        if (this.options.noClip)return void(this._parts = [e]);
        this._parts = [];
        var g = this._parts, h = this._map._pathViewport, i = a.LineUtil, j = this._map.getPixcelBoundsLayer(this._map.getMaxBounds());
        for (j && !window.L_DEBUG && (h = h.inters(j)), b = 0, c = 0; f - 1 > b; b++)d = i.clipSegment(e[b], e[b + 1], h, b), d && (g[c] = g[c] || [], g[c].push(d[0]), (d[1] !== e[b + 1] || b === f - 2) && (g[c].push(d[1]), c++))
    }}, a.Polyline.include(a.ClipPath)
}(L), function (a) {
    "use strict";
    a.PolylinePopup = a.PopupBehavior, a.Polyline.include(a.PathCaptionBehavior), a.Polyline.include(a.ClickableSvg(a.Polyline.prototype)), a.Polyline.include({setLatLngs: function (a) {
        return this._latlngs = this._convertLatLngs(a), this.fire("move", {latlng: this._latlngs[0]}), this.redraw()
    }, projectLatlngs: function () {
        var a, b;
        for (this._originalPoints = [], a = 0, b = this._latlngs.length; b > a; a += 1)this._originalPoints[a] = this._map.latLngToLayerPoint(this._latlngs[a]);
        this._container && (this._container._leaflet_pos && delete this._container._leaflet_pos, this._container._leaflet_pos = this._originalPoints[0])
    }}), a.MultiPolyline.include({_initEvents: function () {
        a.MultiPolyline.prototype._initEvents.call(this), this.setDraggable(this.options.draggable)
    }, projectLatlngs: function () {
        a.MultiPolyline.prototype._initEvents.call(this), this._container && (this._container._leaflet_pos && delete this._container._leaflet_pos, this._container._leaflet_pos = this._map.latLngToLayerPoint(this._latlngs[0]))
    }}), a.Polyline.include(a.PolylineExtend), a.Polyline.include(a.PolylinePopup), a.Polygon.include(a.PolylinePopup), a.MultiPolyline.include(a.PolylineExtend), a.MultiPolyline.include(a.PolylinePopup)
}(L), L.Path.CANVAS && (L.Circle.include(L.CaptionBehavior), L.Ellipse = L.Circle.extend({includes: L.PathFillExtend, getLabelLatLng: function () {
    return this._latlng
}, initialize: function (a, b, c, d, e) {
    L.Path.prototype.initialize.call(this, e), this._latlng = L.latLng(a), this._mRadius = b, this._mSecondRadius = c, this._mAngle = d
}, setDraggable: function (a) {
    this.options.draggable = !!a, L.Handler.SvgDrag && (this.options.draggable ? (this.dragging = new L.Handler.SvgDrag(this), this.dragging.enable()) : this.dragging && (this.dragging.disable(), this.dragging = void 0))
}, setLayerPosition: function (a) {
    return this.setLatLng(this._map.layerPointToLatLng(a)), this.redraw()
}, _getLngSRadius: function () {
    return this._getLatRadius(this._mSecondRadius) / Math.cos(L.LatLng.DEG_TO_RAD * this._latlng.lat)
}, _getLatRadius: function (a) {
    return(a || this._mRadius) / 40075017 * 360
}, projectLatlngs: function () {
    var a = this._getLngRadius(), b = new L.LatLng(this._latlng.lat, this._latlng.lng - a), c = this._map.latLngToLayerPoint(b);
    this._point = this._map.latLngToLayerPoint(this._latlng), this._radius = Math.max(Math.round(this._point.x - c.x), 1), this._sRadius = Math.max(Math.round(this._radius / this._mRadius * this._mSecondRadius), 1), this._container && "object" == typeof this._container._leaflet_pos && ("object" == typeof this._container._leaflet_pos && delete this._container._leaflet_pos, this._container._leaflet_pos = this._map.latLngToLayerPoint(this._latlng))
}, _drawPath: function () {
    function a(a, b, c, d, e, f) {
        a.save(), a.beginPath(), f = f || 0, a.translate(b, c), a.rotate(f), a.translate(-d, -e), a.scale(d, e), a.arc(1, 1, 1, 0, 2 * Math.PI, !1), a.restore()
    }

    var b = this._point, c = this._radius, d = this._mAngle, e = this._sRadius;
    return this._checkIfEmpty() ? "" : void a(this._ctx, b.x, b.y, c, e, Gis.Util.gradToRad(d))
}, setSecondRadius: function (a) {
    return this._mSecondRadius = a, this.redraw()
}, rotated: function (a, b) {
    return this._point.add(L.point(Math.cos(a), Math.sin(a)).multiplyBy(b))
}, setAngle: function (a) {
    return this._mAngle = a, this.redraw()
}, _containsPoint: function (a) {
    var b = this._point, c = this.options.stroke ? this.options.weight / 2 : 0, d = a.distanceTo(b);
    return d <= this._radius + c
}}), L.Ellipse.include(L.PolylineExtend), L.Ellipse.include(L.ClickableSvg(L.Circle.prototype)), L.Ellipse.include(L.PolylinePopup), L.ellipse = function (a, b, c, d, e) {
    return new L.Ellipse(a, b, c, d, e)
}), function (a) {
    "use strict";
    var b = a.Circle.prototype._updatePath;
    a.Circle.include(a.CaptionBehavior), a.Path.SVG && (a.Ellipse = a.Circle.extend({includes: a.PathFillExtend, getLabelLatLng: function () {
        return this._latlng
    }, initialize: function (b, c, d, e, f) {
        a.Path.prototype.initialize.call(this, f), this._latlng = a.latLng(b), this._mRadius = c, this._mSecondRadius = d, this._mAngle = e
    }, setDraggable: function (b) {
        this.options.draggable = !!b, a.Handler.SvgDrag && (this.options.draggable ? (this.dragging = new a.Handler.SvgDrag(this), this.dragging.enable()) : this.dragging && (this.dragging.disable(), this.dragging = void 0))
    }, setLayerPosition: function (a) {
        return this.setLatLng(this._map.layerPointToLatLng(a)), this.redraw()
    }, _getLngSRadius: function () {
        return this._getLatRadius(this._mSecondRadius) / Math.cos(a.LatLng.DEG_TO_RAD * this._latlng.lat)
    }, _getLatRadius: function (a) {
        return(a || this._mRadius) / 40075017 * 360
    }, _updatePath: function () {
        var a = this._point;
        b.call(this), this._checkIfEmpty() || this._path.setAttribute("transform", "rotate(" + this._mAngle + ", " + a.x + ", " + a.y + ")")
    }, projectLatlngs: function () {
        var b = this._getLngRadius(), c = new a.LatLng(this._latlng.lat, this._latlng.lng - b), d = this._map.latLngToLayerPoint(c);
        this._point = this._map.latLngToLayerPoint(this._latlng), this._radius = Math.max(Math.round(this._point.x - d.x), 1), this._sRadius = Math.max(Math.round(this._radius / this._mRadius * this._mSecondRadius), 1), this._container && ("object" == typeof this._container._leaflet_pos && delete this._container._leaflet_pos, this._container._leaflet_pos = this._map.latLngToLayerPoint(this._latlng))
    }, getPathString: function () {
        var b = this._point, c = this._radius, d = this._mAngle, e = this._sRadius;
        return this._checkIfEmpty() ? "" : a.Browser.svg ? "M" + b.x + "," + (b.y - e) + "A" + c + "," + e + ",0,1,1," + (b.x - .1) + "," + (b.y - e) + " z" : (b._round(), c = Math.round(c), "AL " + b.x + "," + b.y + " " + c + "," + e + " 0," + 65535 * d)
    }, setSecondRadius: function (a) {
        return this._mSecondRadius = a, this.redraw()
    }, rotated: function (b, c) {
        return this._point.add(a.point(Math.cos(b), Math.sin(b)).multiplyBy(c))
    }, _updateStyle: function () {
        var a, b, c, d;
        this.options.stroke ? (this._path.setAttribute("stroke", this.options.color), this._path.setAttribute("stroke-fillOpacity", this.options.opacity), this._path.setAttribute("stroke-width", this.options.weight), this.options.dashArray ? this._path.setAttribute("stroke-dasharray", this.options.dashArray) : this._path.removeAttribute("stroke-dasharray")) : this._path.setAttribute("stroke", "none"), this.options.fill ? (a = this.options.fillColor || this.options.color, c = this.options.fillOpacity + "", b = this._path.getAttribute("fill"), d = this._path.getAttribute("fill-opacity"), b !== a && this._path.setAttribute("fill", a), c !== d && this._path.setAttribute("fill-opacity", c)) : this._path.setAttribute("fill", "none")
    }, setAngle: function (a) {
        return this._mAngle = a, this.redraw()
    }}), a.Ellipse.include(a.PathFillExtend), a.Ellipse.include(a.ClickableSvg(a.Ellipse.prototype)), a.Ellipse.include(a.PolylinePopup), a.ellipse = function (b, c, d, e, f) {
        return new a.Ellipse(b, c, d, e, f)
    })
}(L), L.Icon.Canvas = L.Icon.extend({options: {iconSize: void 0, zIndex: void 0, popupAnchor: void 0, labelAnchor: void 0, clickableClass: ""}, _createImg: function (a) {
    var b;
    if (L.Browser.ie6)throw new Error("to old browser");
    return b = a, this.el = b, b
}, setClickable: function (a) {
    a ? this.el.setAttribute("class", "leaflet-zoom-animated leaflet-marker-icon " + (this.options.className || "") + " " + this.options.clickableClass) : this.el.setAttribute("class", "leaflet-zoom-animated leaflet-marker-icon " + (this.options.className || ""))
}, _setIconStyles: function (a, b) {
    var c, d = this.options, e = L.point(d[b + "Size"]);
    c = L.point("shadow" === b ? d.shadowAnchor || d.iconAnchor : d.iconAnchor), !c && e && (c = e.divideBy(2, !0)), a.setAttribute("class", "leaflet-zoom-animated leaflet-marker-" + b + " " + d.className), c && (a.style.marginLeft = -c.x + "px", a.style.marginTop = -c.y + "px"), e && (a.style.width = e.x + "px", a.style.height = e.y + "px")
}, setStyle: function (a) {
    this.g.setAttribute("style", a)
}, getWidth: function () {
    if (this.options.size)return this.options.size.x;
    var a = this.el.width, b = this.el.height;
    return a > 0 && b > 0 && (this.options.size = L.point(a, b)), a
}, getHeight: function () {
    if (this.options.size)return this.options.size.y;
    var a = this.el.clientHeight, b = this.el.clientWidth;
    return a > 0 && b > 0 && (this.options.size = L.point(b, a)), a
}, addClass: function (a) {
    return a = a && a.trim(), this.el && !this.hasClass(a) && this.el.setAttribute("class", (this.el.getAttribute("class") + " " + a).trim())
}, hasClass: function (a) {
    return this.el && this.el.getAttribute("class").indexOf(a) >= 0
}, removeClass: function (a) {
    return this.el && this.el.setAttribute("class", this.el.getAttribute("class").replace(a, "").trim())
}, createShadow: function () {
    return void 0
}, _getIconUrl: function () {
    return this.options.src
}}), L.Icon.Svg = L.Icon.extend({options: {iconSize: void 0, popupAnchor: void 0, labelAnchor: void 0, clickableClass: ""}, _createImg: function (a) {
    var b, c, d;
    if (L.Browser.ie6)throw new Error("to old browser");
    return d = document.createElement("div"), d.innerHTML = a, b = d.getElementsByTagName("svg")[0], c = d.getElementsByTagName("g")[0], this.el = b, this.g = c, b
}, setClickable: function (a) {
    a ? this.el.setAttribute("class", "leaflet-zoom-animated leaflet-marker-icon " + (this.options.className || "") + " " + this.options.clickableClass) : this.el.setAttribute("class", "leaflet-zoom-animated leaflet-marker-icon " + (this.options.className || ""))
}, _setIconStyles: function (a, b) {
    var c, d = this.options, e = L.point(d[b + "Size"]);
    c = L.point("shadow" === b ? d.shadowAnchor || d.iconAnchor : d.iconAnchor), !c && e && (c = e.divideBy(2, !0)), a.setAttribute("class", "leaflet-zoom-animated leaflet-marker-" + b + " " + d.className), c && (a.style.marginLeft = -c.x + "px", a.style.marginTop = -c.y + "px"), e && (a.style.width = e.x + "px", a.style.height = e.y + "px")
}, setStyle: function (a) {
    this.g.setAttribute("style", a)
}, getWidth: function () {
    if (this.options.size)return this.options.size.x;
    var a = this.el.clientWidth;
    return a > 0 && this.el.clientHeight > 0 && (this.options.size = L.point(a, this.el.clientHeight)), a
}, getHeight: function () {
    if (this.options.size)return this.options.size.y;
    var a = this.el.clientHeight;
    return a > 0 && this.el.clientWidth > 0 && (this.options.size = L.point(this.el.clientWidth, a)), a
}, addClass: function (a) {
    return a = a && a.trim(), this.el && !this.hasClass(a) && this.el.setAttribute("class", (this.el.getAttribute("class") + " " + a).trim())
}, hasClass: function (a) {
    return this.el && this.el.getAttribute("class").indexOf(a) >= 0
}, removeClass: function (a) {
    return this.el && this.el.setAttribute("class", this.el.getAttribute("class").replace(a, "").trim())
}, createShadow: function () {
    return void 0
}, _getIconUrl: function () {
    return this.options.src
}}), function (a) {
    "use strict";
    a.Point.prototype.contains = function (b) {
        b = a.point(b);
        var c = 1e-8;
        return Math.abs(b.x) - Math.abs(this.x) <= c && Math.abs(b.y) - Math.abs(this.y) <= c
    }, a.Point.prototype.ceil = function () {
        return this.clone()._ceil()
    }, a.Point.prototype.toFixed = function (a) {
        return this.multiplyBy(a)._floor().divideBy(a)
    }, a.Point.prototype._ceil = function () {
        return this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this
    }
}(L), function (a) {
    "use strict";
    var b = a.Polygon.prototype.projectLatlngs;
    a.Polygon.include(a.PolylineExtend), a.Polygon.include(a.PathFillExtend), a.Polygon.include(a.ClickableSvg(a.Path.prototype)), a.Polygon.include(a.PathCaptionBehavior), a.Polygon.include({projectLatlngs: function () {
        b.call(this), a.Path.SVG && (this._container._leaflet_pos && delete this._container._leaflet_pos, this._container._leaflet_pos = this._map.latLngToLayerPoint(this.getMiddleLatLng()))
    }})
}(L), function (a) {
    "use strict";
    var b = a.Circle.prototype.getPathString;
    a.Circle.include(a.CaptionBehavior), a.Sector = a.Circle.extend({options: {startAngle: 0, innerRadius: 0, stopAngle: 359.9999}, getLabelLatLng: function () {
        var b, c, d, e = this._radius, f = this._sRadius;
        return c = [this.rotated(this.startAngle(), e), this.rotated(this.stopAngle(), e), this.rotated(this.startAngle(), f), this.rotated(this.stopAngle(), f)], d = c[0], c.forEach(function (a) {
            d = d.y > a.y ? d : a
        }), b = this._map.layerPointToLatLng(180 > this.options.startAngle && 180 < this.options.stopAngle || this.options.startAngle > this.options.stopAngle && (180 < this.options.stopAngle || 180 > this.options.startAngle) ? a.point(this._point.x, this._point.y + e) : d), (f || b.lat < this._latlng.lat) && b || b
    }, setDraggable: function (b) {
        this.options.draggable = !!b, a.Path.SVG && a.Handler.SvgDrag && (this.options.draggable ? (this.dragging = new a.Handler.SvgDrag(this), this.dragging.enable()) : this.dragging && (this.dragging.disable(), this.dragging = void 0))
    }, _fixAngle: function (b) {
        return(b % 360 - 90) * a.LatLng.DEG_TO_RAD
    }, startAngle: function () {
        return this._fixAngle(this.options.startAngle)
    }, stopAngle: function () {
        return this._fixAngle(this.options.stopAngle)
    }, setLayerPosition: function (a) {
        return this.setLatLng(this._map.layerPointToLatLng(a)), this.redraw()
    }, rotated: function (b, c) {
        return this._point.add(a.point(Math.cos(b), Math.sin(b)).multiplyBy(c))
    }, projectLatlngs: function () {
        var b = this._getLngRadius(), c = new a.LatLng(this._latlng.lat, this._latlng.lng - b), d = this._map.latLngToLayerPoint(c);
        this._point = this._map.latLngToLayerPoint(this._latlng), this._radius = Math.max(Math.round(this._point.x - d.x), 1), this._sRadius = Math.max(Math.round(this._radius / this._mRadius * this.options.innerRadius), 1), a.Path.SVG && (this._container._leaflet_pos = this._map.latLngToLayerPoint(this._latlng))
    }, isLargeArc: function () {
        return this.options.stopAngle - this.options.startAngle >= 180 && this.options.stopAngle - this.options.startAngle < 360 || this.options.startAngle - this.options.stopAngle < 180 && this.options.startAngle - this.options.stopAngle > 0
    }, getPathString: function () {
        var c, d, e, f, g, h, i = this._point, j = this._radius, k = this._sRadius;
        return 0 === this.options.startAngle && this.options.stopAngle > 359 && !k ? b.call(this) : (c = this.rotated(this.startAngle(), j), d = this.rotated(this.stopAngle(), j), e = this.rotated(this.startAngle(), k), f = this.rotated(this.stopAngle(), k), this._checkIfEmpty() ? "" : a.Path.SVG ? (h = this.isLargeArc() ? "1" : "0", g = "M" + e.x + "," + e.y, g += "A " + k + "," + k + ",0," + h + ",1," + (f.x - .001) + "," + f.y, g += "L " + d.x + "," + d.y, g += "A " + j + "," + j + ",0," + h + ",0," + (c.x - .001) + "," + c.y + " z") : (i._round(), j = Math.round(j), "A " + i.x + "," + i.y + " " + j + "," + j + " 0,23592600"))
    }, setStartAngle: function (a) {
        return this.options.startAngle = a, this.redraw()
    }, setInnerRadius: function (a) {
        return this.options.innerRadius = a, this.redraw()
    }, setStopAngle: function (a) {
        return this.options.stopAngle = a, this.redraw()
    }, setDirection: function (a, b) {
        return void 0 === b && (b = 10), this.options.startAngle = a - b / 2, this.options.stopAngle = a + b / 2, this.redraw()
    }}), a.Sector.include(a.PathFillExtend), a.Sector.include(a.Path.CANVAS ? {_drawPath: function () {
        var a, c, d, e, f = this._point, g = this._radius, h = this._sRadius;
        return 0 === this.options.startAngle && this.options.stopAngle > 359 && !h ? b.call(this) : (a = this.rotated(this.startAngle(), g), c = this.rotated(this.stopAngle(), g), d = h > 1 ? this.rotated(this.startAngle(), h) : f, e = h > 1 ? this.rotated(this.stopAngle(), h) : f, this._ctx.beginPath(), this._ctx.moveTo(d.x, d.y), this._ctx.lineTo(a.x, a.y), this._ctx.arc(f.x, f.y, g, this.startAngle(), this.stopAngle(), !1), this._ctx.lineTo(e.x, e.y), void(h > 1 && this._ctx.arc(f.x, f.y, h, this.stopAngle(), this.startAngle(), !0)))
    }, _containsPoint: function (a) {
        var b, c = this._point, d = Math.atan((a.y - c.y) / (a.x - c.x)), e = this.options.stroke ? this.options.weight / 2 : 0, f = a.distanceTo(c), g = this.startAngle(), h = this.stopAngle();
        return 0 > g && (g = 2 * Math.PI + g), 0 > h && (h = 2 * Math.PI + h), a.x < c.x ? d += Math.PI : a.y < c.y && (d += 2 * Math.PI), b = h > g && d >= g && h >= d || g > h && d >= g && d >= h || this.isLargeArc() && g > h && g >= d && h >= d, f <= this._radius + e && f >= this._sRadius - e && b
    }} : {}), a.Sector.include(a.ClickableSvg(a.Polygon.prototype)), a.Sector.include(a.PolylinePopup), a.Sector.squareTriangle = function (a, b, c, d, e, f) {
        return Math.abs(c * f - e * d - a * f + e * b + a * d - c * b)
    }, a.Sector.isPointInTriangle = function (b, c, d, e) {
        var f = a.Sector.squareTriangle, g = 1e-6, h = f(b.x, b.y, c.x, c.y, e.x, e.y), i = f(b.x, b.y, d.x, d.y, e.x, e.y), j = f(c.x, c.y, d.x, d.y, e.x, e.y);
        return console.log(Math.abs(f(b.x, b.y, c.x, c.y, d.x, d.y) - (h + i + j))), Math.abs(f(b.x, b.y, c.x, c.y, d.x, d.y) - (h + i + j)) <= g
    }, a.sector = function (b, c, d) {
        return new a.Sector(b, c, d)
    }
}(L), L.DraggableSvg = L.Draggable.extend({_updatePosition: function () {
    this.fire("predrag"), this._svgElement.setLayerPosition(this._newPos), this.fire("drag")
}, setElement: function (a) {
    this._svgElement = a
}}), L.Handler.SvgDrag = L.Handler.extend({initialize: function (a) {
    this._svgElement = a
}, addHooks: function () {
    var a = this._svgElement._container;
    this._draggable || (this._draggable = new L.DraggableSvg(a, a).on("dragstart", this._onDragStart, this).on("drag", this._onDrag, this).on("dragend", this._onDragEnd, this), this._draggable.setElement(this._svgElement)), this._draggable.enable()
}, removeHooks: function () {
    this._draggable.disable()
}, moved: function () {
    return this._draggable && this._draggable._moved
}, _onDragStart: function () {
    this._svgElement.fire("movestart").fire("dragstart")
}, _onDrag: function () {
    var a = this._svgElement, b = L.DomUtil.getPosition(a._container), c = a._map.layerPointToLatLng(b);
    a._latlng = c, a.fire("move", {latlng: c}).fire("drag")
}, _onDragEnd: function () {
    this._svgElement.fire("moveend").fire("dragend")
}}), L.Handler.LabelDrag = L.Handler.extend({initialize: function (a) {
    this._label = a
}, addHooks: function () {
    var a = this._label._container;
    this._draggable || (this._draggable = new L.Draggable(a, a).on("dragstart", this._onDragStart, this).on("drag", this._onDrag, this).on("dragend", this._onDragEnd, this)), this._draggable.enable()
}, removeHooks: function () {
    this._draggable.disable()
}, moved: function () {
    return this._draggable && this._draggable._moved
}, _onDragStart: function () {
    this._label.fire("movestart").fire("dragstart")
}, _onDrag: function () {
    var a = this._label, b = L.DomUtil.getPosition(a._container), c = b.subtract(a._calculatedOffset), d = a._map.layerPointToLatLng(c);
    a._latlng = d, a.fire("move", {latlng: d}).fire("drag", {latlng: d})
}, _onDragEnd: function () {
    this._label.fire("moveend").fire("dragend")
}}), L.Icon.Default.mergeOptions({labelAnchor: L.point(9, -20)}), L.Icon.include(L.Mixin.Events), L.Icon.include({_createImg: function (a) {
    var b, c = this;
    return L.Browser.ie6 ? (b = document.createElement("div"), b.style.filter = 'progid:DXImageTransform.Microsoft.AlphaImageLoader(src="' + a + '")') : (b = document.createElement("img"), b.src = a, this.options.size || (b.onload = function () {
        c._width = b.clientWidth, c._height = b.clientHeight, c.fire("load")
    })), this.el = b, b
}, getWidth: function () {
    return this.options.size ? this.options.size.x : this._width
}, getHeight: function () {
    return this.options.size ? this.options.size.y : this._height
}, addClass: function (a) {
    this.el && L.DomUtil.addClass(this.el, a)
}, removeClass: function (a) {
    this.el && L.DomUtil.removeClass(this.el, a)
}}), function () {
    var a = 256;
    L.PopupGis = L.Popup.extend({options: {autoPan: !1}, _update: function () {
        this._map && (this._container.style.visibility = "hidden", this._updateContent(), this._updateLayout(), this._updatePosition(), this._container.style.visibility = "", this._adjustPan())
    }, _updateLayout: function () {
        var a = this._contentNode, b = a.style;
        b.whiteSpace = "nowrap";
        var c = $(a).width();
        c = Math.min(c, this.options.maxWidth), c = Math.max(c, this.options.minWidth), (this.options.minWidth || this.options.minWidth) && (b.width = c + 1 + "px"), b.whiteSpace = "", b.height = "";
        var d = a.offsetHeight, e = this.options.maxHeight, f = "leaflet-popup-scrolled";
        e && d > e ? (b.height = e + "px", L.DomUtil.addClass(a, f)) : L.DomUtil.removeClass(a, f), this._containerWidth = this._container.offsetWidth
    }, _updateContent: function () {
        if (this._content) {
            if ("string" == typeof this._content)this._contentNode.innerHTML = this._content; else {
                for (; this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);
                this._contentNode.appendChild(this._content)
            }
            this.fire("contentupdate")
        }
    }, setContent: function (a) {
        return this._content !== a && (this._content = a, this._update()), this
    }, _updatePosition: function () {
        if (this._map) {
            var a = this._map.latLngToLayerPoint(this._latlng), b = L.Browser.any3d, c = this.options.offset;
            b && L.DomUtil.setPosition(this._container, a), this._containerBottom = -c.y - (b ? 0 : a.y), this._containerLeft = c.x + (b ? 0 : a.x), this._container.style.bottom = this._containerBottom + "px", this._container.style.left = this._containerLeft + "px"
        }
    }, getContainerBounds: function () {
        var a, b, c = this._container.clientHeight, d = this._container.clientWidth;
        return this._containerLeft || this._updatePosition(), a = L.latLng(this._map.layerPointToLatLng(new L.Point(this._containerLeft, this._containerBottom + c))), b = L.latLng(this._map.layerPointToLatLng(new L.Point(this._containerLeft + d, this._containerBottom))), new L.LatLngBounds(a, b)
    }, setOffset: function (a) {
        if (a = L.point(a), this.options.offset) {
            if (L.point(this.options.offset).distanceTo(a) < 1)return;
            L.Point.cache(this.options.offset)
        }
        this.options.offset = a, this._update()
    }}), L.PopupGis.mergeOptions({closeButton: !1, minWidth: null, maxWidth: null}), L.Label = L.PopupGis.extend({includes: [L.Mixin.Events], selected: !1, options: {maxWidth: 600, autoPan: !1, className: "gis-caption", classClickable: "gis-clickable", selectedClass: void 0, closePopupOnClick: !1, position: "centerleft", clickable: !1, draggable: !1, color: "#111", bgColor: void 0, noHide: !1, offset: L.point(0, 0)}, setPosition: function (a) {
        this.options.position = a, this._update()
    }, onRemove: function (a) {
        this.options.position && L.Point.cache(this.options.position), this.options.position && L.Point.cache(this.options.offset), this._iconOffset && L.Point.cache(this._iconOffset), this._latlng && L.LatLng.cache(this._latlng), L.PopupGis.prototype.onRemove.call(this, a), this.off("mousemove", this.bringToFront, this)
    }, onAdd: function (a) {
        this._map = a, this._container || (this._initLayout(), this._initEvents()), this._updateContent();
        var b = a.options.fadeAnimation;
        b && L.DomUtil.setOpacity(this._container, 0), a._panes.popupPane.appendChild(this._container), this.fire("appended"), a.on("viewreset", this._updatePosition, this), L.Browser.any3d && a.on("zoomanim", this._zoomAnimation, this), this.on("mousemove", this.bringToFront, this), this._update(), b && L.DomUtil.setOpacity(this._container, 1)
    }, bringToFront: function () {
        return this._container && this._map._panes.popupPane.appendChild(this._container), this
    }, bringToBack: function () {
        var a = this._map._panes.popupPane;
        return this._container && a.insertBefore(this._container, a.firstChild), this
    }, setIconOffset: function (a) {
        this._iconOffset = a, this._updatePosition()
    }, getDimension: function () {
        var b, c, d = L.PopupGis.CACHE_DIMENSION[this.options.text];
        return d || (b = this._container && this._container.offsetWidth || 0, c = this._container && this._container.offsetHeight || 0, d = {width: b, height: c}, b && c && (Object.keys(L.PopupGis.CACHE_DIMENSION).length > a && (L.PopupGis.CACHE_DIMENSION = {}), L.PopupGis.CACHE_DIMENSION[this.options.text] = d)), d
    }, calculateLabelOffset: function () {
        if (this._oldText === this.options.text && this._oldContent === this._content && this._oldPosition && this.options.position === this._lastPosition && this._lastIcoOffset === this._iconOffset)return this._oldPosition;
        this._oldText = this.options.text, this._oldContent = this._content, this._lastPosition = this.options.position, this._lastIcoOffset = this._iconOffset;
        var a, b, c, d, e, f = this.options.position || "centerright", g = this.getDimension();
        switch (b = g.width, c = g.height, d = this._iconOffset && this._iconOffset.x || 0, e = this._iconOffset && this._iconOffset.y || 0, f) {
            case"topright":
                a = L.point(0, -c - e);
                break;
            case"topleft":
                a = L.point(-b - d, -c - e);
                break;
            case"topcenter":
                a = L.point(-b / 2 - d / 2, -c - e);
                break;
            case"bottomright":
                a = L.point(0, 0);
                break;
            case"bottomleft":
                a = L.point(-b - d, 0);
                break;
            case"bottomcenter":
                a = L.point(-b / 2 - d / 2, 0);
                break;
            case"centerleft":
                a = L.point(-b - d, -c / 2 - e / 2);
                break;
            case"centerright":
                a = L.point(0, -c / 2 - e / 2);
                break;
            case"center":
                a = L.point(-b / 2 - d / 2, -c / 2 - e / 2);
                break;
            default:
                a = L.point(0, 0)
        }
        return!isNaN(a.x) && !isNaN(a.y) && b > 0 && c > 0 && (this._oldPosition = a), a
    }, _initEvents: function () {
        if (this.options.clickable) {
            L.DomUtil.addClass(this._container, this.options.classClickable), L.DomEvent.on(this._container, "click", this._onMouseClick, this);
            var a, b = ["dblclick", "mousedown", "mouseover", "mouseout", "mousemove", "contextmenu"];
            for (a = 0; a < b.length; a += 1)L.DomEvent.on(this._container, b[a], this._fireMouseEvent, this)
        }
        L.Handler.LabelDrag && (this.dragging = new L.Handler.LabelDrag(this), this.options.draggable && this.dragging.enable())
    }, setColor: function (a) {
        return this.options.color = a, this._update(), this
    }, _updateClickable: function () {
        this._container && this.options.clickable ? this._container.classList.add(this.options.classClickable) : this._container.classList.remove(this.options.classClickable)
    }, setClickable: function (a) {
        var b = this.options.clickable;
        return this.options.clickable = a, b !== a && this._updateClickable(), this._update(), this
    }, setSelected: function (a) {
        return this.selected = a, this._container ? (a ? L.DomUtil.addClass(this._container, this.options.selectedClass) : L.DomUtil.removeClass(this._container, this.options.selectedClass), this) : this
    }, getLatLngBounds: function () {
    }, setDraggable: function (a) {
        if (this.options.draggable = a, a) {
            if (!this.dragging) {
                if (!L.Handler.LabelDrag)return this;
                this.dragging = new L.Handler.LabelDrag(this)
            }
            this.dragging.enable()
        } else this.dragging && this.dragging.disable();
        return this._update(), this
    }, setBgColor: function (a) {
        return this.options.bgColor = a, this._update(), this
    }, _onMouseClick: function (a) {
        this._map.dragging && this._map.dragging.moved() || this._fireMouseEvent(a)
    }, _fireMouseEvent: function (a) {
        if (this.hasEventListeners(a.type)) {
            var b = this._map, c = b.mouseEventToContainerPoint(a), d = b.containerPointToLayerPoint(c), e = b.layerPointToLatLng(d);
            this.fire(a.type, {latlng: e, layerPoint: d, containerPoint: c, originalEvent: a}), "contextmenu" === a.type && L.DomEvent.preventDefault(a), "mousemove" !== a.type && L.DomEvent.stopPropagation(a)
        }
    }, close: function () {
        var a = this._map;
        a && (a._label = null, a.removeLayer(this))
    }, _initLayout: function () {
        var a = this.selected ? " " + this.options.selectedClass : "";
        this._container = L.DomUtil.create("div", "leaflet-label " + this.options.className + a + " leaflet-zoom-animated")
    }, _updateContent: function () {
        this._content && "string" == typeof this._content && (this._oldHtml !== this._content && (this._oldHtml = this._content, this._container.innerHTML = this._content), this._calculatedOffset && L.Point.cache(this._calculatedOffset), this._calculatedOffset = this.options.offset.add(this.calculateLabelOffset()))
    }, openOn: function (a) {
        return a.showLabel(this), this
    }, _updateLayout: function () {
        var a, b = this._container, c = b.style;
        c.width = "", c.whiteSpace = "nowrap", a = this.getDimension().width, a = Math.min(a, this.options.maxWidth), a = Math.max(a, this.options.minWidth), c.width = a + 1 + "px", c.whiteSpace = "", c.height = "", this._container.style.color = this.options.color, this._container.style.background = this.options.bgColor
    }, _updatePosition: function () {
        if (this._map) {
            var a = this._map.latLngToLayerPoint(this._latlng);
            this._setPosition(a)
        }
    }, _setPosition: function (a) {
        this._calculatedOffset = this._calculatedOffset || this.options.offset.add(this.calculateLabelOffset()), a = a.add(this._calculatedOffset), this._containerBottom = a.y, this._containerLeft = a.x, L.DomUtil.setPosition(this._container, a)
    }, _zoomAnimation: function (a) {
        var b = this._map._latLngToNewLayerPoint(this._latlng, a.zoom, a.center);
        this._setPosition(b)
    }, setOffset: function (a) {
        if (a = L.point(a), this.options.offset) {
            if (L.point(this.options.offset).distanceTo(a) < 1)return;
            L.Point.cache(this.options.offset)
        }
        delete this.options.offset, this.options.offset = a, this._update()
    }, getLatLng: function () {
        return this._latlng
    }, openPopup: function (a) {
        return this._popup && this._map && (this._popup.setLatLng(a.latlng), this._map.openPopup(this._popup)), this
    }, closePopup: function () {
        return this._popup && this._popup._close(), this
    }, bindPopup: function (a, b) {
        var c = L.point(0, -10);
        return c = c.add(L.PopupGis.prototype.options.offset), b && b.offset && (c = c.add(b.offset)), b = L.extend({offset: c}, b), this._popup || this.on("mouseover", this.openPopup, this).on("mouseout", this.closePopup, this).on("move", this._movePopup, this), this._popup = new L.PopupGis(b, this).setContent(a), this
    }, unbindPopup: function () {
        return this._popup && (this._popup = null, this.off("mouseover", this.openPopup).off("mouseout", this.closePopup).off("move", this._movePopup)), this
    }, _movePopup: function (a) {
        this._popup.setLatLng(a.latlng)
    }}), L.PopupGis.CACHE_DIMENSION = {}
}(), L.Map.include({_labels: {}, showLabel: function (a) {
    var b = L.stamp(a);
    return this._labels[b] = a, this.addLayer(a).fire("layerOpen", {popup: a})
}, closeLabel: function (a) {
    var b = L.stamp(a);
    return this._labels[b] && (this._labels[b]._close(), this.removeLayer(a), delete this._labels[b]), this
}}), function () {
    "use strict";
    L.Map.include({initKinetic: function () {
        this._initkineticRootTop(), this.showTopKinetic(!1), this._initkineticRoot()
    }, _initkineticRoot: function () {
        if (!this._kineticRootSrc) {
            var a = this._kineticRootSrc = document.createElement("div");
            a.className = "leaflet-kinetic-container", a.id = "kinetic-objects-container", Gis.DomUtil.prepend(this._panes.overlayPane, a), this._kineticStage = new Kinetic.Stage({width: document.body.clientWidth, height: document.body.clientHeight, container: "kinetic-objects-container"}), this._kineticRoot = this._kineticStage.container(), this.options.zoomAnimation && L.Browser.any3d ? (L.DomUtil.addClass(this._kineticRoot, "leaflet-zoom-animated"), this.on({zoomanim: this._animateKineticZoom, zoomend: this._endKineticZoom})) : L.DomUtil.addClass(this._kineticRoot, "leaflet-zoom-hide"), this.on("moveend", this._updateKineticViewport), this._updateKineticViewport()
        }
    }, _initkineticRootTop: function () {
        if (!this._kineticRootTopSrc) {
            this._panes.topPane = this._panes.topPane || this._createPane("leaflet-top-pane");
            var a = this._kineticRootTopSrc = document.createElement("div");
            a.className = "leaflet-kinetic-container-top", a.id = "kinetic-objects-container-top", Gis.DomUtil.prepend(this._panes.topPane, a), this._kineticStageTop = new Kinetic.Stage({width: document.body.clientWidth, height: document.body.clientHeight, container: "kinetic-objects-container-top"}), this._kineticRootTop = this._kineticStageTop.container(), this.options.zoomAnimation && L.Browser.any3d ? L.DomUtil.addClass(this._kineticRootTop, "leaflet-zoom-animated") : L.DomUtil.addClass(this._kineticRootTop, "leaflet-zoom-hide")
        }
    }, showTopKinetic: function (a) {
        this._kineticRootTop.style.display = a ? "block" : "none"
    }, _animateKineticZoom: function (a) {
        var b = this.getZoomScale(a.zoom), c = this._getCenterOffset(a.center)._multiplyBy(-b)._add(this._kineticViewport.min);
        this._kineticRoot.style[L.DomUtil.TRANSFORM] = L.DomUtil.getTranslateString(c) + " scale(" + b + ") ", this._kineticRootTop.style[L.DomUtil.TRANSFORM] = L.DomUtil.getTranslateString(c) + " scale(" + b + ") ", this._kineticZooming = !0
    }, _endKineticZoom: function () {
        this._kineticZooming = !1
    }, _updateKineticViewport: function () {
        var a = L.Map.KINETIC_PRELOAD, b = this.getSize(), c = L.DomUtil.getPosition(this._mapPane), d = c.multiplyBy(-1)._subtract(b.multiplyBy(a)._round()), e = d.add(b.multiplyBy(1 + 2 * a)._round());
        this._kineticViewport = new L.Bounds(d, e);
        var f = e.x - d.x, g = e.y - d.y, h = this._kineticRoot, i = this._panes.overlayPane;
        L.Browser.mobileWebkit && i.removeChild(h), L.DomUtil.setPosition(h, d), L.DomUtil.setPosition(this._kineticRootTop, d), this._kineticStage.width(f), this._kineticStage.height(g), this._kineticStageTop.width(f), this._kineticStageTop.height(g), L.Browser.mobileWebkit && i.appendChild(h)
    }}), L.Map.KINETIC_PRELOAD = 0, L.KineticFuncs = {zoomOutFunc: function (a, b, c) {
        return function () {
            var d = this.radius(), e = this, f = b - d;
            this._anim && this._anim.stop(), this._anim = new Kinetic.Animation(function (c) {
                var g;
                g = d + f * (c.time / a), b > g && (e._anim.stop(), g = b), e.radius(g)
            }, c), Gis.Map.CURRENT_MAP.setDraggableEnabled(!0), this._anim.start()
        }
    }, zoomInFunc: function (a, b, c) {
        return function () {
            var d = this.radius(), e = this, f = b - d;
            this._anim && this._anim.stop(), this._anim = new Kinetic.Animation(function (c) {
                var g;
                g = d + f * (c.time / a), g > b && (e._anim.stop(), g = b), e.radius(g)
            }, c), Gis.Map.CURRENT_MAP.setDraggableEnabled(!1), this._anim.start()
        }
    }, zoomOutFuncOpacity: function (a, b, c) {
        return function () {
            var d, e = this;
            Gis.Util.isArray(e) || (e = [e]), d = e[0];
            var f = d.opacity(), g = e, h = b - f;
            d._anim_o && d._anim_o.stop(), d._anim_o = new Kinetic.Animation(function (c) {
                var d;
                d = f + h * (c.time / a), b > d && (g[0]._anim_o.stop(), d = b), g.forEach(function (a) {
                    a.opacity(d)
                })
            }, c), Gis.Map.CURRENT_MAP.setDraggableEnabled(!0), d._anim_o.start()
        }
    }, zoomInFuncOpacity: function (a, b, c) {
        return function () {
            var d, e = this;
            Gis.Util.isArray(e) || (e = [e]), d = e[0];
            var f = d.opacity(), g = e, h = b - f;
            d._anim_o && d._anim_o.stop(), d._anim_o = new Kinetic.Animation(function (c) {
                var d;
                d = f + h * (c.time / a), d > b && (g[0]._anim_o.stop(), d = b), g.forEach(function (a) {
                    a.opacity(d)
                })
            }, c), Gis.Map.CURRENT_MAP.setDraggableEnabled(!1), d._anim_o.start()
        }
    }}
}(), function () {
    "use strict";
    var a = L.point(400, 400), b = 1;
    L.Overlay = L.Class.extend({includes: [L.Mixin.Events], _preloadSize: a, options: {className: "", clickable: !0, opacity: 1}, updateDraggedPosition: function (a) {
        this._draggedLatLng = this._map.layerPointToLatLng(this._map.latLngToLayerPoint(this._draggedLatLng || this._imageData.latlng)._add(a || L.point(this._layer.x(), this._layer.y())))
    }, initialize: function (a, c) {
        function d(a) {
            i.updateDraggedPosition(), i.fire("dragend", {latLng: i._draggedLatLng}), h(a)
        }

        function e(a, b) {
            var c = i._map.latLngToLayerPoint(i._draggedLatLng || i._imageData.latlng)._add(L.point(a / 2, b / 2));
            c._subtract(L.point(i.getWidth(i._imageData) / 2, i.getHeight(i._imageData) / 2)), i._draggedLatLng = i._map.layerPointToLatLng(c)
        }

        function f(a, b) {
            var c = i.getWidth(i._imageData), d = i.getHeight(i._imageData), f = i.getScale() + a;
            f > 0 && (i.setScale(f), e(c, d), h(b), i.fire("resize", {scale: i.getScale(), rotation: i.getRotation(), latlng: i._draggedLatLng}))
        }

        function g(a, b) {
            i.setRotation(i.getRotation() + a), i.fire("rotate", {rotation: i.getRotation()}), Gis.requestAnimationFrame(10)(function () {
                i._layer.draw()
            }), b.stopPropagation(), b.preventDefault()
        }

        var h, i = this;
        this._layer = a, this._delta = L.point(0, 0), L.setOptions(this, c), h = function (a) {
            Gis.requestAnimationFrame(10)(function () {
                i.redraw()
            }), a.stopPropagation(), a.preventDefault()
        }, this._keyUp = function (a) {
            var b = a.shiftKey ? 10 : 1, c = 4 / i._imageData.dWidth, e = a.shiftKey ? 1 : .1;
            switch (c = a.shiftKey ? 10 * c : c, a.keyCode) {
                case 81:
                    g(-e, a);
                    break;
                case 69:
                    g(e, a);
                    break;
                case 65:
                    i._layer.x(i._layer.x() - b), d(a);
                    break;
                case 83:
                    i._layer.y(i._layer.y() + b), d(a);
                    break;
                case 68:
                    i._layer.x(i._layer.x() + b), d(a);
                    break;
                case 87:
                    i._layer.y(i._layer.y() - b), d(a);
                    break;
                case 90:
                    f(-c, a);
                    break;
                case 88:
                    f(c, a)
            }
        }, this.dragFunc = function (a) {
            var c = i.doDragRotate(a) || i.doDragResize(a);
            return c ? (i._notFireDragEnd = !0, c.x ? c : this.getAbsolutePosition()) : (Gis.requestAnimationFrame(10)(function () {
                i.fire("drag", {latlng: i._draggedLatLng})
            }), i._drag = b, a)
        }, this._dragStart = function () {
            i.isResizing() || i.isRotating() || i.fire("dragstart")
        }, this._dragEnd = function () {
            i.isResizing() || i.isRotating() || i._notFireDragEnd || Gis.requestAnimationFrame(10)(function () {
                i.updateDraggedPosition(), i.redraw(), i.fire("dragend", {latLng: i._draggedLatLng})
            }), i._notFireDragEnd = !1
        }, this._fireMouseEvent = function (a) {
            if (i.hasEventListeners(a.type)) {
                if (a.originalEvent = a.originalEvent || a, "mousemove" === a.type && !i._lastEntered)return a.type = "mouseover", i.fire("mouseover", a), void(i._lastEntered = !0);
                i.fire(a.type, a), "contextmenu" === a.type && L.DomEvent.preventDefault(a), "mousemove" !== a.type && L.DomEvent.stopPropagation(a)
            }
        }, this._fireMouseEventMap = function (a) {
            if ("click" === a.type) {
                var b = i._map._kineticStage.getIntersection({x: a.originalEvent.clientX + i._map.getSize().x * L.Map.KINETIC_PRELOAD, y: a.originalEvent.clientY + i._map.getSize().y * L.Map.KINETIC_PRELOAD});
                b === i._kineticImage && i.fire(a.type, a), L.DomEvent.preventDefault(a)
            }
        }
    }, inImage: function (a) {
        return this.inImagePoint(L.point(a.pageX, a.pageY))
    }, inImagePoint: function (a) {
        return this._imageBounds.contains(a.add(this._preloadSize))
    }, initKeyboardActions: function (a) {
        a ? document.body.addEventListener("keydown", this._keyUp) : document.body.removeEventListener("keydown", this._keyUp)
    }, setSelected: function (a) {
        var b = this._selected !== a, c = this;
        this._selected = a, b && this._map && this._kineticImage && (a ? (this._kineticImage.stroke(L.Overlay.STROKE_COLOR), this.setRotatorsVisible(!0), this.setResizersVisible(!0), this.setDraggable(this.options.draggable), this.initKeyboardActions(!0), this._map.showTopKinetic(!0), Gis.requestAnimationFrame(10)(function () {
            c._map._kineticStageTop.add(c._layer)
        })) : (this._kineticImage.stroke(L.Overlay.STROKE_TRANSPARENT), this.setRotatorsVisible(!1), this.setResizersVisible(!1), this.setDraggable(!1), this.initKeyboardActions(!1), this._map.showTopKinetic(!1), Gis.requestAnimationFrame(10)(function () {
            c._map._kineticStage.add(c._layer)
        })), this._layer.draw())
    }, _initEvents: function () {
        var a, b;
        if (this.options.clickable) {
            for (L.DomUtil.addClass(this._layer.canvas._canvas, "leaflet-clickable"), b = ["click", "dblclick", "mousedown", "mouseup", "mouseover", "mouseout", "mousemove", "contextmenu"], a = 0; a < b.length; a += 1)this._kineticImage.on(b[a], this._fireMouseEvent, this);
            this._map.on("click", this._fireMouseEventMap, this)
        }
    }, _deinitEvents: function () {
        var a, b = ["click", "dblclick", "mousedown", "mouseup", "mouseover", "mouseout", "mousemove", "contextmenu"];
        for (a = 0; a < b.length; a++)this._kineticImage.off(b[a], this._fireMouseEvent, this);
        this._map.off("click", this._fireMouseEventMap, this)
    }, setLayerPosition: function () {
    }, getWidth: function (a) {
        return a.dWidth * this.getScale()
    }, getHeight: function (a) {
        return a.dHeight * this.getScale()
    }, setImage: function (a) {
        a.clearDrag && (a.clearDrag = void 0, this._draggedLatLng = void 0);
        var b, c, d, e, f = this._map.latLngToLayerPoint(this._draggedLatLng || a.latlng), g = this;
        if (this._layer.show(), this._layer.position({x: 0, y: 0}), this._imageData = a, d = this.getWidth(a), e = this.getHeight(a), !d || !e)return void this._layer.hide();
        b = this._map._kineticViewport.min, this._dataForZoom = this._map.getZoom(), c = L.point(f.x - b.x, f.y - b.y), this._imageBounds = L.bounds(c, c.add(L.point(d, e)));
        var h = L.point(-d / 2, -e / 2);
        return this._group.position(this._imageBounds.min.subtract(h)), this._group.rotation(this.getRotation()), this._kineticImage ? (this._kineticImage.setImage(a.image), this._kineticImage.position(h), this._kineticImage.width(d), this._kineticImage.height(e)) : (this._kineticImage = new Kinetic.Image({x: h.x, y: h.y, image: a.image, width: d, height: e, stroke: this._selected ? L.Overlay.STROKE_COLOR : L.Overlay.STROKE_TRANSPARENT, strokeWidth: 5}), this._group.add(this._kineticImage), this._initEvents(), this._map._kineticStage.add(this._layer), Gis.requestAnimationFrame(10)(function () {
            g._layer.setZIndex(2)
        }), this._createRotaters(), this._createResizers(), this.setRotatorsVisible(!!this._selected), this.setResizersVisible(!!this._selected)), this._updateRotaters(), this._updateResizers(), this._layer.draw(), this
    }, predrag: function () {
        this._delta = this._map.latLngToLayerPoint(this._draggedLatLng || this._imageData.latlng).subtract(this._map._kineticViewport.min)
    }, onAdd: function (a) {
        this._map = a, a.initKinetic(), this._layer = this._layer || new Kinetic.Layer, this._group = new Kinetic.Group, this._layer.dragBoundFunc(this.dragFunc), this._layer.on("dragstart", this._dragStart), this._layer.on("dragend", this._dragEnd), this._layer.draggable(this.options.draggable && this._selected), this._layer.add(this._group), this.fire("add"), L.DomUtil.addClass(this._layer.canvas._canvas, "leaflet-canvas-overlay"), L.DomUtil.addClass(this._layer.canvas._canvas, this.options.className), this.on("dragstart", this.predrag, this), a.on("moveend", this.moveEnd, this), a.on("dragend", this.moveEnd, this), a.on("zoomend", this._zoomEnd, this)
    }, setOpacity: function (a) {
        this.options.opacity = parseFloat(a), this._kineticImage && (this._kineticImage.opacity(this.options.opacity), this._layer.draw())
    }, _zoomEnd: function () {
        this._imageData = null, this._layer.hide()
    }, setDraggable: function (a) {
        var b = this.options || this._options;
        b.draggable = !!a, this._layer.draggable(a)
    }, addTo: function (a) {
        return a.addLayer(this), this
    }, moveEnd: function () {
        clearTimeout(this.timer), this.timer = !1, this.redraw()
    }, _setPos: function () {
    }, getLatLng: function () {
        return L.latLng(this._imageData.latlng.lat, this._imageData.latlng.lng)
    }, onRemove: function (a) {
        this._layer.remove(), this._deinitEvents(), this.fire("remove"), this._layer.off("dragstart", this._dragStart), this._layer.off("dragend", this._dragEnd), a.off("moveend", this.moveEnd, this), a.off("dragend", this.moveEnd, this), a.off("zoomend", this._zoomEnd, this), this.off("dragstart", this.predrag, this), this.setDraggable(!1), this._map = null, a.off({viewreset: this.redraw}, this)
    }, setStyle: function (a) {
        return L.setOptions(this, a), this
    }, redraw: function () {
        return this._map && this._dataForZoom === this._map.getZoom() && this._imageData && this.setImage(this._imageData, !0), this
    }}), L.Overlay.STROKE_COLOR = "rgb(75, 84, 255)", L.Overlay.STROKE_TRANSPARENT = "transparent"
}(), function () {
    "use strict";
    var a = 3, b = 6, c = {radius: a, fill: "white", stroke: L.Overlay.STROKE_COLOR, strokeWidth: 2}, d = {_scale: 1, isResizing: function () {
        return this.resizer
    }, calculateRotated: function (a) {
        var b = this._group.rotation();
        return Gis.Util.rotate(a, b)
    }, doDragResize: function (a) {
        if (this.isResizing()) {
            var b, c = this, d = this._imageData, e = L.point(a.x, a.y)._subtract(L.point(this._layer.x(), this._layer.y())), f = this.resizer.position(), g = L.point(f.x, f.y), h = this._draggedLatLng || d.latlng, i = this.getWidth(d), j = this.getHeight(d), k = this._map.latLngToLayerPoint(h)._add(L.point(i / 2, j / 2));
            return f = Gis.Util.rotate(g, -this._group.rotation()), e = this.calculateRotated(e.add(f)).subtract(g), b = e, this.pointDeltaOld && (e = e.subtract(this.pointDeltaOld)), e = e.multiplyBy(2), this._circlesResize[0] === this.resizer && (i -= e.x, j -= e.y), this._circlesResize[1] === this.resizer && (j -= e.y), this._circlesResize[2] === this.resizer && (i += e.x, j -= e.y), this._circlesResize[3] === this.resizer && (i += e.x), this._circlesResize[4] === this.resizer && (i += e.x, j += e.y), this._circlesResize[5] === this.resizer && (j += e.y), this._circlesResize[6] === this.resizer && (j += e.y, i -= e.x), this._circlesResize[7] === this.resizer && (i -= e.x), i > 0 && j > 0 && (this.pointDeltaOld = b, c.setScale(Math.abs(i - this.getWidth(d)) > Math.abs(j - this.getHeight(d)) ? i / d.dWidth : j / d.dHeight), k._subtract(L.point(this.getWidth(d) / 2, this.getHeight(d) / 2)), c._draggedLatLng = this._map.layerPointToLatLng(k), Gis.requestAnimationFrame(10)(function () {
                c.redraw();
                var a = {};
                a.scale = c.getScale(), a.latlng = c._draggedLatLng, a.rotation = c.getRotation(), c.fire("resize", a)
            })), !0
        }
        return!1
    }, setScale: function (a) {
        this._scale = a, this._imageData && (this._imageData.scale = a)
    }, getScale: function () {
        return this._imageData ? this._imageData.scale : this._scale
    }, _createResizers: function () {
        this._circlesResize = [];
        var d, e = this, f = this._layer, g = function () {
            e.resizer = this, e.pointDeltaOld = !1
        }, h = function () {
            document.body.classList.add("gis-grab"), this.radius(b), this.setZIndex(2), f.draw()
        }, i = function () {
            document.body.classList.remove("gis-grab"), e.resizer = !1, this.setZIndex(1), this.radius(a), f.draw()
        };
        for (d = 0; 8 > d; d += 1)this._circlesResize[d] = new Kinetic.Circle(c), this._group.add(this._circlesResize[d]), this._circlesResize[d].on("mousedown", g), this._circlesResize[d].on("mousemove", h), this._circlesResize[d].on("mouseleave", i)
    }, _updateResizers: function () {
        var a = this._imageData, b = this.getWidth(a), c = this.getHeight(a), d = L.point(-b / 2, -c / 2);
        this._circlesResize[0].position(d), this._circlesResize[1].position(d.add(L.point(b / 2, 0))), this._circlesResize[2].position(d.add(L.point(b, 0))), this._circlesResize[3].position(d.add(L.point(b, c / 2))), this._circlesResize[4].position(d.add(L.point(b, c))), this._circlesResize[5].position(d.add(L.point(b / 2, c))), this._circlesResize[6].position(d.add(L.point(0, c))), this._circlesResize[7].position(d.add(L.point(0, c / 2)))
    }, setResizersVisible: function (a) {
        var b, c;
        for (b = 0, c = this._circlesResize.length; c > b; b += 1)this._circlesResize[b].visible(a)
    }};
    L.Overlay.include(d)
}(), function () {
    "use strict";
    function a(a, b) {
        return Gis.Util.radToGrad(Math.atan2(a.x * b.y - a.y * b.x, a.x * b.x + a.y * b.y))
    }

    var b = 3, c = 6, d = {radius: b, fill: "white", stroke: L.Overlay.STROKE_COLOR, strokeWidth: 2}, e = 10, f = {isRotating: function () {
        return this._rotation
    }, getRotation: function () {
        return Gis.Util.isDefine(this._imageData.rotation) ? this._imageData.rotation : this._group.rotation()
    }, setRotation: function (a) {
        this._imageData.rotation = a, this._group.rotation(a)
    }, doDragRotate: function (b) {
        if (this.isRotating()) {
            var c, d, e = L.point(b.x, b.y)._subtract(L.point(this._layer.x(), this._layer.y()));
            return c = this._rotation.add(e), d = a(this._rotationSrc, c), this.setRotation(d), this.fire("rotate", {rotation: this.getRotation()}), !0
        }
        return!1
    }, _createEventListeners: function () {
        var a = this;
        this.rotatorMouseDown = function () {
            var b = this.position();
            a._rotationSrc = L.point(b.x, b.y), a._rotation = Gis.Util.rotate(a._rotationSrc, -a.getRotation())
        }, this._rotatorMouseUp = function () {
            a._rotation = !1
        }, this._layer.on("mouseup", this._rotatorMouseUp), this._layer.on("mouseleave", this._rotatorMouseUp)
    }, _createRotaters: function () {
        this._createEventListeners(), this._circles = [];
        var a, e = this._layer, f = function () {
            this.radius(c), this.setZIndex(2), e.draw()
        }, g = function () {
            document.body.style.cursor = "", this.setZIndex(1), this.radius(b), e.draw()
        };
        for (a = 0; 4 > a; a += 1)this._circles[a] = new Kinetic.Circle(d), this._circles[a].on("mousedown", this.rotatorMouseDown), this._circles[a].on("mousemove", f), this._circles[a].on("mouseleave", g), this._group.add(this._circles[a])
    }, _updateRotaters: function () {
        var a = this._imageData, b = this.getWidth(a), c = this.getHeight(a), d = L.point(-b / 2, -c / 2);
        this._circles[0].position(d.subtract(L.point(e, e))), this._circles[1].position(d.add(L.point(b, 0)).add(L.point(e, -e))), this._circles[2].position(d.add(L.point(b, c)).add(L.point(e, e))), this._circles[3].position(d.add(L.point(0, c)).add(L.point(-e, e)))
    }, setRotatorsVisible: function (a) {
        var b, c;
        for (b = 0, c = this._circles.length; c > b; b += 1)this._circles[b].visible(a)
    }};
    L.Overlay.include(f)
}(), function (a) {
    function b(a) {
        return parseInt(1e6 * a, 10) / 1e6
    }

    var c = a.Proj.CRS.TMS.prototype.initialize;
    a.Proj.CRS.TMS.include({_minMaxBounds: null, initialize: function (d, e, f, g) {
        var h, i;
        this._minMaxBounds = {}, this._originCoordinate = {}, this._origin = g && g.origin.slice() || [f[2], f[3]], this._originPoint = a.point(this._origin), g && g.origin && (g.origin = g.origin.slice()), c.apply(this, arguments), this._originLat = this.projection.unproject(e.projName && "merc" !== e.projName || e.indexOf && !e.indexOf("+proj=merc") ? a.point(b(this._origin[0]), this._origin[1]) : a.point(this._origin)), h = this.projection.unproject(a.point(f[0], f[3])), i = this.projection.unproject(a.point(f[2], f[3])), this._topLeftLatLng = h.lng > i.lng ? i : h, this._bbox = [this.projection.unproject(a.point(f.slice(0, 2))), this.projection.unproject(a.point(f[0], f[3])), this.projection.unproject(a.point(f.slice(2, 4))), this.projection.unproject(a.point(f[2], f[1]))], this._bboxOrigin = [a.point(f.slice(0, 2)), a.point(f[0], f[3]), a.point(f.slice(2, 4)), a.point(f[2], f[1])]
    }, getOriginPoint: function (a) {
        return this._originCoordinate[a] || (this._originCoordinate[a] = this.srcPointToPoint(this._originPoint.clone(), a)._round()), this._originCoordinate[a].clone()
    }, srcPointToPoint: function (b, c) {
        var d = this.scale(c);
        return this.transformation._transform(a.point(b), d)
    }, getMinMaxBounds: function (b) {
        if (!this._minMaxBounds[b]) {
            for (var c, d, e, f, g, h = this._bboxOrigin.length, i = 0; h > i; i += 1)c = this.srcPointToPoint(this._bboxOrigin[i].clone(), b), void 0 === d && (d = c.y, e = c.y), void 0 === f && (f = c.x, g = c.x), d = Math.max(d, c.y), e = Math.min(e, c.y), f = Math.max(f, c.x), g = Math.min(g, c.x);
            this._minMaxBounds[b] = a.bounds(a.point(f, d, !0), a.point(g, e, !0))
        }
        return a.bounds(this._minMaxBounds[b].max.clone(), this._minMaxBounds[b].min.clone())
    }}), a.TMSLayer = a.TileLayer.extend({initialize: function (b, c, d) {
        a.TileLayer.prototype.initialize.call(this, b, d), this.crs = c, this._sizes = {}, this._delta = {}, this._posiotion = {}
    }, getUrlZoom: function (b) {
        return a.Util.isArray(this._url) ? this._url[b] : this._url
    }, getMinMaxBounds: function (b, c) {
        return void 0 == c && (c = b, b = this.options.crs), b.getMinMaxBounds ? b.getMinMaxBounds(c) : a.bounds(b.latLngToPoint(a.latLng(a.Projection.Mercator.MAX_LATITUDE, -180), c).clone(), b.latLngToPoint(a.latLng(-a.Projection.Mercator.MAX_LATITUDE, 180), c).clone())
    }, getOriginPoint: function (b, c) {
        return b.getOriginPoint ? b.getOriginPoint(c) : b.latLngToPoint(a.latLng(a.Projection.Mercator.MAX_LATITUDE, -180))
    }, getLayerSize: function (b) {
        if (!this._sizes[b]) {
            var c = this.options.crs || this._map.options.crs, d = this.getMinMaxBounds(c, b), e = this.getOriginPoint(c, b);
            this._sizes[b] = a.point(d.min.x - e.x, d.min.y - e.y)
        }
        return this._sizes[b].clone()
    }, _getDelta: function (a, b) {
        b = b || !this.isAdditionalLayer();
        var c = this._map.getZoom() + ":" + a + ":" + b;
        if (!this._delta[c]) {
            var d, e, f, g = this._getTileSize(a);
            d = this.getLayerSize(a), b ? g = this.options.tileSize : d._multiplyBy(this._mapScale(this._map.options.crs, this._map.getZoom()) / this._mapScale(this.options.crs, a));
            try {
                e = this._getWrapTileNum(a)
            } catch (h) {
                return
            }
            f = e.multiplyBy(g), f.x = 0, this._delta[c] = f.add(d)
        }
        return this._delta[c] && this._delta[c].clone()
    }, _getTilePos: function (a, b) {
        var c = this._map.getPixelOrigin(), d = this._getTileSize(), e = a.multiplyBy(d).subtract(c), f = this._getDelta(this.getLayerZoom());
        return this.isAdditionalLayer() && e._add(this.getGlobalLayerPosition(this._map.getZoom())), f && !b ? e.subtract(f) : e
    }, _adjustTilePoint: function (a, b) {
        b = void 0 !== b ? b : void 0 !== a.z ? a.z : this.getLayerZoom();
        var c, d, e, f = this._getWrapTileNum(b);
        this.options.tms && (d = (this.options.crs || this._map.options.crs).getOriginPoint(b), e = f.y, d && (c = this._getDelta(b, !0), c && (e = d.add(c).divideBy(this.options.tileSize).floor().y)), a.y = e - a.y - 1), this.options.continuousWorld || this.options.noWrap || (a.x = (a.x % f.x + f.x) % f.x), a.z = void 0 !== b ? b : this._getZoomForUrl()
    }, _update: function () {
        if (this._map) {
            var b = this._map, c = this.getLayerZoom(), d = this._getDelta(c), e = b.getPixelBounds(), f = this._getTileSize();
            if (f) {
                if (d && (e.min = e.min.add(d), e.max = e.max.add(d)), this.isAdditionalLayer()) {
                    var g, h = this.getGlobalLayerPosition(this._map.getZoom());
                    e.min = e.min.subtract(h), e.max = e.max.subtract(h), g = this.getMinMaxBounds(c), g.max._multiplyBy(this._mapScale(b.options.crs, b.getZoom()) / this._mapScale(this.options.crs, this.getLayerZoom())), e = e.getIntersect(g)
                }
                if (c > this.options.maxZoom || c < this.options.minZoom || !e)return;
                var i = a.bounds(e.min.divideBy(f)._floor(), e.max.divideBy(f)._floor());
                this._addTilesFromCenterOut(i), (this.options.unloadInvisibleTiles || this.options.reuseTiles) && this._removeOtherTiles(i)
            }
        }
    }, getGlobalLayerPosition: function (b) {
        var c;
        return b = void 0 !== b ? b : this._map.getZoom(), this._posiotion[b] || (c = this.options.crs && this.options.crs._topLeftLatLng || a.latLng(a.Projection.Mercator.MAX_LATITUDE, -180), this._posiotion[b] = this._map.project(c, b)), this._posiotion[b].clone()
    }, getTileUrl: function (b, c) {
        c = void 0 !== c ? c : this._getZoomForUrl();
        var d = this.options.errorTileUrl;
        try {
            d = a.Util.template(this.getUrlZoom(c), a.extend({s: this._getSubdomain(b), z: c, x: Math.ceil(b.x), y: Math.ceil(b.y)}, this.options)), c - Math.floor(c) > 0 && this._map && this._map.getZoom() % 1 > 0 && this._map.setZoom(Math.floor(this._map.getZoom()))
        } catch (e) {
            this._map && this._map.getZoom() % 1 > 0 && this._map.setZoom(Math.floor(this._map.getZoom())), Gis.Logger.log("getTileUrl", e, e.stack)
        }
        if (this.options.autoRefresh && (d = this._appendIndex(d)), this.options.getParams) {
            var f = this.getDelimeter(d);
            for (var g in this.options.getParams)this.options.getParams.hasOwnProperty(g) && (d += f + g + "=" + this.options.getParams[g])
        }
        return d
    }, _tileShouldBeLoaded: function (a) {
        if (a.x + ":" + a.y in this._tiles)return!1;
        var b, c, d, e, f, g, h, i = this.options, j = this._getTileSize();
        if (!i.continuousWorld)if (b = this._getWrapTileNum(), f = this.getLayerZoom(), h = this.options.crs || this._map.options.crs, h.getMinMaxBounds && (c = h.getMinMaxBounds(this.getLayerZoom()))) {
            if (g = this._getDelta(f), d = c.min.add(g).divideBy(j).floor(), e = c.max.add(g).divideBy(j).ceil(), i.noWrap && (a.x < d.x || a.x >= e.x) || a.y < d.y || a.y >= e.y)return!1
        } else if (i.noWrap && (a.x < 0 || a.x >= b.x) || a.y < 0 || a.y >= b.y)return!1;
        if (i.bounds) {
            var k = a.multiplyBy(j), l = k.add([j, j]), m = this._map.unproject(k), n = this._map.unproject(l);
            if (i.continuousWorld || i.noWrap || (m = m.wrap(), n = n.wrap()), !i.bounds.intersects([m, n]))return!1
        }
        return!0
    }, _getWrapTileNum: function (a) {
        a = void 0 !== a ? a : this.getLayerZoom();
        var b = this.options.crs || this._map.options.crs, c = b.getMinMaxBounds(a);
        return c.max.subtract(c.min).divideBy(this.options.tileSize).ceil()
    }})
}(L), function (a) {
    "use strict";
    a.TileUpdater = a.Class.extend({run: function () {
        var a = this;
        this.tileLayer.refreshTile && (this.timeout = setTimeout(function () {
            Gis.requestAnimationFrame(0)(function () {
                a._updateFunction()
            })
        }, this.tileLayer.options.autoRefresh))
    }, stopAllRequests: function () {
        var a;
        for (a in this._processing)this._processing.hasOwnProperty(a) && this._processing[a] && (this._processing[a].abort(), this._processing[a] = void 0)
    }, stop: function () {
        this.timeout && (clearTimeout(this.timeout), this.stopAllRequests())
    }, initialize: function (a) {
        this.tileLayer = a, this._processing = {}, this.run()
    }, checkLayerUpdate: function (a, b) {
        var c, d = this;
        !d._processing[a] && this.tileLayer._isTileLoaded(b) && (b.lastUpdate || (b.lastUpdate = (new Date).toUTCString()), c = $.ajax({url: b.realSrc, headers: {"If-Modified-Since": b.lastUpdate}, statusCode: {200: function () {
            d.tileLayer.refreshTile(a), b.lastUpdate = (new Date).toUTCString()
        }}, beforeSend: function () {
            d._processing[a] = c
        }, complete: function () {
            d._processing[a] = void 0
        }}))
    }, _updateFunction: function () {
        var a, b, c = this.tileLayer._tiles;
        for (a in c)c.hasOwnProperty(a) && (b = c[a], this.checkLayerUpdate(a, b));
        this.timeout && this.run()
    }})
}(L), function () {
    "use strict";
    function a() {
        var a = Gis.config(L.TileWithLoader.CONFIG_KEY, L.TileWithLoader.CORNER_LOADER);
        return a === L.TileWithLoader.FULL_LOADER || a === L.TileWithLoader.TILE_LOADER
    }

    var b = function (b) {
        a() ? (this.tile = L.DomUtil.create("img", ""), this.div = L.DomUtil.create("div", "leaflet-tile image-loader"), this._mainBlock = this.div, this.div.style.width = this.div.style.height = b + "px", this.div.appendChild(this.tile)) : (this.tile = L.DomUtil.create("img", "leaflet-tile"), this._mainBlock = this.tile), this.tile.container = this, Object.defineProperty(this, "src", {get: function () {
            return this.tile.src
        }, set: function (a) {
            this.tile.src = a
        }}), Object.defineProperty(this, "parentNode", {get: function () {
            return this._mainBlock.parentNode
        }, set: function (a) {
            this.tile.parentNode = a
        }})
    };
    b.prototype.setStyle = function (a, b) {
        $(this._mainBlock).css(a, b)
    }, b.prototype.removeClass = function (a) {
        L.DomUtil.removeClass(this._mainBlock, a)
    }, b.prototype.addClass = function (a) {
        L.DomUtil.addClass(this._mainBlock, a)
    }, b.prototype.removeFrom = function () {
        this._mainBlock.parentNode && this._mainBlock.parentNode.removeChild(this._mainBlock)
    }, b.prototype.appendTo = function (a) {
        var b = this._mainBlock;
        a.appendChild(b), setTimeout(function () {
            Gis.requestAnimationFrame(10)(function () {
                b.classList.add("showed")
            })
        }, 50)
    }, b.prototype.showImg = function () {
        this.addClass("leaflet-tile-loaded"), this.removeClass("image-loader")
    }, b.prototype.load = function (a) {
        this.tile.src = a
    }, b.prototype.setData = function (a, b) {
        this.tile[a] = b, this.div && (this.div[a] = b)
    }, b.prototype.setPosition = function (a, b) {
        L.DomUtil.setPosition(this._mainBlock, a, b)
    }, b.prototype.addEventListener = function (a, b) {
        L.DomEvent.addListener(this.tile, a, b), this.div && L.DomEvent.addListener(this.div, a, b)
    }, b.prototype.removeEventListener = function (a, b) {
        L.DomEvent.removeListener(this.tile, a, b), this.div && L.DomEvent.removeListener(this.div, a, b)
    }, b.prototype.setOpacity = function (a) {
        L.DomUtil.setOpacity(this._mainBlock, a)
    }, b.prototype.notChildOf = function (a) {
        return this._mainBlock.parentNode !== a
    }, L.TileWithLoader = b, L.tileWithLoader = function (a) {
        return new b(a)
    }, L.TileWithLoader.NO_LOADER = 0, L.TileWithLoader.FULL_LOADER = 1, L.TileWithLoader.TILE_LOADER = 2, L.TileWithLoader.CORNER_LOADER = 3, L.TileWithLoader.CONFIG_KEY = "show-tile-loaders"
}(), function (a) {
    "use strict";
    a.Maps.Leaflet = a.Maps.Leaflet || {}, a.Maps.Leaflet.OptionsConverter = Gis.BaseClass.extend({ellipse: function (a) {
        var b = {latlng: "latlng", alpha: "alpha", betta: "betta", gamma: "gamma", stroke: "stroke", color: "color", weight: "weight", opacity: "opacity", fill: "fill", fillColor: "fillColor", fillOpacity: "fillOpacity", dashArray: "dashArray", caption: "caption", tooltip: "tooltip", selectable: "clickable", draggable: "draggable"};
        return this._checkOptions(b, a)
    }, sector: function (a) {
        var b = {latlng: "latlng", startAngle: "startAngle", finishAngle: "stopAngle", radius: "radius", innerRadius: "innerRadius", stroke: "stroke", color: "color", weight: "weight", opacity: "opacity", caption: "caption", tooltip: "tooltip", fill: "fill", fillColor: "fillColor", fillOpacity: "fillOpacity", dashArray: "dashArray", selectable: "clickable", draggable: "draggable"};
        return this._checkOptions(b, a)
    }, path: function (a) {
        var b = {latlng: "latlng", stroke: "stroke", color: "color", noClip: "noClip", weight: "weight", smoothFactor: "smoothFactor", opacity: "opacity", caption: "caption", tooltip: "tooltip", dashArray: "dashArray", selectable: "clickable", className: "className", draggable: "draggable"};
        return this._checkOptions(b, a)
    }, marker: function (a) {
        var b = {latlng: "latlng", className: "className", icon: "icon", popup: "popup", position: "position", caption: "caption", opacity: "opacity", dashArray: "dashArray", angle: "angle", selectable: "selectable", selected: "selected", clickable: "clickable", captionPosition: "labelPosition", draggable: "draggable"};
        return this._checkOptions(b, a)
    }, _checkOptions: function (a, b) {
        var c, d = {};
        for (c in b)b.hasOwnProperty(c) && a.hasOwnProperty(c) && (d[a[c]] = b[c]);
        return d
    }, ellipseSetters: function () {
        return{latlng: "setLatLng", alpha: "setRadius", betta: "setSecondRadius", draggable: "setDraggable", hatch: "setFillHatch", clickable: "setClickable", gamma: "setAngle"}
    }, polygonSetters: function () {
        return{latlng: "setLatLngs", draggable: "setDraggable", clickable: "setClickable", hatch: "setFillHatch"}
    }, polylineSetters: function () {
        return{latlng: "setLatLngs", draggable: "setDraggable", clickable: "setClickable", className: "setClassName"}
    }, overlaySetters: function () {
        return{imageData: "setImage", draggable: "setDraggable", selected: "setSelected", opacity: "setOpacity"}
    }, sectorSetters: function () {
        return a.Util.extend(this.ellipseSetters(), {latlng: "setLatLng", radius: "setRadius", startAngle: "setStartAngle", stopAngle: "setStopAngle", clickable: "setClickable", hatch: "setFillHatch", innerRadius: "setInnerRadius"})
    }, markerSetters: function () {
        return{icon: "setIcon", opacity: "setOpacity", position: "setPosition", angle: "setAngle", latlng: "setLatLng", clickable: "setClickable", selected: "setSelected", draggable: "setDraggable"}
    }, textSetters: function () {
        return{text: "setContent", color: "setColor", bgColor: "setBgColor", latlng: "setLatLng", position: "setPosition", clickable: "setClickable", selected: "setSelected"}
    }, textLabel: function (a) {
        var b = {latlng: "latlng", text: "text", backColor: "bgColor", foreColor: "color", position: "position", selected: "selected", clickable: "clickable", draggable: "draggable"};
        return this._checkOptions(b, a)
    }, setOptions: function (a, b, c) {
        var d;
        for (d in a)a.hasOwnProperty(d) && b.hasOwnProperty(d) && c[a[d]](b[d])
    }}), a.Maps.Leaflet.optionsConverter = function () {
        return new a.Maps.Leaflet.OptionsConverter
    }
}(Gis), function (a) {
    "use strict";
    Gis.ConnectionBase = Gis.BaseClass.extend({_messages: [], _listenConnection: void 0, _sendConnection: void 0, options: {gis: void 0, domain: void 0, port: void 0, portSecond: void 0, reconnectDelay: void 0}, layerChanged: function (a) {
        if (a.rows && a.rows.length && a.target && a.target.isControllableByServer() > Gis.FULL_LOCAL && !a.notFireToServer) {
            var b;
            b = a.isAdd ? new Gis.Commands.add({gis: this.options.gis, connection: this, object: a.target, fromServer: !1}) : new Gis.Commands.changed({gis: this.options.gis, connection: this, object: a.target, fromServer: !1, fieldNames: a.rows}), b.execute()
        }
    }, layerRemoved: function (a) {
        if (a.target && a.target.isEditableByUser() && a.target.isControllableByServer() > Gis.FULL_LOCAL && !a.notFireToServer && Gis.Util.checkGUID(a.target.getId())) {
            var b = new Gis.Commands.remove({gis: this.options.gis, connection: this, fromServer: !1, ids: [a.target.getId()]});
            b.execute()
        }
    }, _onCustomAction: function (a) {
        if (a.action && a.target && a.target.isControllableByServer() > Gis.FULL_LOCAL) {
            var b = new Gis.Commands.customActionEvent({gis: this.options.gis, connection: this, id: a.target.getId(), action: a.action, fromServer: !1});
            b.execute()
        }
    }, _onOverlayChanged: function (a) {
        if (a.target && a.target.isControllableByServer() > Gis.FULL_LOCAL) {
            var b = a.delta, c = new Gis.Commands.sendOverlayDrag({gis: this.options.gis, connection: this, id: a.target.getId(), geoCoords: a.geoCoords, angle: a.angle, scale: a.scale, shift_lat: b && b.lat || 0, shift_lon: b && b.lng || 0});
            c.execute()
        }
    }, onMessage: function () {
        a.extendError()
    }, sendMessage: function () {
        a.extendError()
    }, connect: function () {
        a.extendError()
    }, getDomain: function () {
        return this.options.domain
    }, getPort: function () {
        a.extendError()
    }, setStatus: function (a) {
        a !== this._status && (a === Gis.ConnectionBase.STATUS_CONNECTED && this.sendConnect(), this._status = a, this.fire("statuschanged", {target: this}))
    }, sendConnect: function () {
        var a = new Gis.Commands.connect({gis: this.options.gis, connection: this, clientType: "client", projection: this.options.gis.getProjection(), name: this.options.gis.getSetting("creator")});
        a.execute()
    }, getStatus: function () {
        return this._status
    }, isConnected: function () {
        return this._status === Gis.ConnectionBase.STATUS_CONNECTED
    }, isConnecting: function () {
        return this._status === Gis.ConnectionBase.STATUS_CONNECTING
    }, disconnect: function () {
        a.extendError()
    }, onError: function (a) {
        Gis.Logger.log("Error connection ", a.message)
    }}), a.ConnectionBase.GUID = a.Util.generateGUID(), a.ConnectionBase.STATUS_CONNECTED = 1, a.ConnectionBase.STATUS_DISCONNECTED = 0, a.ConnectionBase.STATUS_CONNECTING = 2
}(Gis), function (a) {
    "use strict";
    var b = 202, c = 500;
    Gis.ConnectionComet = Gis.ConnectionBase.extend({required: ["gis", "domain", "portSecond"], _messages: [], getPort: function () {
        return this.options.portSecond
    }, initialize: function (d) {
        function e(b) {
            var c;
            try {
                b && "string" === (typeof b).toLowerCase() && (c = b.replace(/\n|\r\n/g, ""), JSON.parse(c) && f.onMessage(c))
            } catch (d) {
                a.Logger.log("   JSON", b, d.stack)
            }
        }

        a.BaseClass.prototype.initialize.call(this, d);
        var f = this;
        this._doSendConnect = this.sendConnect, this.sendConnect = function () {
        }, this._onError = this._onError || function (a) {
            "timeout" !== a.statusText && "abort" !== a.statusText && (f.onError(a), f.startReconnectDelay())
        }, this.isAnswerOnConnect = function () {
            return f._sendedMessage && JSON.parse(f._sendedMessage).command === Gis.Commands.connect.prototype.options.type
        }, this._onCompliteMessage = function (d) {
            var g, h = parseInt(d.status, 10);
            f._sendConnection = void 0, "accepted" === d.statusText.toLowerCase() && h === b ? (g = f._sendedMessage && JSON.parse(f._sendedMessage), f.fire("commandok", {command: g}), f._listenConnection || (f._disconnect || f.setStatus(a.ConnectionBase.STATUS_CONNECTED), f.startListen()), e(d.responseText), f._sendedMessage = void 0, f._messages.length && f.sendAjaxMessage()) : (h !== c && f._messages.unshift(f._sendedMessage), f.startReconnectDelay())
        }, this._onComplite = function (b) {
            var d = parseInt(b.status, 10);
            200 === d || "timeout" === b.statusText || "abort" === b.statusText ? (f._disconnect || f.setStatus(a.ConnectionBase.STATUS_CONNECTED), e(b.responseText), f.startListen()) : (d !== c && f._messages.unshift(f._sendedMessage), f.startReconnectDelay())
        }
    }, _generateUrl: function (b) {
        return"http://" + this.options.domain + ":" + this.options.portSecond + (b ? "/?id=" + a.ConnectionBase.GUID : "")
    }, startListen: function () {
        this._disconnect || (this.stopInterval(), this._listenConnection && this._listenConnection.abort(), this._listenConnection = $.ajax({url: this._generateUrl(!1), cache: !1, type: "get", dataType: "json", crossDomain: !0, timeout: 2e4, data: {id: a.ConnectionBase.GUID}, complete: this._onComplite}))
    }, disconnect: function () {
        this._disconnect = !0, this.setStatus(a.ConnectionBase.STATUS_DISCONNECTED), this._listenConnection && this._listenConnection.abort()
    }, sendAjaxMessage: function (a, b) {
        if (!this._disconnect) {
            if (a && (b ? this._messages.unshift(a) : this._messages.push(a)), this._sendConnection && 4 !== this._sendConnection.readyState)return;
            for (this._sendedMessage = this._messages.shift(); !this._sendedMessage && this._messages.length;)this._sendedMessage = this._messages.shift();
            this._sendedMessage && (Gis.Logger.log("Message to " + this._generateUrl(), this._sendedMessage), this._sendConnection = $.ajax({url: this._generateUrl(!0), type: "post", dataType: "text", contentType: "application/json", crossDomain: !0, processData: !1, data: this._sendedMessage, complete: this._onCompliteMessage}))
        }
    }, stopInterval: function () {
        this._reconnectInterval && (clearTimeout(this._reconnectInterval), this._reconnectInterval = void 0, this.fire("reconnectcleared"))
    }, startReconnectDelay: function () {
        this._listenConnection = void 0, this.setStatus(a.ConnectionBase.STATUS_CONNECTING);
        var b = this;
        this.stopInterval(), this._disconnect || (this._reconnectInterval = setTimeout(function () {
            b.isAnswerOnConnect() ? b.sendAjaxMessage() : b._doSendConnect(), a.Logger.log("Reconnect start"), b.fire("reconnectfired")
        }, this.options.reconnectDelay || a.Config.connection.reconnectDelay), a.Logger.log("Reconnect timeout start"), this.fire("reconnectdelaystarted"))
    }, connect: function () {
        this.setStatus(a.ConnectionBase.STATUS_CONNECTING), this._disconnect = !1;
        var b = this;
        setTimeout(function () {
            b._doSendConnect()
        }, 100)
    }, sendMessage: function (a, b) {
        this.sendAjaxMessage(a, b)
    }, onMessage: function (b) {
        var c, d;
        try {
            Gis.Logger.log("message from " + this._generateUrl(!1), b), c = JSON.parse(b)
        } catch (e) {
            return void Gis.Logger.log("incorrect json", b, e)
        }
        d = new Gis.Commands[c.command](a.Util.extend({gis: this.options.gis, connection: this, fromServer: !0}, c));
        try {
            d.execute()
        } catch (f) {
            a.Logger.log("Error execute cmd.", b, f.stack)
        }
    }, onOpen: function () {
        Gis.Logger.log("Connected to " + this._generateUrl())
    }})
}(Gis), function (a) {
    "use strict";
    Gis.WS_DISABLE = !1, Gis.ConnectionWs = Gis.ConnectionBase.extend({_needConnect: !0, required: ["gis", "domain", "port"], getPort: function () {
        return this.options.port
    }, isConnected: function () {
        return this._connection && this._connection.readyState === WebSocket.OPEN
    }, isConnecting: function () {
        return this._connection && this._connection.readyState === WebSocket.CONNECTING
    }, disconnect: function () {
        this._needConnect = !1, this.stopInterval(), this.isConnected() && this._connection.close(), this.stopInterval(), this.setStatus(a.ConnectionBase.STATUS_DISCONNECTED)
    }, connect: function () {
        if (this._needConnect = !0, this.setStatus(a.ConnectionBase.STATUS_CONNECTING), this.stopInterval(), !this.isConnected() && !this.isConnecting()) {
            var b = this;
            if (!WebSocket)throw new Error("Your browser not support webSocket");
            this._connection = new WebSocket("ws://" + this.options.domain + ":" + this.options.port), this._connection.onopen = function (c) {
                b._needConnect ? (b.setStatus(a.ConnectionBase.STATUS_CONNECTED), b.onOpen(c)) : this.close()
            }, this._connection.onmessage = function (a) {
                Gis.Logger.log("Message from " + (a.currentTarget.URL || a.currentTarget.url), a.data), b.onMessage(a)
            }, this._connection.onclose = function (c) {
                b.setStatus(a.ConnectionBase.STATUS_DISCONNECTED), b.onClose(c)
            }, this._connection.onerror = function (c) {
                b.setStatus(a.ConnectionBase.STATUS_DISCONNECTED), b.onError(c)
            }
        }
    }, sendMessage: function (a) {
        this.isConnected() ? (Gis.Logger.log("Message to " + (this._connection.URL || this._connection.url), a), this._connection.send(a), this.fire("commandok", {command: a.command})) : Gis.Logger.log("Not connected to " + (this._connection.URL || this._connection.url) + ". Message not sended.")
    }, onOpen: function (a) {
        Gis.Logger.log("Connected to " + (a.target.URL || a.target.url))
    }, stopInterval: function () {
        this._reconnectInterval && (clearTimeout(this._reconnectInterval), this._reconnectInterval = void 0, this.fire("reconnectcleared"))
    }, startReconnectDelay: function () {
        this.setStatus(a.ConnectionBase.STATUS_CONNECTING);
        var b = this;
        this.stopInterval(), this._reconnectInterval = setTimeout(function () {
            b.connect(), a.Logger.log("Reconnect start"), b.fire("reconnectfired")
        }, this.options.reconnectDelay || a.Config.connection.reconnectDelay), a.Logger.log("Reconnect timeout start"), this.fire("reconnectdelaystarted")
    }, onClose: function (a) {
        var b, c = !1;
        a.wasClean ? b = "  " : (b = " ", c = !0), Gis.Logger.log(b, ": " + a.code + " : " + a.reason), c && this._needConnect && this.startReconnectDelay()
    }, onMessage: function (b) {
        var c, d;
        try {
            c = JSON.parse(b.data)
        } catch (e) {
            return void Gis.Logger.log("incorrect json", b.data, e)
        }
        d = new Gis.Commands[c.command](a.Util.extend({gis: this.options.gis, connection: this, fromServer: !0}, c)), Gis.requestAnimationFrame(50)(function () {
            try {
                d.execute()
            } catch (c) {
                a.Logger.log("Error execute cmd.", b.data, c.stack)
            }
        })
    }})
}(Gis), function () {
    "use strict";
    Gis.connection = function (a) {
        return window.WebSocket && !Gis.WS_DISABLE ? new Gis.ConnectionWs(a) : new Gis.ConnectionComet(a)
    }
}(), function (a) {
    "use strict";
    function b(a) {
        var b = "";
        for (var c in a)a.hasOwnProperty(c) && (b += "&" + c + "=" + a[c]);
        return b
    }

    var c = {add: "q=-ma" + encodeURIComponent(" ") + "Path={{path}}" + encodeURIComponent(" ") + 'Title="{{title}}"', remove: "q=-mr" + encodeURIComponent(" ") + "{{id}}", list: "q=-ml"}, d = [], e = "my_owned_maps", f = {0: !1, 1: " ", 2: " ", 100: "  ", 101: " ", 102: "  ", 103: " EPSG-", 104: "  ,    MapType", 105: "  ", 106: "Path  ", 107: "Title  ", 108: "ID  ", 109: "TileSize   "};
    Gis.TmsWorker = {options: {tmsConsolePort: 8109, tmsConsoleHost: "localhost"}, getCmd: function (a, b) {
        var d, e = c[a];
        if (e) {
            if (b)for (d in b)b.hasOwnProperty(d) && (e = e.replace("{{" + d + "}}", b[d]));
            return e
        }
    }, isLayerTileMapService: function (a) {
        return"tilemapservice" === a.getType()
    }, isLocalTms: function (a) {
        return a && a.isLocalServer() && this.isLayerTileMapService(a)
    }, getLocalTMS: function () {
        var a, b, c = this._settings, d = this, e = c.getMaps(), f = [];
        for (b in e)e.hasOwnProperty(b) && (a = e[b], d.isLocalTms(a) && f.push(a));
        return f.length ? f : null
    }, getFirstTMS: function () {
        var a, b, c = this._settings, d = this, e = c.getMaps();
        for (b in e)if (e.hasOwnProperty(b) && (a = e[b], d.isLayerTileMapService(a)))return a;
        return null
    }, getSelectedTms: function () {
        var a, b = this.getSelectedMapKey(), c = Gis.TileMapService.decodeKey(b);
        return c && c[0] && (a = this._settings.getMaps()[c[0]], a._isTms) ? a : void 0
    }, rememberMyMap: function (a) {
        var b = Gis.Preferences.getPreferenceData(e) || [];
        b.indexOf(a) < 0 && (b.push(a), Gis.Preferences.setPreferenceData(e, b))
    }, forgetMyMap: function (a) {
        var b = Gis.Preferences.getPreferenceData(e) || [], c = b.indexOf(a);
        0 > c && (b.splice(c, 1), Gis.Preferences.setPreferenceData(e, b))
    }, isMeOwnerOfTms: function (a) {
        var b = Gis.Preferences.getPreferenceData(e) || [];
        return b.indexOf(a) >= 0
    }, pushTileToServer: function (a, b) {
        var c = this;
        return a && b && b.path && b.title && this.isLocalTms(a) ? void $.ajax({processData: !1, url: "http://" + this.options.tmsConsoleHost + ":" + this.options.tmsConsolePort, data: this.getCmd("add", Gis.Util.extend({}, b, {title: encodeURIComponent(b.title)})), success: function (e, g, h) {
            var i;
            return 200 !== h.status || (i = e.length < 4 && f[e]) ? (c.fire("tilesenderror", {tms: a, data: b}), Gis.Logger.log(i || "    ", b), void Gis.notify(i || "    ", "error")) : (c.getMapListFromTMS(a), d.push(b.title), void Gis.Logger.log("      ", b))
        }, error: function () {
            c.fire("tilesenderror", {tms: a, data: b}), Gis.Logger.log("     ", b), Gis.notify("   ", "error")
        }}) : (c.fire("notcorrecttile", {tms: a, data: b}), Gis.Logger.log("    ", b), void Gis.notify("    ", "error"))
    }, getMapListFromTMS: function (a, b) {
        var c = this;
        return a && this.isLocalTms(a) ? void $.ajax({processData: !1, url: "http://" + this.options.tmsConsoleHost + ":" + this.options.tmsConsolePort, data: this.getCmd("list"), success: function (d, e, g) {
            var h;
            return 200 !== g.status || (h = d.length < 3 && f[d]) ? (c.fire("tilelistloaderror", {tms: a, data: b}), Gis.Logger.log(h || "    ", b), void Gis.notify(h || "    ", "error")) : (d = d.trim().split("\n"), void(d.length > 0 && d.forEach(function (b) {
                "" === b || c.getTileLayerByKey(Gis.TileMapService.encodeKey(a.getURL(), b)) || a.loadTileData(b)
            })))
        }, error: function () {
            c.fire("tilelistloaderror", {tms: a, data: b}), Gis.Logger.log("    ", b), Gis.notify("     ", "error")
        }}) : (c.fire("notcorrecttile", {tms: a, data: b}), Gis.Logger.log("    ", b), void Gis.notify("    ", "error"))
    }, getRestUrl: function () {
        var a = Gis.Util.lastTrim(this.getFirstTMS().getURL(), "/");
        return Gis.config("REST.port") && (a.search(/:[\d]+/g) > -1 ? a = a.replace(/:[\d]+/g, ":" + Gis.config("REST.port")) : a += ":" + Gis.config("REST.port")), a
    }, getHeights: function (a, b, c, d, e) {
        var f = this.getRestUrl();
        $.ajax({url: f + "/relief/linear?lat=" + a.lat + "&lon=" + a.lng + "&lat2=" + b.lat + "&lon2=" + b.lng + "&coords=true&count=" + c, type: "GET", dataType: "json", success: function (a) {
            d && d(a)
        }, error: function () {
            Gis.notify("   ", "error"), e && e()
        }})
    }, getHeightsAreal: function (a, b, c, d) {
        var e = this.getRestUrl();
        $.ajax({url: e + "/relief/areal?n=" + a.getNorthEast().lat + "&e=" + a.getNorthEast().lng + "&s=" + a.getSouthWest().lat + "&w=" + a.getSouthWest().lng + "&coords=true&count=" + b, type: "GET", dataType: "json", success: function (a) {
            c && c(a)
        }, error: function () {
            Gis.notify("   ", "error"), d && d()
        }})
    }, getVisibility: function (a, c, d, e, f, g, h, i, j, k) {
        var l = this.getRestUrl();
        f = f || 0, g = g || 0, j = j || Gis.config("gis.region-of-sight.count") || 100, h = h || "relative", i = i || "relative";
        var m = k ? "radiovisibility" : "region-of-sight";
        return $.ajax({url: l + "/relief/" + m + "?lat=" + a.lat + "&lon=" + a.lng + "&radius=" + c + "&alt=" + f + "&alt-type=" + h + "&areal-alt=" + g + "&areal-alt-type=" + i + "&count=" + j + b(k), type: "GET", dataType: "json", success: function (a) {
            d && d(a)
        }, error: function (a, b) {
            "abort" !== b && (Gis.notify("   ", "error"), e && e())
        }})
    }, getUrlTms: function () {
        return"http://" + this.options.tmsConsoleHost + ":" + this.options.tmsConsolePort
    }, mapLoaded: function (a) {
        var b, c, e, f = this;
        "load" === a.type ? d.length && (d.forEach(function (b) {
            Gis.notify("   " + b + "  ,      .   .", "warn"), f.fire("tilesenderror", {tms: a.target, data: {path: b, title: b}})
        }), d = []) : "partialloaded" === a.type && ("local" === a.map.getType() && this._settings.setMap(a.map.getKey(), a.map), b = d.indexOf(a.map.getTitle()), b > -1 && (c = Gis.TileMapService.decodeKey(a.map.getKey()), c && c.length && c.length > 1 && (this.rememberMyMap(c[1]), d.splice(b, 1), this.fire("tilesendok", {tms: a.target, data: {path: c[1], title: a.map.getTitle()}}), Gis.notify(" " + a.map.getTitle() + "  .", "success"))), this._mapShowed && a.map.getKey() === this._getInitSelectedMapKey() && !this._recovered && (this._recovered = !0, a.target.off("load partialloaded", this.mapLoaded, this), this._recoverMap(), this.setZoom(this._getInitZoom()), this.setCenter(this._getInitLatLng())), this._mapShowed && this.options.layer && (e = this.options.layer.getAdditionalLayerInfo(a.map), e && e.checked && this.addMapLayer(a.map, e)))
    }, removeMap: function (a, b) {
        var c = this;
        a && b && this.isLocalTms(a) && $.ajax({processData: !1, url: this.getUrlTms(), data: this.getCmd("remove", {id: encodeURIComponent(b)}), success: function (d, e, g) {
            var h;
            return 200 !== g.status || (h = f[d]) ? (c.fire("tilesenderror", {tms: a, data: b}), Gis.Logger.log(h || "      ", b), void Gis.notify(h || "      ", "warn")) : (c.fire("tileremoveok", {tms: a, data: b}), a.removeMap(b), c.getSelectedMapKey() === Gis.TileMapService.encodeKey(a.getURL(), b) && c.setMapType(c._settings && c._settings.getMap(0)), Gis.Logger.log(" ", b), void Gis.notify(" ", "success"))
        }, error: function () {
            c.fire("tileremoveerror", {tms: a, data: b}), Gis.Logger.log("   ", b), Gis.notify("   ", "error")
        }})
    }}, a.Map.include(a.TmsWorker)
}(Gis), Gis.Commands = Gis.Commands || {}, Gis.Commands.Command = Gis.BaseClass.extend({required: ["gis", "connection"], options: {type: null, fromServer: !1, gis: void 0, connection: void 0}, initialize: function (a) {
    Gis.BaseClass.prototype.initialize.call(this, a), this.options.connection = this.options.connection || this.options.gis.getConnection()
}, execute: function () {
    Gis.extendError()
}}), Gis.Commands.changed = Gis.Commands.Command.extend({options: {type: "changed", object: void 0, fieldNames: void 0}, execute: function () {
    this.options.fromServer ? new Gis.Commands.add({gis: this.options.gis, connection: this.options.connection, object: this.options.object}).execute() : this.options.object.isControllableByServer() > Gis.FULL_LOCAL && this.options.connection.sendMessage(JSON.stringify({command: "changed", object: this.options.object.objectOfficialData(), fieldNames: this.options.fieldNames}))
}}), Gis.Commands.connect = Gis.Commands.Command.extend({_clientAvailable: "client server dataSource", options: {fromServer: !1, type: "connect", clientType: void 0, name: void 0, projection: void 0}, _checkDataCorrect: function () {
    return this._clientAvailable.indexOf(this.options.clientType) >= 0
}, execute: function () {
    this._checkDataCorrect() && (this.options.fromServer ? this.options.gis.fire("connected", {name: this.options.name, projection: this.options.projection}) : this.options.connection.sendMessage(JSON.stringify({command: "connect", clientType: this.options.clientType, name: this.options.name, projection: this.options.projection}), !0))
}}), function () {
    "use strict";
    Gis.Commands.customActionEvent = Gis.Commands.Command.extend({required: ["gis", "connection", "id", "action"], options: {fromServer: !1, type: "customActionEvent", id: void 0, action: void 0}, execute: function () {
        this.options.fromServer || this.options.connection.sendMessage(JSON.stringify({command: "customActionEvent", id: this.options.id, action: this.options.action}))
    }})
}(), function () {
    "use strict";
    Gis.Commands.getStyles = Gis.Commands.Command.extend({required: ["gis", "connection"], options: {type: "getStyles"}, execute: function () {
        this.options.connection.sendMessage(JSON.stringify({command: "getStyles"}))
    }})
}(Gis), function () {
    "use strict";
    Gis.Commands.SendAllObjects = Gis.Commands.Command.extend({options: {type: "sendAllObjects"}, execute: function () {
        this.options.connection.sendMessage(JSON.stringify({command: "sendAllObjects", objects: this.options.gis.getLayerIDs()}))
    }}), Gis.Commands.sendAllObjects = Gis.Commands.SendAllObjects
}(Gis), function () {
    "use strict";
    Gis.Commands.sendImage = Gis.Commands.Command.extend({required: ["gis", "connection", "queryId", "image"], options: {type: "sendImage", queryId: void 0, image: void 0}, execute: function () {
        this.options.connection.sendMessage(JSON.stringify({command: "sendImage", queryId: this.options.queryId, image: this.options.image}))
    }})
}(Gis), function () {
    "use strict";
    Gis.Commands.sendObject = Gis.Commands.Command.extend({options: {type: "sendObject", id: void 0}, execute: function () {
        this.options.fromServer ? new Gis.Commands.add({gis: this.options.gis, connection: this.options.connection, object: this.options.object}).execute() : this.options.connection.sendMessage(JSON.stringify({command: "sendObject", object: this.options.gis.getLayer(this.options.id).objectData()}))
    }})
}(Gis), function () {
    "use strict";
    Gis.Commands.sendOverlayDrag = Gis.Commands.Command.extend({required: ["gis", "connection", "id", "shift_lat", "shift_lon"], options: {type: "sendImage", id: void 0, geoCoords: void 0, angle: void 0, scale: void 0, shift_lat: void 0, shift_lon: void 0}, execute: function () {
        this.options.fromServer ? Gis.Logger.log("received sendOverlayDrag from server. Do nothing.") : this.options.connection.sendMessage(JSON.stringify({command: "sendOverlayDrag", id: this.options.id, geoCoords: this.options.geoCoords, angle: this.options.angle, scale: this.options.scale, shift_lat: this.options.shift_lat, shift_lon: this.options.shift_lon}))
    }})
}(Gis), function () {
    "use strict";
    Gis.Commands.sendZoom = Gis.Commands.Command.extend({options: {type: "sendZoom"}, execute: function () {
        var a = this.options.gis.getMapProvider(), b = this.options.gis.getCenter();
        this.options.connection.sendMessage(JSON.stringify(Gis.Util.extend(Gis.Commands.sendZoom.getBounds(a), {command: "sendZoom", center: b && {lat: b.lat, lon: b.lng}})))
    }}), Gis.Commands.sendZoom.getBounds = function (a) {
        var b = a.getPixelBounds(), c = b.getTopRight(), d = b.getBottomLeft(), e = a.unproject(Gis.point(d.x, c.y)), f = a.unproject(Gis.point(c.x, d.y)), g = a.unproject(d), h = a.unproject(c);
        return{topLeft: b && {lat: e.lat, lon: e.lng}, topRight: b && {lat: h.lat, lon: h.lng}, bottomLeft: b && {lat: g.lat, lon: g.lng}, bottomRight: b && {lat: f.lat, lon: f.lng}}
    }
}(Gis), function (a) {
    "use strict";
    Gis.Commands.add = Gis.Commands.Command.extend({options: {fromServer: !0, object: void 0}, execute: function () {
        this.options.fromServer ? this._fromServerExecute() : this._toServerExecute()
    }, _toServerExecute: function () {
        this.options.object.isControllableByServer() > Gis.FULL_LOCAL && this.options.connection.sendMessage(JSON.stringify({command: "add", object: this.options.object.objectOfficialData()}))
    }, _fromServerExecute: function () {
        var b = this.options.gis, c = b.getLayer(this.options.object.id);
        c && c.getType() === this.options.object.tacticObjectType ? (b.showLayersByID(c.getId()), c.setData(this.options.object, void 0, !0), a.Logger.log("Object updated " + c.getId(), c)) : (b.addLayer(a.ObjectFactory.createObject(this.options.object), !0, !0), this.options.object.tacticObjectType === Gis.Objects.Overlay.prototype.options.tacticObjectType && new Gis.Commands.getObject({fromServer: !1, gis: this.options.gis, connection: this.options.connection, id: this.options.object.id}).execute())
    }})
}(Gis), function () {
    "use strict";
    Gis.Commands.getAllObjects = Gis.Commands.Command.extend({options: {fromServer: !0}, execute: function () {
        var a = new Gis.Commands.sendAllObjects({gis: this.options.gis, connection: this.options.connection});
        a.execute()
    }})
}(Gis), function () {
    "use strict";
    Gis.Commands.getImage = Gis.Commands.Command.extend({required: ["gis", "connection", "queryId", "ids"], options: {fromServer: !0, queryId: void 0, ids: void 0, latitudes: void 0, longitudes: void 0, width: void 0, height: void 0}, execute: function () {
        console.log("NOT IMPLEMENTED")
    }})
}(Gis), function () {
    "use strict";
    Gis.Commands.getObject = Gis.Commands.Command.extend({options: {fromServer: !0, id: void 0}, execute: function () {
        if (this.options.fromServer) {
            var a = new Gis.Commands.sendObject({gis: this.options.gis, connection: this.options.connection, id: this.options.id});
            a.execute()
        } else this.options.connection.sendMessage(JSON.stringify({command: "getObject", id: this.options.id}))
    }})
}(Gis), function () {
    "use strict";
    Gis.Commands.getZoom = Gis.Commands.Command.extend({options: {fromServer: !0}, execute: function () {
        var a = new Gis.Commands.sendZoom({gis: this.options.gis, connection: this.options.connection});
        a.execute()
    }})
}(Gis), function () {
    "use strict";
    Gis.Commands.remove = Gis.Commands.Command.extend({options: {fromServer: !0, ids: void 0}, execute: function () {
        if (this.options.fromServer) {
            if (!this.options.ids.length)throw new Error("layers with id=" + JSON.stringify(this.options.ids) + " not exist");
            this.options.gis.removeLayer(this.options.ids)
        } else this.options.connection.sendMessage(JSON.stringify({command: "remove", ids: this.options.ids}))
    }})
}(Gis), function () {
    "use strict";
    Gis.Commands.removeByCreator = Gis.Commands.Command.extend({options: {fromServer: !0, creator: void 0}, execute: function () {
        var a = this.options.gis.getLayerIDs(), b = this, c = b.options.creator;
        a.length && a.forEach(function (a) {
            a.getTag(Gis.Objects.Base.CREATOR_TAG_NAME) === c && b.removeLayer(a)
        })
    }})
}(Gis), function () {
    "use strict";
    Gis.Commands.setStyle = Gis.Commands.Command.extend({options: {fromServer: !0, name: void 0, style: void 0}, execute: function () {
        this.options.gis.putStyle(this.options.style)
    }})
}(Gis), function () {
    "use strict";
    Gis.Commands.setStyles = Gis.Commands.Command.extend({options: {fromServer: !0, styles: void 0}, execute: function () {
        var a = this.options.gis;
        this.styles && a.putStyle(this.styles)
    }})
}(Gis), function () {
    "use strict";
    Gis.Commands.setZoom = Gis.Commands.Command.extend({options: {fromServer: !0, ids: void 0, coords: void 0, latitudes: void 0, longitudes: void 0}, execute: function () {
        var a, b, c, d, e = this.options.coords;
        if (e)for (a = [], b = [], c = 0, d = e.length; d > c; c += 1)a.push(e[c].lat), b.push(e[c].lon); else a = this.options.latitudes, b = this.options.longitudes;
        this.options.gis.setMapBounds({ids: this.options.ids, latitudes: a, longitudes: b})
    }})
}(Gis);